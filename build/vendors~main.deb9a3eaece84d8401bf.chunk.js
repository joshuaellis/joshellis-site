(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"0091fa8d74c45e0dd589":function(e,t){t.f={}.propertyIsEnumerable},"00c22f5845a5f3d8fe8c":function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("1ae513448994dc2a1e86").set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c="process"==r("0116c75136b233002fb9")(a);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var h=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),r=function(){d.data=h=!h}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},"0116c75136b233002fb9":function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},"01a9501d9e4a26a76a44":function(e,t,r){(e.exports=r("c138e55a31f3f8960e99")(!1)).push([e.i,"/*! sanitize.css v4.1.0 | CC0 License | github.com/jonathantneal/sanitize.css */article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}*,:after,:before{background-repeat:no-repeat;box-sizing:inherit}:after,:before{text-decoration:inherit;vertical-align:inherit}html{box-sizing:border-box;cursor:default;font-family:sans-serif;line-height:1.5;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}hr{height:0;overflow:visible}nav ol,nav ul{list-style:none}abbr[title]{border-bottom:1px dotted;text-decoration:none}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}mark{background-color:#ff0;color:#000}progress{vertical-align:baseline}small,sub,sup{font-size:83.3333%}sub,sup{line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}::-moz-selection{background-color:#b3d4fc;color:#000;text-shadow:none}::selection{background-color:#b3d4fc;color:#000;text-shadow:none}audio,canvas,iframe,img,svg,video{vertical-align:middle}img{border-style:none}svg{fill:currentColor}svg:not(:root){overflow:hidden}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:hover{outline-width:0}table{border-collapse:collapse;border-spacing:0}button,input,select,textarea{background-color:transparent;border-style:none;color:inherit;font-size:1em;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto;resize:vertical}[type=checkbox],[type=radio]{padding:0}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-cancel-button,::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled]{cursor:default}[tabindex],a,area,button,input,label,select,textarea{-ms-touch-action:manipulation;touch-action:manipulation}[hidden][aria-hidden=false]{clip:rect(0,0,0,0);display:inherit;position:absolute}[hidden][aria-hidden=false]:focus{clip:auto}",""])},"02fcd2201285b358795d":function(e,t,r){"use strict";if(r("5975c7ea3ecd56e534e3")){var n=r("46a1a30d151cac60057c"),i=r("1139de1233fd67f45bd7"),o=r("7a7739dd8a198a2cfcb5"),a=r("2d13d93c336705cd8ff9"),s=r("622bea1a0aa515bde59f"),c=r("41f6983f842d46fa6592"),u=r("0e717e1f47872428608d"),l=r("fd8b6034a9a06242cc87"),h=r("9d5592e83ab7f3d08974"),d=r("5f25c015bbbf9d42c661"),f=r("503a0df91bcab33c39b8"),p=r("1f3157d073736826d4fa"),m=r("ca19e32ab6ee3b3692aa"),v=r("2dc5be6768ca6c7f0d4d"),g=r("23d432718b3e8ce32362"),y=r("4ef7a75a1d1957a7c5c0"),b=r("d34390b928ecadc11dc8"),x=r("32b716d95af2fd3c5c23"),w=r("a459ab805827640a27e8"),_=r("d394d0a4c1838202489d"),S=r("71d3ec5bd65418e28ebc"),M=r("ef09ce044ac3210bc947"),T=r("12323e1413cbffdabe02"),A=r("a9e0e4b5ca884ed0dd59").f,E=r("f88518adc3004bf8d923"),C=r("273d2eedcd369c189e70"),L=r("621a65702ee1a566fd32"),P=r("ecd0e0fb36455021f082"),O=r("2076e982c14c41925fb4"),N=r("8b246eab22bc34690d38"),R=r("307014e72ed12da69e15"),I=r("224ae09e536c09e69a0a"),D=r("574ea81f94fc0b2f332a"),F=r("89a21af31babcdc56725"),U=r("03192b087bb464f059c0"),k=r("06b2b473e53cc019ca74"),B=r("1b01d0e59d3af79760a0"),z=r("61fcea04092a9580d371"),j=B.f,V=z.f,G=i.RangeError,W=i.TypeError,H=i.Uint8Array,X=Array.prototype,q=c.ArrayBuffer,Y=c.DataView,J=P(0),Q=P(2),Z=P(3),K=P(4),$=P(5),ee=P(6),te=O(!0),re=O(!1),ne=R.values,ie=R.keys,oe=R.entries,ae=X.lastIndexOf,se=X.reduce,ce=X.reduceRight,ue=X.join,le=X.sort,he=X.slice,de=X.toString,fe=X.toLocaleString,pe=L("iterator"),me=L("toStringTag"),ve=C("typed_constructor"),ge=C("def_constructor"),ye=s.CONSTR,be=s.TYPED,xe=s.VIEW,we=P(1,function(e,t){return Ae(N(e,e[ge]),t)}),_e=o(function(){return 1===new H(new Uint16Array([1]).buffer)[0]}),Se=!!H&&!!H.prototype.set&&o(function(){new H(1).set({})}),Me=function(e,t){var r=p(e);if(r<0||r%t)throw G("Wrong offset!");return r},Te=function(e){if(w(e)&&be in e)return e;throw W(e+" is not a typed array!")},Ae=function(e,t){if(!(w(e)&&ve in e))throw W("It is not a typed array constructor!");return new e(t)},Ee=function(e,t){return Ce(N(e,e[ge]),t)},Ce=function(e,t){for(var r=0,n=t.length,i=Ae(e,n);n>r;)i[r]=t[r++];return i},Le=function(e,t,r){j(e,t,{get:function(){return this._d[r]}})},Pe=function(e){var t,r,n,i,o,a,s=_(e),c=arguments.length,l=c>1?arguments[1]:void 0,h=void 0!==l,d=E(s);if(void 0!=d&&!S(d)){for(a=d.call(s),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);s=n}for(h&&c>2&&(l=u(l,arguments[2],2)),t=0,r=m(s.length),i=Ae(this,r);r>t;t++)i[t]=h?l(s[t],t):s[t];return i},Oe=function(){for(var e=0,t=arguments.length,r=Ae(this,t);t>e;)r[e]=arguments[e++];return r},Ne=!!H&&o(function(){fe.call(new H(1))}),Re=function(){return fe.apply(Ne?he.call(Te(this)):Te(this),arguments)},Ie={copyWithin:function(e,t){return k.call(Te(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return K(Te(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return U.apply(Te(this),arguments)},filter:function(e){return Ee(this,Q(Te(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return $(Te(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Te(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){J(Te(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Te(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Te(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ue.apply(Te(this),arguments)},lastIndexOf:function(e){return ae.apply(Te(this),arguments)},map:function(e){return we(Te(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Te(this),arguments)},reduceRight:function(e){return ce.apply(Te(this),arguments)},reverse:function(){for(var e,t=Te(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return Z(Te(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return le.call(Te(this),e)},subarray:function(e,t){var r=Te(this),n=r.length,i=g(e,n);return new(N(r,r[ge]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,m((void 0===t?n:g(t,n))-i))}},De=function(e,t){return Ee(this,he.call(Te(this),e,t))},Fe=function(e){Te(this);var t=Me(arguments[1],1),r=this.length,n=_(e),i=m(n.length),o=0;if(i+t>r)throw G("Wrong length!");for(;o<i;)this[t+o]=n[o++]},Ue={entries:function(){return oe.call(Te(this))},keys:function(){return ie.call(Te(this))},values:function(){return ne.call(Te(this))}},ke=function(e,t){return w(e)&&e[be]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Be=function(e,t){return ke(e,t=y(t,!0))?h(2,e[t]):V(e,t)},ze=function(e,t,r){return!(ke(e,t=y(t,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?j(e,t,r):(e[t]=r.value,e)};ye||(z.f=Be,B.f=ze),a(a.S+a.F*!ye,"Object",{getOwnPropertyDescriptor:Be,defineProperty:ze}),o(function(){de.call({})})&&(de=fe=function(){return ue.call(this)});var je=f({},Ie);f(je,Ue),d(je,pe,Ue.values),f(je,{slice:De,set:Fe,constructor:function(){},toString:de,toLocaleString:Re}),Le(je,"buffer","b"),Le(je,"byteOffset","o"),Le(je,"byteLength","l"),Le(je,"length","e"),j(je,me,{get:function(){return this[be]}}),e.exports=function(e,t,r,c){var u=e+((c=!!c)?"Clamped":"")+"Array",h="get"+e,f="set"+e,p=i[u],g=p||{},y=p&&T(p),b=!p||!s.ABV,_={},S=p&&p.prototype,E=function(e,r){j(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[h](r*t+n.o,_e)}(this,r)},set:function(e){return function(e,r,n){var i=e._d;c&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[f](r*t+i.o,n,_e)}(this,r,e)},enumerable:!0})};b?(p=r(function(e,r,n,i){l(e,p,u,"_d");var o,a,s,c,h=0,f=0;if(w(r)){if(!(r instanceof q||"ArrayBuffer"==(c=x(r))||"SharedArrayBuffer"==c))return be in r?Ce(p,r):Pe.call(p,r);o=r,f=Me(n,t);var g=r.byteLength;if(void 0===i){if(g%t)throw G("Wrong length!");if((a=g-f)<0)throw G("Wrong length!")}else if((a=m(i)*t)+f>g)throw G("Wrong length!");s=a/t}else s=v(r),o=new q(a=s*t);for(d(e,"_d",{b:o,o:f,l:a,e:s,v:new Y(o)});h<s;)E(e,h++)}),S=p.prototype=M(je),d(S,"constructor",p)):o(function(){p(1)})&&o(function(){new p(-1)})&&D(function(e){new p,new p(null),new p(1.5),new p(e)},!0)||(p=r(function(e,r,n,i){var o;return l(e,p,u),w(r)?r instanceof q||"ArrayBuffer"==(o=x(r))||"SharedArrayBuffer"==o?void 0!==i?new g(r,Me(n,t),i):void 0!==n?new g(r,Me(n,t)):new g(r):be in r?Ce(p,r):Pe.call(p,r):new g(v(r))}),J(y!==Function.prototype?A(g).concat(A(y)):A(g),function(e){e in p||d(p,e,g[e])}),p.prototype=S,n||(S.constructor=p));var C=S[pe],L=!!C&&("values"==C.name||void 0==C.name),P=Ue.values;d(p,ve,!0),d(S,be,u),d(S,xe,!0),d(S,ge,p),(c?new p(1)[me]==u:me in S)||j(S,me,{get:function(){return u}}),_[u]=p,a(a.G+a.W+a.F*(p!=g),_),a(a.S,u,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o(function(){g.of.call(p,1)}),u,{from:Pe,of:Oe}),"BYTES_PER_ELEMENT"in S||d(S,"BYTES_PER_ELEMENT",t),a(a.P,u,Ie),F(u),a(a.P+a.F*Se,u,{set:Fe}),a(a.P+a.F*!L,u,Ue),n||S.toString==de||(S.toString=de),a(a.P+a.F*o(function(){new p(1).slice()}),u,{slice:De}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!o(function(){S.toLocaleString.call([1,2])})),u,{toLocaleString:Re}),I[u]=L?C:P,n||L||d(S,pe,P)}}else e.exports=function(){}},"03192b087bb464f059c0":function(e,t,r){"use strict";var n=r("d394d0a4c1838202489d"),i=r("23d432718b3e8ce32362"),o=r("ca19e32ab6ee3b3692aa");e.exports=function(e){for(var t=n(this),r=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),c=a>2?arguments[2]:void 0,u=void 0===c?r:i(c,r);u>s;)t[s++]=e;return t}},"03ba1ede2f4706d1e7f7":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7a7739dd8a198a2cfcb5"),o=r("7ad2c0eb9a8edcc472a4"),a=/"/g,s=function(e,t,r,n){var i=String(o(e)),s="<"+t;return""!==r&&(s+=" "+r+'="'+String(n).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(s),n(n.P+n.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)}},"044f282f6141fc605782":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"0565be87d109f51269ca":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(2);n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},"0594430ce9777a0767aa":function(e,t,r){var n=r("6ae9955278ddcf01bbfd");e.exports=function(e,t){return new(n(e))(t)}},"0633550d227682cecd10":function(e,t,r){"use strict";var n=r("1139de1233fd67f45bd7"),i=r("2d13d93c336705cd8ff9"),o=r("88db22626e6c88b175cf"),a=r("503a0df91bcab33c39b8"),s=r("87f7b2a2f3e179b5c40a"),c=r("4133d6461867e9751fc3"),u=r("fd8b6034a9a06242cc87"),l=r("a459ab805827640a27e8"),h=r("7a7739dd8a198a2cfcb5"),d=r("574ea81f94fc0b2f332a"),f=r("62828dc3ffa96c06b7c9"),p=r("cf8d6afd09746a2b5bc3");e.exports=function(e,t,r,m,v,g){var y=n[e],b=y,x=v?"set":"add",w=b&&b.prototype,_={},S=function(e){var t=w[e];o(w,e,"delete"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof b&&(g||w.forEach&&!h(function(){(new b).entries().next()}))){var M=new b,T=M[x](g?{}:-0,1)!=M,A=h(function(){M.has(1)}),E=d(function(e){new b(e)}),C=!g&&h(function(){for(var e=new b,t=5;t--;)e[x](t,t);return!e.has(-0)});E||((b=t(function(t,r){u(t,b,e);var n=p(new y,t,b);return void 0!=r&&c(r,v,n[x],n),n})).prototype=w,w.constructor=b),(A||C)&&(S("delete"),S("has"),v&&S("get")),(C||T)&&S(x),g&&w.clear&&delete w.clear}else b=m.getConstructor(t,e,v,x),a(b.prototype,r),s.NEED=!0;return f(b,e),_[e]=b,i(i.G+i.W+i.F*(b!=y),_),g||m.setStrong(b,e,v),b}},"06b2b473e53cc019ca74":function(e,t,r){"use strict";var n=r("d394d0a4c1838202489d"),i=r("23d432718b3e8ce32362"),o=r("ca19e32ab6ee3b3692aa");e.exports=[].copyWithin||function(e,t){var r=n(this),a=o(r.length),s=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),h=1;for(c<s&&s<c+l&&(h=-1,c+=l-1,s+=l-1);l-- >0;)c in r?r[s]=r[c]:delete r[s],s+=h,c+=h;return r}},"06d4481d8fe57248a157":function(e,t,r){var n=r("1139de1233fd67f45bd7").parseInt,i=r("57e7a4ee5fd1ce9280ef").trim,o=r("f3bd18506acf22d8f1d4"),a=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(a.test(r)?16:10))}:n},"07a2173bac8ab93c3080":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=c(r("49a47d064cfbf2949ee5")),o=c(r("6a4f9c383785f9168266")),a=c(r("8af190b70a6bc55c6f1b")),s=c(r("8a2d1b95e05b6a321e74"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.state={match:n.computeMatch(n.props.history.location.pathname)},u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:n({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},t.prototype.computeMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}},t.prototype.componentWillMount=function(){var e=this,t=this.props,r=t.children,n=t.history;(0,o.default)(null==r||1===a.default.Children.count(r),"A <Router> may have only one child element"),this.unlisten=n.listen(function(){e.setState({match:e.computeMatch(n.location.pathname)})})},t.prototype.componentWillReceiveProps=function(e){(0,i.default)(this.props.history===e.history,"You cannot change <Router history>")},t.prototype.componentWillUnmount=function(){this.unlisten()},t.prototype.render=function(){var e=this.props.children;return e?a.default.Children.only(e):null},t}(a.default.Component);l.propTypes={history:s.default.object.isRequired,children:s.default.node},l.contextTypes={router:s.default.object},l.childContextTypes={router:s.default.object.isRequired},t.default=l},"07de7eab7d9aab23fb86":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("79c91dcd8cd554c59c7b"),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},"07f8363c924f4e12fef3":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("efae14a3f8cd9a616256"),o=r("ca19e32ab6ee3b3692aa");n(n.S,"String",{raw:function(e){for(var t=i(e.raw),r=o(t.length),n=arguments.length,a=[],s=0;r>s;)a.push(String(t[s++])),s<n&&a.push(String(arguments[s]));return a.join("")}})},"089f6438d068e21c2e37":function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},"08aacfc067e33d327708":function(e,t,r){"use strict";
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},"0a5193b0534d54dbcda1":function(e,t,r){"use strict";var n=r("0e717e1f47872428608d"),i=r("2d13d93c336705cd8ff9"),o=r("d394d0a4c1838202489d"),a=r("4357234160788ed77205"),s=r("71d3ec5bd65418e28ebc"),c=r("ca19e32ab6ee3b3692aa"),u=r("8de492c765fbfb624515"),l=r("f88518adc3004bf8d923");i(i.S+i.F*!r("574ea81f94fc0b2f332a")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,i,h,d=o(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,v=void 0!==m,g=0,y=l(d);if(v&&(m=n(m,p>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(r=new f(t=c(d.length));t>g;g++)u(r,g,v?m(d[g],g):d[g]);else for(h=y.call(d),r=new f;!(i=h.next()).done;g++)u(r,g,v?a(h,m,[i.value,g],!0):i.value);return r.length=g,r}})},"0aac488a388d7f2d0eea":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},"0b3f87eafc807ad7f3a2":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},"0b69aae3945a07e52c9a":function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=n.get,a=n.key;n.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},"0bd0985e8178c4e69b67":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("87f7b2a2f3e179b5c40a").onFreeze;r("f34797c0b42452934317")("seal",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},"0ce98ded3187eccaf15a":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("d394d0a4c1838202489d"),o=r("4d073e2fededcdd3f3d3"),a=r("1b01d0e59d3af79760a0");r("5975c7ea3ecd56e534e3")&&n(n.P+r("615b8c1bc8c3f66221bc"),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},"0cfe2a6849380b697b26":function(e,t,r){r("02fcd2201285b358795d")("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},"0d694d86343010af9d4f":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("79c91dcd8cd554c59c7b"),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r("0e717e1f47872428608d")(Function.call,r("61fcea04092a9580d371").f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},"0d7f0986bcd2f33d8a2a":function(e,t,r){t.__esModule=!0,t.Helmet=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=h(r("8af190b70a6bc55c6f1b")),a=h(r("8a2d1b95e05b6a321e74")),s=h(r("7830fb198d99e49e14ff")),c=h(r("1cbd705abc411c9a1e5b")),u=r("c8f33559dbc0657cda35"),l=r("b93293c8278c29a2c7c2");function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var f=function(e){var t,r;return r=t=function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),r.prototype.shouldComponentUpdate=function(e){return!(0,c.default)(this.props,e)},r.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case l.TAG_NAMES.SCRIPT:case l.TAG_NAMES.NOSCRIPT:return{innerHTML:t};case l.TAG_NAMES.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},r.prototype.flattenArrayTypeChildren=function(e){var t,r=e.child,i=e.arrayTypeChildren,o=e.newChildProps,a=e.nestedChildren;return n({},i,((t={})[r.type]=[].concat(i[r.type]||[],[n({},o,this.mapNestedChildrenToProps(r,a))]),t))},r.prototype.mapObjectTypeChildren=function(e){var t,r,i=e.child,o=e.newProps,a=e.newChildProps,s=e.nestedChildren;switch(i.type){case l.TAG_NAMES.TITLE:return n({},o,((t={})[i.type]=s,t.titleAttributes=n({},a),t));case l.TAG_NAMES.BODY:return n({},o,{bodyAttributes:n({},a)});case l.TAG_NAMES.HTML:return n({},o,{htmlAttributes:n({},a)})}return n({},o,((r={})[i.type]=n({},a),r))},r.prototype.mapArrayTypeChildrenToProps=function(e,t){var r=n({},t);return Object.keys(e).forEach(function(t){var i;r=n({},r,((i={})[t]=e[t],i))}),r},r.prototype.warnOnInvalidChildren=function(e,t){return!0},r.prototype.mapChildrenToProps=function(e,t){var r=this,n={};return o.default.Children.forEach(e,function(e){if(e&&e.props){var i=e.props,o=i.children,a=d(i,["children"]),s=(0,u.convertReactPropstoHtmlAttributes)(a);switch(r.warnOnInvalidChildren(e,o),e.type){case l.TAG_NAMES.LINK:case l.TAG_NAMES.META:case l.TAG_NAMES.NOSCRIPT:case l.TAG_NAMES.SCRIPT:case l.TAG_NAMES.STYLE:n=r.flattenArrayTypeChildren({child:e,arrayTypeChildren:n,newChildProps:s,nestedChildren:o});break;default:t=r.mapObjectTypeChildren({child:e,newProps:t,newChildProps:s,nestedChildren:o})}}}),t=this.mapArrayTypeChildrenToProps(n,t)},r.prototype.render=function(){var t=this.props,r=t.children,i=d(t,["children"]),a=n({},i);return r&&(a=this.mapChildrenToProps(r,a)),o.default.createElement(e,a)},i(r,null,[{key:"canUseDOM",set:function(t){e.canUseDOM=t}}]),r}(o.default.Component),t.propTypes={base:a.default.object,bodyAttributes:a.default.object,children:a.default.oneOfType([a.default.arrayOf(a.default.node),a.default.node]),defaultTitle:a.default.string,defer:a.default.bool,encodeSpecialCharacters:a.default.bool,htmlAttributes:a.default.object,link:a.default.arrayOf(a.default.object),meta:a.default.arrayOf(a.default.object),noscript:a.default.arrayOf(a.default.object),onChangeClientState:a.default.func,script:a.default.arrayOf(a.default.object),style:a.default.arrayOf(a.default.object),title:a.default.string,titleAttributes:a.default.object,titleTemplate:a.default.string},t.defaultProps={defer:!0,encodeSpecialCharacters:!0},t.peek=e.peek,t.rewind=function(){var t=e.rewind();return t||(t=(0,u.mapStateOnServer)({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),t},r}((0,s.default)(u.reducePropsToState,u.handleClientStateChange,u.mapStateOnServer)(function(){return null}));f.renderStatic=f.rewind,t.Helmet=f,t.default=f},"0e717e1f47872428608d":function(e,t,r){var n=r("4d073e2fededcdd3f3d3");e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},"0efece4c8cb91e128a85":function(e,t,r){"use strict";e.exports=r("82c3e6e6e3fe41af700d")},"0f025c284bc567debf3d":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(0),o=r("40b064d4eb439c0c1c2b")([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},"0f2d451cc44dcac3d457":function(e,t,r){r("02fcd2201285b358795d")("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},"0f3e6bbfb9058f37cb22":function(e,t,r){r("f34797c0b42452934317")("getOwnPropertyNames",function(){return r("92efe77f5aacb0dee3db").f})},"0fcd62dab3511fe4dbf9":function(e,t,r){"use strict";var n=r("4d073e2fededcdd3f3d3");e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},"104a011c3c0c4bae71c3":function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},"112d1eecaede6e2dcf09":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Object",{create:r("ef09ce044ac3210bc947")})},"1139de1233fd67f45bd7":function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},"113c58cbe121d529688c":function(e,t,r){r("c68991e63a6e99ff2511")("observable")},"11d2d9cd5d1b52a535e7":function(e,t,r){"use strict";r.r(t),function(e,n){function i(){}r.d(t,"WebGLRenderTargetCube",function(){return Qt}),r.d(t,"WebGLRenderTarget",function(){return Jt}),r.d(t,"WebGLRenderer",function(){return li}),r.d(t,"ShaderLib",function(){return sr}),r.d(t,"UniformsLib",function(){return ar}),r.d(t,"UniformsUtils",function(){return nr}),r.d(t,"ShaderChunk",function(){return rr}),r.d(t,"FogExp2",function(){return hi}),r.d(t,"Fog",function(){return di}),r.d(t,"Scene",function(){return fi}),r.d(t,"Sprite",function(){return gi}),r.d(t,"LOD",function(){return yi}),r.d(t,"SkinnedMesh",function(){return wi}),r.d(t,"Skeleton",function(){return bi}),r.d(t,"Bone",function(){return xi}),r.d(t,"Mesh",function(){return jr}),r.d(t,"LineSegments",function(){return Mi}),r.d(t,"LineLoop",function(){return Ti}),r.d(t,"Line",function(){return Si}),r.d(t,"Points",function(){return Ei}),r.d(t,"Group",function(){return oi}),r.d(t,"VideoTexture",function(){return Ci}),r.d(t,"DataTexture",function(){return Zt}),r.d(t,"DataTexture3D",function(){return Wr}),r.d(t,"CompressedTexture",function(){return Li}),r.d(t,"CubeTexture",function(){return Gr}),r.d(t,"CanvasTexture",function(){return Pi}),r.d(t,"DepthTexture",function(){return Oi}),r.d(t,"Texture",function(){return qt}),r.d(t,"CompressedTextureLoader",function(){return ca}),r.d(t,"DataTextureLoader",function(){return ua}),r.d(t,"CubeTextureLoader",function(){return ha}),r.d(t,"TextureLoader",function(){return da}),r.d(t,"ObjectLoader",function(){return ps}),r.d(t,"MaterialLoader",function(){return cs}),r.d(t,"BufferGeometryLoader",function(){return us}),r.d(t,"DefaultLoadingManager",function(){return oa}),r.d(t,"LoadingManager",function(){return ia}),r.d(t,"JSONLoader",function(){return fs}),r.d(t,"ImageLoader",function(){return la}),r.d(t,"ImageBitmapLoader",function(){return bs}),r.d(t,"FontLoader",function(){return Ss}),r.d(t,"FileLoader",function(){return sa}),r.d(t,"Loader",function(){return hs}),r.d(t,"LoaderUtils",function(){return ds}),r.d(t,"Cache",function(){return na}),r.d(t,"AudioLoader",function(){return Ts}),r.d(t,"SpotLightShadow",function(){return Ba}),r.d(t,"SpotLight",function(){return za}),r.d(t,"PointLight",function(){return ja}),r.d(t,"RectAreaLight",function(){return Xa}),r.d(t,"HemisphereLight",function(){return Ua}),r.d(t,"DirectionalLightShadow",function(){return Ga}),r.d(t,"DirectionalLight",function(){return Wa}),r.d(t,"AmbientLight",function(){return Ha}),r.d(t,"LightShadow",function(){return ka}),r.d(t,"Light",function(){return Fa}),r.d(t,"StereoCamera",function(){return As}),r.d(t,"PerspectiveCamera",function(){return si}),r.d(t,"OrthographicCamera",function(){return Va}),r.d(t,"CubeCamera",function(){return Es}),r.d(t,"ArrayCamera",function(){return ci}),r.d(t,"Camera",function(){return ai}),r.d(t,"AudioListener",function(){return Cs}),r.d(t,"PositionalAudio",function(){return Ps}),r.d(t,"AudioContext",function(){return Ms}),r.d(t,"AudioAnalyser",function(){return Os}),r.d(t,"Audio",function(){return Ls}),r.d(t,"VectorKeyframeTrack",function(){return os}),r.d(t,"StringKeyframeTrack",function(){return is}),r.d(t,"QuaternionKeyframeTrack",function(){return ns}),r.d(t,"NumberKeyframeTrack",function(){return ts}),r.d(t,"ColorKeyframeTrack",function(){return es}),r.d(t,"BooleanKeyframeTrack",function(){return $a}),r.d(t,"PropertyMixer",function(){return Ns}),r.d(t,"PropertyBinding",function(){return Fs}),r.d(t,"KeyframeTrack",function(){return Ka}),r.d(t,"AnimationUtils",function(){return qa}),r.d(t,"AnimationObjectGroup",function(){return Us}),r.d(t,"AnimationMixer",function(){return Bs}),r.d(t,"AnimationClip",function(){return as}),r.d(t,"Uniform",function(){return zs}),r.d(t,"InstancedBufferGeometry",function(){return js}),r.d(t,"BufferGeometry",function(){return Pr}),r.d(t,"Geometry",function(){return vr}),r.d(t,"InterleavedBufferAttribute",function(){return mi}),r.d(t,"InstancedInterleavedBuffer",function(){return Vs}),r.d(t,"InterleavedBuffer",function(){return pi}),r.d(t,"InstancedBufferAttribute",function(){return Gs}),r.d(t,"Face3",function(){return lr}),r.d(t,"Object3D",function(){return pr}),r.d(t,"Raycaster",function(){return Ws}),r.d(t,"Layers",function(){return dr}),r.d(t,"EventDispatcher",function(){return i}),r.d(t,"Clock",function(){return qs}),r.d(t,"QuaternionLinearInterpolant",function(){return rs}),r.d(t,"LinearInterpolant",function(){return Qa}),r.d(t,"DiscreteInterpolant",function(){return Za}),r.d(t,"CubicInterpolant",function(){return Ja}),r.d(t,"Interpolant",function(){return Ya}),r.d(t,"Triangle",function(){return Br}),r.d(t,"Math",function(){return Bt}),r.d(t,"Spherical",function(){return Ys}),r.d(t,"Cylindrical",function(){return Js}),r.d(t,"Plane",function(){return er}),r.d(t,"Frustum",function(){return tr}),r.d(t,"Sphere",function(){return $t}),r.d(t,"Ray",function(){return kr}),r.d(t,"Matrix4",function(){return jt}),r.d(t,"Matrix3",function(){return Wt}),r.d(t,"Box3",function(){return Kt}),r.d(t,"Box2",function(){return Qs}),r.d(t,"Line3",function(){return Zs}),r.d(t,"Euler",function(){return hr}),r.d(t,"Vector4",function(){return Yt}),r.d(t,"Vector3",function(){return Gt}),r.d(t,"Vector2",function(){return zt}),r.d(t,"Quaternion",function(){return Vt}),r.d(t,"Color",function(){return or}),r.d(t,"ImmediateRenderObject",function(){return Ks}),r.d(t,"VertexNormalsHelper",function(){return $s}),r.d(t,"SpotLightHelper",function(){return ec}),r.d(t,"SkeletonHelper",function(){return tc}),r.d(t,"PointLightHelper",function(){return rc}),r.d(t,"RectAreaLightHelper",function(){return nc}),r.d(t,"HemisphereLightHelper",function(){return ic}),r.d(t,"GridHelper",function(){return oc}),r.d(t,"PolarGridHelper",function(){return ac}),r.d(t,"FaceNormalsHelper",function(){return sc}),r.d(t,"DirectionalLightHelper",function(){return cc}),r.d(t,"CameraHelper",function(){return uc}),r.d(t,"BoxHelper",function(){return lc}),r.d(t,"Box3Helper",function(){return hc}),r.d(t,"PlaneHelper",function(){return dc}),r.d(t,"ArrowHelper",function(){return fc}),r.d(t,"AxesHelper",function(){return pc}),r.d(t,"Shape",function(){return Da}),r.d(t,"Path",function(){return Ia}),r.d(t,"ShapePath",function(){return xs}),r.d(t,"Font",function(){return ws}),r.d(t,"CurvePath",function(){return Ra}),r.d(t,"Curve",function(){return fa}),r.d(t,"ImageUtils",function(){return Ht}),r.d(t,"ShapeUtils",function(){return xo}),r.d(t,"WebGLUtils",function(){return ii}),r.d(t,"WireframeGeometry",function(){return Ni}),r.d(t,"ParametricGeometry",function(){return Ri}),r.d(t,"ParametricBufferGeometry",function(){return Ii}),r.d(t,"TetrahedronGeometry",function(){return Ui}),r.d(t,"TetrahedronBufferGeometry",function(){return ki}),r.d(t,"OctahedronGeometry",function(){return Bi}),r.d(t,"OctahedronBufferGeometry",function(){return zi}),r.d(t,"IcosahedronGeometry",function(){return ji}),r.d(t,"IcosahedronBufferGeometry",function(){return Vi}),r.d(t,"DodecahedronGeometry",function(){return Gi}),r.d(t,"DodecahedronBufferGeometry",function(){return Wi}),r.d(t,"PolyhedronGeometry",function(){return Di}),r.d(t,"PolyhedronBufferGeometry",function(){return Fi}),r.d(t,"TubeGeometry",function(){return Hi}),r.d(t,"TubeBufferGeometry",function(){return Xi}),r.d(t,"TorusKnotGeometry",function(){return qi}),r.d(t,"TorusKnotBufferGeometry",function(){return Yi}),r.d(t,"TorusGeometry",function(){return Ji}),r.d(t,"TorusBufferGeometry",function(){return Qi}),r.d(t,"TextGeometry",function(){return Eo}),r.d(t,"TextBufferGeometry",function(){return Co}),r.d(t,"SphereGeometry",function(){return Lo}),r.d(t,"SphereBufferGeometry",function(){return Po}),r.d(t,"RingGeometry",function(){return Oo}),r.d(t,"RingBufferGeometry",function(){return No}),r.d(t,"PlaneGeometry",function(){return Rr}),r.d(t,"PlaneBufferGeometry",function(){return Ir}),r.d(t,"LatheGeometry",function(){return Ro}),r.d(t,"LatheBufferGeometry",function(){return Io}),r.d(t,"ShapeGeometry",function(){return Do}),r.d(t,"ShapeBufferGeometry",function(){return Fo}),r.d(t,"ExtrudeGeometry",function(){return So}),r.d(t,"ExtrudeBufferGeometry",function(){return Mo}),r.d(t,"EdgesGeometry",function(){return ko}),r.d(t,"ConeGeometry",function(){return jo}),r.d(t,"ConeBufferGeometry",function(){return Vo}),r.d(t,"CylinderGeometry",function(){return Bo}),r.d(t,"CylinderBufferGeometry",function(){return zo}),r.d(t,"CircleGeometry",function(){return Go}),r.d(t,"CircleBufferGeometry",function(){return Wo}),r.d(t,"BoxGeometry",function(){return Or}),r.d(t,"BoxBufferGeometry",function(){return Nr}),r.d(t,"ShadowMaterial",function(){return Xo}),r.d(t,"SpriteMaterial",function(){return vi}),r.d(t,"RawShaderMaterial",function(){return qo}),r.d(t,"ShaderMaterial",function(){return Ur}),r.d(t,"PointsMaterial",function(){return Ai}),r.d(t,"MeshPhysicalMaterial",function(){return Jo}),r.d(t,"MeshStandardMaterial",function(){return Yo}),r.d(t,"MeshPhongMaterial",function(){return Qo}),r.d(t,"MeshToonMaterial",function(){return Zo}),r.d(t,"MeshNormalMaterial",function(){return Ko}),r.d(t,"MeshLambertMaterial",function(){return $o}),r.d(t,"MeshDepthMaterial",function(){return ei}),r.d(t,"MeshDistanceMaterial",function(){return ti}),r.d(t,"MeshBasicMaterial",function(){return zr}),r.d(t,"MeshMatcapMaterial",function(){return ea}),r.d(t,"LineDashedMaterial",function(){return ta}),r.d(t,"LineBasicMaterial",function(){return _i}),r.d(t,"Material",function(){return Fr}),r.d(t,"Float64BufferAttribute",function(){return Ar}),r.d(t,"Float32BufferAttribute",function(){return Tr}),r.d(t,"Uint32BufferAttribute",function(){return Mr}),r.d(t,"Int32BufferAttribute",function(){return Sr}),r.d(t,"Uint16BufferAttribute",function(){return _r}),r.d(t,"Int16BufferAttribute",function(){return wr}),r.d(t,"Uint8ClampedBufferAttribute",function(){return xr}),r.d(t,"Uint8BufferAttribute",function(){return br}),r.d(t,"Int8BufferAttribute",function(){return yr}),r.d(t,"BufferAttribute",function(){return gr}),r.d(t,"ArcCurve",function(){return ma}),r.d(t,"CatmullRomCurve3",function(){return wa}),r.d(t,"CubicBezierCurve",function(){return Ta}),r.d(t,"CubicBezierCurve3",function(){return Aa}),r.d(t,"EllipseCurve",function(){return pa}),r.d(t,"LineCurve",function(){return Ea}),r.d(t,"LineCurve3",function(){return Ca}),r.d(t,"QuadraticBezierCurve",function(){return La}),r.d(t,"QuadraticBezierCurve3",function(){return Pa}),r.d(t,"SplineCurve",function(){return Oa}),r.d(t,"REVISION",function(){return o}),r.d(t,"MOUSE",function(){return a}),r.d(t,"CullFaceNone",function(){return s}),r.d(t,"CullFaceBack",function(){return c}),r.d(t,"CullFaceFront",function(){return u}),r.d(t,"CullFaceFrontBack",function(){return l}),r.d(t,"FrontFaceDirectionCW",function(){return h}),r.d(t,"FrontFaceDirectionCCW",function(){return d}),r.d(t,"BasicShadowMap",function(){return f}),r.d(t,"PCFShadowMap",function(){return p}),r.d(t,"PCFSoftShadowMap",function(){return m}),r.d(t,"FrontSide",function(){return v}),r.d(t,"BackSide",function(){return g}),r.d(t,"DoubleSide",function(){return y}),r.d(t,"FlatShading",function(){return b}),r.d(t,"SmoothShading",function(){return x}),r.d(t,"NoColors",function(){return w}),r.d(t,"FaceColors",function(){return _}),r.d(t,"VertexColors",function(){return S}),r.d(t,"NoBlending",function(){return M}),r.d(t,"NormalBlending",function(){return T}),r.d(t,"AdditiveBlending",function(){return A}),r.d(t,"SubtractiveBlending",function(){return E}),r.d(t,"MultiplyBlending",function(){return C}),r.d(t,"CustomBlending",function(){return L}),r.d(t,"AddEquation",function(){return P}),r.d(t,"SubtractEquation",function(){return O}),r.d(t,"ReverseSubtractEquation",function(){return N}),r.d(t,"MinEquation",function(){return R}),r.d(t,"MaxEquation",function(){return I}),r.d(t,"ZeroFactor",function(){return D}),r.d(t,"OneFactor",function(){return F}),r.d(t,"SrcColorFactor",function(){return U}),r.d(t,"OneMinusSrcColorFactor",function(){return k}),r.d(t,"SrcAlphaFactor",function(){return B}),r.d(t,"OneMinusSrcAlphaFactor",function(){return z}),r.d(t,"DstAlphaFactor",function(){return j}),r.d(t,"OneMinusDstAlphaFactor",function(){return V}),r.d(t,"DstColorFactor",function(){return G}),r.d(t,"OneMinusDstColorFactor",function(){return W}),r.d(t,"SrcAlphaSaturateFactor",function(){return H}),r.d(t,"NeverDepth",function(){return X}),r.d(t,"AlwaysDepth",function(){return q}),r.d(t,"LessDepth",function(){return Y}),r.d(t,"LessEqualDepth",function(){return J}),r.d(t,"EqualDepth",function(){return Q}),r.d(t,"GreaterEqualDepth",function(){return Z}),r.d(t,"GreaterDepth",function(){return K}),r.d(t,"NotEqualDepth",function(){return $}),r.d(t,"MultiplyOperation",function(){return ee}),r.d(t,"MixOperation",function(){return te}),r.d(t,"AddOperation",function(){return re}),r.d(t,"NoToneMapping",function(){return ne}),r.d(t,"LinearToneMapping",function(){return ie}),r.d(t,"ReinhardToneMapping",function(){return oe}),r.d(t,"Uncharted2ToneMapping",function(){return ae}),r.d(t,"CineonToneMapping",function(){return se}),r.d(t,"UVMapping",function(){return ce}),r.d(t,"CubeReflectionMapping",function(){return ue}),r.d(t,"CubeRefractionMapping",function(){return le}),r.d(t,"EquirectangularReflectionMapping",function(){return he}),r.d(t,"EquirectangularRefractionMapping",function(){return de}),r.d(t,"SphericalReflectionMapping",function(){return fe}),r.d(t,"CubeUVReflectionMapping",function(){return pe}),r.d(t,"CubeUVRefractionMapping",function(){return me}),r.d(t,"RepeatWrapping",function(){return ve}),r.d(t,"ClampToEdgeWrapping",function(){return ge}),r.d(t,"MirroredRepeatWrapping",function(){return ye}),r.d(t,"NearestFilter",function(){return be}),r.d(t,"NearestMipMapNearestFilter",function(){return xe}),r.d(t,"NearestMipMapLinearFilter",function(){return we}),r.d(t,"LinearFilter",function(){return _e}),r.d(t,"LinearMipMapNearestFilter",function(){return Se}),r.d(t,"LinearMipMapLinearFilter",function(){return Me}),r.d(t,"UnsignedByteType",function(){return Te}),r.d(t,"ByteType",function(){return Ae}),r.d(t,"ShortType",function(){return Ee}),r.d(t,"UnsignedShortType",function(){return Ce}),r.d(t,"IntType",function(){return Le}),r.d(t,"UnsignedIntType",function(){return Pe}),r.d(t,"FloatType",function(){return Oe}),r.d(t,"HalfFloatType",function(){return Ne}),r.d(t,"UnsignedShort4444Type",function(){return Re}),r.d(t,"UnsignedShort5551Type",function(){return Ie}),r.d(t,"UnsignedShort565Type",function(){return De}),r.d(t,"UnsignedInt248Type",function(){return Fe}),r.d(t,"AlphaFormat",function(){return Ue}),r.d(t,"RGBFormat",function(){return ke}),r.d(t,"RGBAFormat",function(){return Be}),r.d(t,"LuminanceFormat",function(){return ze}),r.d(t,"LuminanceAlphaFormat",function(){return je}),r.d(t,"RGBEFormat",function(){return Ve}),r.d(t,"DepthFormat",function(){return Ge}),r.d(t,"DepthStencilFormat",function(){return We}),r.d(t,"RedFormat",function(){return He}),r.d(t,"RGB_S3TC_DXT1_Format",function(){return Xe}),r.d(t,"RGBA_S3TC_DXT1_Format",function(){return qe}),r.d(t,"RGBA_S3TC_DXT3_Format",function(){return Ye}),r.d(t,"RGBA_S3TC_DXT5_Format",function(){return Je}),r.d(t,"RGB_PVRTC_4BPPV1_Format",function(){return Qe}),r.d(t,"RGB_PVRTC_2BPPV1_Format",function(){return Ze}),r.d(t,"RGBA_PVRTC_4BPPV1_Format",function(){return Ke}),r.d(t,"RGBA_PVRTC_2BPPV1_Format",function(){return $e}),r.d(t,"RGB_ETC1_Format",function(){return et}),r.d(t,"RGBA_ASTC_4x4_Format",function(){return tt}),r.d(t,"RGBA_ASTC_5x4_Format",function(){return rt}),r.d(t,"RGBA_ASTC_5x5_Format",function(){return nt}),r.d(t,"RGBA_ASTC_6x5_Format",function(){return it}),r.d(t,"RGBA_ASTC_6x6_Format",function(){return ot}),r.d(t,"RGBA_ASTC_8x5_Format",function(){return at}),r.d(t,"RGBA_ASTC_8x6_Format",function(){return st}),r.d(t,"RGBA_ASTC_8x8_Format",function(){return ct}),r.d(t,"RGBA_ASTC_10x5_Format",function(){return ut}),r.d(t,"RGBA_ASTC_10x6_Format",function(){return lt}),r.d(t,"RGBA_ASTC_10x8_Format",function(){return ht}),r.d(t,"RGBA_ASTC_10x10_Format",function(){return dt}),r.d(t,"RGBA_ASTC_12x10_Format",function(){return ft}),r.d(t,"RGBA_ASTC_12x12_Format",function(){return pt}),r.d(t,"LoopOnce",function(){return mt}),r.d(t,"LoopRepeat",function(){return vt}),r.d(t,"LoopPingPong",function(){return gt}),r.d(t,"InterpolateDiscrete",function(){return yt}),r.d(t,"InterpolateLinear",function(){return bt}),r.d(t,"InterpolateSmooth",function(){return xt}),r.d(t,"ZeroCurvatureEnding",function(){return wt}),r.d(t,"ZeroSlopeEnding",function(){return _t}),r.d(t,"WrapAroundEnding",function(){return St}),r.d(t,"TrianglesDrawMode",function(){return Mt}),r.d(t,"TriangleStripDrawMode",function(){return Tt}),r.d(t,"TriangleFanDrawMode",function(){return At}),r.d(t,"LinearEncoding",function(){return Et}),r.d(t,"sRGBEncoding",function(){return Ct}),r.d(t,"GammaEncoding",function(){return Lt}),r.d(t,"RGBEEncoding",function(){return Pt}),r.d(t,"LogLuvEncoding",function(){return Ot}),r.d(t,"RGBM7Encoding",function(){return Nt}),r.d(t,"RGBM16Encoding",function(){return Rt}),r.d(t,"RGBDEncoding",function(){return It}),r.d(t,"BasicDepthPacking",function(){return Dt}),r.d(t,"RGBADepthPacking",function(){return Ft}),r.d(t,"TangentSpaceNormalMap",function(){return Ut}),r.d(t,"ObjectSpaceNormalMap",function(){return kt}),r.d(t,"CubeGeometry",function(){return Or}),r.d(t,"Face4",function(){return mc}),r.d(t,"LineStrip",function(){return vc}),r.d(t,"LinePieces",function(){return gc}),r.d(t,"MeshFaceMaterial",function(){return yc}),r.d(t,"MultiMaterial",function(){return bc}),r.d(t,"PointCloud",function(){return xc}),r.d(t,"Particle",function(){return wc}),r.d(t,"ParticleSystem",function(){return _c}),r.d(t,"PointCloudMaterial",function(){return Sc}),r.d(t,"ParticleBasicMaterial",function(){return Mc}),r.d(t,"ParticleSystemMaterial",function(){return Tc}),r.d(t,"Vertex",function(){return Ac}),r.d(t,"DynamicBufferAttribute",function(){return Ec}),r.d(t,"Int8Attribute",function(){return Cc}),r.d(t,"Uint8Attribute",function(){return Lc}),r.d(t,"Uint8ClampedAttribute",function(){return Pc}),r.d(t,"Int16Attribute",function(){return Oc}),r.d(t,"Uint16Attribute",function(){return Nc}),r.d(t,"Int32Attribute",function(){return Rc}),r.d(t,"Uint32Attribute",function(){return Ic}),r.d(t,"Float32Attribute",function(){return Dc}),r.d(t,"Float64Attribute",function(){return Fc}),r.d(t,"ClosedSplineCurve3",function(){return Uc}),r.d(t,"SplineCurve3",function(){return kc}),r.d(t,"Spline",function(){return Bc}),r.d(t,"AxisHelper",function(){return zc}),r.d(t,"BoundingBoxHelper",function(){return jc}),r.d(t,"EdgesHelper",function(){return Vc}),r.d(t,"WireframeHelper",function(){return Gc}),r.d(t,"XHRLoader",function(){return Wc}),r.d(t,"BinaryTextureLoader",function(){return Hc}),r.d(t,"GeometryUtils",function(){return Xc}),r.d(t,"Projector",function(){return qc}),r.d(t,"CanvasRenderer",function(){return Yc}),r.d(t,"SceneUtils",function(){return Jc}),r.d(t,"LensFlare",function(){return Qc}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),Object.assign(i.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=t.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,e)}}}});var o="97",a={LEFT:0,MIDDLE:1,RIGHT:2},s=0,c=1,u=2,l=3,h=0,d=1,f=0,p=1,m=2,v=0,g=1,y=2,b=1,x=2,w=0,_=1,S=2,M=0,T=1,A=2,E=3,C=4,L=5,P=100,O=101,N=102,R=103,I=104,D=200,F=201,U=202,k=203,B=204,z=205,j=206,V=207,G=208,W=209,H=210,X=0,q=1,Y=2,J=3,Q=4,Z=5,K=6,$=7,ee=0,te=1,re=2,ne=0,ie=1,oe=2,ae=3,se=4,ce=300,ue=301,le=302,he=303,de=304,fe=305,pe=306,me=307,ve=1e3,ge=1001,ye=1002,be=1003,xe=1004,we=1005,_e=1006,Se=1007,Me=1008,Te=1009,Ae=1010,Ee=1011,Ce=1012,Le=1013,Pe=1014,Oe=1015,Ne=1016,Re=1017,Ie=1018,De=1019,Fe=1020,Ue=1021,ke=1022,Be=1023,ze=1024,je=1025,Ve=Be,Ge=1026,We=1027,He=1028,Xe=33776,qe=33777,Ye=33778,Je=33779,Qe=35840,Ze=35841,Ke=35842,$e=35843,et=36196,tt=37808,rt=37809,nt=37810,it=37811,ot=37812,at=37813,st=37814,ct=37815,ut=37816,lt=37817,ht=37818,dt=37819,ft=37820,pt=37821,mt=2200,vt=2201,gt=2202,yt=2300,bt=2301,xt=2302,wt=2400,_t=2401,St=2402,Mt=0,Tt=1,At=2,Et=3e3,Ct=3001,Lt=3007,Pt=3002,Ot=3003,Nt=3004,Rt=3005,It=3006,Dt=3200,Ft=3201,Ut=0,kt=1,Bt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&r]+e[r>>8&255]+"-"+e[r>>16&15|64]+e[r>>24&255]+"-"+e[63&n|128]+e[n>>8&255]+"-"+e[n>>16&255]+e[n>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Bt.DEG2RAD},radToDeg:function(e){return e*Bt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function zt(e,t){this.x=e||0,this.y=t||0}function jt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Vt(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1}function Gt(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function Wt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(zt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(zt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new zt,t=new zt;return function(r,n){return e.set(r,r),t.set(n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*r-o*n+e.x,this.y=i*n+o*r+e.y,this}}),Object.assign(jt.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,o,a,s,c,u,l,h,d,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=u,v[10]=l,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new jt).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new Gt;return function(t){var r=this.elements,n=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),c=Math.sin(n),u=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var h=o*u,d=o*l,f=a*u,p=a*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=d+f*c,t[5]=h-p*c,t[9]=-a*s,t[2]=p-h*c,t[6]=f+d*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,v=s*l,g=c*u,y=c*l;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*c,t[1]=o*l,t[5]=o*u,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,v=s*l,g=c*u,y=c*l;t[0]=m-y*a,t[4]=-o*l,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,d=o*l,f=a*u,p=a*l;t[0]=s*u,t[4]=f*c-d,t[8]=h*c+p,t[1]=s*l,t[5]=p*c+h,t[9]=d*c-f,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*c,w=a*s,_=a*c;t[0]=s*u,t[4]=_-b*l,t[8]=w*l+x,t[1]=l,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=x*l+w,t[10]=b-_*l}else if("XZY"===e.order){b=o*s,x=o*c,w=a*s,_=a*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=b*l+_,t[5]=o*u,t[9]=x*l-w,t[2]=w*l-x,t[6]=a*u,t[10]=_*l+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new Gt(0,0,0),t=new Gt(1,1,1);return function(r){return this.compose(e,r,t)}}(),lookAt:function(){var e=new Gt,t=new Gt,r=new Gt;return function(n,i,o){var a=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),e.crossVectors(o,r),0===e.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),e.crossVectors(o,r)),e.normalize(),t.crossVectors(r,e),a[0]=e.x,a[4]=t.x,a[8]=r.x,a[1]=e.y,a[5]=t.y,a[9]=r.y,a[2]=e.z,a[6]=t.z,a[10]=r.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],c=r[12],u=r[1],l=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],v=r[14],g=r[3],y=r[7],b=r[11],x=r[15],w=n[0],_=n[4],S=n[8],M=n[12],T=n[1],A=n[5],E=n[9],C=n[13],L=n[2],P=n[6],O=n[10],N=n[14],R=n[3],I=n[7],D=n[11],F=n[15];return i[0]=o*w+a*T+s*L+c*R,i[4]=o*_+a*A+s*P+c*I,i[8]=o*S+a*E+s*O+c*D,i[12]=o*M+a*C+s*N+c*F,i[1]=u*w+l*T+h*L+d*R,i[5]=u*_+l*A+h*P+d*I,i[9]=u*S+l*E+h*O+d*D,i[13]=u*M+l*C+h*N+d*F,i[2]=f*w+p*T+m*L+v*R,i[6]=f*_+p*A+m*P+v*I,i[10]=f*S+p*E+m*O+v*D,i[14]=f*M+p*C+m*N+v*F,i[3]=g*w+y*T+b*L+x*R,i[7]=g*_+y*A+b*P+x*I,i[11]=g*S+y*E+b*O+x*D,i[15]=g*M+y*C+b*N+x*F,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Gt;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],d=e[14];return e[3]*(+i*s*l-n*c*l-i*a*h+r*c*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*c*h+i*o*h-n*o*d+n*c*u-i*s*u)+e[11]*(+t*c*l-t*a*d-i*o*l+r*o*d+i*a*u-r*c*u)+e[15]*(-n*a*u-t*s*l+t*a*h+n*o*l-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],x=f*y*h-g*p*h+g*l*m-u*y*m-f*l*b+u*p*b,w=v*p*h-d*y*h-v*l*m+c*y*m+d*l*b-c*p*b,_=d*g*h-v*f*h+v*u*m-c*g*m-d*u*b+c*f*b,S=v*f*l-d*g*l-v*u*p+c*g*p+d*u*y-c*f*y,M=i*x+o*w+a*_+s*S;if(0===M){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var A=1/M;return r[0]=x*A,r[1]=(g*p*s-f*y*s-g*a*m+o*y*m+f*a*b-o*p*b)*A,r[2]=(u*y*s-g*l*s+g*a*h-o*y*h-u*a*b+o*l*b)*A,r[3]=(f*l*s-u*p*s-f*a*h+o*p*h+u*a*m-o*l*m)*A,r[4]=w*A,r[5]=(d*y*s-v*p*s+v*a*m-i*y*m-d*a*b+i*p*b)*A,r[6]=(v*l*s-c*y*s-v*a*h+i*y*h+c*a*b-i*l*b)*A,r[7]=(c*p*s-d*l*s+d*a*h-i*p*h-c*a*m+i*l*m)*A,r[8]=_*A,r[9]=(v*f*s-d*g*s-v*o*m+i*g*m+d*o*b-i*f*b)*A,r[10]=(c*g*s-v*u*s+v*o*h-i*g*h-c*o*b+i*u*b)*A,r[11]=(d*u*s-c*f*s-d*o*h+i*f*h+c*o*m-i*u*m)*A,r[12]=S*A,r[13]=(d*g*a-v*f*a+v*o*p-i*g*p-d*o*y+i*f*y)*A,r[14]=(v*u*a-c*g*a-v*o*l+i*g*l+c*o*y-i*u*y)*A,r[15]=(c*f*a-d*u*a+d*o*l-i*f*l-c*o*p+i*u*p)*A,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;return this.set(c*o+r,c*a-n*s,c*s+n*a,0,c*a+n*s,u*a+r,u*s-n*o,0,c*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){var n=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,c=i+i,u=o+o,l=a+a,h=i*c,d=i*u,f=i*l,p=o*u,m=o*l,v=a*l,g=s*c,y=s*u,b=s*l,x=r.x,w=r.y,_=r.z;return n[0]=(1-(p+v))*x,n[1]=(d+b)*x,n[2]=(f-y)*x,n[3]=0,n[4]=(d-b)*w,n[5]=(1-(h+v))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(f+y)*_,n[9]=(m-g)*_,n[10]=(1-(h+p))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(){var e=new Gt,t=new jt;return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),c=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.copy(this);var u=1/a,l=1/s,h=1/c;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=l,t.elements[5]*=l,t.elements[6]*=l,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=c,this}}(),makePerspective:function(e,t,r,n,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),c=2*i/(r-n),u=(t+e)/(t-e),l=(r+n)/(r-n),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=1/(t-e),c=1/(r-n),u=1/(o-i),l=(t+e)*s,h=(r+n)*c,d=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),Object.assign(Vt,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,o,a){var s=r[n+0],c=r[n+1],u=r[n+2],l=r[n+3],h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(l!==p||s!==h||c!==d||u!==f){var m=1-a,v=s*h+c*d+u*f+l*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,v*g);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var w=a*g;if(s=s*m+h*w,c=c*m+d*w,u=u*m+f*w,l=l*m+p*w,m===1-a){var _=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=_,c*=_,u*=_,l*=_}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}}),Object.defineProperties(Vt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Vt.prototype,{isQuaternion:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(r/2),u=a(n/2),l=a(i/2),h=s(r/2),d=s(n/2),f=s(i/2);return"XYZ"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l-h*d*f):"YXZ"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l+h*d*f):"ZXY"===o?(this._x=h*u*l-c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l-h*d*f):"ZYX"===o?(this._x=h*u*l-c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l+h*d*f):"YZX"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l-h*d*f):"XZY"===o&&(this._x=h*u*l-c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l+h*d*f),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],c=r[9],u=r[2],l=r[6],h=r[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(l-c)*t,this._y=(o-u)*t,this._z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(l-c)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(c+l)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(c+l)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new Gt;return function(r,n){return void 0===t&&(t=new Gt),(e=r.dot(n)+1)<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),angleTo:function(e){return 2*Math.acos(Math.abs(Bt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var r=this.angleTo(e);if(0===r)return this;var n=Math.min(1,t/r);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;return this._x=r*u+o*a+n*c-i*s,this._y=n*u+o*s+i*a-r*c,this._z=i*u+o*c+r*s-n*a,this._w=o*u-r*a-n*s-i*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*r+t*this._x,this._y=c*n+t*this._y,this._z=c*i+t*this._z,this.normalize()}var u=Math.sqrt(s),l=Math.atan2(u,a),h=Math.sin((1-t)*l)/u,d=Math.sin(t*l)/u;return this._w=o*h+this._w*d,this._x=r*h+this._x*d,this._y=n*h+this._y*d,this._z=i*h+this._z*d,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Gt.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new Vt;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new Vt;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*n-a*r,u=s*r+a*t-i*n,l=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=c*s+h*-i+u*-a-l*-o,this.y=u*s+h*-o+l*-i-c*-a,this.z=l*s+h*-a+c*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(){var e=new jt;return function(t){return this.applyMatrix4(e.getInverse(t.projectionMatrix)).applyMatrix4(t.matrixWorld)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Gt,t=new Gt;return function(r,n){return e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Gt;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Gt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Bt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){var n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Wt.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,o,a,s,c){var u=this.elements;return u[0]=e,u[1]=n,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=r,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Gt;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[3],s=r[6],c=r[1],u=r[4],l=r[7],h=r[2],d=r[5],f=r[8],p=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return i[0]=o*p+a*g+s*x,i[3]=o*m+a*y+s*w,i[6]=o*v+a*b+s*_,i[1]=c*p+u*g+l*x,i[4]=c*m+u*y+l*w,i[7]=c*v+u*b+l*_,i[2]=h*p+d*g+f*x,i[5]=h*m+d*y+f*w,i[8]=h*v+d*b+f*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*i*u+r*a*s+n*i*c-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],d=r[8],f=d*c-u*h,p=u*l-d*s,m=h*s-c*l,v=i*f+o*p+a*m;if(0===v){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return n[0]=f*y,n[1]=(a*h-d*o)*y,n[2]=(u*o-a*c)*y,n[3]=p*y,n[4]=(d*i-a*l)*y,n[5]=(a*s-u*i)*y,n[6]=m*y,n[7]=(o*l-h*i)*y,n[8]=(c*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(r*s,r*c,-r*(s*o+c*a)+o+e,-n*c,n*s,-n*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],o=n[3],a=n[6],s=n[1],c=n[4],u=n[7];return n[0]=t*i+r*s,n[3]=t*o+r*c,n[6]=t*a+r*u,n[1]=-r*i+t*s,n[4]=-r*o+t*c,n[7]=-r*a+t*u,this},translate:function(e,t){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var Ht={getDataURL:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var r=t.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Xt=0;function qt(e,t,r,n,i,o,a,s,c,u){Object.defineProperty(this,"id",{value:Xt++}),this.uuid=Bt.generateUUID(),this.name="",this.image=void 0!==e?e:qt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:qt.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:ge,this.wrapT=void 0!==n?n:ge,this.magFilter=void 0!==i?i:_e,this.minFilter=void 0!==o?o:Me,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Be,this.type=void 0!==s?s:Te,this.offset=new zt(0,0),this.repeat=new zt(1,1),this.center=new zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Et,this.version=0,this.onUpdate=null}function Yt(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1}function Jt(e,t,r){this.width=e,this.height=t,this.scissor=new Yt(0,0,e,t),this.scissorTest=!1,this.viewport=new Yt(0,0,e,t),void 0===(r=r||{}).minFilter&&(r.minFilter=_e),this.texture=new qt(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.generateMipmaps=void 0===r.generateMipmaps||r.generateMipmaps,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function Qt(e,t,r){Jt.call(this,e,t,r),this.activeCubeFace=0,this.activeMipMapLevel=0}function Zt(e,t,r,n,i,o,a,s,c,u,l,h){qt.call(this,null,o,a,s,c,u,n,i,l,h),this.image={data:e,width:t,height:r},this.magFilter=void 0!==c?c:be,this.minFilter=void 0!==u?u:be,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Kt(e,t){this.min=void 0!==e?e:new Gt(1/0,1/0,1/0),this.max=void 0!==t?t:new Gt(-1/0,-1/0,-1/0)}function $t(e,t){this.center=void 0!==e?e:new Gt,this.radius=void 0!==t?t:0}function er(e,t){this.normal=void 0!==e?e:new Gt(1,0,0),this.constant=void 0!==t?t:0}function tr(e,t,r,n,i,o){this.planes=[void 0!==e?e:new er,void 0!==t?t:new er,void 0!==r?r:new er,void 0!==n?n:new er,void 0!==i?i:new er,void 0!==o?o:new er]}qt.DEFAULT_IMAGE=void 0,qt.DEFAULT_MAPPING=ce,qt.prototype=Object.assign(Object.create(i.prototype),{constructor:qt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=Bt.generateUUID()),!t&&void 0===e.images[n.uuid]){var i;if(Array.isArray(n)){i=[];for(var o=0,a=n.length;o<a;o++)i.push(Ht.getDataURL(n[o]))}else i=Ht.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==ce)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ve:e.x=e.x-Math.floor(e.x);break;case ge:e.x=e.x<0?0:1;break;case ye:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ve:e.y=e.y-Math.floor(e.y);break;case ge:e.y=e.y<0?0:1;break;case ye:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(qt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Yt.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=e.elements,a=o[0],s=o[4],c=o[8],u=o[1],l=o[5],h=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(c-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(c+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(l+1)/2,g=(p+1)/2,y=(s+u)/4,b=(c+d)/4,x=(h+f)/4;return m>v&&m>g?m<.01?(r=0,n=.707106781,i=.707106781):(n=y/(r=Math.sqrt(m)),i=b/r):v>g?v<.01?(r=.707106781,n=0,i=.707106781):(r=y/(n=Math.sqrt(v)),i=x/n):g<.01?(r=.707106781,n=.707106781,i=0):(r=b/(i=Math.sqrt(g)),n=x/i),this.set(r,n,i,t),this}var w=Math.sqrt((f-h)*(f-h)+(c-d)*(c-d)+(u-s)*(u-s));return Math.abs(w)<.001&&(w=1),this.x=(f-h)/w,this.y=(c-d)/w,this.z=(u-s)/w,this.w=Math.acos((a+l+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new Yt,t=new Yt),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Jt.prototype=Object.assign(Object.create(i.prototype),{constructor:Jt,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Qt.prototype=Object.create(Jt.prototype),Qt.prototype.constructor=Qt,Qt.prototype.isWebGLRenderTargetCube=!0,Zt.prototype=Object.create(qt.prototype),Zt.prototype.constructor=Zt,Zt.prototype.isDataTexture=!0,Object.assign(Kt.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),h=e.getZ(s);u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Gt;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Gt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Gt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,r,n=new Gt;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,r=a.length;t<r;t++)n.copy(a[t]),n.applyMatrix4(i.matrixWorld),e.expandByPoint(n)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++)n.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(n)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Gt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new Gt;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(){var e=new Gt,t=new Gt,r=new Gt,n=new Gt,i=new Gt,o=new Gt,a=new Gt,s=new Gt,c=new Gt,u=new Gt;function l(n){var i,o;for(i=0,o=n.length-3;i<=o;i+=3){a.fromArray(n,i);var s=c.x*Math.abs(a.x)+c.y*Math.abs(a.y)+c.z*Math.abs(a.z),u=e.dot(a),l=t.dot(a),h=r.dot(a);if(Math.max(-Math.max(u,l,h),Math.min(u,l,h))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),e.subVectors(a.a,s),t.subVectors(a.b,s),r.subVectors(a.c,s),n.subVectors(t,e),i.subVectors(r,t),o.subVectors(e,r);var h=[0,-n.z,n.y,0,-i.z,i.y,0,-o.z,o.y,n.z,0,-n.x,i.z,0,-i.x,o.z,0,-o.x,-n.y,n.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!l(h)&&(!!l(h=[1,0,0,0,1,0,0,0,1])&&(u.crossVectors(n,i),l(h=[u.x,u.y,u.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Gt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Gt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Gt;return function(t){return void 0===t&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),t=new $t),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new Gt,new Gt,new Gt,new Gt,new Gt,new Gt,new Gt,new Gt];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign($t.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new Kt;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).getCenter(n);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Gt),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Kt),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(er.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Gt,t=new Gt;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Gt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Gt;return function(t,r){void 0===r&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new Gt);var n=t.delta(e),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?r.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:r.copy(n).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Gt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Gt,t=new Wt;return function(r,n){var i=n||t.getNormalMatrix(r),o=this.coplanarPoint(e).applyMatrix4(r),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(tr.prototype,{set:function(e,t,r,n,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],c=r[5],u=r[6],l=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],v=r[13],g=r[14],y=r[15];return t[0].setComponents(a-n,l-s,p-h,y-m).normalize(),t[1].setComponents(a+n,l+s,p+h,y+m).normalize(),t[2].setComponents(a+i,l+c,p+d,y+v).normalize(),t[3].setComponents(a-i,l-c,p-d,y-v).normalize(),t[4].setComponents(a-o,l-u,p-f,y-g).normalize(),t[5].setComponents(a+o,l+u,p+f,y+g).normalize(),this},intersectsObject:function(){var e=new $t;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new $t;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:function(){var e=new Gt;return function(t){for(var r=this.planes,n=0;n<6;n++){var i=r[n];if(e.x=i.normal.x>0?t.max.x:t.min.x,e.y=i.normal.y>0?t.max.y:t.min.y,e.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(e)<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}});var rr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n}\n",background_vert:"varying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = vec4( position, 1.0 );\n\tgl_Position.z = 1.0;\n}\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\tvec4 matcapColor = texture2D( matcap, uv );\n\tmatcapColor = matcapTexelToLinear( matcapColor );\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},nr={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}},ir={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function or(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}Object.assign(or.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){if(t=Bt.euclideanModulo(t,1),r=Bt.clamp(r,0,1),n=Bt.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,o=2*n-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,c)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,l=(u=r[1]).length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(u=ir[e])?this.setHex(u):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,r,n=this.r,i=this.g,o=this.b,a=Math.max(n,i,o),s=Math.min(n,i,o),c=(s+a)/2;if(s===a)t=0,r=0;else{var u=a-s;switch(r=c<=.5?u/(a+s):u/(2-a-s),a){case n:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-n)/u+2;break;case o:t=(n-i)/u+4}t/=6}return e.h=t,e.s=r,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var e={};return function(t,r,n){return this.getHSL(e),e.h+=t,e.s+=r,e.l+=n,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var e={h:0,s:0,l:0},t={h:0,s:0,l:0};return function(r,n){this.getHSL(e),r.getHSL(t);var i=Bt.lerp(e.h,t.h,n),o=Bt.lerp(e.s,t.s,n),a=Bt.lerp(e.l,t.l,n);return this.setHSL(i,o,a),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var ar={common:{diffuse:{value:new or(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Wt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new or(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new or(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Wt}},sprite:{diffuse:{value:new or(15658734)},opacity:{value:1},center:{value:new zt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Wt}}},sr={basic:{uniforms:nr.merge([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.fog]),vertexShader:rr.meshbasic_vert,fragmentShader:rr.meshbasic_frag},lambert:{uniforms:nr.merge([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.fog,ar.lights,{emissive:{value:new or(0)}}]),vertexShader:rr.meshlambert_vert,fragmentShader:rr.meshlambert_frag},phong:{uniforms:nr.merge([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.gradientmap,ar.fog,ar.lights,{emissive:{value:new or(0)},specular:{value:new or(1118481)},shininess:{value:30}}]),vertexShader:rr.meshphong_vert,fragmentShader:rr.meshphong_frag},standard:{uniforms:nr.merge([ar.common,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.roughnessmap,ar.metalnessmap,ar.fog,ar.lights,{emissive:{value:new or(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:rr.meshphysical_vert,fragmentShader:rr.meshphysical_frag},matcap:{uniforms:nr.merge([ar.common,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.fog,{matcap:{value:null}}]),vertexShader:rr.meshmatcap_vert,fragmentShader:rr.meshmatcap_frag},points:{uniforms:nr.merge([ar.points,ar.fog]),vertexShader:rr.points_vert,fragmentShader:rr.points_frag},dashed:{uniforms:nr.merge([ar.common,ar.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:rr.linedashed_vert,fragmentShader:rr.linedashed_frag},depth:{uniforms:nr.merge([ar.common,ar.displacementmap]),vertexShader:rr.depth_vert,fragmentShader:rr.depth_frag},normal:{uniforms:nr.merge([ar.common,ar.bumpmap,ar.normalmap,ar.displacementmap,{opacity:{value:1}}]),vertexShader:rr.normal_vert,fragmentShader:rr.normal_frag},sprite:{uniforms:nr.merge([ar.sprite,ar.fog]),vertexShader:rr.sprite_vert,fragmentShader:rr.sprite_frag},background:{uniforms:{t2D:{value:null}},vertexShader:rr.background_vert,fragmentShader:rr.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:rr.cube_vert,fragmentShader:rr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:rr.equirect_vert,fragmentShader:rr.equirect_frag},distanceRGBA:{uniforms:nr.merge([ar.common,ar.displacementmap,{referencePosition:{value:new Gt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:rr.distanceRGBA_vert,fragmentShader:rr.distanceRGBA_frag},shadow:{uniforms:nr.merge([ar.lights,ar.fog,{color:{value:new or(0)},opacity:{value:1}}]),vertexShader:rr.shadow_vert,fragmentShader:rr.shadow_frag}};function cr(){var e=null,t=!1,r=null;function n(i,o){!1!==t&&(r(i,o),e.requestAnimationFrame(n))}return{start:function(){!0!==t&&null!==r&&(e.requestAnimationFrame(n),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function ur(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=t.get(r);n&&(e.deleteBuffer(n.buffer),t.delete(r))},update:function(r,n){r.isInterleavedBufferAttribute&&(r=r.data);var i=t.get(r);void 0===i?t.set(r,function(t,r){var n=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,n,i),t.onUploadCallback();var a=e.FLOAT;return n instanceof Float32Array?a=e.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=e.UNSIGNED_SHORT:n instanceof Int16Array?a=e.SHORT:n instanceof Uint32Array?a=e.UNSIGNED_INT:n instanceof Int32Array?a=e.INT:n instanceof Int8Array?a=e.BYTE:n instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(r,n)):i.version<r.version&&(function(t,r,n){var i=r.array,o=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(n,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,r,n),i.version=r.version)}}}function lr(e,t,r,n,i,o){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new Gt,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new or,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function hr(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||hr.DefaultOrder}function dr(){this.mask=1}sr.physical={uniforms:nr.merge([sr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:rr.meshphysical_vert,fragmentShader:rr.meshphysical_frag},Object.assign(lr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),hr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],hr.DefaultOrder="XYZ",Object.defineProperties(hr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(hr.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=Bt.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],c=i[1],u=i[5],l=i[9],h=i[2],d=i[6],f=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new jt;return function(t,r,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new Vt;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Gt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(dr.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var fr=0;function pr(){Object.defineProperty(this,"id",{value:fr++}),this.uuid=Bt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pr.DefaultUp.clone();var e=new Gt,t=new hr,r=new Vt,n=new Gt(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)}),r.onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new jt},normalMatrix:{value:new Wt}}),this.matrix=new jt,this.matrixWorld=new jt,this.matrixAutoUpdate=pr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new dr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}pr.DefaultUp=new Gt(0,1,0),pr.DefaultMatrixAutoUpdate=!0,pr.prototype=Object.assign(Object.create(i.prototype),{constructor:pr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new Vt;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new Vt;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Gt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Gt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Gt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Gt;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new Gt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Gt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Gt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new jt;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Vt,t=new jt,r=new Gt,n=new Gt;return function(i,o,a){i.isVector3?r.copy(i):r.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld),this.isCamera?t.lookAt(n,r,this.up):t.lookAt(r,n,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var r=this.children.indexOf(e);return-1!==r&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Gt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new Gt,t=new Gt;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new Vt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,t),r}}(),getWorldScale:function(){var e=new Gt,t=new Vt;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new Gt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,r),r}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Gt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,i=0,o=n.length;i<o;i++)n[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(e.materials,this.material[s]));n.material=l}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),d=m(e.materials),f=m(e.textures),p=m(e.images);a=m(e.shapes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),f.length>0&&(r.textures=f),p.length>0&&(r.images=p),a.length>0&&(r.shapes=a)}return r.object=n,r;function m(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}});var mr=0;function vr(){Object.defineProperty(this,"id",{value:mr+=2}),this.uuid=Bt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function gr(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function yr(e,t,r){gr.call(this,new Int8Array(e),t,r)}function br(e,t,r){gr.call(this,new Uint8Array(e),t,r)}function xr(e,t,r){gr.call(this,new Uint8ClampedArray(e),t,r)}function wr(e,t,r){gr.call(this,new Int16Array(e),t,r)}function _r(e,t,r){gr.call(this,new Uint16Array(e),t,r)}function Sr(e,t,r){gr.call(this,new Int32Array(e),t,r)}function Mr(e,t,r){gr.call(this,new Uint32Array(e),t,r)}function Tr(e,t,r){gr.call(this,new Float32Array(e),t,r)}function Ar(e,t,r){gr.call(this,new Float64Array(e),t,r)}function Er(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Cr(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}vr.prototype=Object.assign(Object.create(i.prototype),{constructor:vr,isGeometry:!0,applyMatrix:function(e){for(var t=(new Wt).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new jt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new jt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new jt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new jt;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new jt;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new pr;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,r=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var u=[],l=[],h=[],d=0,f=0;d<i.length;d+=3,f+=2)t.vertices.push(new Gt(i[d],i[d+1],i[d+2])),void 0!==o&&u.push(new Gt(o[d],o[d+1],o[d+2])),void 0!==a&&t.colors.push(new or(a[d],a[d+1],a[d+2])),void 0!==s&&l.push(new zt(s[f],s[f+1])),void 0!==c&&h.push(new zt(c[f],c[f+1]));function p(e,r,n,i){var d=new lr(e,r,n,void 0!==o?[u[e].clone(),u[r].clone(),u[n].clone()]:[],void 0!==a?[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()]:[],i);t.faces.push(d),void 0!==s&&t.faceVertexUvs[0].push([l[e].clone(),l[r].clone(),l[n].clone()]),void 0!==c&&t.faceVertexUvs[1].push([h[e].clone(),h[r].clone(),h[n].clone()])}var m=e.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var v=m[d],g=v.start,y=(f=g,g+v.count);f<y;f+=3)void 0!==r?p(r[f],r[f+1],r[f+2],v.materialIndex):p(f,f+1,f+2,v.materialIndex);else if(void 0!==r)for(d=0;d<r.length;d+=3)p(r[d],r[d+1],r[d+2]);else for(d=0;d<i.length/3;d+=3)p(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new Gt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new jt;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new Gt,t=new Gt,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)a[t]=new Gt;if(e){var s,c,u,l=new Gt,h=new Gt;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=this.vertices[o.a],c=this.vertices[o.b],u=this.vertices[o.c],l.subVectors(u,c),h.subVectors(s,c),l.cross(h),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,r=this.vertices.length;t<r;t++)a[t].normalize();for(n=0,i=this.faces.length;n<i;n++){var d=(o=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(r=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new vr;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)c=new Gt,u={a:new Gt,b:new Gt,c:new Gt},a.push(c),s.push(u)}var c,u,l=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],c=l.faceNormals[r],u=l.vertexNormals[r],c.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Kt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $t),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e&&e.isGeometry){var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,u=this.faceVertexUvs[0],l=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new Wt).getNormalMatrix(t));for(var f=0,p=a.length;f<p;f++){var m=a[f].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(f=0,p=d.length;f<p;f++)h.push(d[f].clone());for(f=0,p=c.length;f<p;f++){var v,g,y,b=c[f],x=b.vertexNormals,w=b.vertexColors;(v=new lr(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var _=0,S=x.length;_<S;_++)g=x[_].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),v.vertexNormals.push(g);v.color.copy(b.color);for(_=0,S=w.length;_<S;_++)y=w[_],v.vertexColors.push(y.clone());v.materialIndex=b.materialIndex+r,s.push(v)}for(f=0,p=l.length;f<p;f++){var M=l[f],T=[];if(void 0!==M){for(_=0,S=M.length;_<S;_++)T.push(M[_].clone());u.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,o,a,s,c={},u=[],l=[],h=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=r,u.push(this.vertices[r]),l[r]=u.length-1):l[r]=l[c[t]];var d=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){d.push(r);break}}for(r=d.length-1;r>=0;r--){var p=d[r];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];this.vertices.push(new Gt(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(i=[]);for(r=0;r<t;r++){var s=e[r]._id;n&&n.push(o[s]),i&&i.push(a[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var a=[],s=[],c={},u=[],l={},h=[],d={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,v=f.vertexNormals.length>0,g=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b,0,0),1,!0),2,!1),3,p),4,m),5,v),6,g),7,y),a.push(b),a.push(f.a,f.b,f.c),a.push(f.materialIndex),p){var x=this.faceVertexUvs[0][i];a.push(A(x[0]),A(x[1]),A(x[2]))}if(m&&a.push(M(f.normal)),v){var w=f.vertexNormals;a.push(M(w[0]),M(w[1]),M(w[2]))}if(g&&a.push(T(f.color)),y){var _=f.vertexColors;a.push(T(_[0]),T(_[1]),T(_[2]))}}function S(e,t,r){return r?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==l[t]?l[t]:(l[t]=u.length,u.push(e.getHex()),l[t])}function A(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/2,h.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=n,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new vr).copy(this)},copy:function(e){var t,r,n,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,r=c.length;t<r;t++)this.colors.push(c[t].clone());var u=e.faces;for(t=0,r=u.length;t<r;t++)this.faces.push(u[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=l.length;n<i;n++){var h=l[n],d=[];for(o=0,a=h.length;o<a;o++){var f=h[o];d.push(f.clone())}this.faceVertexUvs[t].push(d)}}var p=e.morphTargets;for(t=0,r=p.length;t<r;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],n=0,i=p[t].vertices.length;n<i;n++)m.vertices.push(p[t].vertices[n].clone());if(void 0!==p[t].normals)for(m.normals=[],n=0,i=p[t].normals.length;n<i;n++)m.normals.push(p[t].normals[n].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,r=v.length;t<r;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],n=0,i=v[t].vertexNormals.length;n<i;n++){var y=v[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],n=0,i=v[t].faceNormals.length;n<i;n++)g.faceNormals.push(v[t].faceNormals[n].clone());this.morphNormals.push(g)}var x=e.skinWeights;for(t=0,r=x.length;t<r;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,r=_.length;t<r;t++)this.lineDistances.push(_[t]);var S=e.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(gr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(gr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new or),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new zt),t[r++]=o.x,t[r++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Gt),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Yt),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),yr.prototype=Object.create(gr.prototype),yr.prototype.constructor=yr,br.prototype=Object.create(gr.prototype),br.prototype.constructor=br,xr.prototype=Object.create(gr.prototype),xr.prototype.constructor=xr,wr.prototype=Object.create(gr.prototype),wr.prototype.constructor=wr,_r.prototype=Object.create(gr.prototype),_r.prototype.constructor=_r,Sr.prototype=Object.create(gr.prototype),Sr.prototype.constructor=Sr,Mr.prototype=Object.create(gr.prototype),Mr.prototype.constructor=Mr,Tr.prototype=Object.create(gr.prototype),Tr.prototype.constructor=Tr,Ar.prototype=Object.create(gr.prototype),Ar.prototype.constructor=Ar,Object.assign(Er.prototype,{computeGroups:function(e){for(var t,r=[],n=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,r.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var u=0;u<c;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var l,h=e.morphNormals,d=h.length;if(d>0){l=[];for(u=0;u<d;u++)l[u]={name:h[u].name,data:[]};this.morphTargets.normal=l}var f=e.skinIndices,p=e.skinWeights,m=f.length===n.length,v=p.length===n.length;n.length>0&&0===r.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<r.length;u++){var g=r[u];this.vertices.push(n[g.a],n[g.b],n[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=g.normal;this.normals.push(b,b,b)}var x,w=g.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var _=g.color;this.colors.push(_,_,_)}if(!0===o)void 0!==(x=i[0][u])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new zt,new zt,new zt));if(!0===a)void 0!==(x=i[1][u])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new zt,new zt,new zt));for(var S=0;S<c;S++){var M=s[S].vertices;t[S].data.push(M[g.a],M[g.b],M[g.c])}for(S=0;S<d;S++){var T=h[S].vertexNormals[u];l[S].data.push(T.a,T.b,T.c)}m&&this.skinIndices.push(f[g.a],f[g.b],f[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var Lr=1;function Pr(){Object.defineProperty(this,"id",{value:Lr+=2}),this.uuid=Bt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Or(e,t,r,n,i,o){vr.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Nr(e,t,r,n,i,o)),this.mergeVertices()}function Nr(e,t,r,n,i,o){Pr.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1;var s=[],c=[],u=[],l=[],h=0,d=0;function f(e,t,r,n,i,o,f,p,m,v,g){var y,b,x=o/m,w=f/v,_=o/2,S=f/2,M=p/2,T=m+1,A=v+1,E=0,C=0,L=new Gt;for(b=0;b<A;b++){var P=b*w-S;for(y=0;y<T;y++){var O=y*x-_;L[e]=O*n,L[t]=P*i,L[r]=M,c.push(L.x,L.y,L.z),L[e]=0,L[t]=0,L[r]=p>0?1:-1,u.push(L.x,L.y,L.z),l.push(y/m),l.push(1-b/v),E+=1}}for(b=0;b<v;b++)for(y=0;y<m;y++){var N=h+y+T*b,R=h+y+T*(b+1),I=h+(y+1)+T*(b+1),D=h+(y+1)+T*b;s.push(N,R,D),s.push(R,I,D),C+=6}a.addGroup(d,C,g),d+=C,h+=E}f("z","y","x",-1,-1,r,t,e,o=Math.floor(o)||1,i,0),f("z","y","x",1,-1,r,t,-e,o,i,1),f("x","z","y",1,1,e,r,t,n,o,2),f("x","z","y",1,-1,e,r,-t,n,o,3),f("x","y","z",1,-1,e,t,r,n,i,4),f("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(s),this.addAttribute("position",new Tr(c,3)),this.addAttribute("normal",new Tr(u,3)),this.addAttribute("uv",new Tr(l,2))}function Rr(e,t,r,n){vr.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Ir(e,t,r,n)),this.mergeVertices()}function Ir(e,t,r,n){Pr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(r)||1,u=Math.floor(n)||1,l=c+1,h=u+1,d=e/c,f=t/u,p=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<l;i++){var b=i*d-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/c),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<c;i++){var x=i+l*o,w=i+l*(o+1),_=i+1+l*(o+1),S=i+1+l*o;p.push(x,w,S),p.push(w,_,S)}this.setIndex(p),this.addAttribute("position",new Tr(m,3)),this.addAttribute("normal",new Tr(v,3)),this.addAttribute("uv",new Tr(g,2))}Pr.prototype=Object.assign(Object.create(i.prototype),{constructor:Pr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Cr(e)>65535?Mr:_r)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new gr(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new Wt).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new jt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new jt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new jt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new jt;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new jt;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new pr;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Gt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new Tr(3*t.vertices.length,3),n=new Tr(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Tr(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Tr(t,3)),this},updateFromObject:function(e){var t,r=e.geometry;if(e.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(r.vertices),t.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(r.normals),t.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(r.colors),t.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(r.uvs),t.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(r.lineDistances),t.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(e.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Er).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new gr(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new gr(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new gr(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new gr(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new gr(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],u=0,l=c.length;u<l;u++){var h=c[u],d=new Tr(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var f=new Tr(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new Tr(4*e.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Kt);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Kt,t=new Gt;return function(){null===this.boundingSphere&&(this.boundingSphere=new $t);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(n);for(var i=0,o=0,a=r.count;o<a;o++)t.x=r.getX(o),t.y=r.getY(o),t.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new gr(new Float32Array(r.length),3));else for(var n=t.normal.array,i=0,o=n.length;i<o;i++)n[i]=0;var a,s,c,u=t.normal.array,l=new Gt,h=new Gt,d=new Gt,f=new Gt,p=new Gt;if(e){var m=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],c=3*m[i+2],l.fromArray(r,a),h.fromArray(r,s),d.fromArray(r,c),f.subVectors(d,h),p.subVectors(l,h),f.cross(p),u[a]+=f.x,u[a+1]+=f.y,u[a+2]+=f.z,u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[c]+=f.x,u[c+1]+=f.y,u[c+2]+=f.z}else for(i=0,o=r.length;i<o;i+=9)l.fromArray(r,i),h.fromArray(r,i+3),d.fromArray(r,i+6),f.subVectors(d,h),p.subVectors(l,h),f.cross(p),u[i]=f.x,u[i+1]=f.y,u[i+2]=f.z,u[i+3]=f.x,u[i+4]=f.y,u[i+5]=f.z,u[i+6]=f.x,u[i+7]=f.y,u[i+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,c=o.itemSize*t;s<a.length;s++,c++)i[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Gt;return function(){for(var t=this.attributes.normal,r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.normalize(),t.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Pr,t=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],o=i.array,a=i.itemSize,s=new o.constructor(t.length*a),c=0,u=0,l=0,h=t.length;l<h;l++){c=t[l]*a;for(var d=0;d<a;d++)s[u++]=o[c++]}e.addAttribute(n,new gr(s,a))}var f=this.groups;for(l=0,h=f.length;l<h;l++){var p=f[l];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var a=o[r];i=Array.prototype.slice.call(a.array);e.data.attributes[r]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e},clone:function(){return(new Pr).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],u=s[t];for(r=0,n=u.length;r<n;r++)c.push(u[r].clone());this.morphAttributes[t]=c}var l=e.groups;for(r=0,n=l.length;r<n;r++){var h=l[r];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Or.prototype=Object.create(vr.prototype),Or.prototype.constructor=Or,Nr.prototype=Object.create(Pr.prototype),Nr.prototype.constructor=Nr,Rr.prototype=Object.create(vr.prototype),Rr.prototype.constructor=Rr,Ir.prototype=Object.create(Pr.prototype),Ir.prototype.constructor=Ir;var Dr=0;function Fr(){Object.defineProperty(this,"id",{value:Dr++}),this.uuid=Bt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=T,this.side=v,this.flatShading=!1,this.vertexColors=w,this.opacity=1,this.transparent=!1,this.blendSrc=B,this.blendDst=z,this.blendEquation=P,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=J,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Ur(e){Fr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function kr(e,t){this.origin=void 0!==e?e:new Gt,this.direction=void 0!==t?t:new Gt}function Br(e,t,r){this.a=void 0!==e?e:new Gt,this.b=void 0!==t?t:new Gt,this.c=void 0!==r?r:new Gt}function zr(e){Fr.call(this),this.type="MeshBasicMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function jr(e,t){pr.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Pr,this.material=void 0!==t?t:new zr({color:16777215*Math.random()}),this.drawMode=Mt,this.updateMorphTargets()}function Vr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Gr(e,t,r,n,i,o,a,s,c,u){e=void 0!==e?e:[],t=void 0!==t?t:ue,qt.call(this,e,t,r,n,i,o,a,s,c,u),this.flipY=!1}function Wr(e,t,r,n){qt.call(this,null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=be,this.minFilter=be,this.generateMipmaps=!1,this.flipY=!1}Fr.prototype=Object.assign(Object.create(i.prototype),{constructor:Fr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]="overdraw"===t?Number(r):r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===b;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==T&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==v&&(r.side=this.side),this.vertexColors!==w&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){var i=n(e.textures),o=n(e.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ur.prototype=Object.create(Fr.prototype),Ur.prototype.constructor=Ur,Ur.prototype.isShaderMaterial=!0,Ur.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=nr.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Ur.prototype.toJSON=function(e){var t=Fr.prototype.toJSON.call(this,e);for(var r in t.uniforms={},this.uniforms){var n=this.uniforms[r].value;n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}return Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(kr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Gt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Gt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Gt),t.subVectors(e,this.origin);var r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Gt;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new Gt,t=new Gt,r=new Gt;return function(n,i,o,a){e.copy(n).add(i).multiplyScalar(.5),t.copy(i).sub(n).normalize(),r.copy(this.origin).sub(e);var s,c,u,l,h=.5*n.distanceTo(i),d=-this.direction.dot(t),f=r.dot(this.direction),p=-r.dot(t),m=r.lengthSq(),v=Math.abs(1-d*d);if(v>0)if(c=d*f-p,l=h*v,(s=d*p-f)>=0)if(c>=-l)if(c<=l){var g=1/v;u=(s*=g)*(s+d*(c*=g)+2*f)+c*(d*s+c+2*p)+m}else c=h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;else c=-h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;else c<=-l?u=-(s=Math.max(0,-(-d*h+f)))*s+(c=s>0?-h:Math.min(Math.max(-h,-p),h))*(c+2*p)+m:c<=l?(s=0,u=(c=Math.min(Math.max(-h,-p),h))*(c+2*p)+m):u=-(s=Math.max(0,-(d*h+f)))*s+(c=s>0?h:Math.min(Math.max(-h,-p),h))*(c+2*p)+m;else c=d>0?-h:h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(t).multiplyScalar(c).add(e),u}}(),intersectSphere:function(){var e=new Gt;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,c=n+a;return s<0&&c<0?null:s<0?this.at(c,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var r,n,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,n=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,n=(e.min.x-h.x)*c),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||i>n?null:((i>r||r!=r)&&(r=i),(o<n||n!=n)&&(n=o),l>=0?(a=(e.min.z-h.z)*l,s=(e.max.z-h.z)*l):(a=(e.max.z-h.z)*l,s=(e.min.z-h.z)*l),r>s||a>n?null:((a>r||r!=r)&&(r=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:function(){var e=new Gt;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new Gt,t=new Gt,r=new Gt,n=new Gt;return function(i,o,a,s,c){t.subVectors(o,i),r.subVectors(a,i),n.crossVectors(t,r);var u,l=this.direction.dot(n);if(l>0){if(s)return null;u=1}else{if(!(l<0))return null;u=-1,l=-l}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(h<0)return null;var d=u*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>l)return null;var f=-u*e.dot(n);return f<0?null:this.at(f/l,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Br,{getNormal:function(){var e=new Gt;return function(t,r,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Gt),i.subVectors(n,r),e.subVectors(t,r),i.cross(e);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var e=new Gt,t=new Gt,r=new Gt;return function(n,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),r.subVectors(n,i);var c=e.dot(e),u=e.dot(t),l=e.dot(r),h=t.dot(t),d=t.dot(r),f=c*h-u*u;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Gt),0===f)return s.set(-2,-1,-1);var p=1/f,m=(h*l-u*d)*p,v=(c*d-u*l)*p;return s.set(1-m-v,v,m)}}(),containsPoint:function(){var e=new Gt;return function(t,r,n,i){return Br.getBarycoord(t,r,n,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:function(){var e=new Gt;return function(t,r,n,i,o,a,s,c){return this.getBarycoord(t,r,n,i,e),c.set(0,0),c.addScaledVector(o,e.x),c.addScaledVector(a,e.y),c.addScaledVector(s,e.z),c}}()}),Object.assign(Br.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Gt,t=new Gt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Gt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Br.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Gt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Br.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Br.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,r,n,i){return Br.getUV(e,this.a,this.b,this.c,t,r,n,i)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new Gt,t=new Gt,r=new Gt,n=new Gt,i=new Gt,o=new Gt;return function(a,s){void 0===s&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),s=new Gt);var c,u,l=this.a,h=this.b,d=this.c;e.subVectors(h,l),t.subVectors(d,l),n.subVectors(a,l);var f=e.dot(n),p=t.dot(n);if(f<=0&&p<=0)return s.copy(l);i.subVectors(a,h);var m=e.dot(i),v=t.dot(i);if(m>=0&&v<=m)return s.copy(h);var g=f*v-m*p;if(g<=0&&f>=0&&m<=0)return c=f/(f-m),s.copy(l).addScaledVector(e,c);o.subVectors(a,d);var y=e.dot(o),b=t.dot(o);if(b>=0&&y<=b)return s.copy(d);var x=y*p-f*b;if(x<=0&&p>=0&&b<=0)return u=p/(p-b),s.copy(l).addScaledVector(t,u);var w=m*b-y*v;if(w<=0&&v-m>=0&&y-b>=0)return r.subVectors(d,h),u=(v-m)/(v-m+(y-b)),s.copy(h).addScaledVector(r,u);var _=1/(w+x+g);return c=x*_,u=g*_,s.copy(l).addScaledVector(e,c).addScaledVector(t,u)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),zr.prototype=Object.create(Fr.prototype),zr.prototype.constructor=zr,zr.prototype.isMeshBasicMaterial=!0,zr.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},jr.prototype=Object.assign(Object.create(pr.prototype),{constructor:jr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return pr.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)r=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}},raycast:function(){var e=new jt,t=new kr,r=new $t,n=new Gt,i=new Gt,o=new Gt,a=new Gt,s=new Gt,c=new Gt,u=new zt,l=new zt,h=new zt,d=new Gt,f=new Gt;function p(e,t,r,n,i,o,a,s){if(null===(t.side===g?n.intersectTriangle(a,o,i,!0,s):n.intersectTriangle(i,o,a,t.side!==y,s)))return null;f.copy(s),f.applyMatrix4(e.matrixWorld);var c=r.ray.origin.distanceTo(f);return c<r.near||c>r.far?null:{distance:c,point:f.clone(),object:e}}function m(e,t,r,a,s,c,f,m,v){n.fromBufferAttribute(s,f),i.fromBufferAttribute(s,m),o.fromBufferAttribute(s,v);var g=p(e,t,r,a,n,i,o,d);if(g){c&&(u.fromBufferAttribute(c,f),l.fromBufferAttribute(c,m),h.fromBufferAttribute(c,v),g.uv=Br.getUV(d,n,i,o,u,l,h,new zt));var y=new lr(f,m,v);Br.getNormal(n,i,o,y.normal),g.face=y}return g}return function(f,v){var g,y=this.geometry,b=this.material,x=this.matrixWorld;if(void 0!==b&&(null===y.boundingSphere&&y.computeBoundingSphere(),r.copy(y.boundingSphere),r.applyMatrix4(x),!1!==f.ray.intersectsSphere(r)&&(e.getInverse(x),t.copy(f.ray).applyMatrix4(e),null===y.boundingBox||!1!==t.intersectsBox(y.boundingBox))))if(y.isBufferGeometry){var w,_,S,M,T,A,E,C,L,P=y.index,O=y.attributes.position,N=y.attributes.uv,R=y.groups,I=y.drawRange;if(null!==P)if(Array.isArray(b))for(M=0,A=R.length;M<A;M++)for(L=b[(C=R[M]).materialIndex],T=Math.max(C.start,I.start),E=Math.min(C.start+C.count,I.start+I.count);T<E;T+=3)w=P.getX(T),_=P.getX(T+1),S=P.getX(T+2),(g=m(this,L,f,t,O,N,w,_,S))&&(g.faceIndex=Math.floor(T/3),v.push(g));else for(M=Math.max(0,I.start),A=Math.min(P.count,I.start+I.count);M<A;M+=3)w=P.getX(M),_=P.getX(M+1),S=P.getX(M+2),(g=m(this,b,f,t,O,N,w,_,S))&&(g.faceIndex=Math.floor(M/3),v.push(g));else if(void 0!==O)if(Array.isArray(b))for(M=0,A=R.length;M<A;M++)for(L=b[(C=R[M]).materialIndex],T=Math.max(C.start,I.start),E=Math.min(C.start+C.count,I.start+I.count);T<E;T+=3)(g=m(this,L,f,t,O,N,w=T,_=T+1,S=T+2))&&(g.faceIndex=Math.floor(T/3),v.push(g));else for(M=Math.max(0,I.start),A=Math.min(O.count,I.start+I.count);M<A;M+=3)(g=m(this,b,f,t,O,N,w=M,_=M+1,S=M+2))&&(g.faceIndex=Math.floor(M/3),v.push(g))}else if(y.isGeometry){var D,F,U,k,B=Array.isArray(b),z=y.vertices,j=y.faces,V=y.faceVertexUvs[0];V.length>0&&(k=V);for(var G=0,W=j.length;G<W;G++){var H=j[G],X=B?b[H.materialIndex]:b;if(void 0!==X){if(D=z[H.a],F=z[H.b],U=z[H.c],!0===X.morphTargets){var q=y.morphTargets,Y=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var J=0,Q=q.length;J<Q;J++){var Z=Y[J];if(0!==Z){var K=q[J].vertices;n.addScaledVector(a.subVectors(K[H.a],D),Z),i.addScaledVector(s.subVectors(K[H.b],F),Z),o.addScaledVector(c.subVectors(K[H.c],U),Z)}}n.add(D),i.add(F),o.add(U),D=n,F=i,U=o}if(g=p(this,X,f,t,D,F,U,d)){if(k&&k[G]){var $=k[G];u.copy($[0]),l.copy($[1]),h.copy($[2]),g.uv=Br.getUV(d,D,F,U,u,l,h,new zt)}g.face=H,g.faceIndex=G,v.push(g)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Gr.prototype=Object.create(qt.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isCubeTexture=!0,Object.defineProperty(Gr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Wr.prototype=Object.create(qt.prototype),Wr.prototype.constructor=Wr,Wr.prototype.isDataTexture3D=!0;var Hr=new qt,Xr=new Wr,qr=new Gr;function Yr(){this.seq=[],this.map={}}var Jr=[],Qr=[],Zr=new Float32Array(16),Kr=new Float32Array(9),$r=new Float32Array(4);function en(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,o=Jr[i];if(void 0===o&&(o=new Float32Array(i),Jr[i]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=r,e[a].toArray(o,s)}return o}function tn(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function rn(e,t){for(var r=0,n=t.length;r<n;r++)e[r]=t[r]}function nn(e,t){var r=Qr[t];void 0===r&&(r=new Int32Array(t),Qr[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocTextureUnit();return r}function on(e,t){var r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function an(e,t){var r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function sn(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(tn(r,t))return;e.uniform2fv(this.addr,t),rn(r,t)}}function cn(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(tn(r,t))return;e.uniform3fv(this.addr,t),rn(r,t)}}function un(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(tn(r,t))return;e.uniform4fv(this.addr,t),rn(r,t)}}function ln(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(tn(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),rn(r,t)}else{if(tn(r,n))return;$r.set(n),e.uniformMatrix2fv(this.addr,!1,$r),rn(r,n)}}function hn(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(tn(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),rn(r,t)}else{if(tn(r,n))return;Kr.set(n),e.uniformMatrix3fv(this.addr,!1,Kr),rn(r,n)}}function dn(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(tn(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),rn(r,t)}else{if(tn(r,n))return;Zr.set(n),e.uniformMatrix4fv(this.addr,!1,Zr),rn(r,n)}}function fn(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||Hr,i)}function pn(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||Xr,i)}function mn(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||qr,i)}function vn(e,t){var r=this.cache;tn(r,t)||(e.uniform2iv(this.addr,t),rn(r,t))}function gn(e,t){var r=this.cache;tn(r,t)||(e.uniform3iv(this.addr,t),rn(r,t))}function yn(e,t){var r=this.cache;tn(r,t)||(e.uniform4iv(this.addr,t),rn(r,t))}function bn(e,t){var r=this.cache;tn(r,t)||(e.uniform1fv(this.addr,t),rn(r,t))}function xn(e,t){var r=this.cache;tn(r,t)||(e.uniform1iv(this.addr,t),rn(r,t))}function wn(e,t){var r=this.cache,n=en(t,this.size,2);tn(r,n)||(e.uniform2fv(this.addr,n),this.updateCache(n))}function _n(e,t){var r=this.cache,n=en(t,this.size,3);tn(r,n)||(e.uniform3fv(this.addr,n),this.updateCache(n))}function Sn(e,t){var r=this.cache,n=en(t,this.size,4);tn(r,n)||(e.uniform4fv(this.addr,n),this.updateCache(n))}function Mn(e,t){var r=this.cache,n=en(t,this.size,4);tn(r,n)||(e.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function Tn(e,t){var r=this.cache,n=en(t,this.size,9);tn(r,n)||(e.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function An(e,t){var r=this.cache,n=en(t,this.size,16);tn(r,n)||(e.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function En(e,t,r){var n=this.cache,i=t.length,o=nn(r,i);!1===tn(n,o)&&(e.uniform1iv(this.addr,o),rn(n,o));for(var a=0;a!==i;++a)r.setTexture2D(t[a]||Hr,o[a])}function Cn(e,t,r){var n=this.cache,i=t.length,o=nn(r,i);!1===tn(n,o)&&(e.uniform1iv(this.addr,o),rn(n,o));for(var a=0;a!==i;++a)r.setTextureCube(t[a]||qr,o[a])}function Ln(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return on;case 35664:return sn;case 35665:return cn;case 35666:return un;case 35674:return ln;case 35675:return hn;case 35676:return dn;case 35678:case 36198:return fn;case 35679:return pn;case 35680:return mn;case 5124:case 35670:return an;case 35667:case 35671:return vn;case 35668:case 35672:return gn;case 35669:case 35673:return yn}}(t.type)}function Pn(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return bn;case 35664:return wn;case 35665:return _n;case 35666:return Sn;case 35674:return Mn;case 35675:return Tn;case 35676:return An;case 35678:return En;case 35680:return Cn;case 5124:case 35670:return xn;case 35667:case 35671:return vn;case 35668:case 35672:return gn;case 35669:case 35673:return yn}}(t.type)}function On(e){this.id=e,Yr.call(this)}Pn.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),rn(t,e)},On.prototype.setValue=function(e,t,r){for(var n=this.seq,i=0,o=n.length;i!==o;++i){var a=n[i];a.setValue(e,t[a.id],r)}};var Nn=/([\w\d_]+)(\])?(\[|\.)?/g;function Rn(e,t){e.seq.push(t),e.map[t.id]=t}function In(e,t,r){var n=e.name,i=n.length;for(Nn.lastIndex=0;;){var o=Nn.exec(n),a=Nn.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){Rn(r,void 0===u?new Ln(s,e,t):new Pn(s,e,t));break}var l=r.map[s];void 0===l&&Rn(r,l=new On(s)),r=l}}function Dn(e,t,r){Yr.call(this),this.renderer=r;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=e.getActiveUniform(t,i);In(o,e.getUniformLocation(t,o.name),this)}}function Fn(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(r)),n}Dn.prototype.setValue=function(e,t,r){var n=this.map[t];void 0!==n&&n.setValue(e,r,this.renderer)},Dn.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},Dn.upload=function(e,t,r,n){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},Dn.seqWithValue=function(e,t){for(var r=[],n=0,i=e.length;n!==i;++n){var o=e[n];o.id in t&&r.push(o)}return r};var Un=0;function kn(e){switch(e){case Et:return["Linear","( value )"];case Ct:return["sRGB","( value )"];case Pt:return["RGBE","( value )"];case Nt:return["RGBM","( value, 7.0 )"];case Rt:return["RGBM","( value, 16.0 )"];case It:return["RGBD","( value, 256.0 )"];case Lt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Bn(e,t){var r=kn(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function zn(e){return""!==e}function jn(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Vn(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Gn(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){var r=rr[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Gn(r)})}function Wn(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){for(var i="",o=parseInt(t);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Hn(e,t,r,n,i,o,a){var s=e.context,c=n.defines,u=i.vertexShader,l=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===p?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===m&&(h="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",v="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case ue:case le:d="ENVMAP_TYPE_CUBE";break;case pe:case me:d="ENVMAP_TYPE_CUBE_UV";break;case he:case de:d="ENVMAP_TYPE_EQUIREC";break;case fe:d="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case le:case de:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case ee:v="ENVMAP_BLENDING_MULTIPLY";break;case te:v="ENVMAP_BLENDING_MIX";break;case re:v="ENVMAP_BLENDING_ADD"}}var g,y,b=e.gammaFactor>0?e.gammaFactor:1,x=a.isWebGL2?"":function(e,t,r){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zn).join("\n")}(n.extensions,o,t),w=function(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(c),_=s.createProgram();if(n.isRawShaderMaterial?((g=[w].filter(zn).join("\n")).length>0&&(g+="\n"),(y=[x,w].filter(zn).join("\n")).length>0&&(y+="\n")):(g=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zn).join("\n"),y=[x,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.envMap?"#define "+f:"",o.envMap?"#define "+v:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==ne?"#define TONE_MAPPING":"",o.toneMapping!==ne?rr.tonemapping_pars_fragment:"",o.toneMapping!==ne?function(e,t){var r;switch(t){case ie:r="Linear";break;case oe:r="Reinhard";break;case ae:r="Uncharted2";break;case se:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?rr.encodings_pars_fragment:"",o.mapEncoding?Bn("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Bn("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Bn("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Bn("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(e,t){var r=kn(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zn).join("\n")),u=Vn(u=jn(u=Gn(u),o),o),l=Vn(l=jn(l=Gn(l),o),o),u=Wn(u),l=Wn(l),a.isWebGL2&&!n.isRawShaderMaterial){var S=!1,M=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(M)&&null!==l.match(M)&&(S=!0,u=u.replace(M,""),l=l.replace(M,"")),g=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#version 300 es\n","#define varying in",S?"":"out highp vec4 pc_fragColor;",S?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y}var T=g+u,A=y+l,E=Fn(s,s.VERTEX_SHADER,T),C=Fn(s,s.FRAGMENT_SHADER,A);s.attachShader(_,E),s.attachShader(_,C),void 0!==n.index0AttributeName?s.bindAttribLocation(_,0,n.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(_,0,"position"),s.linkProgram(_);var L,P,O=s.getProgramInfoLog(_).trim(),N=s.getShaderInfoLog(E).trim(),R=s.getShaderInfoLog(C).trim(),I=!0,D=!0;return!1===s.getProgramParameter(_,s.LINK_STATUS)?(I=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(_,s.VALIDATE_STATUS),"gl.getProgramInfoLog",O,N,R)):""!==O?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",O):""!==N&&""!==R||(D=!1),D&&(this.diagnostics={runnable:I,material:n,programLog:O,vertexShader:{log:N,prefix:g},fragmentShader:{log:R,prefix:y}}),s.deleteShader(E),s.deleteShader(C),this.getUniforms=function(){return void 0===L&&(L=new Dn(s,_,e)),L},this.getAttributes=function(){return void 0===P&&(P=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=e.getActiveAttrib(t,i).name;r[o]=e.getAttribLocation(t,o)}return r}(s,_)),P},this.destroy=function(){s.deleteProgram(_),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=Un++,this.code=r,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=C,this}function Xn(e,t,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=Et,r===Et&&t&&(r=Lt),r}this.getParameters=function(t,n,o,s,c,u,l){var h=i[t.type],d=l.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(l):0,f=r.precision;null!==t.precision&&(f=r.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",f,"instead.");var p=e.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:r.vertexTextures,outputEncoding:a(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:a(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===pe||t.envMap.mapping===me),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===kt,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&d>0,maxBones:d,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:c,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===y,flipSided:t.side===g,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var a=0;a<o.length;a++)n.push(r[o[a]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.join()},this.acquireProgram=function(i,o,a,s){for(var c,u=0,l=n.length;u<l;u++){var h=n[u];if(h.code===s){++(c=h).usedTimes;break}}return void 0===c&&(c=new Hn(e,t,s,i,o,a,r),n.push(c)),c},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},this.programs=n}function qn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Yn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Jn(){var e={};return{get:function(t,r){var n=t.id+","+r.id,i=e[n];return void 0===i&&(i=new function(){var e=[],t=0,r=[],n=[];return{opaque:r,transparent:n,init:function(){t=0,r.length=0,n.length=0},push:function(i,o,a,s,c){var u=e[t];void 0===u?(u={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:c},e[t]=u):(u.id=i.id,u.object=i,u.geometry=o,u.material=a,u.program=a.program,u.renderOrder=i.renderOrder,u.z=s,u.group=c),(!0===a.transparent?n:r).push(u),t++},sort:function(){r.length>1&&r.sort(qn),n.length>1&&n.sort(Yn)}}},e[n]=i),i},dispose:function(){e={}}}}var Qn,Zn=0;function Kn(){var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new Gt,color:new or,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"SpotLight":r={position:new Gt,direction:new Gt,color:new or,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"PointLight":r={position:new Gt,color:new or,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new Gt,skyColor:new or,groundColor:new or};break;case"RectAreaLight":r={color:new or,position:new Gt,halfWidth:new Gt,halfHeight:new Gt}}return e[t.id]=r,r}}},t={id:Zn++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new Gt,n=new jt,i=new jt;return{setup:function(o,a,s){for(var c=0,u=0,l=0,h=0,d=0,f=0,p=0,m=0,v=s.matrixWorldInverse,g=0,y=o.length;g<y;g++){var b=o[g],x=b.color,w=b.intensity,_=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)c+=x.r*w,u+=x.g*w,l+=x.b*w;else if(b.isDirectionalLight){if((T=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.shadow=b.castShadow,b.castShadow){var M=b.shadow;T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize}t.directionalShadowMap[h]=S,t.directionalShadowMatrix[h]=b.shadow.matrix,t.directional[h]=T,h++}else if(b.isSpotLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(x).multiplyScalar(w),T.distance=_,T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.coneCos=Math.cos(b.angle),T.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),T.decay=b.decay,T.shadow=b.castShadow,b.castShadow&&(M=b.shadow,T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize),t.spotShadowMap[f]=S,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=T,f++;else if(b.isRectAreaLight)(T=e.get(b)).color.copy(x).multiplyScalar(w),T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),i.identity(),n.copy(b.matrixWorld),n.premultiply(v),i.extractRotation(n),T.halfWidth.set(.5*b.width,0,0),T.halfHeight.set(0,.5*b.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),t.rectArea[p]=T,p++;else if(b.isPointLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(b.color).multiplyScalar(b.intensity),T.distance=b.distance,T.decay=b.decay,T.shadow=b.castShadow,b.castShadow&&(M=b.shadow,T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize,T.shadowCameraNear=M.camera.near,T.shadowCameraFar=M.camera.far),t.pointShadowMap[d]=S,t.pointShadowMatrix[d]=b.shadow.matrix,t.point[d]=T,d++;else if(b.isHemisphereLight){var T;(T=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),T.direction.transformDirection(v),T.direction.normalize(),T.skyColor.copy(b.color).multiplyScalar(w),T.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[m]=T,m++}}t.ambient[0]=c,t.ambient[1]=u,t.ambient[2]=l,t.directional.length=h,t.spot.length=f,t.rectArea.length=p,t.point.length=d,t.hemi.length=m,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=d,t.hash.spotLength=f,t.hash.rectAreaLength=p,t.hash.hemiLength=m,t.hash.shadowsLength=a.length},state:t}}function $n(){var e=new Kn,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(n){e.setup(t,r,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function ei(e){Fr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Dt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function ti(e){Fr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Gt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function ri(e,t,r){for(var n=new tr,i=new jt,o=new zt,a=new zt(r,r),s=new Gt,c=new Gt,u=1,l=2,h=1+(u|l),d=new Array(h),f=new Array(h),m={},b={0:g,1:v,2:y},x=[new Gt(1,0,0),new Gt(-1,0,0),new Gt(0,0,1),new Gt(0,0,-1),new Gt(0,1,0),new Gt(0,-1,0)],w=[new Gt(0,1,0),new Gt(0,1,0),new Gt(0,1,0),new Gt(0,1,0),new Gt(0,0,1),new Gt(0,0,-1)],_=[new Yt,new Yt,new Yt,new Yt,new Yt,new Yt],S=0;S!==h;++S){var M=0!=(S&u),T=0!=(S&l),A=new ei({depthPacking:Ft,morphTargets:M,skinning:T});d[S]=A;var E=new ti({morphTargets:M,skinning:T});f[S]=E}var C=this;function L(t,r,n,i,o,a){var s=t.geometry,c=null,h=d,p=t.customDepthMaterial;if(n&&(h=f,p=t.customDistanceMaterial),p)c=p;else{var v=!1;r.morphTargets&&(s&&s.isBufferGeometry?v=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(v=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var g=t.isSkinnedMesh&&r.skinning,y=0;v&&(y|=u),g&&(y|=l),c=h[y]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var x=c.uuid,w=r.uuid,_=m[x];void 0===_&&(_={},m[x]=_);var S=_[w];void 0===S&&(S=c.clone(),_[w]=S),c=S}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=null!=r.shadowSide?r.shadowSide:b[r.side],c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=o,c.farDistance=a),c}function P(r,i,o,a){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var s=t.update(r),u=r.material;if(Array.isArray(u))for(var l=s.groups,h=0,d=l.length;h<d;h++){var f=l[h],p=u[f.materialIndex];if(p&&p.visible){var m=L(r,p,a,c,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,f)}}else if(u.visible){m=L(r,u,a,c,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,null)}}for(var v=r.children,g=0,y=v.length;g<y;g++)P(v[g],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p,this.render=function(t,r,u){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var l,h=e.context,d=e.state;d.disable(h.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var m=t[f],v=m.shadow,g=m&&m.isPointLight;if(void 0!==v){var y=v.camera;if(o.copy(v.mapSize),o.min(a),g){var b=o.x,S=o.y;_[0].set(2*b,S,b,S),_[1].set(0,S,b,S),_[2].set(3*b,S,b,S),_[3].set(b,S,b,S),_[4].set(3*b,0,b,S),_[5].set(b,0,b,S),o.x*=4,o.y*=2}if(null===v.map){var M={minFilter:be,magFilter:be,format:Be};v.map=new Jt(o.x,o.y,M),v.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}v.isSpotLightShadow&&v.update(m);var T=v.map,A=v.matrix;c.setFromMatrixPosition(m.matrixWorld),y.position.copy(c),g?(l=6,A.makeTranslation(-c.x,-c.y,-c.z)):(l=1,s.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(y.projectionMatrix),A.multiply(y.matrixWorldInverse)),e.setRenderTarget(T),e.clear();for(var E=0;E<l;E++){if(g){s.copy(y.position),s.add(x[E]),y.up.copy(w[E]),y.lookAt(s),y.updateMatrixWorld();var L=_[E];d.viewport(L)}i.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),n.setFromMatrix(i),P(r,u,y,g)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}C.needsUpdate=!1}}}function ni(e,t,r,n,i,o,a){var s,c={};function u(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var r=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height),n}return e}function l(e){return Bt.isPowerOfTwo(e.width)&&Bt.isPowerOfTwo(e.height)}function h(e,t){return e.generateMipmaps&&t&&e.minFilter!==be&&e.minFilter!==_e}function d(t,r,i,o){e.generateMipmap(t),n.get(r).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function f(t,r){if(!i.isWebGL2)return t;if(t===e.RED){if(r===e.FLOAT)return e.R32F;if(r===e.HALF_FLOAT)return e.R16F;if(r===e.UNSIGNED_BYTE)return e.R8}if(t===e.RGB){if(r===e.FLOAT)return e.RGB32F;if(r===e.HALF_FLOAT)return e.RGB16F;if(r===e.UNSIGNED_BYTE)return e.RGB8}if(t===e.RGBA){if(r===e.FLOAT)return e.RGBA32F;if(r===e.HALF_FLOAT)return e.RGBA16F;if(r===e.UNSIGNED_BYTE)return e.RGBA8}return t}function p(t){return t===be||t===xe||t===we?e.NEAREST:e.LINEAR}function m(t){var r=t.target;r.removeEventListener("dispose",m),function(t){var r=n.get(t);if(t.image&&r.__image__webglTextureCube)e.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture)}n.remove(t)}(r),r.isVideoTexture&&delete c[r.id],a.memory.textures--}function v(t){var r=t.target;r.removeEventListener("dispose",v),function(t){var r=n.get(t),i=n.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[o]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}(r),a.memory.textures--}function g(t,i){var o=n.get(t);if(t.isVideoTexture&&function(e){var t=e.id,r=a.render.frame;c[t]!==r&&(c[t]=r,e.update())}(t),t.version>0&&o.__version!==t.version){var s=t.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void b(o,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function y(r,a,s){var c;if(s?(e.texParameteri(r,e.TEXTURE_WRAP_S,o.convert(a.wrapS)),e.texParameteri(r,e.TEXTURE_WRAP_T,o.convert(a.wrapT)),e.texParameteri(r,e.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a.wrapS===ge&&a.wrapT===ge||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,e.TEXTURE_MAG_FILTER,p(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,p(a.minFilter)),a.minFilter!==be&&a.minFilter!==_e&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(a.type===Oe&&null===t.get("OES_texture_float_linear"))return;if(a.type===Ne&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(r,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function b(t,n,c){var p;p=n.isDataTexture3D?e.TEXTURE_3D:e.TEXTURE_2D,void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",m),t.__webglTexture=e.createTexture(),a.memory.textures++),r.activeTexture(e.TEXTURE0+c),r.bindTexture(p,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var v=u(n.image,i.maxTextureSize);(function(e){return!i.isWebGL2&&(e.wrapS!==ge||e.wrapT!==ge||e.minFilter!==be&&e.minFilter!==_e)})(n)&&!1===l(v)&&(v=function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=Bt.floorPowerOfTwo(e.width),s.height=Bt.floorPowerOfTwo(e.height),s.getContext("2d").drawImage(e,0,0,s.width,s.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+s.width+"x"+s.height),s):e}(v));var g=l(v),b=o.convert(n.format),x=o.convert(n.type),w=f(b,x);y(p,n,g);var _,S=n.mipmaps;if(n.isDepthTexture){if(w=e.DEPTH_COMPONENT,n.type===Oe){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");w=e.DEPTH_COMPONENT32F}else i.isWebGL2&&(w=e.DEPTH_COMPONENT16);n.format===Ge&&w===e.DEPTH_COMPONENT&&n.type!==Ce&&n.type!==Pe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Ce,x=o.convert(n.type)),n.format===We&&(w=e.DEPTH_STENCIL,n.type!==Fe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Fe,x=o.convert(n.type))),r.texImage2D(e.TEXTURE_2D,0,w,v.width,v.height,0,b,x,null)}else if(n.isDataTexture)if(S.length>0&&g){for(var M=0,T=S.length;M<T;M++)_=S[M],r.texImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,b,x,_.data);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,w,v.width,v.height,0,b,x,v.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(M=0,T=S.length;M<T;M++)_=S[M],n.format!==Be&&n.format!==ke?r.getCompressedTextureFormats().indexOf(b)>-1?r.compressedTexImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,b,x,_.data);t.__maxMipLevel=S.length-1}else if(n.isDataTexture3D)r.texImage3D(e.TEXTURE_3D,0,w,v.width,v.height,v.depth,0,b,x,v.data),t.__maxMipLevel=0;else if(S.length>0&&g){for(M=0,T=S.length;M<T;M++)_=S[M],r.texImage2D(e.TEXTURE_2D,M,w,b,x,_);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,w,b,x,v),t.__maxMipLevel=0;h(n,g)&&d(e.TEXTURE_2D,n,v.width,v.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function x(t,i,a,s){var c=o.convert(i.texture.format),u=o.convert(i.texture.type),l=f(c,u);r.texImage2D(s,0,l,i.width,i.height,0,c,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function w(t,r){e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):r.depthBuffer&&r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,r.width,r.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function _(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),g(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===Ge)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==We)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=e.createRenderbuffer(),w(r.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),w(r.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=g,this.setTexture3D=function(t,i){var o=n.get(t);t.version>0&&o.__version!==t.version?b(o,t,i):(r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_3D,o.__webglTexture))},this.setTextureCube=function(t,s){var c=n.get(t);if(6===t.image.length)if(t.version>0&&c.__version!==t.version){c.__image__webglTextureCube||(t.addEventListener("dispose",m),c.__image__webglTextureCube=e.createTexture(),a.memory.textures++),r.activeTexture(e.TEXTURE0+s),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var p=t&&t.isCompressedTexture,v=t.image[0]&&t.image[0].isDataTexture,g=[],b=0;b<6;b++)g[b]=p||v?v?t.image[b].image:t.image[b]:u(t.image[b],i.maxCubemapSize);var x=g[0],w=l(x),_=o.convert(t.format),S=o.convert(t.type),M=f(_,S);for(y(e.TEXTURE_CUBE_MAP,t,w),b=0;b<6;b++)if(p)for(var T,A=g[b].mipmaps,E=0,C=A.length;E<C;E++)T=A[E],t.format!==Be&&t.format!==ke?r.getCompressedTextureFormats().indexOf(_)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+b,E,M,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+b,E,M,T.width,T.height,0,_,S,T.data);else v?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+b,0,M,g[b].width,g[b].height,0,_,S,g[b].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+b,0,M,_,S,g[b]);c.__maxMipLevel=p?A.length-1:0,h(t,w)&&d(e.TEXTURE_CUBE_MAP,t,x.width,x.height),c.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(e.TEXTURE0+s),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,i){r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var i=n.get(t),o=n.get(t.texture);t.addEventListener("dispose",v),o.__webglTexture=e.createTexture(),a.memory.textures++;var s=!0===t.isWebGLRenderTargetCube,c=l(t);if(s){i.__webglFramebuffer=[];for(var u=0;u<6;u++)i.__webglFramebuffer[u]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(s){for(r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),y(e.TEXTURE_CUBE_MAP,t.texture,c),u=0;u<6;u++)x(i.__webglFramebuffer[u],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+u);h(t.texture,c)&&d(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else r.bindTexture(e.TEXTURE_2D,o.__webglTexture),y(e.TEXTURE_2D,t.texture,c),x(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),h(t.texture,c)&&d(e.TEXTURE_2D,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&_(t)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(h(i,l(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=n.get(i).__webglTexture;r.bindTexture(o,a),d(o,i,t.width,t.height),r.bindTexture(o,null)}}}function ii(e,t,r){return{convert:function(n){var i;if(n===ve)return e.REPEAT;if(n===ge)return e.CLAMP_TO_EDGE;if(n===ye)return e.MIRRORED_REPEAT;if(n===be)return e.NEAREST;if(n===xe)return e.NEAREST_MIPMAP_NEAREST;if(n===we)return e.NEAREST_MIPMAP_LINEAR;if(n===_e)return e.LINEAR;if(n===Se)return e.LINEAR_MIPMAP_NEAREST;if(n===Me)return e.LINEAR_MIPMAP_LINEAR;if(n===Te)return e.UNSIGNED_BYTE;if(n===Re)return e.UNSIGNED_SHORT_4_4_4_4;if(n===Ie)return e.UNSIGNED_SHORT_5_5_5_1;if(n===De)return e.UNSIGNED_SHORT_5_6_5;if(n===Ae)return e.BYTE;if(n===Ee)return e.SHORT;if(n===Ce)return e.UNSIGNED_SHORT;if(n===Le)return e.INT;if(n===Pe)return e.UNSIGNED_INT;if(n===Oe)return e.FLOAT;if(n===Ne){if(r.isWebGL2)return e.HALF_FLOAT;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(n===Ue)return e.ALPHA;if(n===ke)return e.RGB;if(n===Be)return e.RGBA;if(n===ze)return e.LUMINANCE;if(n===je)return e.LUMINANCE_ALPHA;if(n===Ge)return e.DEPTH_COMPONENT;if(n===We)return e.DEPTH_STENCIL;if(n===He)return e.RED;if(n===P)return e.FUNC_ADD;if(n===O)return e.FUNC_SUBTRACT;if(n===N)return e.FUNC_REVERSE_SUBTRACT;if(n===D)return e.ZERO;if(n===F)return e.ONE;if(n===U)return e.SRC_COLOR;if(n===k)return e.ONE_MINUS_SRC_COLOR;if(n===B)return e.SRC_ALPHA;if(n===z)return e.ONE_MINUS_SRC_ALPHA;if(n===j)return e.DST_ALPHA;if(n===V)return e.ONE_MINUS_DST_ALPHA;if(n===G)return e.DST_COLOR;if(n===W)return e.ONE_MINUS_DST_COLOR;if(n===H)return e.SRC_ALPHA_SATURATE;if((n===Xe||n===qe||n===Ye||n===Je)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(n===Xe)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===qe)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Ye)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Je)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Qe||n===Ze||n===Ke||n===$e)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(n===Qe)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Ze)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Ke)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===$e)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===et&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((n===tt||n===rt||n===nt||n===it||n===ot||n===at||n===st||n===ct||n===ut||n===lt||n===ht||n===dt||n===ft||n===pt)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return n;if(n===R||n===I){if(r.isWebGL2){if(n===R)return e.MIN;if(n===I)return e.MAX}if(null!==(i=t.get("EXT_blend_minmax"))){if(n===R)return i.MIN_EXT;if(n===I)return i.MAX_EXT}}if(n===Fe){if(r.isWebGL2)return e.UNSIGNED_INT_24_8;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function oi(){pr.call(this),this.type="Group"}function ai(){pr.call(this),this.type="Camera",this.matrixWorldInverse=new jt,this.projectionMatrix=new jt,this.projectionMatrixInverse=new jt}function si(e,t,r,n){ai.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ci(e){si.call(this),this.cameras=e||[]}function ui(e){var t=this,r=null,n=null,i=null,o=[],a=new jt,s=new jt,c="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",y,!1));var u=new jt,l=new Vt,h=new Gt,d=new si;d.bounds=new Yt(0,0,.5,1),d.layers.enable(1);var f=new si;f.bounds=new Yt(.5,0,.5,1),f.layers.enable(2);var p,m,v=new ci([d,f]);function g(){return null!==r&&!0===r.isPresenting}function y(){if(g()){var n=r.getEyeParameters("left"),i=n.renderWidth,o=n.renderHeight;m=e.getPixelRatio(),p=e.getSize(),e.setDrawingBufferSize(2*i,o,1),w.start()}else t.enabled&&e.setDrawingBufferSize(p.width,p.height,m),w.stop()}v.layers.enable(1),v.layers.enable(2);var b=[];function x(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0,i=t.length;r<i;r++){var o=t[r];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(n===e)return o;n++}}}this.enabled=!1,this.getController=function(e){var t=o[e];return void 0===t&&((t=new oi).matrixAutoUpdate=!1,t.visible=!1,o[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),w.setContext(e)},this.setFrameOfReferenceType=function(e){c=e},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){var t="stage"===c?1.6:0;if(null===r)return e.position.set(0,t,0),e;if(r.depthNear=e.near,r.depthFar=e.far,r.getFrameData(n),"stage"===c){var p=r.stageParameters;p?a.fromArray(p.sittingToStandingTransform):a.makeTranslation(0,t,0)}var m=n.pose,g=null!==i?i:e;if(g.matrix.copy(a),g.matrix.decompose(g.position,g.quaternion,g.scale),null!==m.orientation&&(l.fromArray(m.orientation),g.quaternion.multiply(l)),null!==m.position&&(l.setFromRotationMatrix(a),h.fromArray(m.position),h.applyQuaternion(l),g.position.add(h)),g.updateMatrixWorld(),!1===r.isPresenting)return e;d.near=e.near,f.near=e.near,d.far=e.far,f.far=e.far,v.matrixWorld.copy(e.matrixWorld),v.matrixWorldInverse.copy(e.matrixWorldInverse),d.matrixWorldInverse.fromArray(n.leftViewMatrix),f.matrixWorldInverse.fromArray(n.rightViewMatrix),s.getInverse(a),"stage"===c&&(d.matrixWorldInverse.multiply(s),f.matrixWorldInverse.multiply(s));var y=g.parent;null!==y&&(u.getInverse(y.matrixWorld),d.matrixWorldInverse.multiply(u),f.matrixWorldInverse.multiply(u)),d.matrixWorld.getInverse(d.matrixWorldInverse),f.matrixWorld.getInverse(f.matrixWorldInverse),d.projectionMatrix.fromArray(n.leftProjectionMatrix),f.projectionMatrix.fromArray(n.rightProjectionMatrix),v.projectionMatrix.copy(d.projectionMatrix);var w=r.getLayers();if(w.length){var _=w[0];null!==_.leftBounds&&4===_.leftBounds.length&&d.bounds.fromArray(_.leftBounds),null!==_.rightBounds&&4===_.rightBounds.length&&f.bounds.fromArray(_.rightBounds)}return function(){for(var e=0;e<o.length;e++){var t=o[e],r=x(e);if(void 0!==r&&void 0!==r.pose){if(null===r.pose)return;var n=r.pose;!1===n.hasPosition&&t.position.set(.2,-.6,-.05),null!==n.position&&t.position.fromArray(n.position),null!==n.orientation&&t.quaternion.fromArray(n.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(a),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===r.id?0:1;b[e]!==r.buttons[i].pressed&&(b[e]=r.buttons[i].pressed,!0===b[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),v},this.getStandingMatrix=function(){return a},this.isPresenting=g;var w=new cr;this.setAnimationLoop=function(e){w.setAnimationLoop(e)},this.submitFrame=function(){g()&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",y)}}function li(t){console.log("THREE.WebGLRenderer",o);var r=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,a=void 0===t.depth||t.depth,l=void 0===t.stencil||t.stencil,h=void 0!==t.antialias&&t.antialias,d=void 0===t.premultipliedAlpha||t.premultipliedAlpha,f=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,p=void 0!==t.powerPreference?t.powerPreference:"default",m=null,b=null;this.domElement=r,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ie,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var x,w,_,S,O,N,R,I,D,F,U,k,B,z,j,V,G,W,H=this,ee=!1,te=null,re=null,ne=null,oe=-1,ae={geometry:null,program:null,wireframe:!1},se=null,ce=null,ue=new Yt,le=new Yt,he=null,de=0,fe=r.width,pe=r.height,me=1,ve=new Yt(0,0,fe,pe),ge=new Yt(0,0,fe,pe),ye=!1,be=new tr,xe=new function(){var e=this,t=null,r=0,n=!1,i=!1,o=new er,a=new Wt,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,r,n,i){var c=null!==t?t.length:0,u=null;if(0!==c){if(u=s.value,!0!==i||null===u){var l=n+4*c,h=r.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<l)&&(u=new Float32Array(l));for(var d=0,f=n;d!==c;++d,f+=4)o.copy(t[d]).applyMatrix4(h,a),o.normal.toArray(u,f),u[f+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=c,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==r||n;return n=i,t=u(e,o,0),r=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,o,a,l,h,d){if(!n||null===e||0===e.length||i&&!a)i?u(null):c();else{var f=i?0:r,p=4*f,m=h.clippingState||null;s.value=m,m=u(e,l,p,d);for(var v=0;v!==p;++v)m[v]=t[v];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}},we=!1,_e=!1,Se=new jt,Me=new Gt;function Ae(){return null===re?me:1}try{var Ee={alpha:i,depth:a,stencil:l,antialias:h,premultipliedAlpha:d,preserveDrawingBuffer:f,powerPreference:p};if(r.addEventListener("webglcontextlost",Re,!1),r.addEventListener("webglcontextrestored",Ie,!1),null===(x=n||r.getContext("webgl",Ee)||r.getContext("experimental-webgl",Ee)))throw null!==r.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===x.getShaderPrecisionFormat&&(x.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function Ce(){w=new function(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}(x),(_=new function(e,t,r){var n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==r.precision?r.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===r.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==n)return n;var r=t.get("EXT_texture_filter_anisotropic");return n=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y}}(x,w,t)).isWebGL2||(w.get("WEBGL_depth_texture"),w.get("OES_texture_float"),w.get("OES_texture_half_float"),w.get("OES_texture_half_float_linear"),w.get("OES_standard_derivatives"),w.get("OES_element_index_uint"),w.get("ANGLE_instanced_arrays")),w.get("OES_texture_float_linear"),W=new ii(x,w,_),(S=new function(e,t,r,n){var i=new function(){var t=!1,r=new Yt,n=null,i=new Yt(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),r.set(t,n,o,a),!1===i.equals(r)&&(e.clearColor(t,n,o,a),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,r=null,n=null,i=null;return{setTest:function(t){t?oe(e.DEPTH_TEST):ae(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case X:e.depthFunc(e.NEVER);break;case q:e.depthFunc(e.ALWAYS);break;case Y:e.depthFunc(e.LESS);break;case J:e.depthFunc(e.LEQUAL);break;case Q:e.depthFunc(e.EQUAL);break;case Z:e.depthFunc(e.GEQUAL);break;case K:e.depthFunc(e.GREATER);break;case $:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},a=new function(){var t=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(t){t?oe(e.STENCIL_TEST):ae(e.STENCIL_TEST)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,a){n===t&&i===r&&o===a||(e.stencilFunc(t,r,a),n=t,i=r,o=a)},setOp:function(t,r,n){a===t&&s===r&&c===n||(e.stencilOp(t,r,n),a=t,s=r,c=n)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,u=null}}},l=e.getParameter(e.MAX_VERTEX_ATTRIBS),h=new Uint8Array(l),d=new Uint8Array(l),f=new Uint8Array(l),p={},m=null,v=null,b=null,x=null,w=null,_=null,S=null,O=null,N=null,R=null,I=!1,D=null,F=null,U=null,k=null,B=null,z=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),j=!1,V=0,G=e.getParameter(e.VERSION);-1!==G.indexOf("WebGL")?(V=parseFloat(/^WebGL\ ([0-9])/.exec(G)[1]),j=V>=1):-1!==G.indexOf("OpenGL ES")&&(V=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(G)[1]),j=V>=2);var W=null,H={},ee=new Yt,te=new Yt;function re(t,r,n){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<n;a++)e.texImage2D(r+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var ne={};function ie(r,i){h[r]=1,0===d[r]&&(e.enableVertexAttribArray(r),d[r]=1),f[r]!==i&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),f[r]=i)}function oe(t){!0!==p[t]&&(e.enable(t),p[t]=!0)}function ae(t){!1!==p[t]&&(e.disable(t),p[t]=!1)}function se(t,n,i,o,a,s,c,u){if(t!==M){if(b||(oe(e.BLEND),b=!0),t===L)a=a||n,s=s||i,c=c||o,n===w&&a===O||(e.blendEquationSeparate(r.convert(n),r.convert(a)),w=n,O=a),i===_&&o===S&&s===N&&c===R||(e.blendFuncSeparate(r.convert(i),r.convert(o),r.convert(s),r.convert(c)),_=i,S=o,N=s,R=c),x=t,I=null;else if(t!==x||u!==I){if(w===P&&O===P||(e.blendEquation(e.FUNC_ADD),w=P,O=P),u)switch(t){case T:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case A:e.blendFunc(e.ONE,e.ONE);break;case E:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case C:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case T:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case A:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case E:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case C:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}_=null,S=null,N=null,R=null,x=t,I=u}}else b&&(ae(e.BLEND),b=!1)}function ce(t){D!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),D=t)}function ue(t){t!==s?(oe(e.CULL_FACE),t!==F&&(t===c?e.cullFace(e.BACK):t===u?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ae(e.CULL_FACE),F=t}function le(t,r,n){t?(oe(e.POLYGON_OFFSET_FILL),k===r&&B===n||(e.polygonOffset(r,n),k=r,B=n)):ae(e.POLYGON_OFFSET_FILL)}function he(t){void 0===t&&(t=e.TEXTURE0+z-1),W!==t&&(e.activeTexture(t),W=t)}return ne[e.TEXTURE_2D]=re(e.TEXTURE_2D,e.TEXTURE_2D,1),ne[e.TEXTURE_CUBE_MAP]=re(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),oe(e.DEPTH_TEST),o.setFunc(J),ce(!1),ue(c),oe(e.CULL_FACE),se(M),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=h.length;e<t;e++)h[e]=0},enableAttribute:function(e){ie(e,0)},enableAttributeAndDivisor:ie,disableUnusedAttributes:function(){for(var t=0,r=d.length;t!==r;++t)d[t]!==h[t]&&(e.disableVertexAttribArray(t),d[t]=0)},enable:oe,disable:ae,getCompressedTextureFormats:function(){if(null===m&&(m=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)m.push(r[n]);return m},useProgram:function(t){return v!==t&&(e.useProgram(t),v=t,!0)},setBlending:se,setMaterial:function(t,r){t.side===y?ae(e.CULL_FACE):oe(e.CULL_FACE);var n=t.side===g;r&&(n=!n),ce(n),t.blending===T&&!1===t.transparent?se(M):se(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite),le(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ce,setCullFace:ue,setLineWidth:function(t){t!==U&&(j&&e.lineWidth(t),U=t)},setPolygonOffset:le,setScissorTest:function(t){t?oe(e.SCISSOR_TEST):ae(e.SCISSOR_TEST)},activeTexture:he,bindTexture:function(t,r){null===W&&he();var n=H[W];void 0===n&&(n={type:void 0,texture:void 0},H[W]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||ne[t]),n.type=t,n.texture=r)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===ee.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ee.copy(t))},viewport:function(t){!1===te.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),te.copy(t))},reset:function(){for(var t=0;t<d.length;t++)1===d[t]&&(e.disableVertexAttribArray(t),d[t]=0);p={},m=null,W=null,H={},v=null,x=null,D=null,F=null,i.reset(),o.reset(),a.reset()}}}(x,w,W,_)).scissor(le.copy(ge).multiplyScalar(me)),S.viewport(ue.copy(ve).multiplyScalar(me)),O=new function(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,n,i){switch(i=i||1,t.calls++,n){case e.TRIANGLES:t.triangles+=i*(r/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:t.triangles+=i*(r-2);break;case e.LINES:t.lines+=i*(r/2);break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}(x),N=new function(){var e=new WeakMap;return{get:function(t){var r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}},R=new ni(x,w,S,N,_,W,O),I=new ur(x),D=new function(e,t,r){var n={},i={};function o(e){var a=e.target,s=n[a.id];for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);a.removeEventListener("dispose",o),delete n[a.id];var u=i[s.id];u&&(t.remove(u),delete i[s.id]),r.memory.geometries--}return{get:function(e,t){var i=n[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Pr).setFromObject(e)),i=t._bufferGeometry),n[t.id]=i,r.memory.geometries++,i)},update:function(r){var n=r.index,i=r.attributes;for(var o in null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=r.morphAttributes;for(var o in a)for(var s=a[o],c=0,u=s.length;c<u;c++)t.update(s[c],e.ARRAY_BUFFER)},getWireframeAttribute:function(r){var n=i[r.id];if(n)return n;var o,a=[],s=r.index,c=r.attributes;if(null!==s)for(var u=0,l=(o=s.array).length;u<l;u+=3){var h=o[u+0],d=o[u+1],f=o[u+2];a.push(h,d,d,f,f,h)}else for(u=0,l=(o=c.position.array).length/3-1;u<l;u+=3)h=u+0,d=u+1,f=u+2,a.push(h,d,d,f,f,h);return n=new(Cr(a)>65535?Mr:_r)(a,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}}}(x,I,O),F=new function(e,t){var r={};return{update:function(n){var i=t.render.frame,o=n.geometry,a=e.get(n,o);return r[a.id]!==i&&(o.isGeometry&&a.updateFromObject(n),e.update(a),r[a.id]=i),a},dispose:function(){r={}}}}(D,O),j=new function(e){var t={},r=new Float32Array(8);return{update:function(n,i,o,a){var s=n.morphTargetInfluences,c=s.length,u=t[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];t[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++)0!==(f=u[l])[1]&&(h&&i.removeAttribute("morphTarget"+l),d&&i.removeAttribute("morphNormal"+l));for(l=0;l<c;l++)(f=u[l])[0]=l,f[1]=s[l];for(u.sort(Vr),l=0;l<8;l++){var f;if(f=u[l]){var p=f[0],m=f[1];if(m){h&&i.addAttribute("morphTarget"+l,h[p]),d&&i.addAttribute("morphNormal"+l,d[p]),r[l]=m;continue}}r[l]=0}a.getUniforms().setValue(e,"morphTargetInfluences",r)}}}(x),U=new Xn(H,w,_),k=new Jn,B=new function(){var e={};return{get:function(t,r){var n;return void 0===e[t.id]?(n=new $n,e[t.id]={},e[t.id][r.id]=n):void 0===e[t.id][r.id]?(n=new $n,e[t.id][r.id]=n):n=e[t.id][r.id],n},dispose:function(){e={}}}},z=new function(e,t,r,n){var i,o,a=new or(0),s=0;function c(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),c(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){c(a,s=e)},render:function(t,n,u,l){var h=n.background;null===h?c(a,s):h&&h.isColor&&(c(h,1),l=!0),(e.autoClear||l)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),h&&h.isCubeTexture?(void 0===o&&((o=new jr(new Nr(1,1,1),new Ur({uniforms:nr.clone(sr.cube.uniforms),vertexShader:sr.cube.vertexShader,fragmentShader:sr.cube.fragmentShader,side:g,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},r.update(o)),o.material.uniforms.tCube.value=h,t.push(o,o.geometry,o.material,0,null)):h&&h.isTexture&&(void 0===i&&((i=new jr(new Ir(2,2),new Ur({uniforms:nr.clone(sr.background.uniforms),vertexShader:sr.background.vertexShader,fragmentShader:sr.background.fragmentShader,side:v,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),r.update(i)),i.material.uniforms.t2D.value=h,t.push(i,i.geometry,i.material,0,null))}}}(H,S,F,d),V=new function(e,t,r,n){var i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i)},this.renderInstances=function(o,a,s){var c;if(n.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[n.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),r.update(s,i,o.maxInstancedCount)}}(x,w,O,_),G=new function(e,t,r,n){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,o,t*a),r.update(n,i)},this.renderInstances=function(s,c,u){var l;if(n.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[n.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,o,c*a,s.maxInstancedCount),r.update(u,i,s.maxInstancedCount)}}(x,w,O,_),O.programs=U.programs,H.context=x,H.capabilities=_,H.extensions=w,H.properties=N,H.renderLists=k,H.state=S,H.info=O}Ce();var Le=null;"undefined"!=typeof navigator&&(Le="xr"in navigator?new function(t){var r=t.context,n=null,i=null,o=null,a="stage",s=null,c=[],u=[];function l(){return null!==i&&null!==o}var h=new si;h.layers.enable(1),h.viewport=new Yt;var d=new si;d.layers.enable(2),d.viewport=new Yt;var f=new ci([h,d]);function p(e){var t=c[u.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function m(){t.setFramebuffer(null),y.stop()}function v(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=c[e];return void 0===t&&((t=new oi).matrixAutoUpdate=!1,t.visible=!1,c[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),e instanceof XRDevice&&r.setCompatibleXRDevice(e)},this.setFrameOfReferenceType=function(e){a=e},this.setSession=function(e){null!==(i=e)&&(i.addEventListener("select",p),i.addEventListener("selectstart",p),i.addEventListener("selectend",p),i.addEventListener("end",m),i.baseLayer=new XRWebGLLayer(i,r),i.requestFrameOfReference(a).then(function(e){o=e,t.setFramebuffer(i.baseLayer.framebuffer),y.setContext(i),y.start()}),u=i.getInputSources(),i.addEventListener("inputsourceschange",function(){u=i.getInputSources(),console.log(u)}))},this.getCamera=function(e){if(l()){var t=e.parent,r=f.cameras;v(f,t);for(var n=0;n<r.length;n++)v(r[n],t);e.matrixWorld.copy(f.matrixWorld);for(var i=e.children,o=(n=0,i.length);n<o;n++)i[n].updateMatrixWorld(!0);return f}return e},this.isPresenting=l;var g=null,y=new cr;y.setAnimationLoop(function(e,t){if(null!==(s=t.getDevicePose(o)))for(var r=i.baseLayer,n=t.views,a=0;a<n.length;a++){var l=n[a],h=r.getViewport(l),d=s.getViewMatrix(l),p=f.cameras[a];p.matrix.fromArray(d).getInverse(p.matrix),p.projectionMatrix.fromArray(l.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===a&&(f.matrix.copy(p.matrix),f.projectionMatrix.copy(p.projectionMatrix))}for(a=0;a<c.length;a++){var m=c[a],v=u[a];if(v){var y=t.getInputPose(v,o);if(null!==y){"targetRay"in y?m.matrix.elements=y.targetRay.transformMatrix:"pointerMatrix"in y&&(m.matrix.elements=y.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}g&&g(e)}),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new e.Matrix4},this.submitFrame=function(){}}(H):new ui(H)),this.vr=Le;var Pe=new ri(H,F,_.maxTextureSize);function Re(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ee=!0}function Ie(){console.log("THREE.WebGLRenderer: Context Restored."),ee=!1,Ce()}function De(e){var t=e.target;t.removeEventListener("dispose",De),function(e){Fe(e),N.remove(e)}(t)}function Fe(e){var t=N.get(e).program;e.program=void 0,void 0!==t&&U.releaseProgram(t)}this.shadowMap=Pe,this.getContext=function(){return x},this.getContextAttributes=function(){return x.getContextAttributes()},this.forceContextLoss=function(){var e=w.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=w.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return me},this.setPixelRatio=function(e){void 0!==e&&(me=e,this.setSize(fe,pe,!1))},this.getSize=function(){return{width:fe,height:pe}},this.setSize=function(e,t,n){Le.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(fe=e,pe=t,r.width=e*me,r.height=t*me,!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:fe*me,height:pe*me}},this.setDrawingBufferSize=function(e,t,n){fe=e,pe=t,me=n,r.width=e*n,r.height=t*n,this.setViewport(0,0,e,t)},this.getCurrentViewport=function(){return ue},this.setViewport=function(e,t,r,n){ve.set(e,pe-t-n,r,n),S.viewport(ue.copy(ve).multiplyScalar(me))},this.setScissor=function(e,t,r,n){ge.set(e,pe-t-n,r,n),S.scissor(le.copy(ge).multiplyScalar(me))},this.setScissorTest=function(e){S.setScissorTest(ye=e)},this.getClearColor=function(){return z.getClearColor()},this.setClearColor=function(){z.setClearColor.apply(z,arguments)},this.getClearAlpha=function(){return z.getClearAlpha()},this.setClearAlpha=function(){z.setClearAlpha.apply(z,arguments)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=x.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=x.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=x.STENCIL_BUFFER_BIT),x.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",Re,!1),r.removeEventListener("webglcontextrestored",Ie,!1),k.dispose(),B.dispose(),N.dispose(),F.dispose(),Le.dispose(),ke.stop()},this.renderBufferImmediate=function(e,t){S.initAttributes();var r=N.get(e);e.hasPositions&&!r.position&&(r.position=x.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=x.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=x.createBuffer()),e.hasColors&&!r.color&&(r.color=x.createBuffer());var n=t.getAttributes();e.hasPositions&&(x.bindBuffer(x.ARRAY_BUFFER,r.position),x.bufferData(x.ARRAY_BUFFER,e.positionArray,x.DYNAMIC_DRAW),S.enableAttribute(n.position),x.vertexAttribPointer(n.position,3,x.FLOAT,!1,0,0)),e.hasNormals&&(x.bindBuffer(x.ARRAY_BUFFER,r.normal),x.bufferData(x.ARRAY_BUFFER,e.normalArray,x.DYNAMIC_DRAW),S.enableAttribute(n.normal),x.vertexAttribPointer(n.normal,3,x.FLOAT,!1,0,0)),e.hasUvs&&(x.bindBuffer(x.ARRAY_BUFFER,r.uv),x.bufferData(x.ARRAY_BUFFER,e.uvArray,x.DYNAMIC_DRAW),S.enableAttribute(n.uv),x.vertexAttribPointer(n.uv,2,x.FLOAT,!1,0,0)),e.hasColors&&(x.bindBuffer(x.ARRAY_BUFFER,r.color),x.bufferData(x.ARRAY_BUFFER,e.colorArray,x.DYNAMIC_DRAW),S.enableAttribute(n.color),x.vertexAttribPointer(n.color,3,x.FLOAT,!1,0,0)),S.disableUnusedAttributes(),x.drawArrays(x.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,n,i,o){var a=i.isMesh&&i.normalMatrix.determinant()<0;S.setMaterial(n,a);var s=Ge(e,t,n,i),c=!1;ae.geometry===r.id&&ae.program===s.id&&ae.wireframe===(!0===n.wireframe)||(ae.geometry=r.id,ae.program=s.id,ae.wireframe=!0===n.wireframe,c=!0),i.morphTargetInfluences&&(j.update(i,r,n,s),c=!0);var u,l=r.index,h=r.attributes.position,d=1;!0===n.wireframe&&(l=D.getWireframeAttribute(r),d=2);var f=V;null!==l&&(u=I.get(l),(f=G).setIndex(u)),c&&(!function(e,t,r){if(r&&r.isInstancedBufferGeometry&!_.isWebGL2&&null===w.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");S.initAttributes();var n=r.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var c=n[a];if(void 0!==c){var u=c.normalized,l=c.itemSize,h=I.get(c);if(void 0===h)continue;var d=h.buffer,f=h.type,p=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,v=m.stride,g=c.offset;m&&m.isInstancedInterleavedBuffer?(S.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=m.meshPerAttribute*m.count)):S.enableAttribute(s),x.bindBuffer(x.ARRAY_BUFFER,d),x.vertexAttribPointer(s,l,f,u,v*p,g*p)}else c.isInstancedBufferAttribute?(S.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)):S.enableAttribute(s),x.bindBuffer(x.ARRAY_BUFFER,d),x.vertexAttribPointer(s,l,f,u,0,0)}else if(void 0!==o){var y=o[a];if(void 0!==y)switch(y.length){case 2:x.vertexAttrib2fv(s,y);break;case 3:x.vertexAttrib3fv(s,y);break;case 4:x.vertexAttrib4fv(s,y);break;default:x.vertexAttrib1fv(s,y)}}}}S.disableUnusedAttributes()}(n,s,r),null!==l&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,u.buffer));var p=1/0;null!==l?p=l.count:void 0!==h&&(p=h.count);var m=r.drawRange.start*d,v=r.drawRange.count*d,g=null!==o?o.start*d:0,y=null!==o?o.count*d:1/0,b=Math.max(m,g),M=Math.min(p,m+v,g+y)-1,T=Math.max(0,M-b+1);if(0!==T){if(i.isMesh)if(!0===n.wireframe)S.setLineWidth(n.wireframeLinewidth*Ae()),f.setMode(x.LINES);else switch(i.drawMode){case Mt:f.setMode(x.TRIANGLES);break;case Tt:f.setMode(x.TRIANGLE_STRIP);break;case At:f.setMode(x.TRIANGLE_FAN)}else if(i.isLine){var A=n.linewidth;void 0===A&&(A=1),S.setLineWidth(A*Ae()),i.isLineSegments?f.setMode(x.LINES):i.isLineLoop?f.setMode(x.LINE_LOOP):f.setMode(x.LINE_STRIP)}else i.isPoints?f.setMode(x.POINTS):i.isSprite&&f.setMode(x.TRIANGLES);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&f.renderInstances(r,b,T):f.render(b,T)}},this.compile=function(e,t){(b=B.get(e,t)).init(),e.traverse(function(e){e.isLight&&(b.pushLight(e),e.castShadow&&b.pushShadow(e))}),b.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)Ve(t.material[r],e.fog,t);else Ve(t.material,e.fog,t)})};var Ue=null;var ke=new cr;function ze(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=void 0===n?a.material:n,l=a.group;if(r.isArrayCamera){ce=r;for(var h=r.cameras,d=0,f=h.length;d<f;d++){var p=h[d];if(s.layers.test(p.layers)){if("viewport"in p)S.viewport(ue.copy(p.viewport));else{var m=p.bounds,v=m.x*fe,g=m.y*pe,y=m.z*fe,x=m.w*pe;S.viewport(ue.set(v,g,y,x).multiplyScalar(me))}b.setupLights(p),je(s,t,p,c,u,l)}}}else ce=null,je(s,t,r,c,u,l)}}function je(e,t,r,n,i,o){if(e.onBeforeRender(H,t,r,n,i,o),b=B.get(t,ce||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){S.setMaterial(i);var a=Ge(r,t.fog,i,e);ae.geometry=null,ae.program=null,ae.wireframe=!1,function(e,t){e.render(function(e){H.renderBufferImmediate(e,t)})}(e,a)}else H.renderBufferDirect(r,t.fog,n,i,e,o);e.onAfterRender(H,t,r,n,i,o),b=B.get(t,ce||r)}function Ve(e,t,r){var n=N.get(e),i=b.state.lights,o=b.state.shadowsArray,a=n.lightsHash,s=i.state.hash,c=U.getParameters(e,i.state,o,t,xe.numPlanes,xe.numIntersection,r),u=U.getProgramCode(e,c),l=n.program,h=!0;if(void 0===l)e.addEventListener("dispose",De);else if(l.code!==u)Fe(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,h=!1;else{if(void 0!==c.shaderID)return;h=!1}if(h){if(c.shaderID){var d=sr[c.shaderID];n.shader={name:e.type,uniforms:nr.clone(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader,H),u=U.getProgramCode(e,c),l=U.acquireProgram(e,n.shader,c,u),n.program=l,e.program=l}var f=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<H.maxMorphTargets;p++)f["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<H.maxMorphNormals;p++)f["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var m=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=xe.numPlanes,n.numIntersection=xe.numIntersection,m.clippingPlanes=xe.uniform),n.fog=t,void 0===a&&(n.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(m.ambientLightColor.value=i.state.ambient,m.directionalLights.value=i.state.directional,m.spotLights.value=i.state.spot,m.rectAreaLights.value=i.state.rectArea,m.pointLights.value=i.state.point,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotShadowMatrix.value=i.state.spotShadowMatrix,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix);var v=n.program.getUniforms(),g=Dn.seqWithValue(v.seq,m);n.uniformsList=g}function Ge(e,t,r,n){de=0;var i=N.get(r),o=b.state.lights,a=i.lightsHash,s=o.state.hash;if(we&&(_e||e!==se)){var c=e===se&&r.id===oe;xe.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,c)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:(!r.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===xe.numPlanes&&i.numIntersection===xe.numIntersection)||(r.needsUpdate=!0)),r.needsUpdate&&(Ve(r,t,n),r.needsUpdate=!1);var u=!1,l=!1,h=!1,d=i.program,f=d.getUniforms(),p=i.shader.uniforms;if(S.useProgram(d.program)&&(u=!0,l=!0,h=!0),r.id!==oe&&(oe=r.id,l=!0),u||se!==e){if(f.setValue(x,"projectionMatrix",e.projectionMatrix),_.logarithmicDepthBuffer&&f.setValue(x,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),se!==e&&(se=e,l=!0,h=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var m=f.map.cameraPosition;void 0!==m&&m.setValue(x,Me.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&f.setValue(x,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){f.setOptional(x,n,"bindMatrix"),f.setOptional(x,n,"bindMatrixInverse");var v=n.skeleton;if(v){var y=v.bones;if(_.floatVertexTextures){if(void 0===v.boneTexture){var w=Math.sqrt(4*y.length);w=Bt.ceilPowerOfTwo(w),w=Math.max(w,4);var M=new Float32Array(w*w*4);M.set(v.boneMatrices);var T=new Zt(M,w,w,Be,Oe);T.needsUpdate=!0,v.boneMatrices=M,v.boneTexture=T,v.boneTextureSize=w}f.setValue(x,"boneTexture",v.boneTexture),f.setValue(x,"boneTextureSize",v.boneTextureSize)}else f.setOptional(x,v,"boneMatrices")}}return l&&(f.setValue(x,"toneMappingExposure",H.toneMappingExposure),f.setValue(x,"toneMappingWhitePoint",H.toneMappingWhitePoint),r.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(p,h),t&&r.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(p,t),r.isMeshBasicMaterial?We(p,r):r.isMeshLambertMaterial?(We(p,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(p,r)):r.isMeshPhongMaterial?(We(p,r),r.isMeshToonMaterial?function(e,t){He(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(p,r):He(p,r)):r.isMeshStandardMaterial?(We(p,r),r.isMeshPhysicalMaterial?function(e,t){Xe(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(p,r):Xe(p,r)):r.isMeshMatcapMaterial?(We(p,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isMeshDepthMaterial?(We(p,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isMeshDistanceMaterial?(We(p,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(p,r)):r.isMeshNormalMaterial?(We(p,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(p,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(p,r)):r.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*me,e.scale.value=.5*pe,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,r):r.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,r):r.isShadowMaterial&&(p.color.value=r.color,p.opacity.value=r.opacity),void 0!==p.ltc_1&&(p.ltc_1.value=ar.LTC_1),void 0!==p.ltc_2&&(p.ltc_2.value=ar.LTC_2),Dn.upload(x,i.uniformsList,p,H)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Dn.upload(x,i.uniformsList,p,H),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&f.setValue(x,"center",n.center),f.setValue(x,"modelViewMatrix",n.modelViewMatrix),f.setValue(x,"normalMatrix",n.normalMatrix),f.setValue(x,"modelMatrix",n.matrixWorld),d}function We(e,t){var r;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=N.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}function He(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Xe(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}ke.setAnimationLoop(function(e){Le.isPresenting()||Ue&&Ue(e)}),"undefined"!=typeof window&&ke.setContext(window),this.setAnimationLoop=function(e){Ue=e,Le.setAnimationLoop(e),ke.start()},this.render=function(e,t,r,n){if(t&&t.isCamera){if(!ee){ae.geometry=null,ae.program=null,ae.wireframe=!1,oe=-1,se=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Le.enabled&&(t=Le.getCamera(t)),(b=B.get(e,t)).init(),e.onBeforeRender(H,e,t,r),Se.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),be.setFromMatrix(Se),_e=this.localClippingEnabled,we=xe.init(this.clippingPlanes,_e,t),(m=k.get(e,t)).init(),function e(t,r,n){if(!1===t.visible)return;var i=t.layers.test(r.layers);if(i)if(t.isLight)b.pushLight(t),t.castShadow&&b.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||be.intersectsSprite(t)){n&&Me.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se);var o=F.update(t),a=t.material;m.push(t,o,a,Me.z,null)}}else if(t.isImmediateRenderObject)n&&Me.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se),m.push(t,null,t.material,Me.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||be.intersectsObject(t))){n&&Me.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se);var o=F.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,c=0,u=s.length;c<u;c++){var l=s[c],h=a[l.materialIndex];h&&h.visible&&m.push(t,o,h,Me.z,l)}else a.visible&&m.push(t,o,a,Me.z,null)}var d=t.children;for(var c=0,u=d.length;c<u;c++)e(d[c],r,n)}(e,t,H.sortObjects),!0===H.sortObjects&&m.sort(),we&&xe.beginShadows();var i=b.state.shadowsArray;Pe.render(i,e,t),b.setupLights(t),we&&xe.endShadows(),this.info.autoReset&&this.info.reset(),void 0===r&&(r=null),this.setRenderTarget(r),z.render(m,e,t,n);var o=m.opaque,a=m.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&ze(o,e,t,s),a.length&&ze(a,e,t,s)}else o.length&&ze(o,e,t),a.length&&ze(a,e,t);r&&R.updateRenderTargetMipmap(r),S.buffers.depth.setTest(!0),S.buffers.depth.setMask(!0),S.buffers.color.setMask(!0),S.setPolygonOffset(!1),e.onAfterRender(H,e,t),Le.enabled&&Le.submitFrame(),m=null,b=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=de;return e>=_.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+_.maxTextures),de+=1,e},this.setTexture2D=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),R.setTexture2D(t,r)}}(),this.setTexture3D=function(e,t){R.setTexture3D(e,t)},this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),R.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?R.setTextureCube(t,r):R.setTextureCubeDynamic(t,r)}}(),this.setFramebuffer=function(e){te=e},this.getRenderTarget=function(){return re},this.setRenderTarget=function(e){re=e,e&&void 0===N.get(e).__webglFramebuffer&&R.setupRenderTarget(e);var t=te,r=!1;if(e){var n=N.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=n[e.activeCubeFace],r=!0):t=n,ue.copy(e.viewport),le.copy(e.scissor),he=e.scissorTest}else ue.copy(ve).multiplyScalar(me),le.copy(ge).multiplyScalar(me),he=ye;if(ne!==t&&(x.bindFramebuffer(x.FRAMEBUFFER,t),ne=t),S.viewport(ue),S.scissor(le),S.setScissorTest(he),r){var i=N.get(e.texture);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(e&&e.isWebGLRenderTarget){var a=N.get(e).__webglFramebuffer;if(a){var s=!1;a!==ne&&(x.bindFramebuffer(x.FRAMEBUFFER,a),s=!0);try{var c=e.texture,u=c.format,l=c.type;if(u!==Be&&W.convert(u)!==x.getParameter(x.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===Te||W.convert(l)===x.getParameter(x.IMPLEMENTATION_COLOR_READ_TYPE)||l===Oe&&(_.isWebGL2||w.get("OES_texture_float")||w.get("WEBGL_color_buffer_float"))||l===Ne&&(_.isWebGL2?w.get("EXT_color_buffer_float"):w.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");x.checkFramebufferStatus(x.FRAMEBUFFER)===x.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&x.readPixels(t,r,n,i,W.convert(u),W.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&x.bindFramebuffer(x.FRAMEBUFFER,ne)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,r){var n=t.image.width,i=t.image.height,o=W.convert(t.format);this.setTexture2D(t,0),x.copyTexImage2D(x.TEXTURE_2D,r||0,o,e.x,e.y,n,i,0)},this.copyTextureToTexture=function(e,t,r,n){var i=t.image.width,o=t.image.height,a=W.convert(r.format),s=W.convert(r.type);this.setTexture2D(r,0),t.isDataTexture?x.texSubImage2D(x.TEXTURE_2D,n||0,e.x,e.y,i,o,a,s,t.image.data):x.texSubImage2D(x.TEXTURE_2D,n||0,e.x,e.y,a,s,t.image)}}function hi(e,t){this.name="",this.color=new or(e),this.density=void 0!==t?t:25e-5}function di(e,t,r){this.name="",this.color=new or(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function fi(){pr.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function pi(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function mi(e,t,r,n){this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function vi(e){Fr.call(this),this.type="SpriteMaterial",this.color=new or(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function gi(e){if(pr.call(this),this.type="Sprite",void 0===Qn){Qn=new Pr;var t=new pi(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Qn.setIndex([0,1,2,0,2,3]),Qn.addAttribute("position",new mi(t,3,0,!1)),Qn.addAttribute("uv",new mi(t,2,3,!1))}this.geometry=Qn,this.material=void 0!==e?e:new vi,this.center=new zt(.5,.5)}function yi(){pr.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function bi(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new jt)}}function xi(){pr.call(this),this.type="Bone"}function wi(e,t){jr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new jt,this.bindMatrixInverse=new jt;var r=new bi(this.initBones());this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function _i(e){Fr.call(this),this.type="LineBasicMaterial",this.color=new or(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Si(e,t,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),pr.call(this),this.type="Line",this.geometry=void 0!==e?e:new Pr,this.material=void 0!==t?t:new _i({color:16777215*Math.random()})}function Mi(e,t){Si.call(this,e,t),this.type="LineSegments"}function Ti(e,t){Si.call(this,e,t),this.type="LineLoop"}function Ai(e){Fr.call(this),this.type="PointsMaterial",this.color=new or(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ei(e,t){pr.call(this),this.type="Points",this.geometry=void 0!==e?e:new Pr,this.material=void 0!==t?t:new Ai({color:16777215*Math.random()})}function Ci(e,t,r,n,i,o,a,s,c){qt.call(this,e,t,r,n,i,o,a,s,c),this.generateMipmaps=!1}function Li(e,t,r,n,i,o,a,s,c,u,l,h){qt.call(this,null,o,a,s,c,u,n,i,l,h),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Pi(e,t,r,n,i,o,a,s,c){qt.call(this,e,t,r,n,i,o,a,s,c),this.needsUpdate=!0}function Oi(e,t,r,n,i,o,a,s,c,u){if((u=void 0!==u?u:Ge)!==Ge&&u!==We)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&u===Ge&&(r=Ce),void 0===r&&u===We&&(r=Fe),qt.call(this,null,n,i,o,a,s,u,r,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:be,this.minFilter=void 0!==s?s:be,this.flipY=!1,this.generateMipmaps=!1}function Ni(e){Pr.call(this),this.type="WireframeGeometry";var t,r,n,i,o,a,s,c,u,l,h=[],d=[0,0],f={},p=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var v=m[t];for(r=0;r<3;r++)s=v[p[r]],c=v[p[(r+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]})}for(u in f)a=f[u],l=e.vertices[a.index1],h.push(l.x,l.y,l.z),l=e.vertices[a.index2],h.push(l.x,l.y,l.z)}else if(e&&e.isBufferGeometry){var g,y,b,x,w,_,S;if(l=new Gt,null!==e.index){for(g=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(t=w=(x=b[i]).start,n=w+x.count;t<n;t+=3)for(r=0;r<3;r++)s=y.getX(t+r),c=y.getX(t+(r+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]});for(u in f)a=f[u],l.fromBufferAttribute(g,a.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(g,a.index2),h.push(l.x,l.y,l.z)}else for(t=0,n=(g=e.attributes.position).count/3;t<n;t++)for(r=0;r<3;r++)_=3*t+r,l.fromBufferAttribute(g,_),h.push(l.x,l.y,l.z),S=3*t+(r+1)%3,l.fromBufferAttribute(g,S),h.push(l.x,l.y,l.z)}this.addAttribute("position",new Tr(h,3))}function Ri(e,t,r){vr.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new Ii(e,t,r)),this.mergeVertices()}function Ii(e,t,r){Pr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,o=[],a=[],s=[],c=[],u=new Gt,l=new Gt,h=new Gt,d=new Gt,f=new Gt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var p=t+1;for(n=0;n<=r;n++){var m=n/r;for(i=0;i<=t;i++){var v=i/t;e(v,m,l),a.push(l.x,l.y,l.z),v-1e-5>=0?(e(v-1e-5,m,h),d.subVectors(l,h)):(e(v+1e-5,m,h),d.subVectors(h,l)),m-1e-5>=0?(e(v,m-1e-5,h),f.subVectors(l,h)):(e(v,m+1e-5,h),f.subVectors(h,l)),u.crossVectors(d,f).normalize(),s.push(u.x,u.y,u.z),c.push(v,m)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var g=n*p+i,y=n*p+i+1,b=(n+1)*p+i+1,x=(n+1)*p+i;o.push(g,y,x),o.push(y,b,x)}this.setIndex(o),this.addAttribute("position",new Tr(a,3)),this.addAttribute("normal",new Tr(s,3)),this.addAttribute("uv",new Tr(c,2))}function Di(e,t,r,n){vr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new Fi(e,t,r,n)),this.mergeVertices()}function Fi(e,t,r,n){Pr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;var i=[],o=[];function a(e,t,r,n){var i,o,a=Math.pow(2,n),c=[];for(i=0;i<=a;i++){c[i]=[];var u=e.clone().lerp(r,i/a),l=t.clone().lerp(r,i/a),h=a-i;for(o=0;o<=h;o++)c[i][o]=0===o&&i===a?u:u.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var d=Math.floor(o/2);o%2==0?(s(c[i][d+1]),s(c[i+1][d]),s(c[i][d])):(s(c[i][d+1]),s(c[i+1][d+1]),s(c[i+1][d]))}}function s(e){i.push(e.x,e.y,e.z)}function c(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function u(e,t,r,n){n<0&&1===e.x&&(o[t]=e.x-1),0===r.x&&0===r.z&&(o[t]=n/2/Math.PI+.5)}function l(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var r=new Gt,n=new Gt,i=new Gt,o=0;o<t.length;o+=3)c(t[o+0],r),c(t[o+1],n),c(t[o+2],i),a(r,n,i,e)}(n=n||0),function(e){for(var t=new Gt,r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){for(var e=new Gt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var r=l(e)/2/Math.PI+.5,n=h(e)/Math.PI+.5;o.push(r,1-n)}(function(){for(var e=new Gt,t=new Gt,r=new Gt,n=new Gt,a=new zt,s=new zt,c=new zt,h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),r.set(i[h+6],i[h+7],i[h+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),c.set(o[d+4],o[d+5]),n.copy(e).add(t).add(r).divideScalar(3);var f=l(n);u(a,d+0,e,f),u(s,d+2,t,f),u(c,d+4,r,f)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],r=o[e+2],n=o[e+4],i=Math.max(t,r,n),a=Math.min(t,r,n);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),r<.2&&(o[e+2]+=1),n<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new Tr(i,3)),this.addAttribute("normal",new Tr(i.slice(),3)),this.addAttribute("uv",new Tr(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Ui(e,t){vr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ki(e,t)),this.mergeVertices()}function ki(e,t){Fi.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Bi(e,t){vr.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new zi(e,t)),this.mergeVertices()}function zi(e,t){Fi.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ji(e,t){vr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Vi(e,t)),this.mergeVertices()}function Vi(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];Fi.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Gi(e,t){vr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Wi(e,t)),this.mergeVertices()}function Wi(e,t){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];Fi.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Hi(e,t,r,n,i,o){vr.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Xi(e,t,r,n,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Xi(e,t,r,n,i){Pr.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},t=t||64,r=r||1,n=n||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new Gt,u=new Gt,l=new zt,h=new Gt,d=[],f=[],p=[],m=[];function v(i){h=e.getPointAt(i/t,h);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=n;s++){var p=s/n*Math.PI*2,m=Math.sin(p),v=-Math.cos(p);u.x=v*a.x+m*l.x,u.y=v*a.y+m*l.y,u.z=v*a.z+m*l.z,u.normalize(),f.push(u.x,u.y,u.z),c.x=h.x+r*u.x,c.y=h.y+r*u.y,c.z=h.z+r*u.z,d.push(c.x,c.y,c.z)}}!function(){for(a=0;a<t;a++)v(a);v(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=n;s++)l.x=a/t,l.y=s/n,p.push(l.x,l.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=n;a++){var e=(n+1)*(s-1)+(a-1),r=(n+1)*s+(a-1),i=(n+1)*s+a,o=(n+1)*(s-1)+a;m.push(e,r,o),m.push(r,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new Tr(d,3)),this.addAttribute("normal",new Tr(f,3)),this.addAttribute("uv",new Tr(p,2))}function qi(e,t,r,n,i,o,a){vr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Yi(e,t,r,n,i,o)),this.mergeVertices()}function Yi(e,t,r,n,i,o){Pr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},e=e||1,t=t||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var a,s,c=[],u=[],l=[],h=[],d=new Gt,f=new Gt,p=new Gt,m=new Gt,v=new Gt,g=new Gt,y=new Gt;for(a=0;a<=r;++a){var b=a/r*i*Math.PI*2;for(E(b,i,o,e,p),E(b+.01,i,o,e,m),g.subVectors(m,p),y.addVectors(m,p),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=n;++s){var x=s/n*Math.PI*2,w=-t*Math.cos(x),_=t*Math.sin(x);d.x=p.x+(w*y.x+_*v.x),d.y=p.y+(w*y.y+_*v.y),d.z=p.z+(w*y.z+_*v.z),u.push(d.x,d.y,d.z),f.subVectors(d,p).normalize(),l.push(f.x,f.y,f.z),h.push(a/r),h.push(s/n)}}for(s=1;s<=r;s++)for(a=1;a<=n;a++){var S=(n+1)*(s-1)+(a-1),M=(n+1)*s+(a-1),T=(n+1)*s+a,A=(n+1)*(s-1)+a;c.push(S,M,A),c.push(M,T,A)}function E(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e),s=r/t*e,c=Math.cos(s);i.x=n*(2+c)*.5*o,i.y=n*(2+c)*a*.5,i.z=n*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new Tr(u,3)),this.addAttribute("normal",new Tr(l,3)),this.addAttribute("uv",new Tr(h,2))}function Ji(e,t,r,n,i){vr.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new Qi(e,t,r,n,i)),this.mergeVertices()}function Qi(e,t,r,n,i){Pr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||1,t=t||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,a,s=[],c=[],u=[],l=[],h=new Gt,d=new Gt,f=new Gt;for(o=0;o<=r;o++)for(a=0;a<=n;a++){var p=a/n*i,m=o/r*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),c.push(d.x,d.y,d.z),h.x=e*Math.cos(p),h.y=e*Math.sin(p),f.subVectors(d,h).normalize(),u.push(f.x,f.y,f.z),l.push(a/n),l.push(o/r)}for(o=1;o<=r;o++)for(a=1;a<=n;a++){var v=(n+1)*o+a-1,g=(n+1)*(o-1)+a-1,y=(n+1)*(o-1)+a,b=(n+1)*o+a;s.push(v,g,b),s.push(g,y,b)}this.setIndex(s),this.addAttribute("position",new Tr(c,3)),this.addAttribute("normal",new Tr(u,3)),this.addAttribute("uv",new Tr(l,2))}ei.prototype=Object.create(Fr.prototype),ei.prototype.constructor=ei,ei.prototype.isMeshDepthMaterial=!0,ei.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},ti.prototype=Object.create(Fr.prototype),ti.prototype.constructor=ti,ti.prototype.isMeshDistanceMaterial=!0,ti.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},oi.prototype=Object.assign(Object.create(pr.prototype),{constructor:oi,isGroup:!0}),ai.prototype=Object.assign(Object.create(pr.prototype),{constructor:ai,isCamera:!0,copy:function(e,t){return pr.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Gt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){pr.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),si.prototype=Object.assign(Object.create(ai.prototype),{constructor:si,isPerspectiveCamera:!0,copy:function(e,t){return ai.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Bt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Bt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Bt.RAD2DEG*Math.atan(Math.tan(.5*Bt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Bt.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*n/a,t-=o.offsetY*r/s,n*=o.width/a,r*=o.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=pr.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),ci.prototype=Object.assign(Object.create(si.prototype),{constructor:ci,isArrayCamera:!0}),hi.prototype.isFogExp2=!0,hi.prototype.clone=function(){return new hi(this.color,this.density)},hi.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},di.prototype.isFog=!0,di.prototype.clone=function(){return new di(this.color,this.near,this.far)},di.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},fi.prototype=Object.assign(Object.create(pr.prototype),{constructor:fi,copy:function(e,t){return pr.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=pr.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Object.defineProperty(pi.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(mi.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(mi.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),vi.prototype=Object.create(Fr.prototype),vi.prototype.constructor=vi,vi.prototype.isSpriteMaterial=!0,vi.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},gi.prototype=Object.assign(Object.create(pr.prototype),{constructor:gi,isSprite:!0,raycast:function(){var e=new Gt,t=new Gt,r=new Gt,n=new zt,i=new zt,o=new jt,a=new Gt,s=new Gt,c=new Gt,u=new zt,l=new zt,h=new zt;function d(e,t,r,a,s,c){n.subVectors(e,r).addScalar(.5).multiply(a),void 0!==s?(i.x=c*n.x-s*n.y,i.y=s*n.x+c*n.y):i.copy(n),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(n,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),r.setFromMatrixPosition(this.modelViewMatrix);var f,p,m=this.material.rotation;0!==m&&(p=Math.cos(m),f=Math.sin(m));var v=this.center;d(a.set(-.5,-.5,0),r,v,t,f,p),d(s.set(.5,-.5,0),r,v,t,f,p),d(c.set(.5,.5,0),r,v,t,f,p),u.set(0,0),l.set(1,0),h.set(1,1);var g=n.ray.intersectTriangle(a,s,c,!1,e);if(null!==g||(d(s.set(-.5,.5,0),r,v,t,f,p),l.set(0,1),null!==(g=n.ray.intersectTriangle(a,c,s,!1,e)))){var y=n.ray.origin.distanceTo(e);y<n.near||y>n.far||i.push({distance:y,point:e.clone(),uv:Br.getUV(e,a,s,c,u,l,h,new zt),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return pr.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),yi.prototype=Object.assign(Object.create(pr.prototype),{constructor:yi,copy:function(e){pr.prototype.copy.call(this,e,!1);for(var t=e.levels,r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new Gt;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),update:function(){var e=new Gt,t=new Gt;return function(r){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(e){var t=pr.prototype.toJSON.call(this,e);t.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(bi.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new jt;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new jt,t=new jt;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=r.length;a<s;a++){var c=r[a]?r[a].matrixWorld:t;e.multiplyMatrices(c,n[a]),e.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new bi(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,r=this.bones.length;t<r;t++){var n=this.bones[t];if(n.name===e)return n}}}),xi.prototype=Object.assign(Object.create(pr.prototype),{constructor:xi,isBone:!0}),wi.prototype=Object.assign(Object.create(jr.prototype),{constructor:wi,isSkinnedMesh:!0,initBones:function(){var e,t,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)t=this.geometry.bones[r],e=new xi,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)-1!==(t=this.geometry.bones[r]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new Yt,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){jr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_i.prototype=Object.create(Fr.prototype),_i.prototype.constructor=_i,_i.prototype.isLineBasicMaterial=!0,_i.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Si.prototype=Object.assign(Object.create(pr.prototype),{constructor:Si,isLine:!0,computeLineDistances:function(){var e=new Gt,t=new Gt;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],o=1,a=n.count;o<a;o++)e.fromBufferAttribute(n,o-1),t.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=e.distanceTo(t);r.addAttribute("lineDistance",new Tr(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;(i=r.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var e=new jt,t=new kr,r=new $t;return function(n,i){var o=n.linePrecision,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),r.radius+=o,!1!==n.ray.intersectsSphere(r)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,l=new Gt,h=new Gt,d=new Gt,f=new Gt,p=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var m=a.index,v=a.attributes.position.array;if(null!==m)for(var g=m.array,y=0,b=g.length-1;y<b;y+=p){var x=g[y],w=g[y+1];if(l.fromArray(v,3*x),h.fromArray(v,3*w),!(t.distanceSqToSegment(l,h,f,d)>u))f.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(f))<n.near||M>n.far||i.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,b=v.length/3-1;y<b;y+=p){if(l.fromArray(v,3*y),h.fromArray(v,3*y+3),!(t.distanceSqToSegment(l,h,f,d)>u))f.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(f))<n.near||M>n.far||i.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(a.isGeometry){var _=a.vertices,S=_.length;for(y=0;y<S-1;y+=p){var M;if(!(t.distanceSqToSegment(_[y],_[y+1],f,d)>u))f.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(f))<n.near||M>n.far||i.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Mi.prototype=Object.assign(Object.create(Si.prototype),{constructor:Mi,isLineSegments:!0,computeLineDistances:function(){var e=new Gt,t=new Gt;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],o=0,a=n.count;o<a;o+=2)e.fromBufferAttribute(n,o),t.fromBufferAttribute(n,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);r.addAttribute("lineDistance",new Tr(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;for(i=r.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()}),Ti.prototype=Object.assign(Object.create(Si.prototype),{constructor:Ti,isLineLoop:!0}),Ai.prototype=Object.create(Fr.prototype),Ai.prototype.constructor=Ai,Ai.prototype.isPointsMaterial=!0,Ai.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ei.prototype=Object.assign(Object.create(pr.prototype),{constructor:Ei,isPoints:!0,raycast:function(){var e=new jt,t=new kr,r=new $t;return function(n,i){var o=this,a=this.geometry,s=this.matrixWorld,c=n.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(s),r.radius+=c,!1!==n.ray.intersectsSphere(r)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var u=c/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,h=new Gt,d=new Gt;if(a.isBufferGeometry){var f=a.index,p=a.attributes.position.array;if(null!==f)for(var m=f.array,v=0,g=m.length;v<g;v++){var y=m[v];h.fromArray(p,3*y),w(h,y)}else{v=0;for(var b=p.length/3;v<b;v++)h.fromArray(p,3*v),w(h,v)}}else{var x=a.vertices;for(v=0,b=x.length;v<b;v++)w(x[v],v)}}function w(e,r){var a=t.distanceSqToPoint(e);if(a<l){t.closestPointToPoint(e,d),d.applyMatrix4(s);var c=n.ray.origin.distanceTo(d);if(c<n.near||c>n.far)return;i.push({distance:c,distanceToRay:Math.sqrt(a),point:d.clone(),index:r,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ci.prototype=Object.assign(Object.create(qt.prototype),{constructor:Ci,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Li.prototype=Object.create(qt.prototype),Li.prototype.constructor=Li,Li.prototype.isCompressedTexture=!0,Pi.prototype=Object.create(qt.prototype),Pi.prototype.constructor=Pi,Pi.prototype.isCanvasTexture=!0,Oi.prototype=Object.create(qt.prototype),Oi.prototype.constructor=Oi,Oi.prototype.isDepthTexture=!0,Ni.prototype=Object.create(Pr.prototype),Ni.prototype.constructor=Ni,Ri.prototype=Object.create(vr.prototype),Ri.prototype.constructor=Ri,Ii.prototype=Object.create(Pr.prototype),Ii.prototype.constructor=Ii,Di.prototype=Object.create(vr.prototype),Di.prototype.constructor=Di,Fi.prototype=Object.create(Pr.prototype),Fi.prototype.constructor=Fi,Ui.prototype=Object.create(vr.prototype),Ui.prototype.constructor=Ui,ki.prototype=Object.create(Fi.prototype),ki.prototype.constructor=ki,Bi.prototype=Object.create(vr.prototype),Bi.prototype.constructor=Bi,zi.prototype=Object.create(Fi.prototype),zi.prototype.constructor=zi,ji.prototype=Object.create(vr.prototype),ji.prototype.constructor=ji,Vi.prototype=Object.create(Fi.prototype),Vi.prototype.constructor=Vi,Gi.prototype=Object.create(vr.prototype),Gi.prototype.constructor=Gi,Wi.prototype=Object.create(Fi.prototype),Wi.prototype.constructor=Wi,Hi.prototype=Object.create(vr.prototype),Hi.prototype.constructor=Hi,Xi.prototype=Object.create(Pr.prototype),Xi.prototype.constructor=Xi,qi.prototype=Object.create(vr.prototype),qi.prototype.constructor=qi,Yi.prototype=Object.create(Pr.prototype),Yi.prototype.constructor=Yi,Ji.prototype=Object.create(vr.prototype),Ji.prototype.constructor=Ji,Qi.prototype=Object.create(Pr.prototype),Qi.prototype.constructor=Qi;var Zi=function(e,t,r){r=r||2;var n,i,o,a,s,c,u,l=t&&t.length,h=l?t[0]*r:e.length,d=Ki(e,0,h,r,!0),f=[];if(!d)return f;if(l&&(d=function(e,t,r,n){var i,o,a,s,c,u=[];for(i=0,o=t.length;i<o;i++)a=t[i]*n,s=i<o-1?t[i+1]*n:e.length,(c=Ki(e,a,s,n,!1))===c.next&&(c.steiner=!0),u.push(co(c));for(u.sort(oo),i=0;i<u.length;i++)ao(u[i],r),r=$i(r,r.next);return r}(e,t,d,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var p=r;p<h;p+=r)s=e[p],c=e[p+1],s<n&&(n=s),c<i&&(i=c),s>o&&(o=s),c>a&&(a=c);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return eo(d,f,r,n,i,u),f};function Ki(e,t,r,n,i){var o,a;if(i===function(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,r,n)>0)for(o=t;o<r;o+=n)a=go(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=go(o,e[o],e[o+1],a);return a&&fo(a,a.next)&&(yo(a),a=a.next),a}function $i(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!fo(n,n.next)&&0!==ho(n.prev,n,n.next))n=n.next;else{if(yo(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function eo(e,t,r,n,i,o,a){if(e){!a&&o&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=so(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,c,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(c=u;s>0||c>0&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,c--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(e,n,i,o);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?ro(e,n,i,o):to(e))t.push(s.i/r),t.push(e.i/r),t.push(c.i/r),yo(e),e=c.next,u=c.next;else if((e=c)===u){a?1===a?eo(e=no(e,t,r),t,r,n,i,o,2):2===a&&io(e,t,r,n,i,o):eo($i(e),t,r,n,i,o,1);break}}}function to(e){var t=e.prev,r=e,n=e.next;if(ho(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(uo(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&ho(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ro(e,t,r,n){var i=e.prev,o=e,a=e.next;if(ho(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=so(s,c,t,r,n),d=so(u,l,t,r,n),f=e.nextZ;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&uo(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ho(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&uo(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ho(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function no(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!fo(i,o)&&po(i,n,n.next,o)&&mo(i,o)&&mo(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),yo(n),yo(n.next),n=e=o),n=n.next}while(n!==e);return n}function io(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&lo(a,s)){var c=vo(a,s);return a=$i(a,a.next),c=$i(c,c.next),eo(a,t,r,n,i,o),void eo(c,t,r,n,i,o)}s=s.next}a=a.next}while(a!==e)}function oo(e,t){return e.x-t.x}function ao(e,t){if(t=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var c,u=r,l=r.x,h=r.y,d=1/0;n=r.next;for(;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&uo(o<h?i:a,o,l,h,o<h?a:i,o,n.x,n.y)&&((c=Math.abs(o-n.y)/(i-n.x))<d||c===d&&n.x>r.x)&&mo(n,e)&&(r=n,d=c),n=n.next;return r}(e,t)){var r=vo(t,e);$i(r,r.next)}}function so(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function co(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function uo(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function lo(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&po(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&mo(e,t)&&mo(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function ho(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fo(e,t){return e.x===t.x&&e.y===t.y}function po(e,t,r,n){return!!(fo(e,t)&&fo(r,n)||fo(e,n)&&fo(r,t))||ho(e,t,r)>0!=ho(e,t,n)>0&&ho(r,n,e)>0!=ho(r,n,t)>0}function mo(e,t){return ho(e.prev,e,e.next)<0?ho(e,t,e.next)>=0&&ho(e,e.prev,t)>=0:ho(e,t,e.prev)<0||ho(e,e.next,t)<0}function vo(e,t){var r=new bo(e.i,e.x,e.y),n=new bo(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function go(e,t,r,n){var i=new bo(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function yo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function bo(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var xo={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},isClockWise:function(e){return xo.area(e)<0},triangulateShape:function(e,t){var r=[],n=[],i=[];wo(e),_o(r,e);var o=e.length;t.forEach(wo);for(var a=0;a<t.length;a++)n.push(o),o+=t[a].length,_o(r,t[a]);var s=Zi(r,n);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function wo(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function _o(e,t){for(var r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function So(e,t){vr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Mo(e,t)),this.mergeVertices()}function Mo(e,t){Pr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t};for(var r=this,n=[],i=[],o=0,a=(e=Array.isArray(e)?e:[e]).length;o<a;o++){s(e[o])}function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,c=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,l=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:l-2,d=void 0!==t.bevelSegments?t.bevelSegments:3,f=t.extrudePath,p=void 0!==t.UVGenerator?t.UVGenerator:To;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);var m,v,g,y,b,x,w,_,S=!1;f&&(m=f.getSpacedPoints(s),S=!0,u=!1,v=f.computeFrenetFrames(s,!1),g=new Gt,y=new Gt,b=new Gt),u||(d=0,l=0,h=0);var M=e.extractPoints(a),T=M.shape,A=M.holes;if(!xo.isClockWise(T))for(T=T.reverse(),w=0,_=A.length;w<_;w++)x=A[w],xo.isClockWise(x)&&(A[w]=x.reverse());var E=xo.triangulateShape(T,A),C=T;for(w=0,_=A.length;w<_;w++)x=A[w],T=T.concat(x);function L(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}var P,O,N,R,I,D,F=T.length,U=E.length;function k(e,t,r){var n,i,o,a=e.x-t.x,s=e.y-t.y,c=r.x-e.x,u=r.y-e.y,l=a*a+s*s,h=a*u-s*c;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(l),f=Math.sqrt(c*c+u*u),p=t.x-s/d,m=t.y+a/d,v=((r.x-u/f-p)*u-(r.y+c/f-m)*c)/(a*u-s*c),g=(n=p+a*v-e.x)*n+(i=m+s*v-e.y)*i;if(g<=2)return new zt(n,i);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?c>Number.EPSILON&&(y=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(n=-s,i=a,o=Math.sqrt(l)):(n=a,i=s,o=Math.sqrt(l/2))}return new zt(n/o,i/o)}for(var B=[],z=0,j=C.length,V=j-1,G=z+1;z<j;z++,V++,G++)V===j&&(V=0),G===j&&(G=0),B[z]=k(C[z],C[V],C[G]);var W,H,X=[],q=B.concat();for(w=0,_=A.length;w<_;w++){for(x=A[w],W=[],z=0,V=(j=x.length)-1,G=z+1;z<j;z++,V++,G++)V===j&&(V=0),G===j&&(G=0),W[z]=k(x[z],x[V],x[G]);X.push(W),q=q.concat(W)}for(P=0;P<d;P++){for(N=P/d,R=l*Math.cos(N*Math.PI/2),O=h*Math.sin(N*Math.PI/2),z=0,j=C.length;z<j;z++)J((I=L(C[z],B[z],O)).x,I.y,-R);for(w=0,_=A.length;w<_;w++)for(x=A[w],W=X[w],z=0,j=x.length;z<j;z++)J((I=L(x[z],W[z],O)).x,I.y,-R)}for(O=h,z=0;z<F;z++)I=u?L(T[z],q[z],O):T[z],S?(y.copy(v.normals[0]).multiplyScalar(I.x),g.copy(v.binormals[0]).multiplyScalar(I.y),b.copy(m[0]).add(y).add(g),J(b.x,b.y,b.z)):J(I.x,I.y,0);for(H=1;H<=s;H++)for(z=0;z<F;z++)I=u?L(T[z],q[z],O):T[z],S?(y.copy(v.normals[H]).multiplyScalar(I.x),g.copy(v.binormals[H]).multiplyScalar(I.y),b.copy(m[H]).add(y).add(g),J(b.x,b.y,b.z)):J(I.x,I.y,c/s*H);for(P=d-1;P>=0;P--){for(N=P/d,R=l*Math.cos(N*Math.PI/2),O=h*Math.sin(N*Math.PI/2),z=0,j=C.length;z<j;z++)J((I=L(C[z],B[z],O)).x,I.y,c+R);for(w=0,_=A.length;w<_;w++)for(x=A[w],W=X[w],z=0,j=x.length;z<j;z++)I=L(x[z],W[z],O),S?J(I.x,I.y+m[s-1].y,m[s-1].x+R):J(I.x,I.y,c+R)}function Y(e,t){var r,n;for(z=e.length;--z>=0;){r=z,(n=z-1)<0&&(n=e.length-1);var i=0,o=s+2*d;for(i=0;i<o;i++){var a=F*i,c=F*(i+1);Z(t+r+a,t+n+a,t+n+c,t+r+c)}}}function J(e,t,r){o.push(e),o.push(t),o.push(r)}function Q(e,t,i){K(e),K(t),K(i);var o=n.length/3,a=p.generateTopUV(r,n,o-3,o-2,o-1);$(a[0]),$(a[1]),$(a[2])}function Z(e,t,i,o){K(e),K(t),K(o),K(t),K(i),K(o);var a=n.length/3,s=p.generateSideWallUV(r,n,a-6,a-3,a-2,a-1);$(s[0]),$(s[1]),$(s[3]),$(s[1]),$(s[2]),$(s[3])}function K(e){n.push(o[3*e+0]),n.push(o[3*e+1]),n.push(o[3*e+2])}function $(e){i.push(e.x),i.push(e.y)}!function(){var e=n.length/3;if(u){var t=0,i=F*t;for(z=0;z<U;z++)Q((D=E[z])[2]+i,D[1]+i,D[0]+i);for(i=F*(t=s+2*d),z=0;z<U;z++)Q((D=E[z])[0]+i,D[1]+i,D[2]+i)}else{for(z=0;z<U;z++)Q((D=E[z])[2],D[1],D[0]);for(z=0;z<U;z++)Q((D=E[z])[0]+F*s,D[1]+F*s,D[2]+F*s)}r.addGroup(e,n.length/3-e,0)}(),function(){var e=n.length/3,t=0;for(Y(C,t),t+=C.length,w=0,_=A.length;w<_;w++)Y(x=A[w],t),t+=x.length;r.addGroup(e,n.length/3-e,1)}()}this.addAttribute("position",new Tr(n,3)),this.addAttribute("uv",new Tr(i,2)),this.computeVertexNormals()}So.prototype=Object.create(vr.prototype),So.prototype.constructor=So,So.prototype.toJSON=function(){var e=vr.prototype.toJSON.call(this);return Ao(this.parameters.shapes,this.parameters.options,e)},Mo.prototype=Object.create(Pr.prototype),Mo.prototype.constructor=Mo,Mo.prototype.toJSON=function(){var e=Pr.prototype.toJSON.call(this);return Ao(this.parameters.shapes,this.parameters.options,e)};var To={generateTopUV:function(e,t,r,n,i){var o=t[3*r],a=t[3*r+1],s=t[3*n],c=t[3*n+1],u=t[3*i],l=t[3*i+1];return[new zt(o,a),new zt(s,c),new zt(u,l)]},generateSideWallUV:function(e,t,r,n,i,o){var a=t[3*r],s=t[3*r+1],c=t[3*r+2],u=t[3*n],l=t[3*n+1],h=t[3*n+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*o],v=t[3*o+1],g=t[3*o+2];return Math.abs(s-l)<.01?[new zt(a,1-c),new zt(u,1-h),new zt(d,1-p),new zt(m,1-g)]:[new zt(s,1-c),new zt(l,1-h),new zt(f,1-p),new zt(v,1-g)]}};function Ao(e,t,r){if(r.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var o=e[n];r.shapes.push(o.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function Eo(e,t){vr.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Co(e,t)),this.mergeVertices()}function Co(e,t){var r=(t=t||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new vr;var n=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Mo.call(this,n,t),this.type="TextBufferGeometry"}function Lo(e,t,r,n,i,o,a){vr.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Po(e,t,r,n,i,o,a)),this.mergeVertices()}function Po(e,t,r,n,i,o,a){Pr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var s,c,u=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),l=0,h=[],d=new Gt,f=new Gt,p=[],m=[],v=[],g=[];for(c=0;c<=r;c++){var y=[],b=c/r;for(s=0;s<=t;s++){var x=s/t;d.x=-e*Math.cos(n+x*i)*Math.sin(o+b*a),d.y=e*Math.cos(o+b*a),d.z=e*Math.sin(n+x*i)*Math.sin(o+b*a),m.push(d.x,d.y,d.z),f.set(d.x,d.y,d.z).normalize(),v.push(f.x,f.y,f.z),g.push(x,1-b),y.push(l++)}h.push(y)}for(c=0;c<r;c++)for(s=0;s<t;s++){var w=h[c][s+1],_=h[c][s],S=h[c+1][s],M=h[c+1][s+1];(0!==c||o>0)&&p.push(w,_,M),(c!==r-1||u<Math.PI)&&p.push(_,S,M)}this.setIndex(p),this.addAttribute("position",new Tr(m,3)),this.addAttribute("normal",new Tr(v,3)),this.addAttribute("uv",new Tr(g,2))}function Oo(e,t,r,n,i,o){vr.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new No(e,t,r,n,i,o)),this.mergeVertices()}function No(e,t,r,n,i,o){Pr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,s,c,u=[],l=[],h=[],d=[],f=e,p=(t-e)/(n=void 0!==n?Math.max(1,n):1),m=new Gt,v=new zt;for(s=0;s<=n;s++){for(c=0;c<=r;c++)a=i+c/r*o,m.x=f*Math.cos(a),m.y=f*Math.sin(a),l.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/t+1)/2,v.y=(m.y/t+1)/2,d.push(v.x,v.y);f+=p}for(s=0;s<n;s++){var g=s*(r+1);for(c=0;c<r;c++){var y=a=c+g,b=a+r+1,x=a+r+2,w=a+1;u.push(y,b,w),u.push(b,x,w)}}this.setIndex(u),this.addAttribute("position",new Tr(l,3)),this.addAttribute("normal",new Tr(h,3)),this.addAttribute("uv",new Tr(d,2))}function Ro(e,t,r,n){vr.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new Io(e,t,r,n)),this.mergeVertices()}function Io(e,t,r,n){Pr.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=Bt.clamp(n,0,2*Math.PI);var i,o,a,s=[],c=[],u=[],l=1/t,h=new Gt,d=new zt;for(o=0;o<=t;o++){var f=r+o*l*n,p=Math.sin(f),m=Math.cos(f);for(a=0;a<=e.length-1;a++)h.x=e[a].x*p,h.y=e[a].y,h.z=e[a].x*m,c.push(h.x,h.y,h.z),d.x=o/t,d.y=a/(e.length-1),u.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var v=i=a+o*e.length,g=i+e.length,y=i+e.length+1,b=i+1;s.push(v,g,b),s.push(g,y,b)}if(this.setIndex(s),this.addAttribute("position",new Tr(c,3)),this.addAttribute("uv",new Tr(u,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,w=new Gt,_=new Gt,S=new Gt;for(i=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)w.x=x[a+0],w.y=x[a+1],w.z=x[a+2],_.x=x[i+a+0],_.y=x[i+a+1],_.z=x[i+a+2],S.addVectors(w,_).normalize(),x[a+0]=x[i+a+0]=S.x,x[a+1]=x[i+a+1]=S.y,x[a+2]=x[i+a+2]=S.z}}function Do(e,t){vr.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Fo(e,t)),this.mergeVertices()}function Fo(e,t){Pr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var r=[],n=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))u(e);else for(var c=0;c<e.length;c++)u(e[c]),this.addGroup(a,s,c),a+=s,s=0;function u(e){var a,c,u,l=n.length/3,h=e.extractPoints(t),d=h.shape,f=h.holes;if(!1===xo.isClockWise(d))for(d=d.reverse(),a=0,c=f.length;a<c;a++)u=f[a],!0===xo.isClockWise(u)&&(f[a]=u.reverse());var p=xo.triangulateShape(d,f);for(a=0,c=f.length;a<c;a++)u=f[a],d=d.concat(u);for(a=0,c=d.length;a<c;a++){var m=d[a];n.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=p.length;a<c;a++){var v=p[a],g=v[0]+l,y=v[1]+l,b=v[2]+l;r.push(g,y,b),s+=3}}this.setIndex(r),this.addAttribute("position",new Tr(n,3)),this.addAttribute("normal",new Tr(i,3)),this.addAttribute("uv",new Tr(o,2))}function Uo(e,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function ko(e,t){Pr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var r,n,i,o,a=[],s=Math.cos(Bt.DEG2RAD*t),c=[0,0],u={},l=["a","b","c"];e.isBufferGeometry?(o=new vr).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],v=0;v<3;v++)r=m[l[v]],n=m[l[(v+1)%3]],c[0]=Math.min(r,n),c[1]=Math.max(r,n),void 0===u[i=c[0]+","+c[1]]?u[i]={index1:c[0],index2:c[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var g=u[i];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=s){var y=h[g.index1];a.push(y.x,y.y,y.z),y=h[g.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Tr(a,3))}function Bo(e,t,r,n,i,o,a,s){vr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new zo(e,t,r,n,i,o,a,s)),this.mergeVertices()}function zo(e,t,r,n,i,o,a,s){Pr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var c=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var u=[],l=[],h=[],d=[],f=0,p=[],m=r/2,v=0;function g(r){var i,o,p,g=new zt,y=new Gt,b=0,x=!0===r?e:t,w=!0===r?1:-1;for(o=f,i=1;i<=n;i++)l.push(0,m*w,0),h.push(0,w,0),d.push(.5,.5),f++;for(p=f,i=0;i<=n;i++){var _=i/n*s+a,S=Math.cos(_),M=Math.sin(_);y.x=x*M,y.y=m*w,y.z=x*S,l.push(y.x,y.y,y.z),h.push(0,w,0),g.x=.5*S+.5,g.y=.5*M*w+.5,d.push(g.x,g.y),f++}for(i=0;i<n;i++){var T=o+i,A=p+i;!0===r?u.push(A,A+1,T):u.push(A+1,A,T),b+=3}c.addGroup(v,b,!0===r?1:2),v+=b}!function(){var o,g,y=new Gt,b=new Gt,x=0,w=(t-e)/r;for(g=0;g<=i;g++){var _=[],S=g/i,M=S*(t-e)+e;for(o=0;o<=n;o++){var T=o/n,A=T*s+a,E=Math.sin(A),C=Math.cos(A);b.x=M*E,b.y=-S*r+m,b.z=M*C,l.push(b.x,b.y,b.z),y.set(E,w,C).normalize(),h.push(y.x,y.y,y.z),d.push(T,1-S),_.push(f++)}p.push(_)}for(o=0;o<n;o++)for(g=0;g<i;g++){var L=p[g][o],P=p[g+1][o],O=p[g+1][o+1],N=p[g][o+1];u.push(L,P,N),u.push(P,O,N),x+=6}c.addGroup(v,x,0),v+=x}(),!1===o&&(e>0&&g(!0),t>0&&g(!1)),this.setIndex(u),this.addAttribute("position",new Tr(l,3)),this.addAttribute("normal",new Tr(h,3)),this.addAttribute("uv",new Tr(d,2))}function jo(e,t,r,n,i,o,a){Bo.call(this,0,e,t,r,n,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function Vo(e,t,r,n,i,o,a){zo.call(this,0,e,t,r,n,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function Go(e,t,r,n){vr.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new Wo(e,t,r,n)),this.mergeVertices()}function Wo(e,t,r,n){Pr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o,a=[],s=[],c=[],u=[],l=new Gt,h=new zt;for(s.push(0,0,0),c.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var d=r+o/t*n;l.x=e*Math.cos(d),l.y=e*Math.sin(d),s.push(l.x,l.y,l.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,u.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Tr(s,3)),this.addAttribute("normal",new Tr(c,3)),this.addAttribute("uv",new Tr(u,2))}Eo.prototype=Object.create(vr.prototype),Eo.prototype.constructor=Eo,Co.prototype=Object.create(Mo.prototype),Co.prototype.constructor=Co,Lo.prototype=Object.create(vr.prototype),Lo.prototype.constructor=Lo,Po.prototype=Object.create(Pr.prototype),Po.prototype.constructor=Po,Oo.prototype=Object.create(vr.prototype),Oo.prototype.constructor=Oo,No.prototype=Object.create(Pr.prototype),No.prototype.constructor=No,Ro.prototype=Object.create(vr.prototype),Ro.prototype.constructor=Ro,Io.prototype=Object.create(Pr.prototype),Io.prototype.constructor=Io,Do.prototype=Object.create(vr.prototype),Do.prototype.constructor=Do,Do.prototype.toJSON=function(){var e=vr.prototype.toJSON.call(this);return Uo(this.parameters.shapes,e)},Fo.prototype=Object.create(Pr.prototype),Fo.prototype.constructor=Fo,Fo.prototype.toJSON=function(){var e=Pr.prototype.toJSON.call(this);return Uo(this.parameters.shapes,e)},ko.prototype=Object.create(Pr.prototype),ko.prototype.constructor=ko,Bo.prototype=Object.create(vr.prototype),Bo.prototype.constructor=Bo,zo.prototype=Object.create(Pr.prototype),zo.prototype.constructor=zo,jo.prototype=Object.create(Bo.prototype),jo.prototype.constructor=jo,Vo.prototype=Object.create(zo.prototype),Vo.prototype.constructor=Vo,Go.prototype=Object.create(vr.prototype),Go.prototype.constructor=Go,Wo.prototype=Object.create(Pr.prototype),Wo.prototype.constructor=Wo;var Ho=Object.freeze({WireframeGeometry:Ni,ParametricGeometry:Ri,ParametricBufferGeometry:Ii,TetrahedronGeometry:Ui,TetrahedronBufferGeometry:ki,OctahedronGeometry:Bi,OctahedronBufferGeometry:zi,IcosahedronGeometry:ji,IcosahedronBufferGeometry:Vi,DodecahedronGeometry:Gi,DodecahedronBufferGeometry:Wi,PolyhedronGeometry:Di,PolyhedronBufferGeometry:Fi,TubeGeometry:Hi,TubeBufferGeometry:Xi,TorusKnotGeometry:qi,TorusKnotBufferGeometry:Yi,TorusGeometry:Ji,TorusBufferGeometry:Qi,TextGeometry:Eo,TextBufferGeometry:Co,SphereGeometry:Lo,SphereBufferGeometry:Po,RingGeometry:Oo,RingBufferGeometry:No,PlaneGeometry:Rr,PlaneBufferGeometry:Ir,LatheGeometry:Ro,LatheBufferGeometry:Io,ShapeGeometry:Do,ShapeBufferGeometry:Fo,ExtrudeGeometry:So,ExtrudeBufferGeometry:Mo,EdgesGeometry:ko,ConeGeometry:jo,ConeBufferGeometry:Vo,CylinderGeometry:Bo,CylinderBufferGeometry:zo,CircleGeometry:Go,CircleBufferGeometry:Wo,BoxGeometry:Or,BoxBufferGeometry:Nr});function Xo(e){Fr.call(this),this.type="ShadowMaterial",this.color=new or(0),this.transparent=!0,this.setValues(e)}function qo(e){Ur.call(this,e),this.type="RawShaderMaterial"}function Yo(e){Fr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new or(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Jo(e){Yo.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Qo(e){Fr.call(this),this.type="MeshPhongMaterial",this.color=new or(16777215),this.specular=new or(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Zo(e){Qo.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Ko(e){Fr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function $o(e){Fr.call(this),this.type="MeshLambertMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ea(t){if(Fr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new or(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ut,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(t),null===this.matcap){var r=document.createElement("canvas");r.width=1,r.height=1;var n=r.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,1,1),this.matcap=new e.CanvasTexture(r)}}function ta(e){_i.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Xo.prototype=Object.create(Fr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isShadowMaterial=!0,Xo.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this},qo.prototype=Object.create(Ur.prototype),qo.prototype.constructor=qo,qo.prototype.isRawShaderMaterial=!0,Yo.prototype=Object.create(Fr.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isMeshStandardMaterial=!0,Yo.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Jo.prototype=Object.create(Yo.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isMeshPhysicalMaterial=!0,Jo.prototype.copy=function(e){return Yo.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},Qo.prototype=Object.create(Fr.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isMeshPhongMaterial=!0,Qo.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Zo.prototype=Object.create(Qo.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isMeshToonMaterial=!0,Zo.prototype.copy=function(e){return Qo.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Ko.prototype=Object.create(Fr.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isMeshNormalMaterial=!0,Ko.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},$o.prototype=Object.create(Fr.prototype),$o.prototype.constructor=$o,$o.prototype.isMeshLambertMaterial=!0,$o.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ea.prototype=Object.create(Fr.prototype),ea.prototype.constructor=ea,ea.prototype.isMeshMatcapMaterial=!0,ea.prototype.copy=function(e){return Fr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ta.prototype=Object.create(_i.prototype),ta.prototype.constructor=ta,ta.prototype.isLineDashedMaterial=!0,ta.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var ra=Object.freeze({ShadowMaterial:Xo,SpriteMaterial:vi,RawShaderMaterial:qo,ShaderMaterial:Ur,PointsMaterial:Ai,MeshPhysicalMaterial:Jo,MeshStandardMaterial:Yo,MeshPhongMaterial:Qo,MeshToonMaterial:Zo,MeshNormalMaterial:Ko,MeshLambertMaterial:$o,MeshDepthMaterial:ei,MeshDistanceMaterial:ti,MeshBasicMaterial:zr,MeshMatcapMaterial:ea,LineDashedMaterial:ta,LineBasicMaterial:_i,Material:Fr}),na={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function ia(e,t,r){var n=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===i&&void 0!==n.onStart&&n.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var oa=new ia,aa={};function sa(e){this.manager=void 0!==e?e:oa}function ca(e){this.manager=void 0!==e?e:oa,this._parser=null}function ua(e){this.manager=void 0!==e?e:oa,this._parser=null}function la(e){this.manager=void 0!==e?e:oa}function ha(e){this.manager=void 0!==e?e:oa}function da(e){this.manager=void 0!==e?e:oa}function fa(){this.type="Curve",this.arcLengthDivisions=200}function pa(e,t,r,n,i,o,a,s){fa.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function ma(e,t,r,n,i,o){pa.call(this,e,t,r,r,n,i,o),this.type="ArcCurve"}function va(){var e=0,t=0,r=0,n=0;function i(i,o,a,s){e=i,t=a,r=-3*i+3*o-2*a-s,n=2*i-2*o+a+s}return{initCatmullRom:function(e,t,r,n,o){i(t,r,o*(r-e),o*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,o,a,s){var c=(t-e)/o-(r-e)/(o+a)+(r-t)/a,u=(r-t)/a-(n-t)/(a+s)+(n-r)/s;i(t,r,c*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+r*o+n*(o*i)}}}Object.assign(sa.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=na.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;if(void 0===aa[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],u=a[3];u=window.decodeURIComponent(u),c&&(u=window.atob(u));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),f=0;f<u.length;f++)d[f]=u.charCodeAt(f);l="blob"===h?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var p=new DOMParser;l=p.parseFromString(u,s);break;case"json":l=JSON.parse(u);break;default:l=u}window.setTimeout(function(){t&&t(l),i.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},0)}}else{aa[e]=[],aa[e].push({onLoad:t,onProgress:r,onError:n});var m=new XMLHttpRequest;for(var v in m.open("GET",e,!0),m.addEventListener("load",function(t){var r=this.response;na.add(e,r);var n=aa[e];if(delete aa[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=n.length;o<a;o++){(s=n[o]).onLoad&&s.onLoad(r)}i.manager.itemEnd(e)}else{for(o=0,a=n.length;o<a;o++){var s;(s=n[o]).onError&&s.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}},!1),m.addEventListener("progress",function(t){for(var r=aa[e],n=0,i=r.length;n<i;n++){var o=r[n];o.onProgress&&o.onProgress(t)}},!1),m.addEventListener("error",function(t){var r=aa[e];delete aa[e];for(var n=0,o=r.length;n<o;n++){var a=r[n];a.onError&&a.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)},!1),m.addEventListener("abort",function(t){var r=aa[e];delete aa[e];for(var n=0,o=r.length;n<o;n++){var a=r[n];a.onError&&a.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(e),m}aa[e].push({onLoad:t,onProgress:r,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(ca.prototype,{load:function(e,t,r,n){var i=this,o=[],a=new Li;a.image=o;var s=new sa(this.manager);function c(c){s.load(e[c],function(e){var r=i._parser(e,!0);o[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(u+=1)&&(1===r.mipmapCount&&(a.minFilter=_e),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,l=0,h=e.length;l<h;++l)c(l);else s.load(e,function(e){var r=i._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var c=0;c<r.mipmapCount;c++)o[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+c]),o[s].format=r.format,o[s].width=r.width,o[s].height=r.height}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=_e),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,n);return a},setPath:function(e){return this.path=e,this}}),Object.assign(ua.prototype,{load:function(e,t,r,n){var i=this,o=new Zt,a=new sa(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var r=i._parser(e);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:ge,o.wrapT=void 0!==r.wrapT?r.wrapT:ge,o.magFilter=void 0!==r.magFilter?r.magFilter:_e,o.minFilter=void 0!==r.minFilter?r.minFilter:Me,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=_e),o.needsUpdate=!0,t&&t(o,r))},r,n),o}}),Object.assign(la.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=na.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),na.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ha.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new Gr,o=new la(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(r){o.load(e[r],function(e){i.images[r]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(var c=0;c<e.length;++c)s(c);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(da.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new qt,o=new la(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(r){i.image=r;var n=e.search(/\.jpe?g$/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=n?ke:Be,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(fa.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=e;r++)o+=(t=this.getPoint(r/e)).distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t||e*n[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=n[i=Math.floor(s+(c-s)/2)]-r)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(n[i=c]===r)return i/(o-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;t<0&&(t=0),r>1&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,o=new Gt,a=[],s=[],c=[],u=new Gt,l=new jt;for(r=0;r<=e;r++)n=r/e,a[r]=this.getTangentAt(n),a[r].normalize();s[0]=new Gt,c[0]=new Gt;var h=Number.MAX_VALUE,d=Math.abs(a[0].x),f=Math.abs(a[0].y),p=Math.abs(a[0].z);for(d<=h&&(h=d,o.set(1,0,0)),f<=h&&(h=f,o.set(0,1,0)),p<=h&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),c[0].crossVectors(a[0],s[0]),r=1;r<=e;r++)s[r]=s[r-1].clone(),c[r]=c[r-1].clone(),u.crossVectors(a[r-1],a[r]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(Bt.clamp(a[r-1].dot(a[r]),-1,1)),s[r].applyMatrix4(l.makeRotationAxis(u,i))),c[r].crossVectors(a[r],s[r]);if(!0===t)for(i=Math.acos(Bt.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(u.crossVectors(s[0],s[e]))>0&&(i=-i),r=1;r<=e;r++)s[r].applyMatrix4(l.makeRotationAxis(a[r],i*r)),c[r].crossVectors(a[r],s[r]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),pa.prototype=Object.create(fa.prototype),pa.prototype.constructor=pa,pa.prototype.isEllipseCurve=!0,pa.prototype.getPoint=function(e,t){for(var r=t||new zt,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=o?0:n),!0!==this.aClockwise||o||(i===n?i=-n:i-=n);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,d=c-this.aY;s=h*u-d*l+this.aX,c=h*l+d*u+this.aY}return r.set(s,c)},pa.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},pa.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},pa.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ma.prototype=Object.create(pa.prototype),ma.prototype.constructor=ma,ma.prototype.isArcCurve=!0;var ga=new Gt,ya=new va,ba=new va,xa=new va;function wa(e,t,r,n){fa.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function _a(e,t,r,n,i){var o=.5*(n-t),a=.5*(i-r),s=e*e;return(2*r-2*n+o+a)*(e*s)+(-3*r+3*n-2*o-a)*s+o*e+r}function Sa(e,t,r,n){return function(e,t){var r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function Ma(e,t,r,n,i){return function(e,t){var r=1-e;return r*r*r*t}(e,t)+function(e,t){var r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}function Ta(e,t,r,n){fa.call(this),this.type="CubicBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=r||new zt,this.v3=n||new zt}function Aa(e,t,r,n){fa.call(this),this.type="CubicBezierCurve3",this.v0=e||new Gt,this.v1=t||new Gt,this.v2=r||new Gt,this.v3=n||new Gt}function Ea(e,t){fa.call(this),this.type="LineCurve",this.v1=e||new zt,this.v2=t||new zt}function Ca(e,t){fa.call(this),this.type="LineCurve3",this.v1=e||new Gt,this.v2=t||new Gt}function La(e,t,r){fa.call(this),this.type="QuadraticBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=r||new zt}function Pa(e,t,r){fa.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Gt,this.v1=t||new Gt,this.v2=r||new Gt}function Oa(e){fa.call(this),this.type="SplineCurve",this.points=e||[]}wa.prototype=Object.create(fa.prototype),wa.prototype.constructor=wa,wa.prototype.isCatmullRomCurve3=!0,wa.prototype.getPoint=function(e,t){var r,n,i,o,a=t||new Gt,s=this.points,c=s.length,u=(c-(this.closed?0:1))*e,l=Math.floor(u),h=u-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/c)+1)*c:0===h&&l===c-1&&(l=c-2,h=1),this.closed||l>0?r=s[(l-1)%c]:(ga.subVectors(s[0],s[1]).add(s[0]),r=ga),n=s[l%c],i=s[(l+1)%c],this.closed||l+2<c?o=s[(l+2)%c]:(ga.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=ga),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(r.distanceToSquared(n),d),p=Math.pow(n.distanceToSquared(i),d),m=Math.pow(i.distanceToSquared(o),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),ya.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,f,p,m),ba.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,f,p,m),xa.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,f,p,m)}else"catmullrom"===this.curveType&&(ya.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),ba.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),xa.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return a.set(ya.calc(h),ba.calc(h),xa.calc(h)),a},wa.prototype.copy=function(e){fa.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},wa.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},wa.prototype.fromJSON=function(e){fa.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new Gt).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ta.prototype=Object.create(fa.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isCubicBezierCurve=!0,Ta.prototype.getPoint=function(e,t){var r=t||new zt,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(Ma(e,n.x,i.x,o.x,a.x),Ma(e,n.y,i.y,o.y,a.y)),r},Ta.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ta.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ta.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Aa.prototype=Object.create(fa.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isCubicBezierCurve3=!0,Aa.prototype.getPoint=function(e,t){var r=t||new Gt,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(Ma(e,n.x,i.x,o.x,a.x),Ma(e,n.y,i.y,o.y,a.y),Ma(e,n.z,i.z,o.z,a.z)),r},Aa.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Aa.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Aa.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ea.prototype=Object.create(fa.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isLineCurve=!0,Ea.prototype.getPoint=function(e,t){var r=t||new zt;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Ea.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ea.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Ea.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ea.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ea.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ca.prototype=Object.create(fa.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isLineCurve3=!0,Ca.prototype.getPoint=function(e,t){var r=t||new Gt;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Ca.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ca.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ca.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ca.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},La.prototype=Object.create(fa.prototype),La.prototype.constructor=La,La.prototype.isQuadraticBezierCurve=!0,La.prototype.getPoint=function(e,t){var r=t||new zt,n=this.v0,i=this.v1,o=this.v2;return r.set(Sa(e,n.x,i.x,o.x),Sa(e,n.y,i.y,o.y)),r},La.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},La.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},La.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Pa.prototype=Object.create(fa.prototype),Pa.prototype.constructor=Pa,Pa.prototype.isQuadraticBezierCurve3=!0,Pa.prototype.getPoint=function(e,t){var r=t||new Gt,n=this.v0,i=this.v1,o=this.v2;return r.set(Sa(e,n.x,i.x,o.x),Sa(e,n.y,i.y,o.y),Sa(e,n.z,i.z,o.z)),r},Pa.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Pa.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Pa.prototype.fromJSON=function(e){return fa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Oa.prototype=Object.create(fa.prototype),Oa.prototype.constructor=Oa,Oa.prototype.isSplineCurve=!0,Oa.prototype.getPoint=function(e,t){var r=t||new zt,n=this.points,i=(n.length-1)*e,o=Math.floor(i),a=i-o,s=n[0===o?o:o-1],c=n[o],u=n[o>n.length-2?n.length-1:o+1],l=n[o>n.length-3?n.length-1:o+2];return r.set(_a(a,s.x,c.x,u.x,l.x),_a(a,s.y,c.y,u.y,l.y)),r},Oa.prototype.copy=function(e){fa.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this},Oa.prototype.toJSON=function(){var e=fa.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e},Oa.prototype.fromJSON=function(e){fa.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new zt).fromArray(n))}return this};var Na=Object.freeze({ArcCurve:ma,CatmullRomCurve3:wa,CubicBezierCurve:Ta,CubicBezierCurve3:Aa,EllipseCurve:pa,LineCurve:Ea,LineCurve3:Ca,QuadraticBezierCurve:La,QuadraticBezierCurve3:Pa,SplineCurve:Oa});function Ra(){fa.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ia(e){Ra.call(this),this.type="Path",this.currentPoint=new zt,e&&this.setFromPoints(e)}function Da(e){Ia.call(this,e),this.uuid=Bt.generateUUID(),this.type="Shape",this.holes=[]}function Fa(e,t){pr.call(this),this.type="Light",this.color=new or(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ua(e,t,r){Fa.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(pr.DefaultUp),this.updateMatrix(),this.groundColor=new or(t)}function ka(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new zt(512,512),this.map=null,this.matrix=new jt}function Ba(){ka.call(this,new si(50,1,.5,500))}function za(e,t,r,n,i,o){Fa.call(this,e,t),this.type="SpotLight",this.position.copy(pr.DefaultUp),this.updateMatrix(),this.target=new pr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Ba}function ja(e,t,r,n){Fa.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new ka(new si(90,1,.5,500))}function Va(e,t,r,n,i,o){ai.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ga(){ka.call(this,new Va(-5,5,5,-5,.5,500))}function Wa(e,t){Fa.call(this,e,t),this.type="DirectionalLight",this.position.copy(pr.DefaultUp),this.updateMatrix(),this.target=new pr,this.shadow=new Ga}function Ha(e,t){Fa.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Xa(e,t,r,n){Fa.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}Ra.prototype=Object.assign(Object.create(fa.prototype),{constructor:Ra,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ea(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var u=s[c];t&&t.equals(u)||(r.push(u),t=u)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){fa.prototype.copy.call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=fa.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){fa.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push((new Na[n.type]).fromJSON(n))}return this}}),Ia.prototype=Object.assign(Object.create(Ra.prototype),{constructor:Ia,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new Ea(this.currentPoint.clone(),new zt(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var i=new La(this.currentPoint.clone(),new zt(e,t),new zt(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,i,o){var a=new Ta(this.currentPoint.clone(),new zt(e,t),new zt(r,n),new zt(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new Oa([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,r,n,i,o)},absarc:function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},ellipse:function(e,t,r,n,i,o,a,s){var c=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+c,t+u,r,n,i,o,a,s)},absellipse:function(e,t,r,n,i,o,a,s){var c=new pa(e,t,r,n,i,o,a,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(e){return Ra.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Ra.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Ra.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Da.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Da,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Ia.prototype.copy.call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=Ia.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){Ia.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push((new Ia).fromJSON(n))}return this}}),Fa.prototype=Object.assign(Object.create(pr.prototype),{constructor:Fa,isLight:!0,copy:function(e){return pr.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=pr.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Ua.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Ua,isHemisphereLight:!0,copy:function(e){return Fa.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(ka.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Ba.prototype=Object.assign(Object.create(ka.prototype),{constructor:Ba,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*Bt.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),za.prototype=Object.assign(Object.create(Fa.prototype),{constructor:za,isSpotLight:!0,copy:function(e){return Fa.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ja.prototype=Object.assign(Object.create(Fa.prototype),{constructor:ja,isPointLight:!0,copy:function(e){return Fa.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Va.prototype=Object.assign(Object.create(ai.prototype),{constructor:Va,isOrthographicCamera:!0,copy:function(e,t){return ai.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,o=r+e,a=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=pr.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Ga.prototype=Object.assign(Object.create(ka.prototype),{constructor:Ga}),Wa.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Wa,isDirectionalLight:!0,copy:function(e){return Fa.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ha.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Ha,isAmbientLight:!0}),Xa.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Xa,isRectAreaLight:!0,copy:function(e){return Fa.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Fa.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var qa={arraySlice:function(e,t,r){return qa.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=new Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,r,n){for(var i=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(t.push(o.time),r.push.apply(r,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(t.push(o.time),a.toArray(r,r.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(t.push(o.time),r.push(a)),o=e[i++]}while(void 0!==o)}}};function Ya(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function Ja(e,t,r,n){Ya.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Qa(e,t,r,n){Ya.call(this,e,t,r,n)}function Za(e,t,r,n){Ya.call(this,e,t,r,n)}function Ka(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qa.convertArray(t,this.TimeBufferType),this.values=qa.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function $a(e,t,r){Ka.call(this,e,t,r)}function es(e,t,r,n){Ka.call(this,e,t,r,n)}function ts(e,t,r,n){Ka.call(this,e,t,r,n)}function rs(e,t,r,n){Ya.call(this,e,t,r,n)}function ns(e,t,r,n){Ka.call(this,e,t,r,n)}function is(e,t,r,n){Ka.call(this,e,t,r,n)}function os(e,t,r,n){Ka.call(this,e,t,r,n)}function as(e,t,r){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.uuid=Bt.generateUUID(),this.duration<0&&this.resetDuration()}function ss(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ts;case"vector":case"vector2":case"vector3":case"vector4":return os;case"color":return es;case"quaternion":return ns;case"bool":case"boolean":return $a;case"string":return is}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var r=[],n=[];qa.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function cs(e){this.manager=void 0!==e?e:oa,this.textures={}}function us(e){this.manager=void 0!==e?e:oa}Object.assign(Ya.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var o;r:{n:if(!(e<n)){for(var a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,e<(n=t[++r]))break t}o=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break t}o=r,r=0}for(;r<o;){var c=r+o>>>1;e<t[c]?o=c:r=c+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n,o=0;o!==n;++o)t[o]=r[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ya.prototype,{beforeStart_:Ya.prototype.copySampleValue_,afterEnd_:Ya.prototype.copySampleValue_}),Ja.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Ja,DefaultSettings_:{endingStart:wt,endingEnd:wt},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,o=e+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case _t:i=e,a=2*t-r;break;case St:a=t+n[i=n.length-2]-n[i+1];break;default:i=e,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case _t:o=e,s=2*r-t;break;case St:o=1,s=r+n[1]-n[0];break;default:o=e-1,s=t}var c=.5*(r-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-r),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(r-t)/(n-t),p=f*f,m=p*f,v=-h*m+2*h*p-h*f,g=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,x=0;x!==a;++x)i[x]=v*o[u+x]+g*o[c+x]+y*o[s+x]+b*o[l+x];return i}}),Qa.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Qa,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=(r-t)/(n-t),l=1-u,h=0;h!==a;++h)i[h]=o[c+h]*l+o[s+h]*u;return i}}),Za.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Za,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Ka,{toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:qa.convertArray(e.times,Array),values:qa.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(Ka.prototype,{constructor:Ka,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:bt,InterpolantFactoryMethodDiscrete:function(e){return new Za(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Qa(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ja(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case yt:t=this.InterpolantFactoryMethodDiscrete;break;case bt:t=this.InterpolantFactoryMethodLinear;break;case xt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return yt;case this.InterpolantFactoryMethodLinear:return bt;case this.InterpolantFactoryMethodSmooth:return xt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<e;)++i;for(;-1!==o&&r[o]>t;)--o;if(++o,0!==i||o!==n){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=qa.arraySlice(r,i,o),this.values=qa.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=r[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&qa.isTypedArray(n)){a=0;for(var c=n.length;a!==c;++a){var u=n[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=this.getInterpolation()===xt,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(n)s=!0;else for(var u=a*r,l=u-r,h=u+r,d=0;d!==r;++d){var f=t[u+d];if(f!==t[l+d]||f!==t[h+d]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var p=a*r,m=i*r;for(d=0;d!==r;++d)t[m+d]=t[p+d]}++i}}if(o>0){e[i]=e[o];for(p=o*r,m=i*r,d=0;d!==r;++d)t[m+d]=t[p+d];++i}return i!==e.length&&(this.times=qa.arraySlice(e,0,i),this.values=qa.arraySlice(t,0,i*r)),this}}),$a.prototype=Object.assign(Object.create(Ka.prototype),{constructor:$a,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:yt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),es.prototype=Object.assign(Object.create(Ka.prototype),{constructor:es,ValueTypeName:"color"}),ts.prototype=Object.assign(Object.create(Ka.prototype),{constructor:ts,ValueTypeName:"number"}),rs.prototype=Object.assign(Object.create(Ya.prototype),{constructor:rs,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=(r-t)/(n-t),u=s+a;s!==u;s+=4)Vt.slerpFlat(i,0,o,s-a,o,s,c);return i}}),ns.prototype=Object.assign(Object.create(Ka.prototype),{constructor:ns,ValueTypeName:"quaternion",DefaultInterpolation:bt,InterpolantFactoryMethodLinear:function(e){return new rs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),is.prototype=Object.assign(Object.create(Ka.prototype),{constructor:is,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:yt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),os.prototype=Object.assign(Object.create(Ka.prototype),{constructor:os,ValueTypeName:"vector"}),Object.assign(as,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,o=r.length;i!==o;++i)t.push(ss(r[i]).scale(n));return new as(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=r.length;i!==o;++i)t.push(Ka.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var u=qa.getKeyframeOrder(s);s=qa.sortedArray(s,1,u),c=qa.sortedArray(c,1,u),n||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new ts(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/r))}return new as(e,-1,o)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(i);if(c&&c.length>1){var u=n[h=c[1]];u||(n[h]=u=[]),u.push(s)}}var l=[];for(var h in n)l.push(as.CreateFromMorphTargetSequence(h,n[h],t,r));return l},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(e,t,r,n,i){if(0!==r.length){var o=[],a=[];qa.flattenJSON(r,o,a,n),0!==o.length&&i.push(new e(t,o,a))}},n=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var u=s[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var l={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)l[u[h].morphTargets[d]]=-1;for(var f in l){var p=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var v=u[h];p.push(v.time),m.push(v.morphTarget===f?1:0)}n.push(new ts(".morphTargetInfluence["+f+"]",p,m))}o=l.length*(a||1)}else{var g=".bones["+t[c].name+"]";r(os,g+".position",u,"pos",n),r(ns,g+".quaternion",u,"rot",n),r(os,g+".scale",u,"scl",n)}}return 0===n.length?null:new as(i,o,n)}}),Object.assign(as.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(cs.prototype,{load:function(e,t,r,n){var i=this;new sa(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new ra[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(n.uniforms[i]={},o.type){case"t":n.uniforms[i].value=r(o.value);break;case"c":n.uniforms[i].value=(new or).setHex(o.value);break;case"v2":n.uniforms[i].value=(new zt).fromArray(o.value);break;case"v3":n.uniforms[i].value=(new Gt).fromArray(o.value);break;case"v4":n.uniforms[i].value=(new Yt).fromArray(o.value);break;case"m4":n.uniforms[i].value=(new jt).fromArray(o.value);break;default:n.uniforms[i].value=o.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var a=e.normalScale;!1===Array.isArray(a)&&(a=[a,a]),n.normalScale=(new zt).fromArray(a)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),n}}),Object.assign(us.prototype,{load:function(e,t,r,n){var i=this;new sa(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new Pr,r=e.data.index;if(void 0!==r){var n=new ls[r.type](r.array);t.setIndex(new gr(n,1))}var i=e.data.attributes;for(var o in i){var a=i[o];n=new ls[a.type](a.array);t.addAttribute(o,new gr(n,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var c=0,u=s.length;c!==u;++c){var l=s[c];t.addGroup(l.start,l.count,l.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new Gt;void 0!==h.center&&d.fromArray(h.center),t.boundingSphere=new $t(d,h.radius)}return t}});var ls={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function hs(){}hs.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],o=t[r+1];if(i.test(e))return o}return null}},Object.assign(hs.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e={NoBlending:M,NormalBlending:T,AdditiveBlending:A,SubtractiveBlending:E,MultiplyBlending:C,CustomBlending:L},t=new or,r=new da,n=new cs;return function(i,o,a){var s={};function c(e,t,n,i,c){var u,l=o+e,h=hs.Handlers.get(l);null!==h?u=h.load(l):(r.setCrossOrigin(a),u=r.load(l)),void 0!==t&&(u.repeat.fromArray(t),1!==t[0]&&(u.wrapS=ve),1!==t[1]&&(u.wrapT=ve)),void 0!==n&&u.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(u.wrapS=ve),"mirror"===i[0]&&(u.wrapS=ye),"repeat"===i[1]&&(u.wrapT=ve),"mirror"===i[1]&&(u.wrapT=ye)),void 0!==c&&(u.anisotropy=c);var d=Bt.generateUUID();return s[d]=u,d}var u={uuid:Bt.generateUUID(),type:"MeshLambertMaterial"};for(var l in i){var h=i[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=e[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":u.color=t.fromArray(h).getHex();break;case"colorSpecular":u.specular=t.fromArray(h).getHex();break;case"colorEmissive":u.emissive=t.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=c(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=c(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=c(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=c(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=c(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=c(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=c(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=c(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=c(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=c(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=g;break;case"doubleSided":u.side=y;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[l]=h;break;case"vertexColors":!0===h&&(u.vertexColors=S),"face"===h&&(u.vertexColors=_);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),n.setTextures(s),n.parse(u)}}()});var ds={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function fs(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:oa,this.withCredentials=!1}function ps(e){this.manager=void 0!==e?e:oa,this.texturePath=""}Object.assign(fs.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===this.path?ds.extractUrlBase(e):this.path,a=new sa(this.manager);a.setPath(this.path),a.setWithCredentials(this.withCredentials),a.load(e,function(r){var n=JSON.parse(r),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.")}var c=i.parse(n,o);t(c.geometry,c.materials)},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var r=new vr;return function(e,t){function r(e,t){return e&1<<t}var n,i,o,a,s,c,u,l,h,d,f,p,m,v,g,y,b,x,w,_,S,M,T,A,E,C=e.faces,L=e.vertices,P=e.normals,O=e.colors,N=e.scale,R=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&R++;for(n=0;n<R;n++)t.faceVertexUvs[n]=[]}for(a=0,s=L.length;a<s;)(x=new Gt).x=L[a++]*N,x.y=L[a++]*N,x.z=L[a++]*N,t.vertices.push(x);for(a=0,s=C.length;a<s;)if(f=r(d=C[a++],0),p=r(d,1),m=r(d,3),v=r(d,4),g=r(d,5),y=r(d,6),b=r(d,7),f){if((_=new lr).a=C[a],_.b=C[a+1],_.c=C[a+3],(S=new lr).a=C[a+1],S.b=C[a+2],S.c=C[a+3],a+=4,p&&(h=C[a++],_.materialIndex=h,S.materialIndex=h),o=t.faces.length,m)for(n=0;n<R;n++)for(A=e.uvs[n],t.faceVertexUvs[n][o]=[],t.faceVertexUvs[n][o+1]=[],i=0;i<4;i++)E=new zt(A[2*(l=C[a++])],A[2*l+1]),2!==i&&t.faceVertexUvs[n][o].push(E),0!==i&&t.faceVertexUvs[n][o+1].push(E);if(v&&(u=3*C[a++],_.normal.set(P[u++],P[u++],P[u]),S.normal.copy(_.normal)),g)for(n=0;n<4;n++)u=3*C[a++],T=new Gt(P[u++],P[u++],P[u]),2!==n&&_.vertexNormals.push(T),0!==n&&S.vertexNormals.push(T);if(y&&(M=O[c=C[a++]],_.color.setHex(M),S.color.setHex(M)),b)for(n=0;n<4;n++)M=O[c=C[a++]],2!==n&&_.vertexColors.push(new or(M)),0!==n&&S.vertexColors.push(new or(M));t.faces.push(_),t.faces.push(S)}else{if((w=new lr).a=C[a++],w.b=C[a++],w.c=C[a++],p&&(h=C[a++],w.materialIndex=h),o=t.faces.length,m)for(n=0;n<R;n++)for(A=e.uvs[n],t.faceVertexUvs[n][o]=[],i=0;i<3;i++)E=new zt(A[2*(l=C[a++])],A[2*l+1]),t.faceVertexUvs[n][o].push(E);if(v&&(u=3*C[a++],w.normal.set(P[u++],P[u++],P[u])),g)for(n=0;n<3;n++)u=3*C[a++],T=new Gt(P[u++],P[u++],P[u]),w.vertexNormals.push(T);if(y&&(c=C[a++],w.color.setHex(O[c])),b)for(n=0;n<3;n++)c=C[a++],w.vertexColors.push(new or(O[c]));t.faces.push(w)}}(e,r),function(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=r){var o=e.skinWeights[n],a=r>1?e.skinWeights[n+1]:0,s=r>2?e.skinWeights[n+2]:0,c=r>3?e.skinWeights[n+3]:0;t.skinWeights.push(new Yt(o,a,s,c))}if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=r){var u=e.skinIndices[n],l=r>1?e.skinIndices[n+1]:0,h=r>2?e.skinIndices[n+2]:0,d=r>3?e.skinIndices[n+3]:0;t.skinIndices.push(new Yt(u,l,h,d))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,r),function(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,c=a.length;s<c;s+=3){var u=new Gt;u.x=a[s]*r,u.y=a[s+1]*r,u.z=a[s+2]*r,o.push(u)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=t.faces,h=e.morphColors[0].colors;for(n=0,i=l.length;n<i;n++)l[n].color.fromArray(h,3*n)}}(e,r),function(e,t){var r=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var o=as.parseAnimation(n[i],t.bones);o&&r.push(o)}if(t.morphTargets){var a=as.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(a)}r.length>0&&(t.animations=r)}(e,r),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:r}:{geometry:r,materials:hs.prototype.initMaterials(e.materials,this.resourcePath||t,this.crossOrigin)}}}()}),Object.assign(ps.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new sa(i.manager).load(e,function(r){var o=null;try{o=JSON.parse(r)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},r,n)},setTexturePath:function(e){return this.texturePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,n,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var r=0,n=e.length;r<n;r++){var i=(new Da).fromJSON(e[r]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var r={};if(void 0!==e)for(var n=new fs,i=new us,o=0,a=e.length;o<a;o++){var s,c=e[o];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Ho[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Ho[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Ho[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Ho[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Ho[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Ho[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Ho[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Ho[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Ho[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Ho[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Ho[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Ho[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,h=c.shapes.length;l<h;l++){var d=t[c.shapes[l]];u.push(d)}s=new Ho[c.type](u,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,h=c.shapes.length;l<h;l++){d=t[c.shapes[l]];u.push(d)}var f=c.options.extrudePath;void 0!==f&&(c.options.extrudePath=(new Na[f.type]).fromJSON(f)),s=new Ho[c.type](u,c.options);break;case"BufferGeometry":s=i.parse(c);break;case"Geometry":s=n.parse(c,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),r[c.uuid]=s}return r},parseMaterials:function(e,t){var r={};if(void 0!==e){var n=new cs;n.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++)s.push(n.parse(a.materials[c]));r[a.uuid]=s}else r[a.uuid]=n.parse(a)}}return r},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=as.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),t.push(i)}return t},parseImages:function(e,t){var r=this,n={};function i(e){return r.manager.itemStart(e),o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemEnd(e),r.manager.itemError(e)})}if(void 0!==e&&e.length>0){var o=new la(new ia(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var c=e[a],u=c.url;if(Array.isArray(u)){n[c.uuid]=[];for(var l=0,h=u.length;l<h;l++){var d=u[l],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:r.texturePath+d;n[c.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;n[c.uuid]=i(f)}}}return n},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new Gr(t[s.image]):new qt(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=r(s.mapping,vs)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=r(s.wrap[0],gs),a.wrapT=r(s.wrap[1],gs)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=r(s.minFilter,ys)),void 0!==s.magFilter&&(a.magFilter=r(s.magFilter,ys)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),n[s.uuid]=a}return n},parseObject:function(e,t,r){var n;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var o=e[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(r[o])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}switch(e.type){case"Scene":n=new fi,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new or(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new di(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new hi(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new si(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new Va(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new Ha(e.color,e.intensity);break;case"DirectionalLight":n=new Wa(e.color,e.intensity);break;case"PointLight":n=new ja(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new Xa(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new za(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new Ua(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);n=a.bones&&a.bones.length>0?new wi(a,s):new jr(a,s);break;case"LOD":n=new yi;break;case"Line":n=new Si(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":n=new Ti(i(e.geometry),o(e.material));break;case"LineSegments":n=new Mi(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":n=new Ei(i(e.geometry),o(e.material));break;case"Sprite":n=new gi(o(e.material));break;case"Group":n=new oi;break;default:n=new pr}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,u=0;u<c.length;u++)n.add(this.parseObject(c[u],t,r));if("LOD"===e.type)for(var l=e.levels,h=0;h<l.length;h++){var d=l[h],f=n.getObjectByProperty("uuid",d.object);void 0!==f&&n.addLevel(f,d.distance)}return n}});var ms,vs={UVMapping:ce,CubeReflectionMapping:ue,CubeRefractionMapping:le,EquirectangularReflectionMapping:he,EquirectangularRefractionMapping:de,SphericalReflectionMapping:fe,CubeUVReflectionMapping:pe,CubeUVRefractionMapping:me},gs={RepeatWrapping:ve,ClampToEdgeWrapping:ge,MirroredRepeatWrapping:ye},ys={NearestFilter:be,NearestMipMapNearestFilter:xe,NearestMipMapLinearFilter:we,LinearFilter:_e,LinearMipMapNearestFilter:Se,LinearMipMapLinearFilter:Me};function bs(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),void 0===n&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:oa,this.options=void 0}function xs(){this.type="ShapePath",this.color=new or,this.subPaths=[],this.currentPath=null}function ws(e){this.type="Font",this.data=e}function _s(e,t,r,n,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,c,u,l,h,d,f,p=new xs;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*t+r,s=m[v++]*t+n,p.moveTo(a,s);break;case"l":a=m[v++]*t+r,s=m[v++]*t+n,p.lineTo(a,s);break;case"q":c=m[v++]*t+r,u=m[v++]*t+n,l=m[v++]*t+r,h=m[v++]*t+n,p.quadraticCurveTo(l,h,c,u);break;case"b":c=m[v++]*t+r,u=m[v++]*t+n,l=m[v++]*t+r,h=m[v++]*t+n,d=m[v++]*t+r,f=m[v++]*t+n,p.bezierCurveTo(l,h,d,f,c,u)}}return{offsetX:o.ha*t,path:p}}}function Ss(e){this.manager=void 0!==e?e:oa}bs.prototype={constructor:bs,setOptions:function(e){return this.options=e,this},load:function(e,t,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,a=na.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout(function(){t&&t(a),o.manager.itemEnd(e)},0),a;n(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,o.options)}).then(function(r){na.add(e,r),t&&t(r),o.manager.itemEnd(e)}).catch(function(t){i&&i(t),o.manager.itemEnd(e),o.manager.itemError(e)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(xs.prototype,{moveTo:function(e,t){this.currentPath=new Ia,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,o){this.currentPath.bezierCurveTo(e,t,r,n,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new Da;o.curves=i.curves,t.push(o)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],c=-c,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=u*(e.x-a.x)-c*(e.y-a.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var i=xo.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return r(o);var a,s,c,u=[];if(1===o.length)return s=o[0],(c=new Da).curves=s.curves,u.push(c),u;var l=!i(o[0].getPoints());l=e?!l:l;var h,d,f=[],p=[],m=[],v=0;p[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=i(h=(s=o[g]).getPoints()),(a=e?!a:a)?(!l&&p[v]&&v++,p[v]={s:new Da,p:h},p[v].s.curves=s.curves,l&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!p[0])return r(o);if(p.length>1){for(var b=!1,x=[],w=0,_=p.length;w<_;w++)f[w]=[];for(w=0,_=p.length;w<_;w++)for(var S=m[w],M=0;M<S.length;M++){for(var T=S[M],A=!0,E=0;E<p.length;E++)n(T.p,p[E].p)&&(w!==E&&x.push({froms:w,tos:E,hole:M}),A?(A=!1,f[E].push(T)):b=!0);A&&f[w].push(T)}x.length>0&&(b||(m=f))}g=0;for(var C=p.length;g<C;g++){c=p[g].s,u.push(c);for(var L=0,P=(d=m[g]).length;L<P;L++)c.holes.push(d[L].h)}return u}}),Object.assign(ws.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var r=[],n=function(e,t,r){for(var n=Array.from?Array.from(e):String(e).split(""),i=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,a=[],s=0,c=0,u=0;u<n.length;u++){var l=n[u];if("\n"===l)s=0,c-=o;else{var h=_s(l,i,s,c,r);s+=h.offsetX,a.push(h.path)}}return a}(e,t,this.data),i=0,o=n.length;i<o;i++)Array.prototype.push.apply(r,n[i].toShapes());return r}}),Object.assign(Ss.prototype,{load:function(e,t,r,n){var i=this,o=new sa(this.manager);o.setPath(this.path),o.load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new ws(e)},setPath:function(e){return this.path=e,this}});var Ms={getContext:function(){return void 0===ms&&(ms=new(window.AudioContext||window.webkitAudioContext)),ms},setContext:function(e){ms=e}};function Ts(e){this.manager=void 0!==e?e:oa}function As(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new si,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new si,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Es(e,t,r){pr.call(this),this.type="CubeCamera";var n=new si(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new Gt(1,0,0)),this.add(n);var i=new si(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Gt(-1,0,0)),this.add(i);var o=new si(90,1,e,t);o.up.set(0,0,1),o.lookAt(new Gt(0,1,0)),this.add(o);var a=new si(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new Gt(0,-1,0)),this.add(a);var s=new si(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new Gt(0,0,1)),this.add(s);var c=new si(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new Gt(0,0,-1)),this.add(c);var u={format:ke,magFilter:_e,minFilter:_e};this.renderTarget=new Qt(r,r,u),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,u=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,n,r),r.activeCubeFace=1,e.render(t,i,r),r.activeCubeFace=2,e.render(t,o,r),r.activeCubeFace=3,e.render(t,a,r),r.activeCubeFace=4,e.render(t,s,r),r.texture.generateMipmaps=u,r.activeCubeFace=5,e.render(t,c,r),e.setRenderTarget(null)},this.clear=function(e,t,r,n){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,r,n);e.setRenderTarget(null)}}function Cs(){pr.call(this),this.type="AudioListener",this.context=Ms.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ls(e){pr.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ps(e){Ls.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Os(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Ns(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Ts.prototype,{load:function(e,t,r,n){var i=new sa(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){var r=e.slice(0);Ms.getContext().decodeAudioData(r,function(e){t(e)})},r,n)}}),Object.assign(As.prototype,{update:function(){var e,t,r,n,i,o,a,s,c=new jt,u=new jt;return function(l){if(e!==this||t!==l.focus||r!==l.fov||n!==l.aspect*this.aspect||i!==l.near||o!==l.far||a!==l.zoom||s!==this.eyeSep){e=this,t=l.focus,r=l.fov,n=l.aspect*this.aspect,i=l.near,o=l.far,a=l.zoom;var h,d,f=l.projectionMatrix.clone(),p=(s=this.eyeSep/2)*i/t,m=i*Math.tan(Bt.DEG2RAD*r*.5)/a;u.elements[12]=-s,c.elements[12]=s,h=-m*n+p,d=m*n+p,f.elements[0]=2*i/(d-h),f.elements[8]=(d+h)/(d-h),this.cameraL.projectionMatrix.copy(f),h=-m*n-p,d=m*n-p,f.elements[0]=2*i/(d-h),f.elements[8]=(d+h)/(d-h),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),Es.prototype=Object.create(pr.prototype),Es.prototype.constructor=Es,Cs.prototype=Object.assign(Object.create(pr.prototype),{constructor:Cs,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Gt,t=new Vt,r=new Gt,n=new Gt;return function(i){pr.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),Ls.prototype=Object.assign(Object.create(pr.prototype),{constructor:Ls,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Ps.prototype=Object.assign(Object.create(Ls.prototype),{constructor:Ps,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(){var e=new Gt,t=new Vt,r=new Gt,n=new Gt;return function(i){pr.prototype.updateMatrixWorld.call(this,i);var o=this.panner;this.matrixWorld.decompose(e,t,r),n.set(0,0,1).applyQuaternion(t),o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z)}}()}),Object.assign(Os.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(Ns.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)r[i+a]=r[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(r,n,a,1-i,t)}for(var s=t,c=t+t;s!==c;++s)if(r[s]!==r[s+t]){o.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r,o=n;i!==o;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)e[t+o]=e[r+o]},_slerp:function(e,t,r,n){Vt.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[r+a]*n}}});var Rs,Is;function Ds(e,t,r){var n=r||Fs.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Fs(e,t,r){this.path=t,this.parsedPath=r||Fs.parseTrackName(t),this.node=Fs.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Us(){this.uuid=Bt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function ks(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n=t.tracks,i=n.length,o=new Array(i),a={endingStart:wt,endingEnd:wt},s=0;s!==i;++s){var c=n[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Bs(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function zs(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function js(){Pr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Vs(e,t,r){pi.call(this,e,t),this.meshPerAttribute=r||1}function Gs(e,t,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),gr.call(this,e,t,r),this.meshPerAttribute=n||1}function Ws(e,t,r,n){this.ray=new kr(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Hs(e,t){return e.distance-t.distance}function Xs(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,o=0,a=i.length;o<a;o++)Xs(i[o],t,r,!0)}function qs(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ys(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}function Js(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}function Qs(e,t){this.min=void 0!==e?e:new zt(1/0,1/0),this.max=void 0!==t?t:new zt(-1/0,-1/0)}function Zs(e,t){this.start=void 0!==e?e:new Gt,this.end=void 0!==t?t:new Gt}function Ks(e){pr.call(this),this.material=e,this.render=function(){}}function $s(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new Pr,u=new Tr(2*a*3,3);c.addAttribute("position",u),Mi.call(this,c,new _i({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ec(e,t){pr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var r=new Pr,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}r.addAttribute("position",new Tr(n,3));var c=new _i({fog:!1});this.cone=new Mi(r,c),this.add(this.cone),this.update()}function tc(e){for(var t=function e(t){var r=[];t&&t.isBone&&r.push(t);for(var n=0;n<t.children.length;n++)r.push.apply(r,e(t.children[n]));return r}(e),r=new Pr,n=[],i=[],o=new or(0,0,1),a=new or(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}r.addAttribute("position",new Tr(n,3)),r.addAttribute("color",new Tr(i,3));var u=new _i({vertexColors:S,depthTest:!1,depthWrite:!1,transparent:!0});Mi.call(this,r,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function rc(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;var n=new Po(t,4,2),i=new zr({wireframe:!0,fog:!1});jr.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function nc(e,t){pr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var r=new _i({fog:!1}),n=new Pr;n.addAttribute("position",new gr(new Float32Array(15),3)),this.line=new Si(n,r),this.add(this.line),this.update()}function ic(e,t,r){pr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new zi(t);n.rotateY(.5*Math.PI),this.material=new zr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=S);var i=n.getAttribute("position"),o=new Float32Array(3*i.count);n.addAttribute("color",new gr(o,3)),this.add(new jr(n,this.material)),this.update()}function oc(e,t,r,n){e=e||10,t=t||10,r=new or(void 0!==r?r:4473924),n=new or(void 0!==n?n:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],c=[],u=0,l=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=u===i?r:n;d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3}var f=new Pr;f.addAttribute("position",new Tr(s,3)),f.addAttribute("color",new Tr(c,3));var p=new _i({vertexColors:S});Mi.call(this,f,p)}function ac(e,t,r,n,i,o){e=e||10,t=t||16,r=r||8,n=n||64,i=new or(void 0!==i?i:4473924),o=new or(void 0!==o?o:8947848);var a,s,c,u,l,h,d,f=[],p=[];for(u=0;u<=t;u++)c=u/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,f.push(0,0,0),f.push(a,0,s),d=1&u?i:o,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=r;u++)for(d=1&u?i:o,h=e-e/r*u,l=0;l<n;l++)c=l/n*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,f.push(a,0,s),p.push(d.r,d.g,d.b),c=(l+1)/n*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,f.push(a,0,s),p.push(d.r,d.g,d.b);var m=new Pr;m.addAttribute("position",new Tr(f,3)),m.addAttribute("color",new Tr(p,3));var v=new _i({vertexColors:S});Mi.call(this,m,v)}function sc(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new Pr,u=new Tr(2*a*3,3);c.addAttribute("position",u),Mi.call(this,c,new _i({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function cc(e,t,r){pr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);var n=new Pr;n.addAttribute("position",new Tr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new _i({fog:!1});this.lightPlane=new Si(n,i),this.add(this.lightPlane),(n=new Pr).addAttribute("position",new Tr([0,0,0,0,0,1],3)),this.targetLine=new Si(n,i),this.add(this.targetLine),this.update()}function uc(e){var t=new Pr,r=new _i({color:16777215,vertexColors:_}),n=[],i=[],o={},a=new or(16755200),s=new or(16711680),c=new or(43775),u=new or(16777215),l=new or(3355443);function h(e,t,r){d(e,r),d(t,r)}function d(e,t){n.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",u),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),t.addAttribute("position",new Tr(n,3)),t.addAttribute("color",new Tr(i,3)),Mi.call(this,t,r),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function lc(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new Pr;i.setIndex(new gr(r,1)),i.addAttribute("position",new gr(n,3)),Mi.call(this,i,new _i({color:t})),this.matrixAutoUpdate=!1,this.update()}function hc(e,t){this.type="Box3Helper",this.box=e;var r=void 0!==t?t:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Pr;i.setIndex(new gr(n,1)),i.addAttribute("position",new Tr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Mi.call(this,i,new _i({color:r})),this.geometry.computeBoundingSphere()}function dc(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==r?r:16776960,i=new Pr;i.addAttribute("position",new Tr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Si.call(this,i,new _i({color:n}));var o=new Pr;o.addAttribute("position",new Tr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new jr(o,new zr({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function fc(e,t,r,n,i,o){pr.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===Rs&&((Rs=new Pr).addAttribute("position",new Tr([0,0,0,0,1,0],3)),(Is=new zo(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Si(Rs,new _i({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new jr(Is,new zr({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,o)}function pc(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Pr;r.addAttribute("position",new Tr(t,3)),r.addAttribute("color",new Tr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new _i({vertexColors:S});Mi.call(this,r,n)}function mc(e,t,r,n,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new lr(e,t,r,i,o,a)}Object.assign(Ds.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(Fs,{Composite:Ds,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new Fs.Composite(e,t,r):new Fs(e,t,r)},sanitizeNodeName:function(){var e=new RegExp("[\\[\\]\\.:\\/]","g");return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^\\[\\]\\.:\\/]",t="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",e),n=/(WCOD+)?/.source.replace("WCOD",t),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),a=new RegExp("^"+r+n+i+o+"$"),s=["material","materials","bones"];return function(e){var t=a.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==s.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var n=function(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===t||i.uuid===t)return i;var o=n(i.children);if(o)return o}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(Fs.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=Fs.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var o=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Fs.prototype,{_getValue_unbound:Fs.prototype.getValue,_setValue_unbound:Fs.prototype.setValue}),Object.assign(Us.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,u=0,l=arguments.length;u!==l;++u){var h=arguments[u],d=h.uuid,f=n[d];if(void 0===f){f=t++,n[d]=f,e.push(h);for(var p=0,m=s;p!==m;++p)a[p].push(new Fs(h,i[p],o[p]))}else if(f<r){c=e[f];var v=--r,g=e[v];n[g.uuid]=f,e[f]=g,n[d]=v,e[v]=h;for(p=0,m=s;p!==m;++p){var y=a[p],b=y[v],x=y[f];y[f]=b,void 0===x&&(x=new Fs(h,i[p],o[p])),y[v]=x}}else e[f]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,u=r[c];if(void 0!==u&&u>=t){var l=t++,h=e[l];r[h.uuid]=u,e[u]=h,r[c]=l,e[l]=s;for(var d=0,f=i;d!==f;++d){var p=n[d],m=p[l],v=p[u];p[u]=m,p[l]=v}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a].uuid,u=n[c];if(void 0!==u)if(delete n[c],u<r){var l=--r,h=e[l],d=e[g=--t];n[h.uuid]=u,e[u]=h,n[d.uuid]=l,e[l]=d,e.pop();for(var f=0,p=o;f!==p;++f){var m=(y=i[f])[l],v=y[g];y[u]=m,y[l]=v,y.pop()}}else{var g;n[(d=e[g=--t]).uuid]=u,e[u]=d,e.pop();for(f=0,p=o;f!==p;++f){var y;(y=i[f])[u]=y[g],y.pop()}}}this.nCachedObjects_=r},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);n=i.length,r[e]=n,o.push(e),a.push(t),i.push(l);for(var h=u,d=s.length;h!==d;++h){var f=s[h];l[h]=new Fs(f,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=r,o[r]=s,o.pop(),i[r]=i[a],i.pop(),n[r]=n[a],n.pop()}}}),Object.assign(ks.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration,o=i/n,a=n/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+r,c[0]=e/a,c[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*r;if(o<0||0===r)return;this._startTime=null,t=r*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,u=this._propertyBindings,l=0,h=c.length;l!==h;++l)c[l].evaluate(a),u[l].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,r=this._clip.duration,n=this.loop,i=this._loopCount,o=n===gt;if(0===e)return-1===i?t:o&&1==(1&i)?r-t:t;if(n===mt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=r||t<0){var a=Math.floor(t/r);t-=r*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=t,r-t}return this.time=t,t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=_t,n.endingEnd=_t):(n.endingStart=e?this.zeroSlopeAtStart?_t:wt:St,n.endingEnd=t?this.zeroSlopeAtEnd?_t:wt:St)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=r,this}}),Bs.prototype=Object.assign(Object.create(i.prototype),{constructor:Bs,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,a=e._interpolants,s=r.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var h=n[l],d=h.name,f=u[d];if(void 0!==f)o[l]=f;else{if(void 0!==(f=o[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(f=new Ns(Fs.create(r,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),o[l]=f}a[l].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],o=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new Qa(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?as.findByName(r,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[n];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new ks(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,n),u},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?as.findByName(r,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==r;++a){t[a]._update(n,e,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var u=c._cacheIndex,l=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(c)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),zs.prototype.clone=function(){return new zs(void 0===this.value.clone?this.value:this.value.clone())},js.prototype=Object.assign(Object.create(Pr.prototype),{constructor:js,isInstancedBufferGeometry:!0,copy:function(e){return Pr.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Vs.prototype=Object.assign(Object.create(pi.prototype),{constructor:Vs,isInstancedInterleavedBuffer:!0,copy:function(e){return pi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Gs.prototype=Object.assign(Object.create(gr.prototype),{constructor:Gs,isInstancedBufferAttribute:!0,copy:function(e){return gr.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Ws.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){var n=r||[];return Xs(e,this,n,t),n.sort(Hs),n},intersectObjects:function(e,t,r){var n=r||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,o=e.length;i<o;i++)Xs(e[i],this,n,t);return n.sort(Hs),n}}),Object.assign(qs.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Ys.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Bt.clamp(t/this.radius,-1,1))),this}}),Object.assign(Js.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}}),Object.assign(Qs.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new zt;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new zt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new zt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new zt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Zs.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Gt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Gt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Gt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new Gt,t=new Gt;return function(r,n){e.subVectors(r,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),o=t.dot(e)/i;return n&&(o=Bt.clamp(o,0,1)),o}}(),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Gt),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Ks.prototype=Object.create(pr.prototype),Ks.prototype.constructor=Ks,Ks.prototype.isImmediateRenderObject=!0,$s.prototype=Object.create(Mi.prototype),$s.prototype.constructor=$s,$s.prototype.update=function(){var e=new Gt,t=new Gt,r=new Wt;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,u=0,l=0,h=c.length;l<h;l++)for(var d=c[l],f=0,p=d.vertexNormals.length;f<p;f++){var m=s[d[n[f]]],v=d.vertexNormals[f];e.copy(m).applyMatrix4(i),t.copy(v).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry){var g=a.attributes.position,y=a.attributes.normal;for(u=0,f=0,p=g.count;f<p;f++)e.set(g.getX(f),g.getY(f),g.getZ(f)).applyMatrix4(i),t.set(y.getX(f),y.getY(f),y.getZ(f)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),ec.prototype=Object.create(pr.prototype),ec.prototype.constructor=ec,ec.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ec.prototype.update=function(){var e=new Gt,t=new Gt;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),tc.prototype=Object.create(Mi.prototype),tc.prototype.constructor=tc,tc.prototype.updateMatrixWorld=function(){var e=new Gt,t=new jt,r=new jt;return function(n){var i=this.bones,o=this.geometry,a=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(t.multiplyMatrices(r,u.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(r,u.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c+1,e.x,e.y,e.z),c+=2)}o.getAttribute("position").needsUpdate=!0,pr.prototype.updateMatrixWorld.call(this,n)}}(),rc.prototype=Object.create(jr.prototype),rc.prototype.constructor=rc,rc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},rc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},nc.prototype=Object.create(pr.prototype),nc.prototype.constructor=nc,nc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},nc.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,r=this.line.geometry.attributes.position,n=r.array;n[0]=e,n[1]=-t,n[2]=0,n[3]=e,n[4]=t,n[5]=0,n[6]=-e,n[7]=t,n[8]=0,n[9]=-e,n[10]=-t,n[11]=0,n[12]=e,n[13]=-t,n[14]=0,r.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},ic.prototype=Object.create(pr.prototype),ic.prototype.constructor=ic,ic.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ic.prototype.update=function(){var e=new Gt,t=new or,r=new or;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:r;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),oc.prototype=Object.create(Mi.prototype),oc.prototype.constructor=oc,ac.prototype=Object.create(Mi.prototype),ac.prototype.constructor=ac,sc.prototype=Object.create(Mi.prototype),sc.prototype.constructor=sc,sc.prototype.update=function(){var e=new Gt,t=new Gt,r=new Wt;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,u=0,l=s.length;u<l;u++){var h=s[u],d=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(n),t.copy(d).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),c+=1,i.setXYZ(c,t.x,t.y,t.z),c+=1}i.needsUpdate=!0}}(),cc.prototype=Object.create(pr.prototype),cc.prototype.constructor=cc,cc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},cc.prototype.update=function(){var e=new Gt,t=new Gt,r=new Gt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(r),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(r),this.targetLine.scale.z=r.length()}}(),uc.prototype=Object.create(Mi.prototype),uc.prototype.constructor=uc,uc.prototype.update=function(){var e,t,r=new Gt,n=new ai;function i(i,o,a,s){r.set(o,a,s).unproject(n);var c=t[i];if(void 0!==c)for(var u=e.getAttribute("position"),l=0,h=c.length;l<h;l++)u.setXYZ(c[l],r.x,r.y,r.z)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),lc.prototype=Object.create(Mi.prototype),lc.prototype.constructor=lc,lc.prototype.update=function(){var e=new Kt;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),lc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},hc.prototype=Object.create(Mi.prototype),hc.prototype.constructor=hc,hc.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),pr.prototype.updateMatrixWorld.call(this,e))},dc.prototype=Object.create(Si.prototype),dc.prototype.constructor=dc,dc.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?g:v,this.lookAt(this.plane.normal),pr.prototype.updateMatrixWorld.call(this,e)},fc.prototype=Object.create(pr.prototype),fc.prototype.constructor=fc,fc.prototype.setDirection=function(){var e,t=new Gt;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),fc.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},fc.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},pc.prototype=Object.create(Mi.prototype),pc.prototype.constructor=pc;var vc=0,gc=1;function yc(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function bc(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function xc(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ei(e,t)}function wc(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new gi(e)}function _c(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ei(e,t)}function Sc(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ai(e)}function Mc(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ai(e)}function Tc(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ai(e)}function Ac(e,t,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Gt(e,t,r)}function Ec(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new gr(e,t).setDynamic(!0)}function Cc(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new yr(e,t)}function Lc(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new br(e,t)}function Pc(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new xr(e,t)}function Oc(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new wr(e,t)}function Nc(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new _r(e,t)}function Rc(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Sr(e,t)}function Ic(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Mr(e,t)}function Dc(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Tr(e,t)}function Fc(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ar(e,t)}function Uc(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),wa.call(this,e),this.type="catmullrom",this.closed=!0}function kc(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),wa.call(this,e),this.type="catmullrom"}function Bc(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),wa.call(this,e),this.type="catmullrom"}function zc(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new pc(e)}function jc(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new lc(e,t)}function Vc(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Mi(new ko(e.geometry),new _i({color:void 0!==t?t:16777215}))}function Gc(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Mi(new Ni(e.geometry),new _i({color:void 0!==t?t:16777215}))}function Wc(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new sa(e)}function Hc(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ua(e)}fa.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(fa.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Ra.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new vr,r=0,n=e.length;r<n;r++){var i=e[r];t.vertices.push(new Gt(i.x,i.y,i.z||0))}return t}}),Object.assign(Ia.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Uc.prototype=Object.create(wa.prototype),kc.prototype=Object.create(wa.prototype),Bc.prototype=Object.create(wa.prototype),Object.assign(Bc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),oc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},tc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(hs.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ds.extractUrlBase(e)}}),Object.assign(fs.prototype,{setTexturePath:function(e){return console.warn("THREE.JSONLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Qs.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Kt.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Zs.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Bt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Bt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Bt.ceilPowerOfTwo(e)}}),Object.assign(Wt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(jt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Gt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,i,o)}}),er.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Vt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(kr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Br.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Br,{barycoordFromPoint:function(e,t,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Br.getBarycoord(e,t,r,n,i)},normal:function(e,t,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Br.getNormal(e,t,r,n)}}),Object.assign(Da.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new So(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Do(this,e)}}),Object.assign(zt.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Gt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Yt.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(vr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(pr.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(pr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(yi.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(bi.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(fa.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),si.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Fa.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(gr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Pr.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Mo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(zs.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Fr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new or}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===b}}}),Object.defineProperties(Qo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ur.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(li.prototype,{clearTarget:function(e,t,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(li.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ri.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Jt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(ui.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Ls.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Ts).load(e,function(e){t.setBuffer(e)}),this},Os.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Es.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Xc={merge:function(e,t,r){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function qc(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Yc(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}Ht.crossOrigin=void 0,Ht.loadTexture=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new da;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,r,void 0,n);return t&&(o.mapping=t),o},Ht.loadTextureCube=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new ha;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,r,void 0,n);return t&&(o.mapping=t),o},Ht.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ht.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Jc={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Qc(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}}.call(this,r("11d2d9cd5d1b52a535e7"),r("5e511fa944f88972e69c"))},"12323e1413cbffdabe02":function(e,t,r){var n=r("d34390b928ecadc11dc8"),i=r("d394d0a4c1838202489d"),o=r("5f6eded14a8ed86276fc")("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},"1255a24f27d9a947a608":function(e,t,r){"use strict";t.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=u(r("412479c5138fb85aa19f")),a=r("33ac025fdf0477f401a7"),s=r("92274ddfec80152892bc"),c=u(r("ab8261c9b33ea00e4f82"));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e,t,r){return Math.min(Math.max(e,t),r)};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.getUserConfirmation,r=e.initialEntries,u=void 0===r?["/"]:r,h=e.initialIndex,d=void 0===h?0:h,f=e.keyLength,p=void 0===f?6:f,m=(0,c.default)(),v=function(e){i(_,e),_.length=_.entries.length,m.notifyListeners(_.location,_.action)},g=function(){return Math.random().toString(36).substr(2,p)},y=l(d,0,u.length-1),b=u.map(function(e){return"string"==typeof e?(0,s.createLocation)(e,void 0,g()):(0,s.createLocation)(e,void 0,e.key||g())}),x=a.createPath,w=function(e){var r=l(_.index+e,0,_.entries.length-1),n=_.entries[r];m.confirmTransitionTo(n,"POP",t,function(e){e?v({action:"POP",location:n,index:r}):v()})},_={length:b.length,action:"POP",location:b[y],index:y,entries:b,createHref:x,push:function(e,r){(0,o.default)(!("object"===(void 0===e?"undefined":n(e))&&void 0!==e.state&&void 0!==r),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var i=(0,s.createLocation)(e,r,g(),_.location);m.confirmTransitionTo(i,"PUSH",t,function(e){if(e){var t=_.index+1,r=_.entries.slice(0);r.length>t?r.splice(t,r.length-t,i):r.push(i),v({action:"PUSH",location:i,index:t,entries:r})}})},replace:function(e,r){(0,o.default)(!("object"===(void 0===e?"undefined":n(e))&&void 0!==e.state&&void 0!==r),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var i=(0,s.createLocation)(e,r,g(),_.location);m.confirmTransitionTo(i,"REPLACE",t,function(e){e&&(_.entries[_.index]=i,v({action:"REPLACE",location:i}))})},go:w,goBack:function(){return w(-1)},goForward:function(){return w(1)},canGo:function(e){var t=_.index+e;return t>=0&&t<_.entries.length},block:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m.setPrompt(e)},listen:function(e){return m.appendListener(e)}};return _}},"12a106a843fda580d627":function(e,t,r){var n=r("d394d0a4c1838202489d"),i=r("145c4f2bdc487b2578df");r("f34797c0b42452934317")("keys",function(){return function(e){return i(n(e))}})},"12ba4fef039ee145f0aa":function(e,t,r){"use strict";t.__esModule=!0,t.createPath=t.parsePath=t.locationsAreEqual=t.createLocation=t.createMemoryHistory=t.createHashHistory=t.createBrowserHistory=void 0;var n=r("92274ddfec80152892bc");Object.defineProperty(t,"createLocation",{enumerable:!0,get:function(){return n.createLocation}}),Object.defineProperty(t,"locationsAreEqual",{enumerable:!0,get:function(){return n.locationsAreEqual}});var i=r("33ac025fdf0477f401a7");Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return i.parsePath}}),Object.defineProperty(t,"createPath",{enumerable:!0,get:function(){return i.createPath}});var o=c(r("89fa59dfd48f288c4600")),a=c(r("3fb509045374147eb7e3")),s=c(r("1255a24f27d9a947a608"));function c(e){return e&&e.__esModule?e:{default:e}}t.createBrowserHistory=o.default,t.createHashHistory=a.default,t.createMemoryHistory=s.default},"14462f9650d45fd47dc7":function(e,t,r){var n=r("413112319aa96af919d4"),i=r("2d13d93c336705cd8ff9"),o=r("43a62b7f9a94dda95bf8")("metadata"),a=o.store||(o.store=new(r("4b6c3e2b96a7fdc95a33"))),s=function(e,t,r){var i=a.get(e);if(!i){if(!r)return;a.set(e,i=new n)}var o=i.get(t);if(!o){if(!r)return;i.set(t,o=new n)}return o};e.exports={store:a,map:s,has:function(e,t,r){var n=s(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=s(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){s(r,n,!0).set(e,t)},keys:function(e,t){var r=s(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){i(i.S,"Reflect",e)}}},"1451c76b1b1b5a5ba260":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("bold",function(e){return function(){return e(this,"b","","")}})},"145c4f2bdc487b2578df":function(e,t,r){var n=r("e3136eea77d23f8d97ec"),i=r("380c0734c088ca78ccda");e.exports=Object.keys||function(e){return n(e,i)}},"1468f5d37f30f63d76ea":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("efae14a3f8cd9a616256"),o=r("1f3157d073736826d4fa"),a=r("ca19e32ab6ee3b3692aa"),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(c||!r("40b064d4eb439c0c1c2b")(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),r=a(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},"14aa1c87589cec105b74":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},"1582553a0f2276f66f2f":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("0116c75136b233002fb9"),o=r("621a65702ee1a566fd32")("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},"1591b90b4327c94245ad":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(1);n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},"15ad6b6c880d51697e5b":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P,"String",{repeat:r("945a806e4f4787a7905b")})},"1627ebf46087710a4703":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("strike",function(e){return function(){return e(this,"strike","","")}})},"1655a801151bdc7ee673":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("edb183dfe43ad4a21ef0");n(n.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},"16a2663068191a21c134":function(e,t,r){var n=r("c563599eb9734b6ef1c0"),i=r("f0200b4beabe56dc845a"),o=r("848061d2617404d8a848"),a=r("ad8470b596eb2ec5826f"),s=r("43dd891ba6876544e540"),c=r("67042e57ad02a5947bc9"),u=r("cef4e105446199aaf71e"),l=u(n),h=u(i),d=u(o),f=u(a),p=u(s),m=c;(n&&"[object DataView]"!=m(new n(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||o&&"[object Promise]"!=m(o.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case l:return"[object DataView]";case h:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=m},"16c6ea6c9ece643bfb5c":function(e,t,r){"use strict";t.__esModule=!0;var n=c(r("49a47d064cfbf2949ee5")),i=c(r("8af190b70a6bc55c6f1b")),o=c(r("8a2d1b95e05b6a321e74")),a=r("12ba4fef039ee145f0aa"),s=c(r("3ddbfa7ffbc97506f3e4"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.history=(0,a.createBrowserHistory)(n.props),u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){(0,n.default)(!this.props.history,"<BrowserRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { BrowserRouter as Router }`.")},t.prototype.render=function(){return i.default.createElement(s.default,{history:this.history,children:this.props.children})},t}(i.default.Component);l.propTypes={basename:o.default.string,forceRefresh:o.default.bool,getUserConfirmation:o.default.func,keyLength:o.default.number,children:o.default.node},t.default=l},"1792bb2ef9fe352edb1e":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7fd90dee1f5cbd901d1c"),o=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},"1860f64667ad8a670ab7":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("sup",function(e){return function(){return e(this,"sup","","")}})},"18caba858d9ea0f67284":function(e,t,r){var n=r("5de5c65c2c431f821291"),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},"191adceeffad46f4bba8":function(e,t,r){var n=r("18caba858d9ea0f67284")["__core-js_shared__"];e.exports=n},"19289c2680cbdec14eed":function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=n.has,a=n.key;n.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},"19a014a8d7781dbba23a":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{scale:r("7caa05c4b9a2c1771918")})},"1a29b1a839ce123011e8":function(e,t,r){var n=r("7a8c0ef4f45a56962a18"),i=r("5fd4d3d5ac2fe9bfd20e"),o=r("14462f9650d45fd47dc7"),a=r("79c91dcd8cd554c59c7b"),s=r("12323e1413cbffdabe02"),c=o.keys,u=o.key,l=function(e,t){var r=c(e,t),o=s(e);if(null===o)return r;var a=l(o,t);return a.length?r.length?i(new n(r.concat(a))):a:r};o.exp({getMetadataKeys:function(e){return l(a(e),arguments.length<2?void 0:u(arguments[1]))}})},"1a5381b6e12121a4e33d":function(e,t,r){"use strict";var n=r("1b01d0e59d3af79760a0").f,i=r("ef09ce044ac3210bc947"),o=r("503a0df91bcab33c39b8"),a=r("0e717e1f47872428608d"),s=r("fd8b6034a9a06242cc87"),c=r("4133d6461867e9751fc3"),u=r("429cfc8e3ed333e40618"),l=r("dabaabbe8ba08d59975f"),h=r("89a21af31babcdc56725"),d=r("5975c7ea3ecd56e534e3"),f=r("87f7b2a2f3e179b5c40a").fastKey,p=r("2c407c4438ef2794ef23"),m=d?"_s":"size",v=function(e,t){var r,n=f(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e(function(e,n){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=n&&c(n,r,e[u],e)});return o(l.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var r=p(this,t),n=v(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[m]--}return!!n},forEach:function(e){p(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!v(p(this,t),e)}}),d&&n(l.prototype,"size",{get:function(){return p(this,t)[m]}}),l},def:function(e,t,r){var n,i,o=v(e,t);return o?o.v=r:(e._l=o={i:i=f(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:v,setStrong:function(e,t,r){u(e,t,function(e,r){this._t=p(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},r?"entries":"values",!r,!0),h(t)}}},"1ae513448994dc2a1e86":function(e,t,r){var n,i,o,a=r("0e717e1f47872428608d"),s=r("5a3b914e449c6d95aadc"),c=r("5b9dc0e027f5c68eff1a"),u=r("68a989d6f90923909f2a"),l=r("1139de1233fd67f45bd7"),h=l.process,d=l.setImmediate,f=l.clearImmediate,p=l.MessageChannel,m=l.Dispatch,v=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){y.call(e.data)};d&&f||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return g[++v]=function(){s("function"==typeof e?e:Function(e),t)},n(v),v},f=function(e){delete g[e]},"process"==r("0116c75136b233002fb9")(h)?n=function(e){h.nextTick(a(y,e,1))}:m&&m.now?n=function(e){m.now(a(y,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=b,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:d,clear:f}},"1b01d0e59d3af79760a0":function(e,t,r){var n=r("79c91dcd8cd554c59c7b"),i=r("bc1a333d2b6eceac22e3"),o=r("4ef7a75a1d1957a7c5c0"),a=Object.defineProperty;t.f=r("5975c7ea3ecd56e534e3")?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},"1b71f5e96f29a92413b6":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("5b9dc0e027f5c68eff1a"),o=r("0116c75136b233002fb9"),a=r("23d432718b3e8ce32362"),s=r("ca19e32ab6ee3b3692aa"),c=[].slice;n(n.P+n.F*r("7a7739dd8a198a2cfcb5")(function(){i&&c.call(i)}),"Array",{slice:function(e,t){var r=s(this.length),n=o(this);if(t=void 0===t?r:t,"Array"==n)return c.call(this,e,t);for(var i=a(e,r),u=a(t,r),l=s(u-i),h=new Array(l),d=0;d<l;d++)h[d]="String"==n?this.charAt(i+d):this[i+d];return h}})},"1bd0e64edcedab820751":function(e,t,r){"use strict";t.__esModule=!0,t.storeShape=t.subscriptionShape=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("8a2d1b95e05b6a321e74"));t.subscriptionShape=n.default.shape({trySubscribe:n.default.func.isRequired,tryUnsubscribe:n.default.func.isRequired,notifyNestedSubs:n.default.func.isRequired,isSubscribed:n.default.func.isRequired}),t.storeShape=n.default.shape({subscribe:n.default.func.isRequired,dispatch:n.default.func.isRequired,getState:n.default.func.isRequired})},"1bfd0b712b958ac38a24":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("dae53c7f1be5fcfdbe4b"),o=Math.exp;n(n.S+n.F*r("7a7739dd8a198a2cfcb5")(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},"1c750e24757a7c0c1e31":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7fc706acfdba9b87047f"),o=r("efae14a3f8cd9a616256"),a=r("61fcea04092a9580d371"),s=r("8de492c765fbfb624515");n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),c=a.f,u=i(n),l={},h=0;u.length>h;)void 0!==(r=c(n,t=u[h++]))&&s(l,t,r);return l}})},"1cbd705abc411c9a1e5b":function(e,t,r){var n=Array.prototype.slice,i=r("9e0bbfb109257d4426cd"),o=r("87972ac436f8a43eea81"),a=e.exports=function(e,t,r){return r||(r={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?r.strict?e===t:e==t:function(e,t,r){var u,l;if(s(e)||s(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e))return!!o(t)&&(e=n.call(e),t=n.call(t),a(e,t,r));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(u=0;u<e.length;u++)if(e[u]!==t[u])return!1;return!0}try{var h=i(e),d=i(t)}catch(e){return!1}if(h.length!=d.length)return!1;for(h.sort(),d.sort(),u=h.length-1;u>=0;u--)if(h[u]!=d[u])return!1;for(u=h.length-1;u>=0;u--)if(l=h[u],!a(e[l],t[l],r))return!1;return typeof e==typeof t}(e,t,r))};function s(e){return null===e||void 0===e}function c(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}},"1dddc8b9f5f30599741a":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("d394d0a4c1838202489d"),o=r("4ef7a75a1d1957a7c5c0"),a=r("12323e1413cbffdabe02"),s=r("61fcea04092a9580d371").f;r("5975c7ea3ecd56e534e3")&&n(n.P+r("615b8c1bc8c3f66221bc"),"Object",{__lookupSetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.set}while(r=a(r))}})},"1e0f00d296712713afe6":function(e,t,r){var n=r("4d073e2fededcdd3f3d3"),i=r("d394d0a4c1838202489d"),o=r("a537d0accb907bf9d41f"),a=r("ca19e32ab6ee3b3692aa");e.exports=function(e,t,r,s,c){n(t);var u=i(e),l=o(u),h=a(u.length),d=c?h-1:0,f=c?-1:1;if(r<2)for(;;){if(d in l){s=l[d],d+=f;break}if(d+=f,c?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;c?d>=0:h>d;d+=f)d in l&&(s=t(s,l[d],d,u));return s}},"1e4534d1d62a11482e97":function(e,t,r){var n={},i=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),o=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var r=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),a=null,s=0,c=[],u=r("0aac488a388d7f2d0eea");function l(e,t){for(var r=0;r<e.length;r++){var i=e[r],o=n[i.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](i.parts[a]);for(;a<i.parts.length;a++)o.parts.push(v(i.parts[a],t))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(v(i.parts[a],t));n[i.id]={id:i.id,refs:1,parts:s}}}}function h(e,t){for(var r=[],n={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};n[a]?n[a].parts.push(s):r.push(n[a]={id:a,parts:[s]})}return r}function d(e,t){var r=o(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),c.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,i)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function p(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),m(t,e.attrs),d(e,t),t}function m(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function v(e,t){var r,n,i,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var c=s++;r=a||(a=p(t)),n=y.bind(null,r,c,!1),i=y.bind(null,r,c,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",m(t,e.attrs),d(e,t),t}(t),n=function(e,t,r){var n=r.css,i=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(n=u(n));i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,r,t),i=function(){f(r),r.href&&URL.revokeObjectURL(r.href)}):(r=p(t),n=function(e,t){var r=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){f(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=h(e,t);return l(r,t),function(e){for(var i=[],o=0;o<r.length;o++){var a=r[o];(s=n[a.id]).refs--,i.push(s)}e&&l(h(e,t),t);for(o=0;o<i.length;o++){var s;if(0===(s=i[o]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete n[s.id]}}}};var g=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}();function y(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=g(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}},"1ef5eae0d45731e89b6f":function(e,t,r){var n=r("28e5655f45e616ffe40b"),i=r("22387c0eaba857444dfb"),o=r("eedc997fc37971b68c9e"),a=o&&o.isTypedArray,s=a?i(a):n;e.exports=s},"1f3157d073736826d4fa":function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},"1f928caa5aa7943b8c1b":function(e,t,r){"use strict";
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var n=r("08aacfc067e33d327708");function i(e){return!0===n(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,r;return!1!==i(e)&&("function"==typeof(t=e.constructor)&&(!1!==i(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))}},"2076e982c14c41925fb4":function(e,t,r){var n=r("efae14a3f8cd9a616256"),i=r("ca19e32ab6ee3b3692aa"),o=r("23d432718b3e8ce32362");e.exports=function(e){return function(t,r,a){var s,c=n(t),u=i(c.length),l=o(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},"22387c0eaba857444dfb":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"224ae09e536c09e69a0a":function(e,t){e.exports={}},"22c4655df043ec6a4af2":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("3dd7e3cb81b24cbd63d6"),o=r("d394d0a4c1838202489d"),a=r("ca19e32ab6ee3b3692aa"),s=r("1f3157d073736826d4fa"),c=r("0594430ce9777a0767aa");n(n.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),r=a(t.length),n=c(t,0);return i(n,t,t,r,0,void 0===e?1:s(e)),n}}),r("a5e6f0092ff0290e0bcf")("flatten")},"23339791c405611c831e":function(e,t,r){var n=r("efae14a3f8cd9a616256"),i=r("61fcea04092a9580d371").f;r("f34797c0b42452934317")("getOwnPropertyDescriptor",function(){return function(e,t){return i(n(e),t)}})},"23d432718b3e8ce32362":function(e,t,r){var n=r("1f3157d073736826d4fa"),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},"2499ce6d7ea1e9ca2579":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7ae46632a49db7ab2ae0");n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},"24c5bf497be6b8e1330e":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("f62053ff67fa82664144")(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(e){return i(e)}})},"259390904b4b47fe24f8":function(e,t,r){var n=r("67042e57ad02a5947bc9"),i=r("a607943c6ce671e7106b"),o=r("4b93c5a7bb60dd6ab0f4"),a="[object Object]",s=Function.prototype,c=Object.prototype,u=s.toString,l=c.hasOwnProperty,h=u.call(Object);e.exports=function(e){if(!o(e)||n(e)!=a)return!1;var t=i(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&u.call(r)==h}},"2598229f45b3da87877e":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("79c91dcd8cd554c59c7b"),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},"26d59f808dff3e83c741":function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,h=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&f())}function f(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"273d2eedcd369c189e70":function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},"277cfc1331526160cbd4":function(e,t,r){"use strict";var n=function(e){};e.exports=function(e,t,r,i,o,a,s,c){if(n(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[r,i,o,a,s,c],h=0;(u=new Error(t.replace(/%s/g,function(){return l[h++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},"28e5655f45e616ffe40b":function(e,t,r){var n=r("67042e57ad02a5947bc9"),i=r("84696c4e387dcb8648dc"),o=r("4b93c5a7bb60dd6ab0f4"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[n(e)]}},"29141de3bd8fb20e5e9a":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ca19e32ab6ee3b3692aa"),o=r("39dac2a92593ee9501cd"),a="".startsWith;n(n.P+n.F*r("e5c4ff14bae25ddfa508")("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},"298b5be4dd10a9a11c49":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("06d4481d8fe57248a157");n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},"2a0335303f85c0f28de1":function(e,t,r){"undefined"!=typeof self&&self,e.exports=function(e){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(6)(function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},!0)},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";var n=/[A-Z]/g,i=/^ms-/,o={};e.exports=function(e){return e in o?o[e]:o[e]=e.replace(n,"-$&").toLowerCase().replace(i,"-ms-")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o.default.oneOfType([o.default.string,o.default.number]),s={orientation:o.default.oneOf(["portrait","landscape"]),scan:o.default.oneOf(["progressive","interlace"]),aspectRatio:o.default.string,deviceAspectRatio:o.default.string,height:a,deviceHeight:a,width:a,deviceWidth:a,color:o.default.bool,colorIndex:o.default.bool,monochrome:o.default.bool,resolution:a},c=n({minAspectRatio:o.default.string,maxAspectRatio:o.default.string,minDeviceAspectRatio:o.default.string,maxDeviceAspectRatio:o.default.string,minHeight:a,maxHeight:a,minDeviceHeight:a,maxDeviceHeight:a,minWidth:a,maxWidth:a,minDeviceWidth:a,maxDeviceWidth:a,minColor:o.default.number,maxColor:o.default.number,minColorIndex:o.default.number,maxColorIndex:o.default.number,minMonochrome:o.default.number,maxMonochrome:o.default.number,minResolution:a,maxResolution:a},s),u={all:o.default.bool,grid:o.default.bool,aural:o.default.bool,braille:o.default.bool,handheld:o.default.bool,print:o.default.bool,projection:o.default.bool,screen:o.default.bool,tty:o.default.bool,tv:o.default.bool,embossed:o.default.bool},l=n({},u,c);s.type=Object.keys(u),t.default={all:l,types:u,matchers:s,features:c},e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){var r=s({},e);return t.forEach(function(e){return delete r[e]}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.toQuery=t.default=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=r(5),u=n(c),l=r(0),h=n(l),d=r(9),f=n(d),p=r(2),m=n(p),v=r(3),g=n(v),y=r(11),b=n(y),x={component:h.default.node,query:h.default.string,values:h.default.shape(g.default.matchers),children:h.default.oneOfType([h.default.node,h.default.func]),onChange:h.default.func,onBeforeChange:h.default.func},w=Object.keys(g.default.all),_=Object.keys(x),S=_.concat(w),M=function(e){function t(){var e,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={matches:!1},n.updateMatches=function(){n._mql.matches!==n.state.matches&&n.setState({matches:n._mql.matches})},n.removeMql=function(){n._mql&&(n._mql.removeListener(n.updateMatches),n._mql.dispose())},i(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){this.updateQuery(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.updateQuery(e)}},{key:"updateQuery",value:function(e){var t=void 0,r=!1;if(e.query?this.query=e.query:this.query=(0,b.default)(o(e,_)),!this.query)throw new Error("Invalid or missing MediaQuery!");e.values&&(t=Object.keys(e.values).reduce(function(t,r){return t[(0,m.default)(r)]=e.values[r],t},{}),0!==Object.keys(t).length&&(r=!0)),this.removeMql(),this._mql=(0,f.default)(this.query,t,r),this._mql.addListener(this.updateMatches),this.updateMatches()}},{key:"componentWillUpdate",value:function(e,t){this.props.onBeforeChange&&this.state.matches!==t.matches&&this.props.onBeforeChange(this.state.matches)}},{key:"componentDidUpdate",value:function(e,t){this.props.onChange&&t.matches!==this.state.matches&&this.props.onChange(this.state.matches)}},{key:"componentWillUnmount",value:function(){this.removeMql()}},{key:"render",value:function(){if("function"==typeof this.props.children)return this.props.children(this.state.matches);if(!1===this.state.matches)return null;var e=o(this.props,S),t=Object.keys(e).length>0,r=u.default.Children.count(this.props.children);return this.props.component||null==this.props.children||t&&r>1?u.default.createElement(this.props.component||"div",e,this.props.children):t?u.default.cloneElement(this.props.children,e):r?this.props.children:null}}]),t}(u.default.Component);M.displayName="MediaQuery",M.defaultProps={values:{}},t.default=M,t.toQuery=b.default},function(t,r){t.exports=e},function(e,t,r){"use strict";function n(){return null}var i=r(7),o=r(1),a=r(8),s=function(){};s=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},e.exports=function(e,t){function r(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function c(e){this.message=e,this.stack=""}function u(e){function r(r,a,u,l,h,d,f){if(l=l||g,d=d||u,f!==o){if(t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}if("undefined"!=typeof console){var m=l+":"+u;!n[m]&&i<3&&(s("You are manually calling a React.PropTypes validation function for the `"+d+"` prop on `"+l+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),n[m]=!0,i++)}}return null==a[u]?r?new c(null===a[u]?"The "+h+" `"+d+"` is marked as required in `"+l+"`, but its value is `null`.":"The "+h+" `"+d+"` is marked as required in `"+l+"`, but its value is `undefined`."):null:e(a,u,l,h,d)}var n={},i=0,a=r.bind(null,!1);return a.isRequired=r.bind(null,!0),a}function l(e){return u(function(t,r,n,i,o,a){var s=t[r];return d(s)!==e?new c("Invalid "+i+" `"+o+"` of type `"+f(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null})}function h(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(h);if(null===t||e(t))return!0;var r=function(e){var t=e&&(m&&e[m]||e[v]);if("function"==typeof t)return t}(t);if(!r)return!1;var n,i=r.call(t);if(r!==t.entries){for(;!(n=i.next()).done;)if(!h(n.value))return!1}else for(;!(n=i.next()).done;){var o=n.value;if(o&&!h(o[1]))return!1}return!0;default:return!1}}function d(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function f(e){if(void 0===e||null===e)return""+e;var t=d(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function p(e){var t=f(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}var m="function"==typeof Symbol&&Symbol.iterator,v="@@iterator",g="<<anonymous>>",y={array:l("array"),bool:l("boolean"),func:l("function"),number:l("number"),object:l("object"),string:l("string"),symbol:l("symbol"),any:u(n),arrayOf:function(e){return u(function(t,r,n,i,a){if("function"!=typeof e)return new c("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var s=t[r];if(!Array.isArray(s))return new c("Invalid "+i+" `"+a+"` of type `"+d(s)+"` supplied to `"+n+"`, expected an array.");for(var u=0;u<s.length;u++){var l=e(s,u,n,i,a+"["+u+"]",o);if(l instanceof Error)return l}return null})},element:u(function(t,r,n,i,o){var a=t[r];return e(a)?null:new c("Invalid "+i+" `"+o+"` of type `"+d(a)+"` supplied to `"+n+"`, expected a single ReactElement.")}),instanceOf:function(e){return u(function(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||g;return new c("Invalid "+i+" `"+o+"` of type `"+function(e){return e.constructor&&e.constructor.name?e.constructor.name:g}(t[r])+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}return null})},node:u(function(e,t,r,n,i){return h(e[t])?null:new c("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")}),objectOf:function(e){return u(function(t,r,n,i,a){if("function"!=typeof e)return new c("Property `"+a+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var s=t[r],u=d(s);if("object"!==u)return new c("Invalid "+i+" `"+a+"` of type `"+u+"` supplied to `"+n+"`, expected an object.");for(var l in s)if(s.hasOwnProperty(l)){var h=e(s,l,n,i,a+"."+l,o);if(h instanceof Error)return h}return null})},oneOf:function(e){return Array.isArray(e)?u(function(t,n,i,o,a){for(var s=t[n],u=0;u<e.length;u++)if(r(s,e[u]))return null;return new c("Invalid "+o+" `"+a+"` of value `"+s+"` supplied to `"+i+"`, expected one of "+JSON.stringify(e)+".")}):(s("Invalid argument supplied to oneOf, expected an instance of array."),n)},oneOfType:function(e){if(!Array.isArray(e))return s("Invalid argument supplied to oneOfType, expected an instance of array."),n;for(var t=0;t<e.length;t++){var r=e[t];if("function"!=typeof r)return s("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+p(r)+" at index "+t+"."),n}return u(function(t,r,n,i,a){for(var s=0;s<e.length;s++)if(null==(0,e[s])(t,r,n,i,a,o))return null;return new c("Invalid "+i+" `"+a+"` supplied to `"+n+"`.")})},shape:function(e){return u(function(t,r,n,i,a){var s=t[r],u=d(s);if("object"!==u)return new c("Invalid "+i+" `"+a+"` of type `"+u+"` supplied to `"+n+"`, expected `object`.");for(var l in e){var h=e[l];if(h){var f=h(s,l,n,i,a+"."+l,o);if(f)return f}}return null})},exact:function(e){return u(function(t,r,n,a,s){var u=t[r],l=d(u);if("object"!==l)return new c("Invalid "+a+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");var h=i({},t[r],e);for(var f in h){var p=e[f];if(!p)return new c("Invalid "+a+" `"+s+"` key `"+f+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var m=p(u,f,n,a,s+"."+f,o);if(m)return m}return null})}};return c.prototype=Error.prototype,y.checkPropTypes=a,y.PropTypes=y,y}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in r=Object(arguments[c]))i.call(r,u)&&(s[u]=r[u]);if(n){a=n(r);for(var l=0;l<a.length;l++)o.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},function(e,t,r){"use strict";var n=function(){},i=r(1),o={};n=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},e.exports=function(e,t,r,a,s){for(var c in e)if(e.hasOwnProperty(c)){var u;try{if("function"!=typeof e[c]){var l=Error((a||"React class")+": "+r+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[c]+"`.");throw l.name="Invariant Violation",l}u=e[c](t,c,a,r,null,i)}catch(e){u=e}if(!u||u instanceof Error||n((a||"React class")+": type specification of "+r+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof u+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),u instanceof Error&&!(u.message in o)){o[u.message]=!0;var h=s?s():"";n("Failed "+r+" type: "+u.message+(null!=h?h:""))}}}},function(e,t,r){"use strict";var n=r(10).match,i="undefined"!=typeof window?window.matchMedia:null;e.exports=function(e,t,r){return new function(e,t,r){function o(e){a.matches=e.matches,a.media=e.media}var a=this;if(i&&!r){var s=i.call(window,e);this.matches=s.matches,this.media=s.media,s.addListener(o)}else this.matches=n(e,t),this.media=e;this.addListener=function(e){s&&s.addListener(e)},this.removeListener=function(e){s&&s.removeListener(e)},this.dispose=function(){s&&s.removeListener(o)}}(e,t,r)}},function(e,t,r){"use strict";function n(e){return e.split(",").map(function(e){var t=(e=e.trim()).match(s),r=t[1],n=t[2],i=t[3]||"",o={};return o.inverse=!!r&&"not"===r.toLowerCase(),o.type=n?n.toLowerCase():"all",i=i.match(/\([^\)]+\)/g)||[],o.expressions=i.map(function(e){var t=e.match(c),r=t[1].toLowerCase().match(u);return{modifier:r[1],feature:r[2],value:t[2]}}),o})}function i(e){var t,r=Number(e);return r||(t=e.match(/^(\d+)\s*\/\s*(\d+)$/),r=t[1]/t[2]),r}function o(e){var t=parseFloat(e);switch(String(e).match(h)[1]){case"dpcm":return t/2.54;case"dppx":return 96*t;default:return t}}function a(e){var t=parseFloat(e);switch(String(e).match(l)[1]){case"em":case"rem":return 16*t;case"cm":return 96*t/2.54;case"mm":return 96*t/2.54/10;case"in":return 96*t;case"pt":return 72*t;case"pc":return 72*t/12;default:return t}}t.match=function(e,t){return n(e).some(function(e){var r=e.inverse,n="all"===e.type||t.type===e.type;if(n&&r||!n&&!r)return!1;var s=e.expressions.every(function(e){var r=e.feature,n=e.modifier,s=e.value,c=t[r];if(!c)return!1;switch(r){case"orientation":case"scan":return c.toLowerCase()===s.toLowerCase();case"width":case"height":case"device-width":case"device-height":s=a(s),c=a(c);break;case"resolution":s=o(s),c=o(c);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":s=i(s),c=i(c);break;case"grid":case"color":case"color-index":case"monochrome":s=parseInt(s,10)||1,c=parseInt(c,10)||0}switch(n){case"min":return c>=s;case"max":return c<=s;default:return c===s}});return s&&!r||!s&&r})},t.parse=n;var s=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,c=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,u=/^(?:(min|max)-)?(.+)/,l=/(em|rem|px|cm|mm|in|pt|pc)?$/,h=/(dpi|dpcm|dppx)?$/},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[];return Object.keys(s.default.all).forEach(function(r){var n=e[r];null!=n&&t.push(function(e,t){var r=(0,o.default)(e);return"number"==typeof t&&(t+="px"),!0===t?e:!1===t?c(e):"("+r+": "+t+")"}(r,n))}),function(e){return e.join(" and ")}(t)};var i=r(2),o=n(i),a=r(3),s=n(a),c=function(e){return"not "+e};e.exports=t.default}])}(r("8af190b70a6bc55c6f1b"))},"2aec3e82eb0e43bbbba2":function(e,t,r){"use strict";t.__esModule=!0;var n=c(r("49a47d064cfbf2949ee5")),i=c(r("8af190b70a6bc55c6f1b")),o=c(r("8a2d1b95e05b6a321e74")),a=r("12ba4fef039ee145f0aa"),s=c(r("3ddbfa7ffbc97506f3e4"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.history=(0,a.createHashHistory)(n.props),u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){(0,n.default)(!this.props.history,"<HashRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { HashRouter as Router }`.")},t.prototype.render=function(){return i.default.createElement(s.default,{history:this.history,children:this.props.children})},t}(i.default.Component);l.propTypes={basename:o.default.string,getUserConfirmation:o.default.func,hashType:o.default.oneOf(["hashbang","noslash","slash"]),children:o.default.node},t.default=l},"2aec7b6edb2a47e3521f":function(e,t,r){e.exports=function(){"use strict";return function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(r,n,i,o,a,s,c,u,l,h){switch(r){case 1:if(0===l&&64===n.charCodeAt(0))return e(n+";"),"";break;case 2:if(0===u)return n+"/*|*/";break;case 3:switch(u){case 102:case 112:return e(i[0]+n),"";default:return n+(0===h?"/*|*/":"")}case-2:n.split("/*|*/}").forEach(t)}}}}()},"2b4a4ef7612f955b8d3d":function(e,t,r){r("02fcd2201285b358795d")("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},"2c09af3fb5c4ba3698b3":function(e,t,r){(function(t){!function(t){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",u="object"==typeof e,l=t.regeneratorRuntime;if(l)u&&(e.exports=l);else{(l=t.regeneratorRuntime=u?e.exports:{}).wrap=x;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",m={},v={};v[a]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(O([])));y&&y!==n&&i.call(y,a)&&(v=y);var b=M.prototype=_.prototype=Object.create(v);S.prototype=b.constructor=M,M.constructor=S,M[c]=S.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,M):(e.__proto__=M,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(b),e},l.awrap=function(e){return{__await:e}},T(A.prototype),A.prototype[s]=function(){return this},l.AsyncIterator=A,l.async=function(e,t,r,n){var i=new A(x(e,t,r,n));return l.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},T(b),b[c]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},l.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),m}}}function x(e,t,r,n){var i=t&&t.prototype instanceof _?t:_,o=Object.create(i.prototype),a=new P(n||[]);return o._invoke=function(e,t,r){var n=h;return function(i,o){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return N()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=E(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var c=w(e,t,r);if("normal"===c.type){if(n=r.done?p:d,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(e,r,a),o}function w(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function _(){}function S(){}function M(){}function T(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function A(e){function r(t,n,o,a){var s=w(e[t],e,n);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):Promise.resolve(u).then(function(e){c.value=e,o(c)},a)}a(s.arg)}var n;"object"==typeof t.process&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise(function(n,i){r(e,t,n,i)})}return n=n?n.then(i,i):i()}}function E(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,E(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=w(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:N}}function N(){return{value:r,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,r("698d75b157f24ae829cc"))},"2c407c4438ef2794ef23":function(e,t,r){var n=r("a459ab805827640a27e8");e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},"2c54555c94aa6b1cce4a":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("98e9f3c3a8d686f8cc0f"),o=r("5abe37fc05566b7b9eff");n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},"2d13d93c336705cd8ff9":function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("5925dad3c5243ffee3db"),o=r("5f25c015bbbf9d42c661"),a=r("88db22626e6c88b175cf"),s=r("0e717e1f47872428608d"),c=function(e,t,r){var u,l,h,d,f=e&c.F,p=e&c.G,m=e&c.S,v=e&c.P,g=e&c.B,y=p?n:m?n[t]||(n[t]={}):(n[t]||{}).prototype,b=p?i:i[t]||(i[t]={}),x=b.prototype||(b.prototype={});for(u in p&&(r=t),r)h=((l=!f&&y&&void 0!==y[u])?y:r)[u],d=g&&l?s(h,n):v&&"function"==typeof h?s(Function.call,h):h,y&&a(y,u,h,e&c.U),b[u]!=h&&o(b,u,d),v&&x[u]!=h&&(x[u]=h)};n.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},"2d6ca68360dece574932":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},"2d8c8264a871cfe44bc2":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=c(r("8af190b70a6bc55c6f1b")),o=c(r("8a2d1b95e05b6a321e74")),a=c(r("5ef9de3df8d92ea0e41c")),s=c(r("35440e3d539ea8d61c51"));function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(t){var r=t.wrappedComponentRef,o=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["wrappedComponentRef"]);return i.default.createElement(s.default,{children:function(t){return i.default.createElement(e,n({},o,t,{ref:r}))}})};return t.displayName="withRouter("+(e.displayName||e.name)+")",t.WrappedComponent=e,t.propTypes={wrappedComponentRef:o.default.func},(0,a.default)(t,e)}},"2dc5be6768ca6c7f0d4d":function(e,t,r){var n=r("1f3157d073736826d4fa"),i=r("ca19e32ab6ee3b3692aa");e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},"2e20dfefd16154e6ed7b":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.routerReducer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.type,a=t.payload;if(r===i)return n({},e,{location:a});return e};var i=t.LOCATION_CHANGE="@@router/LOCATION_CHANGE",o={location:null}},"2ecd99f9ea85b44ffe1d":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},"2f2c658b8d03e5165a06":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("58a762c5dd9e5f9d6ad3"));t.default=n.default},"2fea013a9d0e76560f8b":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("anchor",function(e){return function(t){return e(this,"a","name",t)}})},"3009383f3d0ad6342c19":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,s=n>>>16,c=(a*o>>>0)+(i*o>>>16);return a*s+(c>>>16)+((i*s>>>0)+(65535&c)>>>16)}})},"307014e72ed12da69e15":function(e,t,r){"use strict";var n=r("a5e6f0092ff0290e0bcf"),i=r("dabaabbe8ba08d59975f"),o=r("224ae09e536c09e69a0a"),a=r("efae14a3f8cd9a616256");e.exports=r("429cfc8e3ed333e40618")(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},"30d14b3a3295666f3aba":function(e,t){function r(){return"serviceWorker"in navigator&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}t.install=function(e){e||(e={}),r()&&navigator.serviceWorker.register("sw.js",{})},t.applyUpdate=function(e,t){},t.update=function(){r()&&navigator.serviceWorker.getRegistration().then(function(e){if(e)return e.update()})}},"3179bff1ebe47c49d3eb":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("1139de1233fd67f45bd7"),o=r("5925dad3c5243ffee3db"),a=r("00c22f5845a5f3d8fe8c")(),s=r("621a65702ee1a566fd32")("observable"),c=r("4d073e2fededcdd3f3d3"),u=r("79c91dcd8cd554c59c7b"),l=r("fd8b6034a9a06242cc87"),h=r("503a0df91bcab33c39b8"),d=r("5f25c015bbbf9d42c661"),f=r("4133d6461867e9751fc3"),p=f.RETURN,m=function(e){return null==e?void 0:c(e)},v=function(e){var t=e._c;t&&(e._c=void 0,t())},g=function(e){return void 0===e._o},y=function(e){g(e)||(e._o=void 0,v(e))},b=function(e,t){u(e),this._c=void 0,this._o=e,e=new x(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:c(r),this._c=r)}catch(t){return void e.error(t)}g(this)&&v(this)};b.prototype=h({},{unsubscribe:function(){y(this)}});var x=function(e){this._s=e};x.prototype=h({},{next:function(e){var t=this._s;if(!g(t)){var r=t._o;try{var n=m(r.next);if(n)return n.call(r,e)}catch(e){try{y(t)}finally{throw e}}}},error:function(e){var t=this._s;if(g(t))throw e;var r=t._o;t._o=void 0;try{var n=m(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{v(t)}finally{throw e}}return v(t),e},complete:function(e){var t=this._s;if(!g(t)){var r=t._o;t._o=void 0;try{var n=m(r.complete);e=n?n.call(r,e):void 0}catch(e){try{v(t)}finally{throw e}}return v(t),e}}});var w=function(e){l(this,w,"Observable","_f")._f=c(e)};h(w.prototype,{subscribe:function(e){return new b(e,this._f)},forEach:function(e){var t=this;return new(o.Promise||i.Promise)(function(r,n){c(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})})}}),h(w,{from:function(e){var t="function"==typeof this?this:w,r=m(u(e)[s]);if(r){var n=u(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return a(function(){if(!r){try{if(f(e,!1,function(e){if(t.next(e),r)return p})===p)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:w)(function(e){var t=!1;return a(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),d(w.prototype,s,function(){return this}),n(n.G,{Observable:w}),r("89a21af31babcdc56725")("Observable")},"318358f29560c8862a62":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{sign:r("edb183dfe43ad4a21ef0")})},"31acd5ae212d901071a3":function(e,t,r){"use strict";var n=r("79c91dcd8cd554c59c7b"),i=r("4ef7a75a1d1957a7c5c0");e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),"number"!=e)}},"32b716d95af2fd3c5c23":function(e,t,r){var n=r("0116c75136b233002fb9"),i=r("621a65702ee1a566fd32")("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},"32c85c5c621c55a6b3ab":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S+n.F,"Object",{assign:r("94fb07840c0fda6ca6a4")})},"336cae077811264f3d1e":function(e,t,r){var n=r("145c4f2bdc487b2578df"),i=r("efae14a3f8cd9a616256"),o=r("0091fa8d74c45e0dd589").f;e.exports=function(e){return function(t){for(var r,a=i(t),s=n(a),c=s.length,u=0,l=[];c>u;)o.call(a,r=s[u++])&&l.push(e?[r,a[r]]:a[r]);return l}}},"33ac025fdf0477f401a7":function(e,t,r){"use strict";t.__esModule=!0;t.addLeadingSlash=function(e){return"/"===e.charAt(0)?e:"/"+e},t.stripLeadingSlash=function(e){return"/"===e.charAt(0)?e.substr(1):e};var n=t.hasBasename=function(e,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(e)};t.stripBasename=function(e,t){return n(e,t)?e.substr(t.length):e},t.stripTrailingSlash=function(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e},t.parsePath=function(e){var t=e||"/",r="",n="",i=t.indexOf("#");-1!==i&&(n=t.substr(i),t=t.substr(0,i));var o=t.indexOf("?");return-1!==o&&(r=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===r?"":r,hash:"#"===n?"":n}},t.createPath=function(e){var t=e.pathname,r=e.search,n=e.hash,i=t||"/";return r&&"?"!==r&&(i+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(i+="#"===n.charAt(0)?n:"#"+n),i}},"33e73011281ee8023d77":function(e,t,r){var n=r("67042e57ad02a5947bc9"),i=r("4b93c5a7bb60dd6ab0f4"),o="[object Arguments]";e.exports=function(e){return i(e)&&n(e)==o}},"340dbda6fe6f17098a91":function(e,t,r){"use strict";var n=r("770f76c876afc046e4e0")(!0);r("429cfc8e3ed333e40618")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},"3430f3e283af0cf06931":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("61fcea04092a9580d371").f,o=r("79c91dcd8cd554c59c7b");n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},"3478ed78d76c28060dce":function(e,t,r){var n=r("98e5f258a85d7fd22ef8"),i=r("ab33744f6df37edcb9b2"),o=r("c9327538105d995811b8");e.exports=function(e){return o(e)?n(e):i(e)}},"34c27cd73a2e6a6b0450":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"35440e3d539ea8d61c51":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=u(r("49a47d064cfbf2949ee5")),o=u(r("6a4f9c383785f9168266")),a=u(r("8af190b70a6bc55c6f1b")),s=u(r("8a2d1b95e05b6a321e74")),c=u(r("56f612169e8c0cac4c0c"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){return 0===a.default.Children.count(e)},d=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=l(this,e.call.apply(e,[this].concat(o))),n.state={match:n.computeMatch(n.props,n.context.router)},l(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:n({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},t.prototype.computeMatch=function(e,t){var r=e.computedMatch,n=e.location,i=e.path,a=e.strict,s=e.exact,u=e.sensitive;if(r)return r;(0,o.default)(t,"You should not use <Route> or withRouter() outside a <Router>");var l=t.route,h=(n||l.location).pathname;return(0,c.default)(h,{path:i,strict:a,exact:s,sensitive:u},l.match)},t.prototype.componentWillMount=function(){(0,i.default)(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),(0,i.default)(!(this.props.component&&this.props.children&&!h(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),(0,i.default)(!(this.props.render&&this.props.children&&!h(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},t.prototype.componentWillReceiveProps=function(e,t){(0,i.default)(!(e.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),(0,i.default)(!(!e.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(e,t.router)})},t.prototype.render=function(){var e=this.state.match,t=this.props,r=t.children,n=t.component,i=t.render,o=this.context.router,s=o.history,c=o.route,u=o.staticContext,l={match:e,location:this.props.location||c.location,history:s,staticContext:u};return n?e?a.default.createElement(n,l):null:i?e?i(l):null:"function"==typeof r?r(l):r&&!h(r)?a.default.Children.only(r):null},t}(a.default.Component);d.propTypes={computedMatch:s.default.object,path:s.default.string,exact:s.default.bool,strict:s.default.bool,sensitive:s.default.bool,component:s.default.func,render:s.default.func,children:s.default.oneOfType([s.default.func,s.default.node]),location:s.default.object},d.contextTypes={router:s.default.shape({history:s.default.object.isRequired,route:s.default.object.isRequired,staticContext:s.default.object})},d.childContextTypes={router:s.default.object.isRequired},t.default=d},"36a2a8f008a24a4063b9":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateNextState=t.getUnexpectedInvocationParameterMessage=t.getStateName=void 0;var n=a(r("a36c797149bbcb96646f")),i=a(r("f6c1259b6a257e147998")),o=a(r("9130a6b385cb6030d86a"));function a(e){return e&&e.__esModule?e:{default:e}}t.getStateName=n.default,t.getUnexpectedInvocationParameterMessage=i.default,t.validateNextState=o.default},"36fb70620452ffd2d407":function(e,t,r){r("02fcd2201285b358795d")("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}})},"380c0734c088ca78ccda":function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"392615e2ae5e100214bd":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P+n.R,"Set",{toJSON:r("b319470fdda47fb5d046")("Set")})},"3932316ffef991f5d157":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("a5e6f0092ff0290e0bcf")("find")},"39dac2a92593ee9501cd":function(e,t,r){var n=r("1582553a0f2276f66f2f"),i=r("7ad2c0eb9a8edcc472a4");e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},"39dc0152a90b3f79e9c4":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},"39e786b6f73d0c2dc9e4":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("87f7b2a2f3e179b5c40a").onFreeze;r("f34797c0b42452934317")("preventExtensions",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},"3a6600337fc4dae8f6f1":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("d394d0a4c1838202489d"),o=r("4ef7a75a1d1957a7c5c0"),a=r("12323e1413cbffdabe02"),s=r("61fcea04092a9580d371").f;r("5975c7ea3ecd56e534e3")&&n(n.P+r("615b8c1bc8c3f66221bc"),"Object",{__lookupGetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.get}while(r=a(r))}})},"3bd50fa414ae910eb455":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Number",{isInteger:r("f5ddf41194f6969220b2")})},"3ca1626832512beb31ab":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("56f612169e8c0cac4c0c"));t.default=n.default},"3cf3ac9966b923e35829":function(e,t,r){var n=r("edb183dfe43ad4a21ef0"),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),c=i(2,-126);e.exports=Math.fround||function(e){var t,r,i=Math.abs(e),u=n(e);return i<c?u*function(e){return e+1/o-1/o}(i/c/a)*c*a:(r=(t=(1+a/o)*i)-(t-i))>s||r!=r?u*(1/0):u*r}},"3d514c6d979a6ce94521":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.defaultMergeProps=i,t.wrapMergePropsFunc=o,t.whenMergePropsIsFunction=a,t.whenMergePropsIsOmitted=s;!function(e){e&&e.__esModule}(r("b452ab1ee9229ca9f134"));function i(e,t,r){return n({},r,e,t)}function o(e){return function(t,r){r.displayName;var n=r.pure,i=r.areMergedPropsEqual,o=!1,a=void 0;return function(t,r,s){var c=e(t,r,s);return o?n&&i(c,a)||(a=c):(o=!0,a=c),a}}}function a(e){return"function"==typeof e?o(e):void 0}function s(e){return e?void 0:function(){return i}}t.default=[a,s]},"3dd7e3cb81b24cbd63d6":function(e,t,r){"use strict";var n=r("8f648b1026e01323935b"),i=r("a459ab805827640a27e8"),o=r("ca19e32ab6ee3b3692aa"),a=r("0e717e1f47872428608d"),s=r("621a65702ee1a566fd32")("isConcatSpreadable");e.exports=function e(t,r,c,u,l,h,d,f){for(var p,m,v=l,g=0,y=!!d&&a(d,f,3);g<u;){if(g in c){if(p=y?y(c[g],g,r):c[g],m=!1,i(p)&&(m=void 0!==(m=p[s])?!!m:n(p)),m&&h>0)v=e(t,r,p,o(p.length),v,h-1)-1;else{if(v>=9007199254740991)throw TypeError();t[v]=p}v++}g++}return v}},"3ddbfa7ffbc97506f3e4":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("07a2173bac8ab93c3080"));t.default=n.default},"3f2012daa60f226e86ec":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("8de492c765fbfb624515");n(n.S+n.F*r("7a7739dd8a198a2cfcb5")(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)i(r,e,arguments[e++]);return r.length=t,r}})},"3fb509045374147eb7e3":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=l(r("412479c5138fb85aa19f")),o=l(r("6a4f9c383785f9168266")),a=r("92274ddfec80152892bc"),s=r("33ac025fdf0477f401a7"),c=l(r("ab8261c9b33ea00e4f82")),u=r("4a0368fb5bf578c56890");function l(e){return e&&e.__esModule?e:{default:e}}var h={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+(0,s.stripLeadingSlash)(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:s.stripLeadingSlash,decodePath:s.addLeadingSlash},slash:{encodePath:s.addLeadingSlash,decodePath:s.addLeadingSlash}},d=function(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)},f=function(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,t>=0?t:0)+"#"+e)};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(u.canUseDOM,"Hash history needs a DOM");var t=window.history,r=(0,u.supportsGoWithoutReloadUsingHash)(),l=e.getUserConfirmation,p=void 0===l?u.getConfirmation:l,m=e.hashType,v=void 0===m?"slash":m,g=e.basename?(0,s.stripTrailingSlash)((0,s.addLeadingSlash)(e.basename)):"",y=h[v],b=y.encodePath,x=y.decodePath,w=function(){var e=x(d());return(0,i.default)(!g||(0,s.hasBasename)(e,g),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+e+'" to begin with "'+g+'".'),g&&(e=(0,s.stripBasename)(e,g)),(0,a.createLocation)(e)},_=(0,c.default)(),S=function(e){n(U,e),U.length=t.length,_.notifyListeners(U.location,U.action)},M=!1,T=null,A=function(){var e=d(),t=b(e);if(e!==t)f(t);else{var r=w(),n=U.location;if(!M&&(0,a.locationsAreEqual)(n,r))return;if(T===(0,s.createPath)(r))return;T=null,E(r)}},E=function(e){M?(M=!1,S()):_.confirmTransitionTo(e,"POP",p,function(t){t?S({action:"POP",location:e}):C(e)})},C=function(e){var t=U.location,r=N.lastIndexOf((0,s.createPath)(t));-1===r&&(r=0);var n=N.lastIndexOf((0,s.createPath)(e));-1===n&&(n=0);var i=r-n;i&&(M=!0,R(i))},L=d(),P=b(L);L!==P&&f(P);var O=w(),N=[(0,s.createPath)(O)],R=function(e){(0,i.default)(r,"Hash history go(n) causes a full page reload in this browser"),t.go(e)},I=0,D=function(e){1===(I+=e)?(0,u.addEventListener)(window,"hashchange",A):0===I&&(0,u.removeEventListener)(window,"hashchange",A)},F=!1,U={length:t.length,action:"POP",location:O,createHref:function(e){return"#"+b(g+(0,s.createPath)(e))},push:function(e,t){(0,i.default)(void 0===t,"Hash history cannot push state; it is ignored");var r=(0,a.createLocation)(e,void 0,void 0,U.location);_.confirmTransitionTo(r,"PUSH",p,function(e){if(e){var t=(0,s.createPath)(r),n=b(g+t);if(d()!==n){T=t,function(e){window.location.hash=e}(n);var o=N.lastIndexOf((0,s.createPath)(U.location)),a=N.slice(0,-1===o?0:o+1);a.push(t),N=a,S({action:"PUSH",location:r})}else(0,i.default)(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),S()}})},replace:function(e,t){(0,i.default)(void 0===t,"Hash history cannot replace state; it is ignored");var r=(0,a.createLocation)(e,void 0,void 0,U.location);_.confirmTransitionTo(r,"REPLACE",p,function(e){if(e){var t=(0,s.createPath)(r),n=b(g+t);d()!==n&&(T=t,f(n));var i=N.indexOf((0,s.createPath)(U.location));-1!==i&&(N[i]=t),S({action:"REPLACE",location:r})}})},go:R,goBack:function(){return R(-1)},goForward:function(){return R(1)},block:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_.setPrompt(e);return F||(D(1),F=!0),function(){return F&&(F=!1,D(-1)),t()}},listen:function(e){var t=_.appendListener(e);return D(1),function(){D(-1),t()}}};return U}},"3fc8b4ca32b0aebd9ff3":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("a5e6f0092ff0290e0bcf")(o)},"40b064d4eb439c0c1c2b":function(e,t,r){"use strict";var n=r("7a7739dd8a198a2cfcb5");e.exports=function(e,t){return!!e&&n(function(){t?e.call(null,function(){},1):e.call(null)})}},"412479c5138fb85aa19f":function(e,t,r){"use strict";e.exports=function(){}},"413112319aa96af919d4":function(e,t,r){"use strict";var n=r("1a5381b6e12121a4e33d"),i=r("2c407c4438ef2794ef23");e.exports=r("0633550d227682cecd10")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(i(this,"Map"),0===e?0:e,t)}},n,!0)},"4133d6461867e9751fc3":function(e,t,r){var n=r("0e717e1f47872428608d"),i=r("4357234160788ed77205"),o=r("71d3ec5bd65418e28ebc"),a=r("79c91dcd8cd554c59c7b"),s=r("ca19e32ab6ee3b3692aa"),c=r("f88518adc3004bf8d923"),u={},l={};(t=e.exports=function(e,t,r,h,d){var f,p,m,v,g=d?function(){return e}:c(e),y=n(r,h,t?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(f=s(e.length);f>b;b++)if((v=t?y(a(p=e[b])[0],p[1]):y(e[b]))===u||v===l)return v}else for(m=g.call(e);!(p=m.next()).done;)if((v=i(m,y,p.value,t))===u||v===l)return v}).BREAK=u,t.RETURN=l},"41d819f9275ef20244e7":function(e,t,r){"use strict";var n=r("1139de1233fd67f45bd7"),i=r("d34390b928ecadc11dc8"),o=r("5975c7ea3ecd56e534e3"),a=r("2d13d93c336705cd8ff9"),s=r("88db22626e6c88b175cf"),c=r("87f7b2a2f3e179b5c40a").KEY,u=r("7a7739dd8a198a2cfcb5"),l=r("43a62b7f9a94dda95bf8"),h=r("62828dc3ffa96c06b7c9"),d=r("273d2eedcd369c189e70"),f=r("621a65702ee1a566fd32"),p=r("42d2ac6d92467eceff72"),m=r("c68991e63a6e99ff2511"),v=r("a37430c2bf749b8b8f88"),g=r("8f648b1026e01323935b"),y=r("79c91dcd8cd554c59c7b"),b=r("a459ab805827640a27e8"),x=r("efae14a3f8cd9a616256"),w=r("4ef7a75a1d1957a7c5c0"),_=r("9d5592e83ab7f3d08974"),S=r("ef09ce044ac3210bc947"),M=r("92efe77f5aacb0dee3db"),T=r("61fcea04092a9580d371"),A=r("1b01d0e59d3af79760a0"),E=r("145c4f2bdc487b2578df"),C=T.f,L=A.f,P=M.f,O=n.Symbol,N=n.JSON,R=N&&N.stringify,I=f("_hidden"),D=f("toPrimitive"),F={}.propertyIsEnumerable,U=l("symbol-registry"),k=l("symbols"),B=l("op-symbols"),z=Object.prototype,j="function"==typeof O,V=n.QObject,G=!V||!V.prototype||!V.prototype.findChild,W=o&&u(function(){return 7!=S(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=C(z,t);n&&delete z[t],L(e,t,r),n&&e!==z&&L(z,t,n)}:L,H=function(e){var t=k[e]=S(O.prototype);return t._k=e,t},X=j&&"symbol"==typeof O.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof O},q=function(e,t,r){return e===z&&q(B,t,r),y(e),t=w(t,!0),y(r),i(k,t)?(r.enumerable?(i(e,I)&&e[I][t]&&(e[I][t]=!1),r=S(r,{enumerable:_(0,!1)})):(i(e,I)||L(e,I,_(1,{})),e[I][t]=!0),W(e,t,r)):L(e,t,r)},Y=function(e,t){y(e);for(var r,n=v(t=x(t)),i=0,o=n.length;o>i;)q(e,r=n[i++],t[r]);return e},J=function(e){var t=F.call(this,e=w(e,!0));return!(this===z&&i(k,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(k,e)||i(this,I)&&this[I][e])||t)},Q=function(e,t){if(e=x(e),t=w(t,!0),e!==z||!i(k,t)||i(B,t)){var r=C(e,t);return!r||!i(k,t)||i(e,I)&&e[I][t]||(r.enumerable=!0),r}},Z=function(e){for(var t,r=P(x(e)),n=[],o=0;r.length>o;)i(k,t=r[o++])||t==I||t==c||n.push(t);return n},K=function(e){for(var t,r=e===z,n=P(r?B:x(e)),o=[],a=0;n.length>a;)!i(k,t=n[a++])||r&&!i(z,t)||o.push(k[t]);return o};j||(s((O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===z&&t.call(B,r),i(this,I)&&i(this[I],e)&&(this[I][e]=!1),W(this,e,_(1,r))};return o&&G&&W(z,e,{configurable:!0,set:t}),H(e)}).prototype,"toString",function(){return this._k}),T.f=Q,A.f=q,r("a9e0e4b5ca884ed0dd59").f=M.f=Z,r("0091fa8d74c45e0dd589").f=J,r("f71a7c9d37f996326dd6").f=K,o&&!r("46a1a30d151cac60057c")&&s(z,"propertyIsEnumerable",J,!0),p.f=function(e){return H(f(e))}),a(a.G+a.W+a.F*!j,{Symbol:O});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;$.length>ee;)f($[ee++]);for(var te=E(f.store),re=0;te.length>re;)m(te[re++]);a(a.S+a.F*!j,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=O(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in U)if(U[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!j,"Object",{create:function(e,t){return void 0===t?S(e):Y(S(e),t)},defineProperty:q,defineProperties:Y,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:K}),N&&a(a.S+a.F*(!j||u(function(){var e=O();return"[null]"!=R([e])||"{}"!=R({a:e})||"{}"!=R(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!X(e))return g(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!X(t))return t}),n[1]=t,R.apply(N,n)}}),O.prototype[D]||r("5f25c015bbbf9d42c661")(O.prototype,D,O.prototype.valueOf),h(O,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},"41f6983f842d46fa6592":function(e,t,r){"use strict";var n=r("1139de1233fd67f45bd7"),i=r("5975c7ea3ecd56e534e3"),o=r("46a1a30d151cac60057c"),a=r("622bea1a0aa515bde59f"),s=r("5f25c015bbbf9d42c661"),c=r("503a0df91bcab33c39b8"),u=r("7a7739dd8a198a2cfcb5"),l=r("fd8b6034a9a06242cc87"),h=r("1f3157d073736826d4fa"),d=r("ca19e32ab6ee3b3692aa"),f=r("2dc5be6768ca6c7f0d4d"),p=r("a9e0e4b5ca884ed0dd59").f,m=r("1b01d0e59d3af79760a0").f,v=r("03192b087bb464f059c0"),g=r("62828dc3ffa96c06b7c9"),y="prototype",b="Wrong index!",x=n.ArrayBuffer,w=n.DataView,_=n.Math,S=n.RangeError,M=n.Infinity,T=x,A=_.abs,E=_.pow,C=_.floor,L=_.log,P=_.LN2,O=i?"_b":"buffer",N=i?"_l":"byteLength",R=i?"_o":"byteOffset";function I(e,t,r){var n,i,o,a=new Array(r),s=8*r-t-1,c=(1<<s)-1,u=c>>1,l=23===t?E(2,-24)-E(2,-77):0,h=0,d=e<0||0===e&&1/e<0?1:0;for((e=A(e))!=e||e===M?(i=e!=e?1:0,n=c):(n=C(L(e)/P),e*(o=E(2,-n))<1&&(n--,o*=2),(e+=n+u>=1?l/o:l*E(2,1-u))*o>=2&&(n++,o/=2),n+u>=c?(i=0,n=c):n+u>=1?(i=(e*o-1)*E(2,t),n+=u):(i=e*E(2,u-1)*E(2,t),n=0));t>=8;a[h++]=255&i,i/=256,t-=8);for(n=n<<t|i,s+=t;s>0;a[h++]=255&n,n/=256,s-=8);return a[--h]|=128*d,a}function D(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=r-1,u=e[c--],l=127&u;for(u>>=7;s>0;l=256*l+e[c],c--,s-=8);for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;n=256*n+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return n?NaN:u?-M:M;n+=E(2,t),l-=a}return(u?-1:1)*n*E(2,l-t)}function F(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function U(e){return[255&e]}function k(e){return[255&e,e>>8&255]}function B(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function z(e){return I(e,52,8)}function j(e){return I(e,23,4)}function V(e,t,r){m(e[y],t,{get:function(){return this[r]}})}function G(e,t,r,n){var i=f(+r);if(i+t>e[N])throw S(b);var o=e[O]._b,a=i+e[R],s=o.slice(a,a+t);return n?s:s.reverse()}function W(e,t,r,n,i,o){var a=f(+r);if(a+t>e[N])throw S(b);for(var s=e[O]._b,c=a+e[R],u=n(+i),l=0;l<t;l++)s[c+l]=u[o?l:t-l-1]}if(a.ABV){if(!u(function(){x(1)})||!u(function(){new x(-1)})||u(function(){return new x,new x(1.5),new x(NaN),"ArrayBuffer"!=x.name})){for(var H,X=(x=function(e){return l(this,x),new T(f(e))})[y]=T[y],q=p(T),Y=0;q.length>Y;)(H=q[Y++])in x||s(x,H,T[H]);o||(X.constructor=x)}var J=new w(new x(2)),Q=w[y].setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||c(w[y],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else x=function(e){l(this,x,"ArrayBuffer");var t=f(e);this._b=v.call(new Array(t),0),this[N]=t},w=function(e,t,r){l(this,w,"DataView"),l(e,x,"DataView");var n=e[N],i=h(t);if(i<0||i>n)throw S("Wrong offset!");if(i+(r=void 0===r?n-i:d(r))>n)throw S("Wrong length!");this[O]=e,this[R]=i,this[N]=r},i&&(V(x,"byteLength","_l"),V(w,"buffer","_b"),V(w,"byteLength","_l"),V(w,"byteOffset","_o")),c(w[y],{getInt8:function(e){return G(this,1,e)[0]<<24>>24},getUint8:function(e){return G(this,1,e)[0]},getInt16:function(e){var t=G(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=G(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return F(G(this,4,e,arguments[1]))},getUint32:function(e){return F(G(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return D(G(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return D(G(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){W(this,1,e,U,t)},setUint8:function(e,t){W(this,1,e,U,t)},setInt16:function(e,t){W(this,2,e,k,t,arguments[2])},setUint16:function(e,t){W(this,2,e,k,t,arguments[2])},setInt32:function(e,t){W(this,4,e,B,t,arguments[2])},setUint32:function(e,t){W(this,4,e,B,t,arguments[2])},setFloat32:function(e,t){W(this,4,e,j,t,arguments[2])},setFloat64:function(e,t){W(this,8,e,z,t,arguments[2])}});g(x,"ArrayBuffer"),g(w,"DataView"),s(w[y],a.VIEW,!0),t.ArrayBuffer=x,t.DataView=w},"4245b1933f7026101770":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=l(r("8af190b70a6bc55c6f1b")),o=l(r("8a2d1b95e05b6a321e74")),a=l(r("49a47d064cfbf2949ee5")),s=l(r("6a4f9c383785f9168266")),c=r("12ba4fef039ee145f0aa"),u=l(r("d14c3129375a94963214"));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},t.prototype.componentWillMount=function(){(0,s.default)(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},t.prototype.componentDidMount=function(){this.isStatic()||this.perform()},t.prototype.componentDidUpdate=function(e){var t=(0,c.createLocation)(e.to),r=(0,c.createLocation)(this.props.to);(0,c.locationsAreEqual)(t,r)?(0,a.default)(!1,"You tried to redirect to the same route you're currently on: \""+r.pathname+r.search+'"'):this.perform()},t.prototype.computeTo=function(e){var t=e.computedMatch,r=e.to;return t?"string"==typeof r?(0,u.default)(r,t.params):n({},r,{pathname:(0,u.default)(r.pathname,t.params)}):r},t.prototype.perform=function(){var e=this.context.router.history,t=this.props.push,r=this.computeTo(this.props);t?e.push(r):e.replace(r)},t.prototype.render=function(){return null},t}(i.default.Component);h.propTypes={computedMatch:o.default.object,push:o.default.bool,from:o.default.string,to:o.default.oneOfType([o.default.string,o.default.object]).isRequired},h.defaultProps={push:!1},h.contextTypes={router:o.default.shape({history:o.default.shape({push:o.default.func.isRequired,replace:o.default.func.isRequired}).isRequired,staticContext:o.default.object}).isRequired},t.default=h},"429cfc8e3ed333e40618":function(e,t,r){"use strict";var n=r("46a1a30d151cac60057c"),i=r("2d13d93c336705cd8ff9"),o=r("88db22626e6c88b175cf"),a=r("5f25c015bbbf9d42c661"),s=r("224ae09e536c09e69a0a"),c=r("5c5d334c57135891e397"),u=r("62828dc3ffa96c06b7c9"),l=r("12323e1413cbffdabe02"),h=r("621a65702ee1a566fd32")("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,r,p,m,v,g){c(r,t,p);var y,b,x,w=function(e){if(!d&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},_=t+" Iterator",S="values"==m,M=!1,T=e.prototype,A=T[h]||T["@@iterator"]||m&&T[m],E=A||w(m),C=m?S?w("entries"):E:void 0,L="Array"==t&&T.entries||A;if(L&&(x=l(L.call(new e)))!==Object.prototype&&x.next&&(u(x,_,!0),n||"function"==typeof x[h]||a(x,h,f)),S&&A&&"values"!==A.name&&(M=!0,E=function(){return A.call(this)}),n&&!g||!d&&!M&&T[h]||a(T,h,E),s[t]=E,s[_]=f,m)if(y={values:S?E:w("values"),keys:v?E:w("keys"),entries:C},g)for(b in y)b in T||o(T,b,y[b]);else i(i.P+i.F*(d||M),t,y);return y}},"42d2ac6d92467eceff72":function(e,t,r){t.f=r("621a65702ee1a566fd32")},"42f5768b7d8d9a994222":function(e,t,r){r("7519864545a89c83682d")("split",2,function(e,t,n){"use strict";var i=r("1582553a0f2276f66f2f"),o=n,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];n=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!i(e))return o.call(r,e,t);var n,c,u,l,h,d=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,m=void 0===t?4294967295:t>>>0,v=new RegExp(e.source,f+"g");for(s||(n=new RegExp("^"+v.source+"$(?!\\s)",f));(c=v.exec(r))&&!((u=c.index+c[0].length)>p&&(d.push(r.slice(p,c.index)),!s&&c.length>1&&c[0].replace(n,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(c[h]=void 0)}),c.length>1&&c.index<r.length&&a.apply(d,c.slice(1)),l=c[0].length,p=u,d.length>=m));)v.lastIndex===c.index&&v.lastIndex++;return p===r.length?!l&&v.test("")||d.push(""):d.push(r.slice(p)),d.length>m?d.slice(0,m):d}}else"0".split(void 0,0).length&&(n=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(r,i){var o=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},"4357234160788ed77205":function(e,t,r){var n=r("79c91dcd8cd554c59c7b");e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},"43a62b7f9a94dda95bf8":function(e,t,r){var n=r("5925dad3c5243ffee3db"),i=r("1139de1233fd67f45bd7"),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r("46a1a30d151cac60057c")?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},"43dd891ba6876544e540":function(e,t,r){var n=r("4be2c15021f717a728f0")(r("18caba858d9ea0f67284"),"WeakMap");e.exports=n},"444c26bc43eec64c837a":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("23d432718b3e8ce32362"),o=String.fromCharCode,a=String.fromCodePoint;n(n.S+n.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,a=0;n>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},"454dda5a76e3e8fad966":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{log1p:r("7fd90dee1f5cbd901d1c")})},"45c7f885186b325fe183":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("622bea1a0aa515bde59f"),o=r("41f6983f842d46fa6592"),a=r("79c91dcd8cd554c59c7b"),s=r("23d432718b3e8ce32362"),c=r("ca19e32ab6ee3b3692aa"),u=r("a459ab805827640a27e8"),l=r("1139de1233fd67f45bd7").ArrayBuffer,h=r("8b246eab22bc34690d38"),d=o.ArrayBuffer,f=o.DataView,p=i.ABV&&l.isView,m=d.prototype.slice,v=i.VIEW;n(n.G+n.W+n.F*(l!==d),{ArrayBuffer:d}),n(n.S+n.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return p&&p(e)||u(e)&&v in e}}),n(n.P+n.U+n.F*r("7a7739dd8a198a2cfcb5")(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(a(this),e);for(var r=a(this).byteLength,n=s(e,r),i=s(void 0===t?r:t,r),o=new(h(this,d))(c(i-n)),u=new f(this),l=new f(o),p=0;n<i;)l.setUint8(p++,u.getUint8(n++));return o}}),r("89a21af31babcdc56725")("ArrayBuffer")},"46a1a30d151cac60057c":function(e,t){e.exports=!1},"47e9e16a3e339321eec5":function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},"481c1f0e850b0c8d0f7d":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("1e0f00d296712713afe6");n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},"4824055ce03b0869d111":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.G+n.W+n.F*!r("622bea1a0aa515bde59f").ABV,{DataView:r("41f6983f842d46fa6592").DataView})},"4901eb5005bcc482eb97":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("2d8c8264a871cfe44bc2"));t.default=n.default},"49112c95d93be1863904":function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=r("8af190b70a6bc55c6f1b"),c=r("8a2d1b95e05b6a321e74"),u=[],l=[];function h(e){var t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then(function(e){return r.loading=!1,r.loaded=e,e}).catch(function(e){throw r.loading=!1,r.error=e,e}),r}function d(e){var t={loading:!1,loaded:{},error:null},r=[];try{Object.keys(e).forEach(function(n){var i=h(e[n]);i.loading?t.loading=!0:(t.loaded[n]=i.loaded,t.error=i.error),r.push(i.promise),i.promise.then(function(e){t.loaded[n]=e}).catch(function(e){t.error=e})})}catch(e){t.error=e}return t.promise=Promise.all(r).then(function(e){return t.loading=!1,e}).catch(function(e){throw t.loading=!1,e}),t}function f(e,t){return s.createElement(function(e){return e&&e.__esModule?e.default:e}(e),t)}function p(e,t){var h,d;if(!t.loading)throw new Error("react-loadable requires a `loading` component");var p=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:f,webpack:null,modules:null},t),m=null;function v(){return m||(m=e(p.loader)),m.promise}return u.push(v),"function"==typeof p.webpack&&l.push(function(){if(function(e){return"object"===n(r.m)&&e().every(function(e){return void 0!==e&&void 0!==r.m[e]})}(p.webpack))return v()}),d=h=function(t){function r(n){i(this,r);var a=o(this,t.call(this,n));return a.retry=function(){a.setState({error:null,loading:!0}),m=e(p.loader),a._loadModule()},v(),a.state={error:m.error,pastDelay:!1,timedOut:!1,loading:m.loading,loaded:m.loaded},a}return a(r,t),r.preload=function(){return v()},r.prototype.componentWillMount=function(){this._mounted=!0,this._loadModule()},r.prototype._loadModule=function(){var e=this;if(this.context.loadable&&Array.isArray(p.modules)&&p.modules.forEach(function(t){e.context.loadable.report(t)}),m.loading){"number"==typeof p.delay&&(0===p.delay?this.setState({pastDelay:!0}):this._delay=setTimeout(function(){e.setState({pastDelay:!0})},p.delay)),"number"==typeof p.timeout&&(this._timeout=setTimeout(function(){e.setState({timedOut:!0})},p.timeout));var t=function(){e._mounted&&(e.setState({error:m.error,loaded:m.loaded,loading:m.loading}),e._clearTimeouts())};m.promise.then(function(){t()}).catch(function(e){t()})}},r.prototype.componentWillUnmount=function(){this._mounted=!1,this._clearTimeouts()},r.prototype._clearTimeouts=function(){clearTimeout(this._delay),clearTimeout(this._timeout)},r.prototype.render=function(){return this.state.loading||this.state.error?s.createElement(p.loading,{isLoading:this.state.loading,pastDelay:this.state.pastDelay,timedOut:this.state.timedOut,error:this.state.error,retry:this.retry}):this.state.loaded?p.render(this.state.loaded,this.props):null},r}(s.Component),h.contextTypes={loadable:c.shape({report:c.func.isRequired})},d}function m(e){return p(h,e)}m.Map=function(e){if("function"!=typeof e.render)throw new Error("LoadableMap requires a `render(loaded, props)` function");return p(d,e)};var v=function(e){function t(){return i(this,t),o(this,e.apply(this,arguments))}return a(t,e),t.prototype.getChildContext=function(){return{loadable:{report:this.props.report}}},t.prototype.render=function(){return s.Children.only(this.props.children)},t}(s.Component);function g(e){for(var t=[];e.length;){var r=e.pop();t.push(r())}return Promise.all(t).then(function(){if(e.length)return g(e)})}v.propTypes={report:c.func.isRequired},v.childContextTypes={loadable:c.shape({report:c.func.isRequired}).isRequired},m.Capture=v,m.preloadAll=function(){return new Promise(function(e,t){g(u).then(e,t)})},m.preloadReady=function(){return new Promise(function(e,t){g(l).then(e,e)})},e.exports=m},"494d4966d2dbdf891514":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.imul;n(n.S+n.F*r("7a7739dd8a198a2cfcb5")(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}})},"49555589e35fce2252cc":function(e,t,r){"use strict";function n(e){return"/"===e.charAt(0)}function i(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}t.__esModule=!0,t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e&&e.split("/")||[],o=t&&t.split("/")||[],a=e&&n(e),s=t&&n(t),c=a||s;if(e&&n(e)?o=r:r.length&&(o.pop(),o=o.concat(r)),!o.length)return"/";var u=void 0;if(o.length){var l=o[o.length-1];u="."===l||".."===l||""===l}else u=!1;for(var h=0,d=o.length;d>=0;d--){var f=o[d];"."===f?i(o,d):".."===f?(i(o,d),h++):h&&(i(o,d),h--)}if(!c)for(;h--;h)o.unshift("..");!c||""===o[0]||o[0]&&n(o[0])||o.unshift("");var p=o.join("/");return u&&"/"!==p.substr(-1)&&(p+="/"),p},e.exports=t.default},"49737199b59f0ac62d15":function(e,t,r){"use strict";var n=r("1139de1233fd67f45bd7"),i=r("d34390b928ecadc11dc8"),o=r("0116c75136b233002fb9"),a=r("cf8d6afd09746a2b5bc3"),s=r("4ef7a75a1d1957a7c5c0"),c=r("7a7739dd8a198a2cfcb5"),u=r("a9e0e4b5ca884ed0dd59").f,l=r("61fcea04092a9580d371").f,h=r("1b01d0e59d3af79760a0").f,d=r("57e7a4ee5fd1ce9280ef").trim,f=n.Number,p=f,m=f.prototype,v="Number"==o(r("ef09ce044ac3210bc947")(m)),g="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=g?t.trim():d(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,c=t.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||a>i)return NaN;return parseInt(c,n)}}return+t};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof f&&(v?c(function(){m.valueOf.call(r)}):"Number"!=o(r))?a(new p(y(t)),r,f):y(t)};for(var b,x=r("5975c7ea3ecd56e534e3")?u(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;x.length>w;w++)i(p,b=x[w])&&!i(f,b)&&h(f,b,l(p,b));f.prototype=m,m.constructor=f,r("88db22626e6c88b175cf")(n,"Number",f)}},"49a47d064cfbf2949ee5":function(e,t,r){"use strict";var n=function(){};e.exports=n},"4a0368fb5bf578c56890":function(e,t,r){"use strict";t.__esModule=!0;t.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),t.addEventListener=function(e,t,r){return e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)},t.removeEventListener=function(e,t,r){return e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent("on"+t,r)},t.getConfirmation=function(e,t){return t(window.confirm(e))},t.supportsHistory=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)},t.supportsPopStateOnHashChange=function(){return-1===window.navigator.userAgent.indexOf("Trident")},t.supportsGoWithoutReloadUsingHash=function(){return-1===window.navigator.userAgent.indexOf("Firefox")},t.isExtraneousPopstateEvent=function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")}},"4b6c3e2b96a7fdc95a33":function(e,t,r){"use strict";var n,i=r("ecd0e0fb36455021f082")(0),o=r("88db22626e6c88b175cf"),a=r("87f7b2a2f3e179b5c40a"),s=r("94fb07840c0fda6ca6a4"),c=r("ccf730c83e7100f675a4"),u=r("a459ab805827640a27e8"),l=r("7a7739dd8a198a2cfcb5"),h=r("2c407c4438ef2794ef23"),d=a.getWeak,f=Object.isExtensible,p=c.ufstore,m={},v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(e){if(u(e)){var t=d(e);return!0===t?p(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(h(this,"WeakMap"),e,t)}},y=e.exports=r("0633550d227682cecd10")("WeakMap",v,g,c,!0,!0);l(function(){return 7!=(new y).set((Object.freeze||Object)(m),7).get(m)})&&(s((n=c.getConstructor(v,"WeakMap")).prototype,g),a.NEED=!0,i(["delete","has","get","set"],function(e){var t=y.prototype,r=t[e];o(t,e,function(t,i){if(u(t)&&!f(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)})}))},"4b80994996621a6e63f3":function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(i(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(var a=0;a<r.length;a++)if(!n.call(t,r[a])||!i(e[r[a]],t[r[a]]))return!1;return!0};var n=Object.prototype.hasOwnProperty;function i(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}},"4b93c5a7bb60dd6ab0f4":function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"4be2c15021f717a728f0":function(e,t,r){var n=r("65955717fc58c97d7378"),i=r("dba25a6f599687a5b44e");e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},"4cc77e026250beeef142":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("efae14a3f8cd9a616256"),o=[].join;n(n.P+n.F*(r("a537d0accb907bf9d41f")!=Object||!r("40b064d4eb439c0c1c2b")(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},"4cd9a60f042223c9ba2c":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("0d694d86343010af9d4f");i&&n(n.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},"4d073e2fededcdd3f3d3":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},"4e2e9348dad8fe460c1d":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineReducers=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("eb3400b937b92a185016"));t.combineReducers=n.default},"4eb232e665ed4f2fa5b1":function(e,t,r){var n=r("a459ab805827640a27e8");r("f34797c0b42452934317")("isFrozen",function(e){return function(t){return!n(t)||!!e&&e(t)}})},"4ef7a75a1d1957a7c5c0":function(e,t,r){var n=r("a459ab805827640a27e8");e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},"4faad91abd2171602dcc":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=180/Math.PI;n(n.S,"Math",{degrees:function(e){return e*i}})},"5024bbbb57e5994af657":function(e,t,r){(function(e,r,n){var i={};"undefined"!=typeof Window?i&&i instanceof Window?i=i:e&&e instanceof Window?i=e:GLOBAL&&GLOBAL instanceof Window?i=GLOBAL:console.warn("Unable to find classic window global variable declaration. Some dependencies that depending on global window variable could not work properly."):console.warn("It seems you are using this package in a non-browser environment. Some dependencies that depending on global window variable could not work properly."),Object.defineProperty(t,"__esModule",{value:!0}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){var t=arguments;if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=t[n];if(void 0!==i&&null!==i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r});var o={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&r]+e[r>>8&255]+"-"+e[r>>16&15|64]+e[r>>24&255]+"-"+e[63&n|128]+e[n>>8&255]+"-"+e[n>>16&255]+e[n>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*o.DEG2RAD},radToDeg:function(e){return e*o.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function a(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("Matrix4: the constructor no longer reads arguments. use .set() instead.")}function s(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function c(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1}function u(){}function l(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||l.DefaultOrder}function h(){this.mask=1}function d(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(a.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,o,a,s,c,u,l,h,d,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=u,v[10]=l,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new a).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new s;return function(t){var r=this.elements,n=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=0,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),c=Math.sin(n),u=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var h=o*u,d=o*l,f=a*u,p=a*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=d+f*c,t[5]=h-p*c,t[9]=-a*s,t[2]=p-h*c,t[6]=f+d*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,v=s*l,g=c*u,y=c*l;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*c,t[1]=o*l,t[5]=o*u,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,v=s*l,g=c*u,y=c*l;t[0]=m-y*a,t[4]=-o*l,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,d=o*l,f=a*u,p=a*l;t[0]=s*u,t[4]=f*c-d,t[8]=h*c+p,t[1]=s*l,t[5]=p*c+h,t[9]=d*c-f,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*c,w=a*s,_=a*c;t[0]=s*u,t[4]=_-b*l,t[8]=w*l+x,t[1]=l,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=x*l+w,t[10]=b-_*l}else if("XZY"===e.order){b=o*s,x=o*c,w=a*s,_=a*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=b*l+_,t[5]=o*u,t[9]=x*l-w,t[2]=w*l-x,t[6]=a*u,t[10]=_*l+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new s(0,0,0),t=new s(1,1,1);return function(r){return this.compose(e,r,t)}}(),lookAt:function(){var e=new s,t=new s,r=new s;return function(n,i,o){var a=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),e.crossVectors(o,r),0===e.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),e.crossVectors(o,r)),e.normalize(),t.crossVectors(r,e),a[0]=e.x,a[4]=t.x,a[8]=r.x,a[1]=e.y,a[5]=t.y,a[9]=r.y,a[2]=e.z,a[6]=t.z,a[10]=r.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],c=r[12],u=r[1],l=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],v=r[14],g=r[3],y=r[7],b=r[11],x=r[15],w=n[0],_=n[4],S=n[8],M=n[12],T=n[1],A=n[5],E=n[9],C=n[13],L=n[2],P=n[6],O=n[10],N=n[14],R=n[3],I=n[7],D=n[11],F=n[15];return i[0]=o*w+a*T+s*L+c*R,i[4]=o*_+a*A+s*P+c*I,i[8]=o*S+a*E+s*O+c*D,i[12]=o*M+a*C+s*N+c*F,i[1]=u*w+l*T+h*L+d*R,i[5]=u*_+l*A+h*P+d*I,i[9]=u*S+l*E+h*O+d*D,i[13]=u*M+l*C+h*N+d*F,i[2]=f*w+p*T+m*L+v*R,i[6]=f*_+p*A+m*P+v*I,i[10]=f*S+p*E+m*O+v*D,i[14]=f*M+p*C+m*N+v*F,i[3]=g*w+y*T+b*L+x*R,i[7]=g*_+y*A+b*P+x*I,i[11]=g*S+y*E+b*O+x*D,i[15]=g*M+y*C+b*N+x*F,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new s;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],d=e[14];return e[3]*(+i*s*l-n*c*l-i*a*h+r*c*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*c*h+i*o*h-n*o*d+n*c*u-i*s*u)+e[11]*(+t*c*l-t*a*d-i*o*l+r*o*d+i*a*u-r*c*u)+e[15]*(-n*a*u-t*s*l+t*a*h+n*o*l-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],x=f*y*h-g*p*h+g*l*m-u*y*m-f*l*b+u*p*b,w=v*p*h-d*y*h-v*l*m+c*y*m+d*l*b-c*p*b,_=d*g*h-v*f*h+v*u*m-c*g*m-d*u*b+c*f*b,S=v*f*l-d*g*l-v*u*p+c*g*p+d*u*y-c*f*y,M=i*x+o*w+a*_+s*S;if(0===M){var T="Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var A=1/M;return r[0]=x*A,r[1]=(g*p*s-f*y*s-g*a*m+o*y*m+f*a*b-o*p*b)*A,r[2]=(u*y*s-g*l*s+g*a*h-o*y*h-u*a*b+o*l*b)*A,r[3]=(f*l*s-u*p*s-f*a*h+o*p*h+u*a*m-o*l*m)*A,r[4]=w*A,r[5]=(d*y*s-v*p*s+v*a*m-i*y*m-d*a*b+i*p*b)*A,r[6]=(v*l*s-c*y*s-v*a*h+i*y*h+c*a*b-i*l*b)*A,r[7]=(c*p*s-d*l*s+d*a*h-i*p*h-c*a*m+i*l*m)*A,r[8]=_*A,r[9]=(v*f*s-d*g*s-v*o*m+i*g*m+d*o*b-i*f*b)*A,r[10]=(c*g*s-v*u*s+v*o*h-i*g*h-c*o*b+i*u*b)*A,r[11]=(d*u*s-c*f*s-d*o*h+i*f*h+c*o*m-i*u*m)*A,r[12]=S*A,r[13]=(d*g*a-v*f*a+v*o*p-i*g*p-d*o*y+i*f*y)*A,r[14]=(v*u*a-c*g*a-v*o*l+i*g*l+c*o*y-i*u*y)*A,r[15]=(c*f*a-d*u*a+d*o*l-i*f*l-c*o*p+i*u*p)*A,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;return this.set(c*o+r,c*a-n*s,c*s+n*a,0,c*a+n*s,u*a+r,u*s-n*o,0,c*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){var n=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,c=i+i,u=o+o,l=a+a,h=i*c,d=i*u,f=i*l,p=o*u,m=o*l,v=a*l,g=s*c,y=s*u,b=s*l,x=r.x,w=r.y,_=r.z;return n[0]=(1-(p+v))*x,n[1]=(d+b)*x,n[2]=(f-y)*x,n[3]=0,n[4]=(d-b)*w,n[5]=(1-(h+v))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(f+y)*_,n[9]=(m-g)*_,n[10]=(1-(h+p))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(){var e=new s,t=new a;return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),c=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.copy(this);var u=1/a,l=1/s,h=1/c;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=l,t.elements[5]*=l,t.elements[6]*=l,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=c,this}}(),makePerspective:function(e,t,r,n,i,o){void 0===o&&console.warn("Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),c=2*i/(r-n),u=(t+e)/(t-e),l=(r+n)/(r-n),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=1/(t-e),c=1/(r-n),u=1/(o-i),l=(t+e)*s,h=(r+n)*c,d=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),Object.assign(s.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new c;return function(t){return t&&t.isEuler||console.error("Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new c;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*n-a*r,u=s*r+a*t-i*n,l=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=c*s+h*-i+u*-a-l*-o,this.y=u*s+h*-o+l*-i-c*-a,this.z=l*s+h*-a+c*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(){var e=new a;return function(t){return this.applyMatrix4(e.getInverse(t.projectionMatrix)).applyMatrix4(t.matrixWorld)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new s,t=new s;return function(r,n){return e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){return void 0!==t?(console.warn("Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new s;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new s;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(o.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){var n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(c,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,o,a){var s=r[n+0],c=r[n+1],u=r[n+2],l=r[n+3],h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(l!==p||s!==h||c!==d||u!==f){var m=1-a,v=s*h+c*d+u*f+l*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,v*g);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var w=a*g;if(s=s*m+h*w,c=c*m+d*w,u=u*m+f*w,l=l*m+p*w,m===1-a){var _=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=_,c*=_,u*=_,l*=_}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}}),Object.defineProperties(c.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(c.prototype,{set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(r/2),u=a(n/2),l=a(i/2),h=s(r/2),d=s(n/2),f=s(i/2);return"XYZ"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l-h*d*f):"YXZ"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l+h*d*f):"ZXY"===o?(this._x=h*u*l-c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l-h*d*f):"ZYX"===o?(this._x=h*u*l-c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l+h*d*f):"YZX"===o?(this._x=h*u*l+c*d*f,this._y=c*d*l+h*u*f,this._z=c*u*f-h*d*l,this._w=c*u*l-h*d*f):"XZY"===o&&(this._x=h*u*l-c*d*f,this._y=c*d*l-h*u*f,this._z=c*u*f+h*d*l,this._w=c*u*l+h*d*f),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],c=r[9],u=r[2],l=r[6],h=r[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(l-c)*t,this._y=(o-u)*t,this._z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(l-c)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(c+l)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(c+l)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new s;return function(r,n){return void 0===t&&(t=new s),(e=r.dot(n)+1)<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),angleTo:function(e){return 2*Math.acos(Math.abs(o.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var r=this.angleTo(e);if(0===r)return this;var n=Math.min(1,t/r);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;return this._x=r*u+o*a+n*c-i*s,this._y=n*u+o*s+i*a-r*c,this._z=i*u+o*c+r*s-n*a,this._w=o*u-r*a-n*s-i*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*r+t*this._x,this._y=c*n+t*this._y,this._z=c*i+t*this._z,this.normalize()}var u=Math.sqrt(s),l=Math.atan2(u,a),h=Math.sin((1-t)*l)/u,d=Math.sin(t*l)/u;return this._w=o*h+this._w*d,this._x=r*h+this._x*d,this._y=n*h+this._y*d,this._z=i*h+this._z*d,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(u.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=t.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,e)}}}}),l.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],l.DefaultOrder="XYZ",Object.defineProperties(l.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(l.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=o.clamp,i=e.elements,a=i[0],s=i[4],c=i[8],u=i[1],l=i[5],h=i[9],d=i[2],f=i[6],p=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(f,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(c,p),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===t?(this._y=Math.asin(-n(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-s,l))):"YZX"===t?(this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(c,p))):"XZY"===t?(this._z=Math.asin(-n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(f,l),this._y=Math.atan2(c,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new a;return function(t,r,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new c;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new s(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(h.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}}),Object.assign(d.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,o,a,s,c){var u=this.elements;return u[0]=e,u[1]=n,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=r,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new s;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[3],s=r[6],c=r[1],u=r[4],l=r[7],h=r[2],d=r[5],f=r[8],p=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return i[0]=o*p+a*g+s*x,i[3]=o*m+a*y+s*w,i[6]=o*v+a*b+s*_,i[1]=c*p+u*g+l*x,i[4]=c*m+u*y+l*w,i[7]=c*v+u*b+l*_,i[2]=h*p+d*g+f*x,i[5]=h*m+d*y+f*w,i[8]=h*v+d*b+f*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*i*u+r*a*s+n*i*c-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],d=r[8],f=d*c-u*h,p=u*l-d*s,m=h*s-c*l,v=i*f+o*p+a*m;if(0===v){var g="Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return n[0]=f*y,n[1]=(a*h-d*o)*y,n[2]=(u*o-a*c)*y,n[3]=p*y,n[4]=(d*i-a*l)*y,n[5]=(a*s-u*i)*y,n[6]=m*y,n[7]=(o*l-h*i)*y,n[8]=(c*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(r*s,r*c,-r*(s*o+c*a)+o+e,-n*c,n*s,-n*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],o=n[3],a=n[6],s=n[1],c=n[4],u=n[7];return n[0]=t*i+r*s,n[3]=t*o+r*c,n[6]=t*a+r*u,n[1]=-r*i+t*s,n[4]=-r*o+t*c,n[7]=-r*a+t*u,this},translate:function(e,t){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var f=0;function p(){Object.defineProperty(this,"id",{value:f++}),this.uuid=o.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=p.DefaultUp.clone();var e=new s,t=new l,r=new c,n=new s(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)}),r.onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new a},normalMatrix:{value:new d}}),this.matrix=new a,this.matrixWorld=new a,this.matrixAutoUpdate=p.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new h,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}p.DefaultUp=new s(0,1,0),p.DefaultMatrixAutoUpdate=!0,p.prototype=Object.assign(Object.create(u.prototype),{constructor:p,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new c;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new c;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new s(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new s(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new s(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new s;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new s(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new s(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new s(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new a;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new c,t=new a,r=new s,n=new s;return function(i,o,a){i.isVector3?r.copy(i):r.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld),this.isCamera?t.lookAt(n,r,this.up):t.lookAt(r,n,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){var t=arguments;if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(t[r]);return this}return e===this?(console.error("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("Object3D.add: object not an instance of Object3D.",e),this)},remove:function(e){var t=arguments;if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.remove(t[r]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("Object3D: .getWorldPosition() target is now required"),e=new s),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new s,t=new s;return function(r){return void 0===r&&(console.warn("Object3D: .getWorldQuaternion() target is now required"),r=new c),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,t),r}}(),getWorldScale:function(){var e=new s,t=new c;return function(r){return void 0===r&&(console.warn("Object3D: .getWorldScale() target is now required"),r=new s),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,r),r}}(),getWorldDirection:function(e){void 0===e&&(console.warn("Object3D: .getWorldDirection() target is now required"),e=new s),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,i=0,o=n.length;i<o;i++)n[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(e.materials,this.material[s]));n.material=l}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),d=m(e.materials),f=m(e.textures),p=m(e.images);a=m(e.shapes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),f.length>0&&(r.textures=f),p.length>0&&(r.images=p),a.length>0&&(r.shapes=a)}return r.object=n,r;function m(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}});var m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function g(e,t,r,n,i,o){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new s,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new v,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function y(e,t){this.min=void 0!==e?e:new s(1/0,1/0,1/0),this.max=void 0!==t?t:new s(-1/0,-1/0,-1/0)}function b(e,t){this.center=void 0!==e?e:new s,this.radius=void 0!==t?t:0}function x(e,t){this.x=e||0,this.y=t||0}Object.assign(v.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){if(t=o.euclideanModulo(t,1),r=o.clamp(r,0,1),n=o.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,a=2*n-i;this.r=e(a,i,t+1/3),this.g=e(a,i,t),this.b=e(a,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,c)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,l=(u=r[1]).length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(u=m[e])?this.setHex(u):console.warn("Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,r,n=this.r,i=this.g,o=this.b,a=Math.max(n,i,o),s=Math.min(n,i,o),c=(s+a)/2;if(s===a)t=0,r=0;else{var u=a-s;switch(r=c<=.5?u/(a+s):u/(2-a-s),a){case n:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-n)/u+2;break;case o:t=(n-i)/u+4}t/=6}return e.h=t,e.s=r,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var e={};return function(t,r,n){return this.getHSL(e),e.h+=t,e.s+=r,e.l+=n,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var e={h:0,s:0,l:0},t={h:0,s:0,l:0};return function(r,n){this.getHSL(e),r.getHSL(t);var i=o.lerp(e.h,t.h,n),a=o.lerp(e.s,t.s,n),s=o.lerp(e.l,t.l,n);return this.setHSL(i,a,s),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Object.assign(g.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),Object.assign(y.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),h=e.getZ(s);u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new s;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("Box3: .getCenter() target is now required"),e=new s),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box3: .getSize() target is now required"),e=new s),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,r,n=new s;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,r=a.length;t<r;t++)n.copy(a[t]),n.applyMatrix4(i.matrixWorld),e.expandByPoint(n)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++)n.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(n)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("Box3: .getParameter() target is now required"),t=new s),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new s;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=e.constant&&r>=e.constant},intersectsTriangle:function(){var e=new s,t=new s,r=new s,n=new s,i=new s,o=new s,a=new s,c=new s,u=new s,l=new s;function h(n){var i,o;for(i=0,o=n.length-3;i<=o;i+=3){a.fromArray(n,i);var s=u.x*Math.abs(a.x)+u.y*Math.abs(a.y)+u.z*Math.abs(a.z),c=e.dot(a),l=t.dot(a),h=r.dot(a);if(Math.max(-Math.max(c,l,h),Math.min(c,l,h))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(c),u.subVectors(this.max,c),e.subVectors(a.a,c),t.subVectors(a.b,c),r.subVectors(a.c,c),n.subVectors(t,e),i.subVectors(r,t),o.subVectors(e,r);var s=[0,-n.z,n.y,0,-i.z,i.y,0,-o.z,o.y,n.z,0,-n.x,i.z,0,-i.x,o.z,0,-o.x,-n.y,n.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!h(s)&&(!!h(s=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(n,i),h(s=[l.x,l.y,l.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("Box3: .clampPoint() target is now required"),t=new s),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new s;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new s;return function(t){return void 0===t&&(console.warn("Box3: .getBoundingSphere() target is now required"),t=new b),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new s,new s,new s,new s,new s,new s,new s,new s];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(b.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new y;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).getCenter(n);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("Sphere: .clampPoint() target is now required"),t=new s),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("Sphere: .getBoundingBox() target is now required"),e=new y),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.defineProperties(x.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(x.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new x,t=new x;return function(r,n){return e.set(r,r),t.set(n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*r-o*n+e.x,this.y=i*n+o*r+e.y,this}});var w=0;function _(){Object.defineProperty(this,"id",{value:w+=2}),this.uuid=o.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function S(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1}function M(e,t,r){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function T(e,t,r){M.call(this,new Int8Array(e),t,r)}function A(e,t,r){M.call(this,new Uint8Array(e),t,r)}function E(e,t,r){M.call(this,new Uint8ClampedArray(e),t,r)}function C(e,t,r){M.call(this,new Int16Array(e),t,r)}function L(e,t,r){M.call(this,new Uint16Array(e),t,r)}function P(e,t,r){M.call(this,new Int32Array(e),t,r)}function O(e,t,r){M.call(this,new Uint32Array(e),t,r)}function N(e,t,r){M.call(this,new Float32Array(e),t,r)}function R(e,t,r){M.call(this,new Float64Array(e),t,r)}function I(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function D(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}_.prototype=Object.assign(Object.create(u.prototype),{constructor:_,isGeometry:!0,applyMatrix:function(e){for(var t=(new d).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new a;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new a;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new a;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new a;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new a;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new p;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,r=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,c=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=[],h=[],d=[],f=0,p=0;f<i.length;f+=3,p+=2)t.vertices.push(new s(i[f],i[f+1],i[f+2])),void 0!==o&&l.push(new s(o[f],o[f+1],o[f+2])),void 0!==a&&t.colors.push(new v(a[f],a[f+1],a[f+2])),void 0!==c&&h.push(new x(c[p],c[p+1])),void 0!==u&&d.push(new x(u[p],u[p+1]));function m(e,r,n,i){var s=new g(e,r,n,void 0!==o?[l[e].clone(),l[r].clone(),l[n].clone()]:[],void 0!==a?[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()]:[],i);t.faces.push(s),void 0!==c&&t.faceVertexUvs[0].push([h[e].clone(),h[r].clone(),h[n].clone()]),void 0!==u&&t.faceVertexUvs[1].push([d[e].clone(),d[r].clone(),d[n].clone()])}var y=e.groups;if(y.length>0)for(f=0;f<y.length;f++)for(var b=y[f],w=b.start,_=(p=w,w+b.count);p<_;p+=3)void 0!==r?m(r[p],r[p+1],r[p+2],b.materialIndex):m(p,p+1,p+2,b.materialIndex);else if(void 0!==r)for(f=0;f<r.length;f+=3)m(r[f],r[f+1],r[f+2]);else for(f=0;f<i.length/3;f+=3)m(f,f+1,f+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new a;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new s,t=new s,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],c=this.vertices[i.c];e.subVectors(c,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)a[t]=new s;if(e){var c,u,l,h=new s,d=new s;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],c=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c],h.subVectors(l,u),d.subVectors(c,u),h.cross(d),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,r=this.vertices.length;t<r;t++)a[t].normalize();for(n=0,i=this.faces.length;n<i;n++){var f=(o=this.faces[n]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(r=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new _;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,c=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)u=new s,l={a:new s,b:new s,c:new s},a.push(u),c.push(l)}var u,l,h=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],u=h.faceNormals[r],l=h.vertexNormals[r],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new y),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new b),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e&&e.isGeometry){var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,u=this.faceVertexUvs[0],l=e.faceVertexUvs[0],h=this.colors,f=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new d).getNormalMatrix(t));for(var p=0,m=a.length;p<m;p++){var v=a[p].clone();void 0!==t&&v.applyMatrix4(t),o.push(v)}for(p=0,m=f.length;p<m;p++)h.push(f[p].clone());for(p=0,m=c.length;p<m;p++){var y,b,x,w=c[p],_=w.vertexNormals,S=w.vertexColors;(y=new g(w.a+i,w.b+i,w.c+i)).normal.copy(w.normal),void 0!==n&&y.normal.applyMatrix3(n).normalize();for(var M=0,T=_.length;M<T;M++)b=_[M].clone(),void 0!==n&&b.applyMatrix3(n).normalize(),y.vertexNormals.push(b);y.color.copy(w.color);for(M=0,T=S.length;M<T;M++)x=S[M],y.vertexColors.push(x.clone());y.materialIndex=w.materialIndex+r,s.push(y)}for(p=0,m=l.length;p<m;p++){var A=l[p],E=[];if(void 0!==A){for(M=0,T=A.length;M<T;M++)E.push(A[M].clone());u.push(E)}}}else console.error("Geometry.merge(): geometry not an instance of Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("Geometry.mergeMesh(): mesh not an instance of Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,o,a,s,c={},u=[],l=[],h=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=r,u.push(this.vertices[r]),l[r]=u.length-1):l[r]=l[c[t]];var d=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){d.push(r);break}}for(r=d.length-1;r>=0;r--){var p=d[r];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];this.vertices.push(new s(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(i=[]);for(r=0;r<t;r++){var s=e[r]._id;n&&n.push(o[s]),i&&i.push(a[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var a=[],s=[],c={},u=[],l={},h=[],d={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,v=f.vertexNormals.length>0,g=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b,0,0),1,!0),2,!1),3,p),4,m),5,v),6,g),7,y),a.push(b),a.push(f.a,f.b,f.c),a.push(f.materialIndex),p){var x=this.faceVertexUvs[0][i];a.push(A(x[0]),A(x[1]),A(x[2]))}if(m&&a.push(M(f.normal)),v){var w=f.vertexNormals;a.push(M(w[0]),M(w[1]),M(w[2]))}if(g&&a.push(T(f.color)),y){var _=f.vertexColors;a.push(T(_[0]),T(_[1]),T(_[2]))}}function S(e,t,r){return r?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==l[t]?l[t]:(l[t]=u.length,u.push(e.getHex()),l[t])}function A(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/2,h.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=n,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new _).copy(this)},copy:function(e){var t,r,n,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,r=c.length;t<r;t++)this.colors.push(c[t].clone());var u=e.faces;for(t=0,r=u.length;t<r;t++)this.faces.push(u[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=l.length;n<i;n++){var h=l[n],d=[];for(o=0,a=h.length;o<a;o++){var f=h[o];d.push(f.clone())}this.faceVertexUvs[t].push(d)}}var p=e.morphTargets;for(t=0,r=p.length;t<r;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],n=0,i=p[t].vertices.length;n<i;n++)m.vertices.push(p[t].vertices[n].clone());if(void 0!==p[t].normals)for(m.normals=[],n=0,i=p[t].normals.length;n<i;n++)m.normals.push(p[t].normals[n].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,r=v.length;t<r;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],n=0,i=v[t].vertexNormals.length;n<i;n++){var y=v[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],n=0,i=v[t].faceNormals.length;n<i;n++)g.faceNormals.push(v[t].faceNormals[n].clone());this.morphNormals.push(g)}var x=e.skinWeights;for(t=0,r=x.length;t<r;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,r=_.length;t<r;t++)this.lineDistances.push(_[t]);var S=e.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(S.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=e.elements,a=o[0],s=o[4],c=o[8],u=o[1],l=o[5],h=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(c-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(c+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(l+1)/2,g=(p+1)/2,y=(s+u)/4,b=(c+d)/4,x=(h+f)/4;return m>v&&m>g?m<.01?(r=0,n=.707106781,i=.707106781):(n=y/(r=Math.sqrt(m)),i=b/r):v>g?v<.01?(r=.707106781,n=0,i=.707106781):(r=y/(n=Math.sqrt(v)),i=x/n):g<.01?(r=.707106781,n=.707106781,i=0):(r=b/(i=Math.sqrt(g)),n=x/i),this.set(r,n,i,t),this}var w=Math.sqrt((f-h)*(f-h)+(c-d)*(c-d)+(u-s)*(u-s));return Math.abs(w)<.001&&(w=1),this.x=(f-h)/w,this.y=(c-d)/w,this.z=(u-s)/w,this.w=Math.acos((a+l+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new S,t=new S),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.defineProperty(M.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(M.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyColorsArray(): color is undefined",n),o=new v),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new x),t[r++]=o.x,t[r++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new s),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new S),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),T.prototype=Object.create(M.prototype),T.prototype.constructor=T,A.prototype=Object.create(M.prototype),A.prototype.constructor=A,E.prototype=Object.create(M.prototype),E.prototype.constructor=E,C.prototype=Object.create(M.prototype),C.prototype.constructor=C,L.prototype=Object.create(M.prototype),L.prototype.constructor=L,P.prototype=Object.create(M.prototype),P.prototype.constructor=P,O.prototype=Object.create(M.prototype),O.prototype.constructor=O,N.prototype=Object.create(M.prototype),N.prototype.constructor=N,R.prototype=Object.create(M.prototype),R.prototype.constructor=R,Object.assign(I.prototype,{computeGroups:function(e){for(var t,r=[],n=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,r.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var u=0;u<c;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var l,h=e.morphNormals,d=h.length;if(d>0){l=[];for(u=0;u<d;u++)l[u]={name:h[u].name,data:[]};this.morphTargets.normal=l}var f=e.skinIndices,p=e.skinWeights,m=f.length===n.length,v=p.length===n.length;n.length>0&&0===r.length&&console.error("DirectGeometry: Faceless geometries are not supported.");for(u=0;u<r.length;u++){var g=r[u];this.vertices.push(n[g.a],n[g.b],n[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=g.normal;this.normals.push(b,b,b)}var w,_=g.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var S=g.color;this.colors.push(S,S,S)}if(!0===o)void 0!==(w=i[0][u])?this.uvs.push(w[0],w[1],w[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new x,new x,new x));if(!0===a)void 0!==(w=i[1][u])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new x,new x,new x));for(var M=0;M<c;M++){var T=s[M].vertices;t[M].data.push(T[g.a],T[g.b],T[g.c])}for(M=0;M<d;M++){var A=h[M].vertexNormals[u];l[M].data.push(A.a,A.b,A.c)}m&&this.skinIndices.push(f[g.a],f[g.b],f[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var F=1;function U(){Object.defineProperty(this,"id",{value:F+=2}),this.uuid=o.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function k(e,t,r,n,i,o,a){_.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new B(e,t,r,n,i,o,a)),this.mergeVertices()}function B(e,t,r,n,i,o,a){U.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var c,u,l=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),h=0,d=[],f=new s,p=new s,m=[],v=[],g=[],y=[];for(u=0;u<=r;u++){var b=[],x=u/r;for(c=0;c<=t;c++){var w=c/t;f.x=-e*Math.cos(n+w*i)*Math.sin(o+x*a),f.y=e*Math.cos(o+x*a),f.z=e*Math.sin(n+w*i)*Math.sin(o+x*a),v.push(f.x,f.y,f.z),p.set(f.x,f.y,f.z).normalize(),g.push(p.x,p.y,p.z),y.push(w,1-x),b.push(h++)}d.push(b)}for(u=0;u<r;u++)for(c=0;c<t;c++){var _=d[u][c+1],S=d[u][c],M=d[u+1][c],T=d[u+1][c+1];(0!==u||o>0)&&m.push(_,S,T),(u!==r-1||l<Math.PI)&&m.push(S,M,T)}this.setIndex(m),this.addAttribute("position",new N(v,3)),this.addAttribute("normal",new N(g,3)),this.addAttribute("uv",new N(y,2))}U.prototype=Object.assign(Object.create(u.prototype),{constructor:U,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(D(e)>65535?O:L)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new M(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new d).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new a;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new a;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new a;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new a;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new a;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new p;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new N(3*t.vertices.length,3),n=new N(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new N(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new N(t,3)),this},updateFromObject:function(e){var t,r=e.geometry;if(e.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(r.vertices),t.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(r.normals),t.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(r.colors),t.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(r.uvs),t.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(r.lineDistances),t.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(e.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new I).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new M(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new M(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new M(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new M(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new M(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],u=0,l=c.length;u<l;u++){var h=c[u],d=new N(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var f=new N(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new N(4*e.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new y);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new y,t=new s;return function(){null===this.boundingSphere&&(this.boundingSphere=new b);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(n);for(var i=0,o=0,a=r.count;o<a;o++)t.x=r.getX(o),t.y=r.getY(o),t.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new M(new Float32Array(r.length),3));else for(var n=t.normal.array,i=0,o=n.length;i<o;i++)n[i]=0;var a,c,u,l=t.normal.array,h=new s,d=new s,f=new s,p=new s,m=new s;if(e){var v=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*v[i+0],c=3*v[i+1],u=3*v[i+2],h.fromArray(r,a),d.fromArray(r,c),f.fromArray(r,u),p.subVectors(f,d),m.subVectors(h,d),p.cross(m),l[a]+=p.x,l[a+1]+=p.y,l[a+2]+=p.z,l[c]+=p.x,l[c+1]+=p.y,l[c+2]+=p.z,l[u]+=p.x,l[u+1]+=p.y,l[u+2]+=p.z}else for(i=0,o=r.length;i<o;i+=9)h.fromArray(r,i),d.fromArray(r,i+3),f.fromArray(r,i+6),p.subVectors(f,d),m.subVectors(h,d),p.cross(m),l[i]=p.x,l[i+1]=p.y,l[i+2]=p.z,l[i+3]=p.x,l[i+4]=p.y,l[i+5]=p.z,l[i+6]=p.x,l[i+7]=p.y,l[i+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,c=o.itemSize*t;s<a.length;s++,c++)i[c]=a[s];return this}console.error("BufferGeometry.merge(): geometry not an instance of BufferGeometry.",e)},normalizeNormals:function(){var e=new s;return function(){for(var t=this.attributes.normal,r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.normalize(),t.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new U,t=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],o=i.array,a=i.itemSize,s=new o.constructor(t.length*a),c=0,u=0,l=0,h=t.length;l<h;l++){c=t[l]*a;for(var d=0;d<a;d++)s[u++]=o[c++]}e.addAttribute(n,new M(s,a))}var f=this.groups;for(l=0,h=f.length;l<h;l++){var p=f[l];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var a=o[r];i=Array.prototype.slice.call(a.array);e.data.attributes[r]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e},clone:function(){return(new U).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],u=s[t];for(r=0,n=u.length;r<n;r++)c.push(u[r].clone());this.morphAttributes[t]=c}var l=e.groups;for(r=0,n=l.length;r<n;r++){var h=l[r];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),k.prototype=Object.create(_.prototype),k.prototype.constructor=k,B.prototype=Object.create(U.prototype),B.prototype.constructor=B;var z="96",j={LEFT:0,MIDDLE:1,RIGHT:2},V=0,G=1,W=2,H=1,X=2,q=0,Y=1,J=2,Q=0,Z=1,K=2,$=0,ee=1,te=2,re=3,ne=4,ie=5,oe=100,ae=101,se=102,ce=103,ue=104,le=200,he=201,de=202,fe=203,pe=204,me=205,ve=206,ge=207,ye=208,be=209,xe=210,we=0,_e=1,Se=2,Me=3,Te=4,Ae=5,Ee=6,Ce=7,Le=0,Pe=1,Oe=2,Ne=0,Re=1,Ie=2,De=3,Fe=4,Ue=300,ke=301,Be=302,ze=303,je=304,Ve=305,Ge=306,We=307,He=1e3,Xe=1001,qe=1002,Ye=1003,Je=1004,Qe=1005,Ze=1006,Ke=1007,$e=1008,et=1009,tt=1010,rt=1011,nt=1012,it=1013,ot=1014,at=1015,st=1016,ct=1017,ut=1018,lt=1019,ht=1020,dt=1021,ft=1022,pt=1023,mt=1024,vt=1025,gt=pt,yt=1026,bt=1027,xt=33776,wt=33777,_t=33778,St=33779,Mt=35840,Tt=35841,At=35842,Et=35843,Ct=36196,Lt=37808,Pt=37809,Ot=37810,Nt=37811,Rt=37812,It=37813,Dt=37814,Ft=37815,Ut=37816,kt=37817,Bt=37818,zt=37819,jt=37820,Vt=37821,Gt=2201,Wt=2300,Ht=2400,Xt=0,qt=1,Yt=2,Jt=3e3,Qt=3001,Zt=3007,Kt=3002,$t=3004,er=3005,tr=3006,rr=3200,nr=3201,ir=0,or=1,ar=0;function sr(){Object.defineProperty(this,"id",{value:ar++}),this.uuid=o.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=ee,this.side=q,this.flatShading=!1,this.vertexColors=Q,this.opacity=1,this.transparent=!1,this.blendSrc=pe,this.blendDst=me,this.blendEquation=oe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Me,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function cr(e){sr.call(this),this.type="MeshBasicMaterial",this.color=new v(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function ur(e){sr.call(this),this.type="LineBasicMaterial",this.color=new v(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function lr(e,t){this.origin=void 0!==e?e:new s,this.direction=void 0!==t?t:new s}function hr(e,t,r){this.a=void 0!==e?e:new s,this.b=void 0!==t?t:new s,this.c=void 0!==r?r:new s}function dr(e,t){p.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new U,this.material=void 0!==t?t:new cr({color:16777215*Math.random()}),this.drawMode=Xt,this.updateMorphTargets()}function fr(e,t,r){1===r&&console.error("Line: parameter LinePieces no longer supported. Use LineSegments instead."),p.call(this),this.type="Line",this.geometry=void 0!==e?e:new U,this.material=void 0!==t?t:new ur({color:16777215*Math.random()})}sr.prototype=Object.assign(Object.create(u.prototype),{constructor:sr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]="overdraw"===t?Number(r):r:console.warn(this.type+": '"+t+"' is not a property of this material.")}else console.warn(this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;else console.warn("Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==ee&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==q&&(r.side=this.side),this.vertexColors!==Q&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){var i=n(e.textures),o=n(e.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),cr.prototype=Object.create(sr.prototype),cr.prototype.constructor=cr,cr.prototype.isMeshBasicMaterial=!0,cr.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},ur.prototype=Object.create(sr.prototype),ur.prototype.constructor=ur,ur.prototype.isLineBasicMaterial=!0,ur.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Object.assign(lr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("Ray: .at() target is now required"),t=new s),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new s;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("Ray: .closestPointToPoint() target is now required"),t=new s),t.subVectors(e,this.origin);var r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new s;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new s,t=new s,r=new s;return function(n,i,o,a){e.copy(n).add(i).multiplyScalar(.5),t.copy(i).sub(n).normalize(),r.copy(this.origin).sub(e);var s,c,u,l,h=.5*n.distanceTo(i),d=-this.direction.dot(t),f=r.dot(this.direction),p=-r.dot(t),m=r.lengthSq(),v=Math.abs(1-d*d);if(v>0)if(c=d*f-p,l=h*v,(s=d*p-f)>=0)if(c>=-l)if(c<=l){var g=1/v;u=(s*=g)*(s+d*(c*=g)+2*f)+c*(d*s+c+2*p)+m}else c=h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;else c=-h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;else c<=-l?u=-(s=Math.max(0,-(-d*h+f)))*s+(c=s>0?-h:Math.min(Math.max(-h,-p),h))*(c+2*p)+m:c<=l?(s=0,u=(c=Math.min(Math.max(-h,-p),h))*(c+2*p)+m):u=-(s=Math.max(0,-(d*h+f)))*s+(c=s>0?h:Math.min(Math.max(-h,-p),h))*(c+2*p)+m;else c=d>0?-h:h,u=-(s=Math.max(0,-(d*c+f)))*s+c*(c+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(t).multiplyScalar(c).add(e),u}}(),intersectSphere:function(){var e=new s;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,c=n+a;return s<0&&c<0?null:s<0?this.at(c,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var r,n,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,n=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,n=(e.min.x-h.x)*c),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||i>n?null:((i>r||r!=r)&&(r=i),(o<n||n!=n)&&(n=o),l>=0?(a=(e.min.z-h.z)*l,s=(e.max.z-h.z)*l):(a=(e.max.z-h.z)*l,s=(e.min.z-h.z)*l),r>s||a>n?null:((a>r||r!=r)&&(r=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:function(){var e=new s;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new s,t=new s,r=new s,n=new s;return function(i,o,a,s,c){t.subVectors(o,i),r.subVectors(a,i),n.crossVectors(t,r);var u,l=this.direction.dot(n);if(l>0){if(s)return null;u=1}else{if(!(l<0))return null;u=-1,l=-l}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(h<0)return null;var d=u*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>l)return null;var f=-u*e.dot(n);return f<0?null:this.at(f/l,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(hr,{getNormal:function(){var e=new s;return function(t,r,n,i){void 0===i&&(console.warn("Triangle: .getNormal() target is now required"),i=new s),i.subVectors(n,r),e.subVectors(t,r),i.cross(e);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var e=new s,t=new s,r=new s;return function(n,i,o,a,c){e.subVectors(a,i),t.subVectors(o,i),r.subVectors(n,i);var u=e.dot(e),l=e.dot(t),h=e.dot(r),d=t.dot(t),f=t.dot(r),p=u*d-l*l;if(void 0===c&&(console.warn("Triangle: .getBarycoord() target is now required"),c=new s),0===p)return c.set(-2,-1,-1);var m=1/p,v=(d*h-l*f)*m,g=(u*f-l*h)*m;return c.set(1-v-g,g,v)}}(),containsPoint:function(){var e=new s;return function(t,r,n,i){return hr.getBarycoord(t,r,n,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:function(){var e=new s;return function(t,r,n,i,o,a,s,c){return this.getBarycoord(t,r,n,i,e),c.set(0,0),c.addScaledVector(o,e.x),c.addScaledVector(a,e.y),c.addScaledVector(s,e.z),c}}()}),Object.assign(hr.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new s,t=new s;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("Triangle: .getMidpoint() target is now required"),e=new s),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return hr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("Triangle: .getPlane() target is now required"),e=new s),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return hr.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return hr.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,r,n,i){return hr.getUV(e,this.a,this.b,this.c,t,r,n,i)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new s,t=new s,r=new s,n=new s,i=new s,o=new s;return function(a,c){void 0===c&&(console.warn("Triangle: .closestPointToPoint() target is now required"),c=new s);var u,l,h=this.a,d=this.b,f=this.c;e.subVectors(d,h),t.subVectors(f,h),n.subVectors(a,h);var p=e.dot(n),m=t.dot(n);if(p<=0&&m<=0)return c.copy(h);i.subVectors(a,d);var v=e.dot(i),g=t.dot(i);if(v>=0&&g<=v)return c.copy(d);var y=p*g-v*m;if(y<=0&&p>=0&&v<=0)return u=p/(p-v),c.copy(h).addScaledVector(e,u);o.subVectors(a,f);var b=e.dot(o),x=t.dot(o);if(x>=0&&b<=x)return c.copy(f);var w=b*m-p*x;if(w<=0&&m>=0&&x<=0)return l=m/(m-x),c.copy(h).addScaledVector(t,l);var _=v*x-b*g;if(_<=0&&g-v>=0&&b-x>=0)return r.subVectors(f,d),l=(g-v)/(g-v+(b-x)),c.copy(d).addScaledVector(r,l);var S=1/(_+w+y);return u=w*S,l=y*S,c.copy(h).addScaledVector(e,u).addScaledVector(t,l)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),dr.prototype=Object.assign(Object.create(p.prototype),{constructor:dr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return p.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)r=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}},raycast:function(){var e=new a,t=new lr,r=new b,n=new s,i=new s,o=new s,c=new s,u=new s,l=new s,h=new x,d=new x,f=new x,p=new s,m=new s;function v(e,t,r,n,i,o,a,s){if(null===(t.side===Y?n.intersectTriangle(a,o,i,!0,s):n.intersectTriangle(i,o,a,t.side!==J,s)))return null;m.copy(s),m.applyMatrix4(e.matrixWorld);var c=r.ray.origin.distanceTo(m);return c<r.near||c>r.far?null:{distance:c,point:m.clone(),object:e}}function y(e,t,r,a,s,c,u,l,m){n.fromBufferAttribute(s,u),i.fromBufferAttribute(s,l),o.fromBufferAttribute(s,m);var y=v(e,t,r,a,n,i,o,p);if(y){c&&(h.fromBufferAttribute(c,u),d.fromBufferAttribute(c,l),f.fromBufferAttribute(c,m),y.uv=hr.getUV(p,n,i,o,h,d,f,new x));var b=new g(u,l,m);hr.getNormal(n,i,o,b.normal),y.face=b}return y}return function(a,s){var m,g=this.geometry,b=this.material,w=this.matrixWorld;if(void 0!==b&&(null===g.boundingSphere&&g.computeBoundingSphere(),r.copy(g.boundingSphere),r.applyMatrix4(w),!1!==a.ray.intersectsSphere(r)&&(e.getInverse(w),t.copy(a.ray).applyMatrix4(e),null===g.boundingBox||!1!==t.intersectsBox(g.boundingBox))))if(g.isBufferGeometry){var _,S,M,T,A,E,C,L,P,O=g.index,N=g.attributes.position,R=g.attributes.uv,I=g.groups,D=g.drawRange;if(null!==O)if(Array.isArray(b))for(T=0,E=I.length;T<E;T++)for(P=b[(L=I[T]).materialIndex],A=Math.max(L.start,D.start),C=Math.min(L.start+L.count,D.start+D.count);A<C;A+=3)_=O.getX(A),S=O.getX(A+1),M=O.getX(A+2),(m=y(this,P,a,t,N,R,_,S,M))&&(m.faceIndex=Math.floor(A/3),s.push(m));else for(T=Math.max(0,D.start),E=Math.min(O.count,D.start+D.count);T<E;T+=3)_=O.getX(T),S=O.getX(T+1),M=O.getX(T+2),(m=y(this,b,a,t,N,R,_,S,M))&&(m.faceIndex=Math.floor(T/3),s.push(m));else if(void 0!==N)if(Array.isArray(b))for(T=0,E=I.length;T<E;T++)for(P=b[(L=I[T]).materialIndex],A=Math.max(L.start,D.start),C=Math.min(L.start+L.count,D.start+D.count);A<C;A+=3)(m=y(this,P,a,t,N,R,_=A,S=A+1,M=A+2))&&(m.faceIndex=Math.floor(A/3),s.push(m));else for(T=Math.max(0,D.start),E=Math.min(N.count,D.start+D.count);T<E;T+=3)(m=y(this,b,a,t,N,R,_=T,S=T+1,M=T+2))&&(m.faceIndex=Math.floor(T/3),s.push(m))}else if(g.isGeometry){var F,U,k,B,z=Array.isArray(b),j=g.vertices,V=g.faces,G=g.faceVertexUvs[0];G.length>0&&(B=G);for(var W=0,H=V.length;W<H;W++){var X=V[W],q=z?b[X.materialIndex]:b;if(void 0!==q){if(F=j[X.a],U=j[X.b],k=j[X.c],!0===q.morphTargets){var Y=g.morphTargets,J=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var Q=0,Z=Y.length;Q<Z;Q++){var K=J[Q];if(0!==K){var $=Y[Q].vertices;n.addScaledVector(c.subVectors($[X.a],F),K),i.addScaledVector(u.subVectors($[X.b],U),K),o.addScaledVector(l.subVectors($[X.c],k),K)}}n.add(F),i.add(U),o.add(k),F=n,U=i,k=o}if(m=v(this,q,a,t,F,U,k,p)){if(B&&B[W]){var ee=B[W];h.copy(ee[0]),d.copy(ee[1]),f.copy(ee[2]),m.uv=hr.getUV(p,F,U,k,h,d,f,new x)}m.face=X,m.faceIndex=W,s.push(m)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),fr.prototype=Object.assign(Object.create(p.prototype),{constructor:fr,isLine:!0,computeLineDistances:function(){var e=new s,t=new s;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],o=1,a=n.count;o<a;o++)e.fromBufferAttribute(n,o-1),t.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=e.distanceTo(t);r.addAttribute("lineDistance",new N(i,1))}else console.error("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;(i=r.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var e=new a,t=new lr,r=new b;return function(n,i){var o=n.linePrecision,a=this.geometry,c=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(c),r.radius+=o,!1!==n.ray.intersectsSphere(r)){e.getInverse(c),t.copy(n.ray).applyMatrix4(e);var u=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,h=new s,d=new s,f=new s,p=new s,m=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var v=a.index,g=a.attributes.position.array;if(null!==v)for(var y=v.array,b=0,x=y.length-1;b<x;b+=m){var w=y[b],_=y[b+1];if(h.fromArray(g,3*w),d.fromArray(g,3*_),!(t.distanceSqToSegment(h,d,p,f)>l))p.applyMatrix4(this.matrixWorld),(T=n.ray.origin.distanceTo(p))<n.near||T>n.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(b=0,x=g.length/3-1;b<x;b+=m){if(h.fromArray(g,3*b),d.fromArray(g,3*b+3),!(t.distanceSqToSegment(h,d,p,f)>l))p.applyMatrix4(this.matrixWorld),(T=n.ray.origin.distanceTo(p))<n.near||T>n.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else if(a.isGeometry){var S=a.vertices,M=S.length;for(b=0;b<M-1;b+=m){var T;if(!(t.distanceSqToSegment(S[b],S[b+1],p,f)>l))p.applyMatrix4(this.matrixWorld),(T=n.ray.origin.distanceTo(p))<n.near||T>n.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var pr=function(){function e(e,t){this.mesh=e,this.iks=t||[],this._valid()}function t(e,t){p.call(this),this.root=e,this.iks=t||[],this.matrix.copy(e.matrixWorld),this.matrixAutoUpdate=!1,this.sphereGeometry=new B(.25,16,8),this.targetSphereMaterial=new cr({color:new v(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new cr({color:new v(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new cr({color:new v(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new ur({color:new v(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init()}return e.prototype={constructor:e,update:function(){var e=new c,t=new s,r=new s,n=new s,i=new s,o=new s,a=new c,u=new s,l=new s,h=new s;return function(){for(var s=this.mesh.skeleton.bones,c=this.iks,d=Math,f=0,p=c.length;f<p;f++){var m=c[f],v=s[m.effector],g=s[m.target];t.setFromMatrixPosition(g.matrixWorld);for(var y=m.links,b=void 0!==m.iteration?m.iteration:1,x=0;x<b;x++){for(var w=!1,_=0,S=y.length;_<S;_++){var M=s[y[_].index];if(!1===y[_].enabled)break;var T=y[_].limitation,A=y[_].rotationMin,E=y[_].rotationMax;M.matrixWorld.decompose(o,a,u),a.inverse(),n.setFromMatrixPosition(v.matrixWorld),i.subVectors(n,o),i.applyQuaternion(a),i.normalize(),r.subVectors(t,o),r.applyQuaternion(a),r.normalize();var C=r.dot(i);if(C>1?C=1:C<-1&&(C=-1),!((C=d.acos(C))<1e-5)){if(void 0!==m.minAngle&&C<m.minAngle&&(C=m.minAngle),void 0!==m.maxAngle&&C>m.maxAngle&&(C=m.maxAngle),l.crossVectors(i,r),l.normalize(),e.setFromAxisAngle(l,C),M.quaternion.multiply(e),void 0!==T){var L=M.quaternion.w;L>1&&(L=1);var P=d.sqrt(1-L*L);M.quaternion.set(T.x*P,T.y*P,T.z*P,L)}void 0!==A&&M.rotation.setFromVector3(M.rotation.toVector3(h).max(A)),void 0!==E&&M.rotation.setFromVector3(M.rotation.toVector3(h).min(E)),M.updateMatrixWorld(!0),w=!0}}if(!w)break}}return this}}(),createHelper:function(){return new t(this.mesh,this.mesh.geometry.userData.MMD.iks)},_valid:function(){for(var e=this.iks,t=this.mesh.skeleton.bones,r=0,n=e.length;r<n;r++){var i,o,a=e[r],s=t[a.effector],c=a.links;i=s;for(var u=0,l=c.length;u<l;u++)o=t[c[u].index],i.parent!==o&&console.warn("CCDIKSolver: bone "+i.name+" is not the child of bone "+o.name),i=o}}},t.prototype=Object.assign(Object.create(p.prototype),{constructor:t,updateMatrixWorld:function(){var e=new a,t=new s;function r(e,r){return t.setFromMatrixPosition(e.matrixWorld).applyMatrix4(r)}function n(e,t,n,i){var o=r(n,i);e[3*t+0]=o.x,e[3*t+1]=o.y,e[3*t+2]=o.z}return function(t){var i=this.root;if(this.visible){var o=0,a=this.iks,s=i.skeleton.bones;e.getInverse(i.matrixWorld);for(var c=0,u=a.length;c<u;c++){var l=a[c],h=s[l.target],d=s[l.effector],f=this.children[o++],m=this.children[o++];f.position.copy(r(h,e)),m.position.copy(r(d,e));for(var v=0,g=l.links.length;v<g;v++){var y=s[l.links[v].index];this.children[o++].position.copy(r(y,e))}var b=this.children[o++],x=b.geometry.attributes.position.array;n(x,0,h,e),n(x,1,d,e);for(v=0,g=l.links.length;v<g;v++){n(x,v+2,y=s[l.links[v].index],e)}b.geometry.attributes.position.needsUpdate=!0}}this.matrix.copy(i.matrixWorld),p.prototype.updateMatrixWorld.call(this,t)}}(),_init:function(){var e=this,t=this.iks;function r(t){return new fr(function(e){var t=new U,r=new Float32Array(3*(2+e.links.length));return t.addAttribute("position",new M(r,3)),t}(t),e.lineMaterial)}for(var n=0,i=t.length;n<i;n++){var o=t[n];this.add(new dr(e.sphereGeometry,e.targetSphereMaterial)),this.add(new dr(e.sphereGeometry,e.effectorSphereMaterial));for(var a=0,s=o.links.length;a<s;a++)this.add(new dr(e.sphereGeometry,e.linkSphereMaterial));this.add(r(o))}}}),e}();function mr(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n=t.tracks,i=n.length,o=new Array(i),a={endingStart:Ht,endingEnd:Ht},s=0;s!==i;++s){var c=n[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Gt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function vr(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function gr(e,t,r,n){vr.call(this,e,t,r,n)}Object.assign(mr.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration,o=i/n,a=n/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+r,c[0]=e/a,c[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*r;if(o<0||0===r)return;this._startTime=null,t=r*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,u=this._propertyBindings,l=0,h=c.length;l!==h;++l)c[l].evaluate(a),u[l].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,r=this._clip.duration,n=this.loop,i=this._loopCount,o=2202===n;if(0===e)return-1===i?t:o&&1==(1&i)?r-t:t;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=r||t<0){var a=Math.floor(t/r);t-=r*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=t,r-t}return this.time=t,t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=e?this.zeroSlopeAtStart?2401:Ht:2402,n.endingEnd=t?this.zeroSlopeAtEnd?2401:Ht:2402)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=r,this}}),Object.assign(vr.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var o;r:{n:if(!(e<n)){for(var a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,e<(n=t[++r]))break t}o=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break t}o=r,r=0}for(;r<o;){var c=r+o>>>1;e<t[c]?o=c:r=c+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n,o=0;o!==n;++o)t[o]=r[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(vr.prototype,{beforeStart_:vr.prototype.copySampleValue_,afterEnd_:vr.prototype.copySampleValue_}),gr.prototype=Object.assign(Object.create(vr.prototype),{constructor:gr,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=(r-t)/(n-t),l=1-u,h=0;h!==a;++h)i[h]=o[c+h]*l+o[s+h]*u;return i}});function yr(e,t,r){var n=r||br.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function br(e,t,r){this.path=t,this.parsedPath=r||br.parseTrackName(t),this.node=br.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function xr(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(yr.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(br,{Composite:yr,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new br.Composite(e,t,r):new br(e,t,r)},sanitizeNodeName:function(){var e=new RegExp("[\\[\\]\\.:\\/]","g");return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^\\[\\]\\.:\\/]",t="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",e),n=/(WCOD+)?/.source.replace("WCOD",t),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),a=new RegExp("^"+r+n+i+o+"$"),s=["material","materials","bones"];return function(e){var t=a.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==s.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var n=function(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===t||i.uuid===t)return i;var o=n(i.children);if(o)return o}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(br.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=br.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var o=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[r])return void console.error("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==o){if(void 0===e[o])return void console.error("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=t.nodeName;console.error("PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e)}}else console.error("PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(br.prototype,{_getValue_unbound:br.prototype.getValue,_setValue_unbound:br.prototype.setValue}),Object.assign(xr.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)r[i+a]=r[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(r,n,a,1-i,t)}for(var s=t,c=t+t;s!==c;++s)if(r[s]!==r[s+t]){o.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r,o=n;i!==o;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)e[t+o]=e[r+o]},_slerp:function(e,t,r,n){c.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[r+a]*n}}});var wr={arraySlice:function(e,t,r){return wr.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=new Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,r,n){for(var i=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(t.push(o.time),r.push.apply(r,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(t.push(o.time),a.toArray(r,r.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(t.push(o.time),r.push(a)),o=e[i++]}while(void 0!==o)}}};function _r(e,t,r,n){vr.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Sr(e,t,r,n){vr.call(this,e,t,r,n)}function Mr(e,t,r,n){if(void 0===e)throw new Error("KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=wr.convertArray(t,this.TimeBufferType),this.values=wr.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function Tr(e,t,r){Mr.call(this,e,t,r)}function Ar(e,t,r,n){Mr.call(this,e,t,r,n)}function Er(e,t,r,n){Mr.call(this,e,t,r,n)}function Cr(e,t,r,n){vr.call(this,e,t,r,n)}function Lr(e,t,r,n){Mr.call(this,e,t,r,n)}function Pr(e,t,r,n){Mr.call(this,e,t,r,n)}function Or(e,t,r,n){Mr.call(this,e,t,r,n)}function Nr(e,t,r){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.uuid=o.generateUUID(),this.duration<0&&this.resetDuration()}function Rr(e){if(void 0===e.type)throw new Error("KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Er;case"vector":case"vector2":case"vector3":case"vector4":return Or;case"color":return Ar;case"quaternion":return Lr;case"bool":case"boolean":return Tr;case"string":return Pr}throw new Error("KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var r=[],n=[];wr.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function Ir(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Dr(){p.call(this),this.type="Bone"}function Fr(e,t,r,n,i,o){_.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Ur(e,t,r,n,i,o)),this.mergeVertices()}function Ur(e,t,r,n,i,o){U.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1;var c=[],u=[],l=[],h=[],d=0,f=0;function p(e,t,r,n,i,o,p,m,v,g,y){var b,x,w=o/v,_=p/g,S=o/2,M=p/2,T=m/2,A=v+1,E=g+1,C=0,L=0,P=new s;for(x=0;x<E;x++){var O=x*_-M;for(b=0;b<A;b++){var N=b*w-S;P[e]=N*n,P[t]=O*i,P[r]=T,u.push(P.x,P.y,P.z),P[e]=0,P[t]=0,P[r]=m>0?1:-1,l.push(P.x,P.y,P.z),h.push(b/v),h.push(1-x/g),C+=1}}for(x=0;x<g;x++)for(b=0;b<v;b++){var R=d+b+A*x,I=d+b+A*(x+1),D=d+(b+1)+A*(x+1),F=d+(b+1)+A*x;c.push(R,I,F),c.push(I,D,F),L+=6}a.addGroup(f,L,y),f+=L,d+=C}p("z","y","x",-1,-1,r,t,e,o=Math.floor(o)||1,i,0),p("z","y","x",1,-1,r,t,-e,o,i,1),p("x","z","y",1,1,e,r,t,n,o,2),p("x","z","y",1,-1,e,r,-t,n,o,3),p("x","y","z",1,-1,e,t,r,n,i,4),p("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(c),this.addAttribute("position",new N(u,3)),this.addAttribute("normal",new N(l,3)),this.addAttribute("uv",new N(h,2))}function kr(e,t,r,n,i,o,a,s){_.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Br(e,t,r,n,i,o,a,s)),this.mergeVertices()}function Br(e,t,r,n,i,o,a,c){U.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:c};var u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,c=void 0!==c?c:2*Math.PI;var l=[],h=[],d=[],f=[],p=0,m=[],v=r/2,g=0;function y(r){var i,o,m,y=new x,b=new s,w=0,_=!0===r?e:t,S=!0===r?1:-1;for(o=p,i=1;i<=n;i++)h.push(0,v*S,0),d.push(0,S,0),f.push(.5,.5),p++;for(m=p,i=0;i<=n;i++){var M=i/n*c+a,T=Math.cos(M),A=Math.sin(M);b.x=_*A,b.y=v*S,b.z=_*T,h.push(b.x,b.y,b.z),d.push(0,S,0),y.x=.5*T+.5,y.y=.5*A*S+.5,f.push(y.x,y.y),p++}for(i=0;i<n;i++){var E=o+i,C=m+i;!0===r?l.push(C,C+1,E):l.push(C+1,C,E),w+=3}u.addGroup(g,w,!0===r?1:2),g+=w}!function(){var o,y,b=new s,x=new s,w=0,_=(t-e)/r;for(y=0;y<=i;y++){var S=[],M=y/i,T=M*(t-e)+e;for(o=0;o<=n;o++){var A=o/n,E=A*c+a,C=Math.sin(E),L=Math.cos(E);x.x=T*C,x.y=-M*r+v,x.z=T*L,h.push(x.x,x.y,x.z),b.set(C,_,L).normalize(),d.push(b.x,b.y,b.z),f.push(A,1-M),S.push(p++)}m.push(S)}for(o=0;o<n;o++)for(y=0;y<i;y++){var P=m[y][o],O=m[y+1][o],N=m[y+1][o+1],R=m[y][o+1];l.push(P,O,R),l.push(O,N,R),w+=6}u.addGroup(g,w,0),g+=w}(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(l),this.addAttribute("position",new N(h,3)),this.addAttribute("normal",new N(d,3)),this.addAttribute("uv",new N(f,2))}_r.prototype=Object.assign(Object.create(vr.prototype),{constructor:_r,DefaultSettings_:{endingStart:Ht,endingEnd:Ht},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,o=e+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=e,a=2*t-r;break;case 2402:a=t+n[i=n.length-2]-n[i+1];break;default:i=e,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*r-t;break;case 2402:o=1,s=r+n[1]-n[0];break;default:o=e-1,s=t}var c=.5*(r-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-r),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(r-t)/(n-t),p=f*f,m=p*f,v=-h*m+2*h*p-h*f,g=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,x=0;x!==a;++x)i[x]=v*o[u+x]+g*o[c+x]+y*o[s+x]+b*o[l+x];return i}}),Sr.prototype=Object.assign(Object.create(vr.prototype),{constructor:Sr,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Mr,{toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:wr.convertArray(e.times,Array),values:wr.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(Mr.prototype,{constructor:Mr,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Sr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new gr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new _r(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Wt:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("KeyframeTrack:",r),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Wt;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<e;)++i;for(;-1!==o&&r[o]>t;)--o;if(++o,0!==i||o!==n){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=wr.arraySlice(r,i,o),this.values=wr.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=r[a];if("number"==typeof s&&isNaN(s)){console.error("KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&wr.isTypedArray(n)){a=0;for(var c=n.length;a!==c;++a){var u=n[a];if(isNaN(u)){console.error("KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=2302===this.getInterpolation(),i=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(n)s=!0;else for(var u=a*r,l=u-r,h=u+r,d=0;d!==r;++d){var f=t[u+d];if(f!==t[l+d]||f!==t[h+d]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var p=a*r,m=i*r;for(d=0;d!==r;++d)t[m+d]=t[p+d]}++i}}if(o>0){e[i]=e[o];for(p=o*r,m=i*r,d=0;d!==r;++d)t[m+d]=t[p+d];++i}return i!==e.length&&(this.times=wr.arraySlice(e,0,i),this.values=wr.arraySlice(t,0,i*r)),this}}),Tr.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Tr,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ar.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Ar,ValueTypeName:"color"}),Er.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Er,ValueTypeName:"number"}),Cr.prototype=Object.assign(Object.create(vr.prototype),{constructor:Cr,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=(r-t)/(n-t),l=s+a;s!==l;s+=4)c.slerpFlat(i,0,o,s-a,o,s,u);return i}}),Lr.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Lr,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Cr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Pr.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Pr,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Or.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Or,ValueTypeName:"vector"}),Object.assign(Nr,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,o=r.length;i!==o;++i)t.push(Rr(r[i]).scale(n));return new Nr(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=r.length;i!==o;++i)t.push(Mr.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var u=wr.getKeyframeOrder(s);s=wr.sortedArray(s,1,u),c=wr.sortedArray(c,1,u),n||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new Er(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/r))}return new Nr(e,-1,o)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(i);if(c&&c.length>1){var u=n[h=c[1]];u||(n[h]=u=[]),u.push(s)}}var l=[];for(var h in n)l.push(Nr.CreateFromMorphTargetSequence(h,n[h],t,r));return l},parseAnimation:function(e,t){if(!e)return console.error("AnimationClip: No animation in JSONLoader data."),null;for(var r=function(e,t,r,n,i){if(0!==r.length){var o=[],a=[];wr.flattenJSON(r,o,a,n),0!==o.length&&i.push(new e(t,o,a))}},n=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var u=s[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var l={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)l[u[h].morphTargets[d]]=-1;for(var f in l){var p=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var v=u[h];p.push(v.time),m.push(v.morphTarget===f?1:0)}n.push(new Er(".morphTargetInfluence["+f+"]",p,m))}o=l.length*(a||1)}else{var g=".bones["+t[c].name+"]";r(Or,g+".position",u,"pos",n),r(Lr,g+".quaternion",u,"rot",n),r(Or,g+".scale",u,"scl",n)}}return 0===n.length?null:new Nr(i,o,n)}}),Object.assign(Nr.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Ir.prototype=Object.assign(Object.create(u.prototype),{constructor:Ir,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,a=e._interpolants,s=r.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var h=n[l],d=h.name,f=u[d];if(void 0!==f)o[l]=f;else{if(void 0!==(f=o[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(f=new xr(br.create(r,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),o[l]=f}a[l].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],o=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new gr(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?Nr.findByName(r,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[n];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new mr(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,n),u},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?Nr.findByName(r,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==r;++a){t[a]._update(n,e,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var u=c._cacheIndex,l=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(c)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Dr.prototype=Object.assign(Object.create(p.prototype),{constructor:Dr,isBone:!0}),Fr.prototype=Object.create(_.prototype),Fr.prototype.constructor=Fr,Ur.prototype=Object.create(U.prototype),Ur.prototype.constructor=Ur,kr.prototype=Object.create(_.prototype),kr.prototype.constructor=kr,Br.prototype=Object.create(U.prototype),Br.prototype.constructor=Br;var zr=function(){function e(e,r,n,i){if("undefined"==typeof Ammo)throw new Error("MMDPhysics: Import ammo.js https://github.com/kripken/ammo.js");n=n||[],i=i||{},this.manager=new t,this.mesh=e,this.unitStep=void 0!==i.unitStep?i.unitStep:1/65,this.maxStepNum=void 0!==i.maxStepNum?i.maxStepNum:3,this.gravity=new s(0,-98,0),void 0!==i.gravity&&this.gravity.copy(gravity),this.world=void 0!==i.world?i.world:null,this.bodies=[],this.constraints=[],this._init(e,r,n)}function t(){this.threeVector3s=[],this.threeMatrix4s=[],this.threeQuaternions=[],this.threeEulers=[],this.transforms=[],this.quaternions=[],this.vector3s=[]}function r(e,t,r,n){this.mesh=e,this.world=t,this.params=r,this.manager=n,this.body=null,this.bone=null,this.boneOffsetForm=null,this.boneOffsetFormInverse=null,this._init()}function n(e,t,r,n,i,o){this.mesh=e,this.world=t,this.bodyA=r,this.bodyB=n,this.params=i,this.manager=o,this.constraint=null,this._init()}function i(e,t){p.call(this),this.root=e,this.physics=t,this.matrix.copy(e.matrixWorld),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new cr({color:new v(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new cr({color:new v(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new cr({color:new v(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init()}return e.prototype={constructor:e,update:function(e){var t,r=this.manager,n=this.mesh,i=!1,o=r.allocThreeVector3(),a=r.allocThreeQuaternion(),s=r.allocThreeVector3();return n.matrixWorld.decompose(o,a,s),1===s.x&&1===s.y&&1===s.z||(i=!0),i&&(null!==(t=n.parent)&&(n.parent=null),s.copy(this.mesh.scale),n.scale.set(1,1,1),n.updateMatrixWorld(!0)),this._updateRigidBodies(),this._stepSimulation(e),this._updateBones(),i&&(null!==t&&(t.parent=t),n.scale.copy(s)),r.freeThreeVector3(s),r.freeThreeQuaternion(a),r.freeThreeVector3(o),this},reset:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].reset();return this},warmup:function(e){for(var t=0;t<e;t++)this.update(1/60);return this},setGravity:function(e){return this.world.setGravity(new Ammo.btVector3(e.x,e.y,e.z)),this.gravity.copy(e),this},createHelper:function(){return new i(this.mesh,this)},_init:function(e,t,r){var n=this.manager,i=e.parent;null!==i&&(i=null);var o=n.allocThreeVector3(),a=n.allocThreeQuaternion(),s=n.allocThreeVector3();o.copy(e.position),a.copy(e.quaternion),s.copy(e.scale),e.position.set(0,0,0),e.quaternion.set(0,0,0,1),e.scale.set(1,1,1),e.updateMatrixWorld(!0),null===this.world&&(this.world=this._createWorld(),this.setGravity(this.gravity)),this._initRigidBodies(t),this._initConstraints(r),null!==i&&(e.parent=i),e.position.copy(o),e.quaternion.copy(a),e.scale.copy(s),e.updateMatrixWorld(!0),this.reset(),n.freeThreeVector3(o),n.freeThreeQuaternion(a),n.freeThreeVector3(s)},_createWorld:function(){var e=new Ammo.btDefaultCollisionConfiguration,t=new Ammo.btCollisionDispatcher(e),r=new Ammo.btDbvtBroadphase,n=new Ammo.btSequentialImpulseConstraintSolver;return new Ammo.btDiscreteDynamicsWorld(t,r,n,e)},_initRigidBodies:function(e){for(var t=0,n=e.length;t<n;t++)this.bodies.push(new r(this.mesh,this.world,e[t],this.manager))},_initConstraints:function(e){for(var t=0,r=e.length;t<r;t++){var i=e[t],o=this.bodies[i.rigidBodyIndex1],a=this.bodies[i.rigidBodyIndex2];this.constraints.push(new n(this.mesh,this.world,o,a,i,this.manager))}},_stepSimulation:function(e){var t=this.unitStep,r=e,n=1+(e/t|0);r<t&&(r=t,n=1),n>this.maxStepNum&&(n=this.maxStepNum),this.world.stepSimulation(r,n,t)},_updateRigidBodies:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateFromBone()},_updateBones:function(){for(var e=0,t=this.bodies.length;e<t;e++)this.bodies[e].updateBone()}},t.prototype={constructor:t,allocThreeVector3:function(){return this.threeVector3s.length>0?this.threeVector3s.pop():new s},freeThreeVector3:function(e){this.threeVector3s.push(e)},allocThreeMatrix4:function(){return this.threeMatrix4s.length>0?this.threeMatrix4s.pop():new a},freeThreeMatrix4:function(e){this.threeMatrix4s.push(e)},allocThreeQuaternion:function(){return this.threeQuaternions.length>0?this.threeQuaternions.pop():new c},freeThreeQuaternion:function(e){this.threeQuaternions.push(e)},allocThreeEuler:function(){return this.threeEulers.length>0?this.threeEulers.pop():new l},freeThreeEuler:function(e){this.threeEulers.push(e)},allocTransform:function(){return this.transforms.length>0?this.transforms.pop():new Ammo.btTransform},freeTransform:function(e){this.transforms.push(e)},allocQuaternion:function(){return this.quaternions.length>0?this.quaternions.pop():new Ammo.btQuaternion},freeQuaternion:function(e){this.quaternions.push(e)},allocVector3:function(){return this.vector3s.length>0?this.vector3s.pop():new Ammo.btVector3},freeVector3:function(e){this.vector3s.push(e)},setIdentity:function(e){e.setIdentity()},getBasis:function(e){var t=this.allocQuaternion();return e.getBasis().getRotation(t),t},getBasisAsMatrix3:function(e){var t=this.getBasis(e),r=this.quaternionToMatrix3(t);return this.freeQuaternion(t),r},getOrigin:function(e){return e.getOrigin()},setOrigin:function(e,t){e.getOrigin().setValue(t.x(),t.y(),t.z())},copyOrigin:function(e,t){var r=t.getOrigin();this.setOrigin(e,r)},setBasis:function(e,t){e.setRotation(t)},setBasisFromMatrix3:function(e,t){var r=this.matrix3ToQuaternion(t);this.setBasis(e,r),this.freeQuaternion(r)},setOriginFromArray3:function(e,t){e.getOrigin().setValue(t[0],t[1],t[2])},setOriginFromThreeVector3:function(e,t){e.getOrigin().setValue(t.x,t.y,t.z)},setBasisFromArray3:function(e,t){var r=this.allocThreeQuaternion(),n=this.allocThreeEuler();n.set(t[0],t[1],t[2]),this.setBasisFromThreeQuaternion(e,r.setFromEuler(n)),this.freeThreeEuler(n),this.freeThreeQuaternion(r)},setBasisFromThreeQuaternion:function(e,t){var r=this.allocQuaternion();r.setX(t.x),r.setY(t.y),r.setZ(t.z),r.setW(t.w),this.setBasis(e,r),this.freeQuaternion(r)},multiplyTransforms:function(e,t){var r=this.allocTransform();this.setIdentity(r);var n=this.getBasisAsMatrix3(e),i=this.getBasisAsMatrix3(t),o=this.getOrigin(e),a=this.getOrigin(t),s=this.multiplyMatrix3ByVector3(n,a),c=this.addVector3(s,o);this.setOrigin(r,c);var u=this.multiplyMatrices3(n,i);return this.setBasisFromMatrix3(r,u),this.freeVector3(s),this.freeVector3(c),r},inverseTransform:function(e){var t=this.allocTransform(),r=this.getBasisAsMatrix3(e),n=this.getOrigin(e),i=this.transposeMatrix3(r),o=this.negativeVector3(n),a=this.multiplyMatrix3ByVector3(i,o);return this.setOrigin(t,a),this.setBasisFromMatrix3(t,i),this.freeVector3(o),this.freeVector3(a),t},multiplyMatrices3:function(e,t){var r=[],n=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),o=this.rowOfMatrix3(e,2),a=this.columnOfMatrix3(t,0),s=this.columnOfMatrix3(t,1),c=this.columnOfMatrix3(t,2);return r[0]=this.dotVectors3(n,a),r[1]=this.dotVectors3(n,s),r[2]=this.dotVectors3(n,c),r[3]=this.dotVectors3(i,a),r[4]=this.dotVectors3(i,s),r[5]=this.dotVectors3(i,c),r[6]=this.dotVectors3(o,a),r[7]=this.dotVectors3(o,s),r[8]=this.dotVectors3(o,c),this.freeVector3(n),this.freeVector3(i),this.freeVector3(o),this.freeVector3(a),this.freeVector3(s),this.freeVector3(c),r},addVector3:function(e,t){var r=this.allocVector3();return r.setValue(e.x()+t.x(),e.y()+t.y(),e.z()+t.z()),r},dotVectors3:function(e,t){return e.x()*t.x()+e.y()*t.y()+e.z()*t.z()},rowOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[3*t+0],e[3*t+1],e[3*t+2]),r},columnOfMatrix3:function(e,t){var r=this.allocVector3();return r.setValue(e[t+0],e[t+3],e[t+6]),r},negativeVector3:function(e){var t=this.allocVector3();return t.setValue(-e.x(),-e.y(),-e.z()),t},multiplyMatrix3ByVector3:function(e,t){var r=this.allocVector3(),n=this.rowOfMatrix3(e,0),i=this.rowOfMatrix3(e,1),o=this.rowOfMatrix3(e,2),a=this.dotVectors3(n,t),s=this.dotVectors3(i,t),c=this.dotVectors3(o,t);return r.setValue(a,s,c),this.freeVector3(n),this.freeVector3(i),this.freeVector3(o),r},transposeMatrix3:function(e){var t=[];return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},quaternionToMatrix3:function(e){var t=[],r=e.x(),n=e.y(),i=e.z(),o=e.w(),a=r*r,s=n*n,c=i*i,u=r*n,l=n*i,h=i*r,d=r*o,f=n*o,p=i*o;return t[0]=1-2*(s+c),t[1]=2*(u-p),t[2]=2*(h+f),t[3]=2*(u+p),t[4]=1-2*(c+a),t[5]=2*(l-d),t[6]=2*(h-f),t[7]=2*(l+d),t[8]=1-2*(a+s),t},matrix3ToQuaternion:function(e){var t,r,n,i,o,a=e[0]+e[4]+e[8];a>0?(o=.25*(t=2*Math.sqrt(a+1)),r=(e[7]-e[5])/t,n=(e[2]-e[6])/t,i=(e[3]-e[1])/t):e[0]>e[4]&&e[0]>e[8]?(t=2*Math.sqrt(1+e[0]-e[4]-e[8]),o=(e[7]-e[5])/t,r=.25*t,n=(e[1]+e[3])/t,i=(e[2]+e[6])/t):e[4]>e[8]?(t=2*Math.sqrt(1+e[4]-e[0]-e[8]),o=(e[2]-e[6])/t,r=(e[1]+e[3])/t,n=.25*t,i=(e[5]+e[7])/t):(t=2*Math.sqrt(1+e[8]-e[0]-e[4]),o=(e[3]-e[1])/t,r=(e[2]+e[6])/t,n=(e[5]+e[7])/t,i=.25*t);var s=this.allocQuaternion();return s.setX(r),s.setY(n),s.setZ(i),s.setW(o),s}},r.prototype={constructor:e.RigidBody,reset:function(){return this._setTransformFromBone(),this},updateFromBone:function(){return-1!==this.params.boneIndex&&0===this.params.type&&this._setTransformFromBone(),this},updateBone:function(){return 0===this.params.type||-1===this.params.boneIndex?this:(this._updateBoneRotation(),1===this.params.type&&this._updateBonePosition(),this.bone.updateMatrixWorld(!0),2===this.params.type&&this._setPositionFromBone(),this)},_init:function(){var e=this.manager,t=this.params,r=this.mesh.skeleton.bones,n=-1===t.boneIndex?new Dr:r[t.boneIndex],i=function(e){switch(e.shapeType){case 0:return new Ammo.btSphereShape(e.width);case 1:return new Ammo.btBoxShape(new Ammo.btVector3(e.width,e.height,e.depth));case 2:return new Ammo.btCapsuleShape(e.width,e.height);default:throw"unknown shape type "+e.shapeType}}(t),o=0===t.type?0:t.weight,a=e.allocVector3();a.setValue(0,0,0),0!==o&&i.calculateLocalInertia(o,a);var s=e.allocTransform();e.setIdentity(s),e.setOriginFromArray3(s,t.position),e.setBasisFromArray3(s,t.rotation);var c=e.allocThreeVector3(),u=e.allocTransform();e.setIdentity(u),e.setOriginFromThreeVector3(u,n.getWorldPosition(c));var l=e.multiplyTransforms(u,s),h=new Ammo.btDefaultMotionState(l),d=new Ammo.btRigidBodyConstructionInfo(o,h,i,a);d.set_m_friction(t.friction),d.set_m_restitution(t.restitution);var f=new Ammo.btRigidBody(d);0===t.type&&(f.setCollisionFlags(2|f.getCollisionFlags()),f.setActivationState(4)),f.setDamping(t.positionDamping,t.rotationDamping),f.setSleepingThresholds(0,0),this.world.addRigidBody(f,1<<t.groupIndex,t.groupTarget),this.body=f,this.bone=n,this.boneOffsetForm=s,this.boneOffsetFormInverse=e.inverseTransform(s),e.freeVector3(a),e.freeTransform(l),e.freeTransform(u),e.freeThreeVector3(c)},_getBoneTransform:function(){var e=this.manager,t=e.allocThreeVector3(),r=e.allocThreeQuaternion(),n=e.allocThreeVector3();this.bone.matrixWorld.decompose(t,r,n);var i=e.allocTransform();e.setOriginFromThreeVector3(i,t),e.setBasisFromThreeQuaternion(i,r);var o=e.multiplyTransforms(i,this.boneOffsetForm);return e.freeTransform(i),e.freeThreeVector3(n),e.freeThreeQuaternion(r),e.freeThreeVector3(t),o},_getWorldTransformForBone:function(){var e=this.manager,t=e.allocTransform();this.body.getMotionState().getWorldTransform(t);var r=e.multiplyTransforms(t,this.boneOffsetFormInverse);return e.freeTransform(t),r},_setTransformFromBone:function(){var e=this.manager,t=this._getBoneTransform();this.body.setCenterOfMassTransform(t),this.body.getMotionState().setWorldTransform(t),e.freeTransform(t)},_setPositionFromBone:function(){var e=this.manager,t=this._getBoneTransform(),r=e.allocTransform();this.body.getMotionState().getWorldTransform(r),e.copyOrigin(r,t),this.body.setCenterOfMassTransform(r),this.body.getMotionState().setWorldTransform(r),e.freeTransform(r),e.freeTransform(t)},_updateBoneRotation:function(){var e=this.manager,t=this._getWorldTransformForBone(),r=e.getBasis(t),n=e.allocThreeQuaternion(),i=e.allocThreeQuaternion(),o=e.allocThreeQuaternion();n.set(r.x(),r.y(),r.z(),r.w()),i.setFromRotationMatrix(this.bone.matrixWorld),i.conjugate(),i.multiply(n),o.setFromRotationMatrix(this.bone.matrix),this.bone.quaternion.copy(i.multiply(o)),e.freeThreeQuaternion(n),e.freeThreeQuaternion(i),e.freeThreeQuaternion(o),e.freeQuaternion(r),e.freeTransform(t)},_updateBonePosition:function(){var e=this.manager,t=this._getWorldTransformForBone(),r=e.allocThreeVector3(),n=e.getOrigin(t);r.set(n.x(),n.y(),n.z());var i=this.bone.worldToLocal(r);this.bone.position.add(i),e.freeThreeVector3(r),e.freeTransform(t)}},n.prototype={constructor:n,_init:function(){var e=this.manager,t=this.params,r=this.bodyA,n=this.bodyB,i=e.allocTransform();e.setIdentity(i),e.setOriginFromArray3(i,t.position),e.setBasisFromArray3(i,t.rotation);var o=e.allocTransform(),a=e.allocTransform();r.body.getMotionState().getWorldTransform(o),n.body.getMotionState().getWorldTransform(a);var s=e.inverseTransform(o),c=e.inverseTransform(a),u=e.multiplyTransforms(s,i),l=e.multiplyTransforms(c,i),h=new Ammo.btGeneric6DofSpringConstraint(r.body,n.body,u,l,!0),d=e.allocVector3(),f=e.allocVector3(),p=e.allocVector3(),m=e.allocVector3();d.setValue(t.translationLimitation1[0],t.translationLimitation1[1],t.translationLimitation1[2]),f.setValue(t.translationLimitation2[0],t.translationLimitation2[1],t.translationLimitation2[2]),p.setValue(t.rotationLimitation1[0],t.rotationLimitation1[1],t.rotationLimitation1[2]),m.setValue(t.rotationLimitation2[0],t.rotationLimitation2[1],t.rotationLimitation2[2]),h.setLinearLowerLimit(d),h.setLinearUpperLimit(f),h.setAngularLowerLimit(p),h.setAngularUpperLimit(m);for(var v=0;v<3;v++)0!==t.springPosition[v]&&(h.enableSpring(v,!0),h.setStiffness(v,t.springPosition[v]));for(v=0;v<3;v++)0!==t.springRotation[v]&&(h.enableSpring(v+3,!0),h.setStiffness(v+3,t.springRotation[v]));if(void 0!==h.setParam)for(v=0;v<6;v++)h.setParam(2,.475,v);this.world.addConstraint(h,!0),this.constraint=h,e.freeTransform(i),e.freeTransform(o),e.freeTransform(a),e.freeTransform(s),e.freeTransform(c),e.freeTransform(u),e.freeTransform(l),e.freeVector3(d),e.freeVector3(f),e.freeVector3(p),e.freeVector3(m)}},i.prototype=Object.assign(Object.create(p.prototype),{constructor:i,updateMatrixWorld:function(){var e=new s,t=new c,r=new s,n=new a;return function(i){var o=this.root;if(this.visible){var a=this.physics.bodies;n.copy(o.matrixWorld).decompose(e,t,r).compose(e,t,r.set(1,1,1)).getInverse(n);for(var s=0,c=a.length;s<c;s++){var u=a[s].body,l=this.children[s],h=u.getCenterOfMassTransform(),d=h.getOrigin(),f=h.getRotation();l.position.set(d.x(),d.y(),d.z()).applyMatrix4(n),l.quaternion.setFromRotationMatrix(n).multiply(t.set(f.x(),f.y(),f.z(),f.w()))}}this.matrix.copy(o.matrixWorld).decompose(e,t,r).compose(e,t,r.set(1,1,1)),p.prototype.updateMatrixWorld.call(this,i)}}(),_init:function(){var e=this.physics.bodies;function t(e){switch(e.shapeType){case 0:return new B(e.width,16,8);case 1:return new Ur(2*e.width,2*e.height,2*e.depth,8,8,8);case 2:return new function(e,t,r,n){var i=new Br(e,e,t,r,n,!0),o=new dr(new B(e,r,n,0,2*Math.PI,0,Math.PI/2)),a=new dr(new B(e,r,n,0,2*Math.PI,Math.PI/2,Math.PI/2));return o.position.set(0,t/2,0),a.position.set(0,-t/2,0),o.updateMatrix(),a.updateMatrix(),i.merge(o.geometry,o.matrix),i.merge(a.geometry,a.matrix),i}(e.width,e.height,16,8);default:return null}}for(var r=0,n=e.length;r<n;r++){var i=e[r].params;this.add(new dr(t(i),this.materials[i.type]))}}}),e}(),jr=function(){function e(e){e=e||{},this.meshes=[],this.camera=null,this.cameraTarget=new p,this.cameraTarget.name="target",this.audio=null,this.audioManager=null,this.objects=new WeakMap,this.configuration={sync:void 0===e.sync||e.sync,afterglow:void 0!==e.afterglow?e.afterglow:0,resetPhysicsOnLoop:void 0===e.resetPhysicsOnLoop||e.resetPhysicsOnLoop},this.enabled={animation:!0,ik:!0,grant:!0,physics:!0,cameraAnimation:!0},this.onBeforePhysics=function(e){},this.sharedPhysics=!1,this.masterPhysics=null}function t(e,t){t=t||{},this.audio=e,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==t.delayTime?t.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime}function r(e,t){this.mesh=e,this.grants=t||[]}return e.prototype={constructor:e,add:function(e,t){if(t=t||{},e.isSkinnedMesh)this._addMesh(e,t);else if(e.isCamera)this._setupCamera(e,t);else{if("Audio"!==e.type)throw new Error("MMDAnimationHelper.add: accepts only SkinnedMesh or Camera or Audio instance.");this._setupAudio(e,t)}return this.configuration.sync&&this._syncDuration(),this},remove:function(e){if(e.isSkinnedMesh)this._removeMesh(e);else if(e.isCamera)this._clearCamera(e);else{if("Audio"!==e.type)throw new Error("MMDAnimationHelper.remove: accepts only SkinnedMesh or Camera or Audio instance.");this._clearAudio(e)}return this.configuration.sync&&this._syncDuration(),this},update:function(e){null!==this.audioManager&&this.audioManager.control(e);for(var t=0;t<this.meshes.length;t++)this._animateMesh(this.meshes[t],e);return this.sharedPhysics&&this._updateSharedPhysics(e),null!==this.camera&&this._animateCamera(this.camera,e),this},pose:function(e,t,r){!1!==(r=r||{}).resetPose&&e.pose();for(var n=e.skeleton.bones,i=t.bones,o={},a=0,u=n.length;a<u;a++)o[n[a].name]=a;var l=new s,h=new c;for(a=0,u=i.length;a<u;a++){var d=i[a],f=o[d.name];if(void 0!==f){var p=n[f];p.position.add(l.fromArray(d.translation)),p.quaternion.multiply(h.fromArray(d.quaternion))}}return e.updateMatrixWorld(!0),!1!==r.ik&&this._createCCDIKSolver(e).update(r.saveOriginalBonesBeforeIK),!1!==r.grant&&this.createGrantSolver(e).update(),this},enable:function(e,t){if(void 0===this.enabled[e])throw new Error("MMDAnimationHelper.enable: unknown key "+e);if(this.enabled[e]=t,"physics"===e)for(var r=0,n=this.meshes.length;r<n;r++)this._optimizeIK(this.meshes[r],t);return this},createGrantSolver:function(e){return new r(e,e.geometry.userData.MMD.grants)},_addMesh:function(e,t){if(this.meshes.indexOf(e)>=0)throw new Error("MMDAnimationHelper._addMesh: SkinnedMesh '"+e.name+"' has already been added.");return this.meshes.push(e),this.objects.set(e,{looped:!1}),this._setupMeshAnimation(e,t.animation),!1!==t.physics&&this._setupMeshPhysics(e,t),this},_setupCamera:function(e,t){if(this.camera===e)throw new Error("MMDAnimationHelper._setupCamera: Camera '"+e.name+"' has already been set.");return this.camera&&this.clearCamera(this.camera),this.camera=e,e.add(this.cameraTarget),this.objects.set(e,{}),void 0!==t.animation&&this._setupCameraAnimation(e,t.animation),this},_setupAudio:function(e,r){if(this.audio===e)throw new Error("MMDAnimationHelper._setupAudio: Audio '"+e.name+"' has already been set.");return this.audio&&this.clearAudio(this.audio),this.audio=e,this.audioManager=new t(e,r),this.objects.set(this.audioManager,{duration:this.audioManager.duration}),this},_removeMesh:function(e){for(var t=!1,r=0,n=0,i=this.meshes.length;n<i;n++)this.meshes[n]!==e?this.meshes[r++]=this.meshes[n]:(this.objects.delete(e),t=!0);if(!t)throw new Error("MMDAnimationHelper._removeMesh: SkinnedMesh '"+e.name+"' has not been added yet.");return this.meshes.length=r,this},_clearCamera:function(e){if(e!==this.camera)throw new Error("MMDAnimationHelper._clearCamera: Camera '"+e.name+"' has not been set yet.");return this.camera.remove(this.cameraTarget),this.objects.delete(this.camera),this.camera=null,this},_clearAudio:function(e){if(e!==this.audio)throw new Error("MMDAnimationHelper._clearAudio: Audio '"+e.name+"' has not been set yet.");return this.objects.delete(this.audioManager),this.audio=null,this.audioManager=null,this},_setupMeshAnimation:function(e,t){var r=this.objects.get(e);if(void 0!==t){var n=Array.isArray(t)?t:[t];r.mixer=new Ir(e);for(var i=0,o=n.length;i<o;i++)r.mixer.clipAction(n[i]).play();r.mixer.addEventListener("loop",function(e){var t=e.action._clip.tracks;t.length>0&&".bones"!==t[0].name.slice(0,6)||(r.looped=!0)})}return r.ikSolver=this._createCCDIKSolver(e),r.grantSolver=this.createGrantSolver(e),this},_setupCameraAnimation:function(e,t){var r=Array.isArray(t)?t:[t],n=this.objects.get(e);n.mixer=new Ir(e);for(var i=0,o=r.length;i<o;i++)n.mixer.clipAction(r[i]).play()},_setupMeshPhysics:function(e,t){var r=this.objects.get(e);if(void 0===t.world&&this.sharedPhysics){var n=this._getMasterPhysics();null!==n&&(world=n.world)}r.physics=this._createMMDPhysics(e,t),r.mixer&&!1!==t.animationWarmup&&(this._animateMesh(e,0),r.physics.reset()),r.physics.warmup(void 0!==t.warmup?t.warmup:60),this._optimizeIK(e,!0)},_animateMesh:function(e,t){var r=this.objects.get(e),n=r.mixer,i=r.ikSolver,o=r.grantSolver,a=r.physics,s=r.looped;n&&this.enabled.animation&&(this._restoreBones(e),n.update(t),this._saveBones(e),i&&this.enabled.ik&&(e.updateMatrixWorld(!0),i.update()),o&&this.enabled.grant&&o.update()),!0===s&&this.enabled.physics&&(a&&this.configuration.resetPhysicsOnLoop&&a.reset(),r.looped=!1),a&&this.enabled.physics&&!this.sharedPhysics&&(this.onBeforePhysics(e),a.update(t))},_animateCamera:function(e,t){var r=this.objects.get(e).mixer;r&&this.enabled.cameraAnimation&&(r.update(t),e.updateProjectionMatrix(),e.up.set(0,1,0),e.up.applyQuaternion(e.quaternion),e.lookAt(this.cameraTarget.position))},_optimizeIK:function(e,t){for(var r=e.geometry.userData.MMD.iks,n=e.geometry.userData.MMD.bones,i=0,o=r.length;i<o;i++)for(var a=r[i].links,s=0,c=a.length;s<c;s++){var u=a[s];u.enabled=!0!==t||!(n[u.index].rigidBodyType>0)}},_createCCDIKSolver:function(e){if(void 0===pr)throw new Error("MMDAnimationHelper: Import CCDIKSolver.");return new pr(e,e.geometry.userData.MMD.iks)},_createMMDPhysics:function(e,t){if(void 0===zr)throw new Error("MMDPhysics: Import MMDPhysics.");return new zr(e,e.geometry.userData.MMD.rigidBodies,e.geometry.userData.MMD.constraints,t)},_syncDuration:function(){for(var e=0,t=this.objects,r=this.meshes,n=this.camera,i=this.audioManager,o=0,a=r.length;o<a;o++){if(void 0!==(u=this.objects.get(r[o]).mixer))for(var s=0;s<u._actions.length;s++){var c=u._actions[s]._clip;t.has(c)||t.set(c,{duration:c.duration}),e=Math.max(e,t.get(c).duration)}}if(null!==n&&void 0!==(u=this.objects.get(n).mixer))for(o=0,a=u._actions.length;o<a;o++){c=u._actions[o]._clip;t.has(c)||t.set(c,{duration:c.duration}),e=Math.max(e,t.get(c).duration)}null!==i&&(e=Math.max(e,t.get(i).duration)),e+=this.configuration.afterglow;for(o=0,a=this.meshes.length;o<a;o++){var u;if(void 0!==(u=this.objects.get(this.meshes[o]).mixer)){s=0;for(var l=u._actions.length;s<l;s++)u._actions[s]._clip.duration=e}}if(null!==n&&void 0!==(u=this.objects.get(n).mixer))for(o=0,a=u._actions.length;o<a;o++)u._actions[o]._clip.duration=e;null!==i&&(i.duration=e)},_updatePropertyMixersBuffer:function(e){for(var t=this.objects.get(e).mixer,r=t._bindings,n=t._accuIndex,i=0,o=r.length;i<o;i++){var a=r[i],s=a.buffer,c=(n+1)*a.valueSize;a.binding.getValue(s,c)}},_saveBones:function(e){var t=this.objects.get(e),r=e.skeleton.bones,n=t.backupBones;void 0===n&&(n=new Float32Array(7*r.length),t.backupBones=n);for(var i=0,o=r.length;i<o;i++){var a=r[i];a.position.toArray(n,7*i),a.quaternion.toArray(n,7*i+3)}},_restoreBones:function(e){var t=this.objects.get(e).backupBones;if(void 0!==t)for(var r=e.skeleton.bones,n=0,i=r.length;n<i;n++){var o=r[n];o.position.fromArray(t,7*n),o.quaternion.fromArray(t,7*n+3)}},_getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var e=0,t=this.meshes.length;e<t;e++){var r=this.meshes[e].physics;if(void 0!==r&&null!==r)return this.masterPhysics=r,this.masterPhysics}return null},_updateSharedPhysics:function(e){if(0!==this.meshes.length&&this.enabled.physics&&this.sharedPhysics){var t=this._getMasterPhysics();if(null!==t){for(var r=0,n=this.meshes.length;r<n;r++){null!==(i=this.meshes[r].physics)&&void 0!==i&&i.updateRigidBodies()}t.stepSimulation(e);for(r=0,n=this.meshes.length;r<n;r++){var i;null!==(i=this.meshes[r].physics)&&void 0!==i&&i.updateBones()}}}}},t.prototype={constructor:t,control:function(e){return this.elapsed+=e,this.currentTime+=e,this._shouldStopAudio()&&this.audio.stop(),this._shouldStartAudio()&&this.audio.play(),this},_shouldStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime)&&(this.audio.startTime=this.currentTime-this.delayTime,!0)},_shouldStopAudio:function(){return this.audio.isPlaying&&this.currentTime>=this.duration}},r.prototype={constructor:r,update:function(){var e=new c;return function(){for(var t=this.mesh.skeleton.bones,r=this.grants,n=0,i=r.length;n<i;n++){var o=r[n],a=t[o.index],s=t[o.parentIndex];o.isLocal?(o.affectPosition,o.affectRotation):(o.affectPosition,o.affectRotation&&(e.set(0,0,0,1),e.slerp(s.quaternion,o.ratio),a.quaternion.multiply(e)))}return this}}()},e}(),Vr=function(){};function Gr(){p.call(this),this.type="Camera",this.matrixWorldInverse=new a,this.projectionMatrix=new a,this.projectionMatrixInverse=new a}function Wr(e,t,r,n){Gr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Vr.CreateRotationAnimation=function(e,t){return new Nr(null,e,[new Er(".rotation["+(t=t||"x")+"]",[0,e],[0,360])])},Vr.CreateScaleAxisAnimation=function(e,t){return new Nr(null,e,[new Er(".scale["+(t=t||"x")+"]",[0,e],[0,1])])},Vr.CreateShakeAnimation=function(e,t){for(var r=[],n=[],i=new s,o=0;o<10*e;o++)r.push(o/10),i.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).multiply(t).toArray(n,n.length);return new Nr(null,e,[new Or(".position",r,n)])},Vr.CreatePulsationAnimation=function(e,t){for(var r=[],n=[],i=new s,o=0;o<10*e;o++){r.push(o/10);var a=Math.random()*t;i.set(a,a,a).toArray(n,n.length)}return new Nr(null,e,[new Or(".scale",r,n)])},Vr.CreateVisibilityAnimation=function(e){return new Nr(null,e,[new Tr(".visible",[0,e/2,e],[!0,!1,!0])])},Vr.CreateMaterialColorAnimation=function(e,t){for(var r=[],n=[],i=e/t.length,o=0;o<=t.length;o++)r.push(o*i),n.push(t[o%t.length]);return new Nr(null,e,[new Ar(".material[0].color",r,n)])},Gr.prototype=Object.assign(Object.create(p.prototype),{constructor:Gr,isCamera:!0,copy:function(e,t){return p.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("Camera: .getWorldDirection() target is now required"),e=new s),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){p.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Wr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Wr,isPerspectiveCamera:!0,copy:function(e,t){return Gr.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*o.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*o.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*o.RAD2DEG*Math.atan(Math.tan(.5*o.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*o.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var s=a.fullWidth,c=a.fullHeight;i+=a.offsetX*n/s,t-=a.offsetY*r/c,n*=a.width/s,r*=a.height/c}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=p.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Hr={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}};function Xr(e){sr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("ShaderMaterial: attributes should now be defined in BufferGeometry instead."),this.setValues(e))}function qr(){p.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Yr(e,t,r,n,i,o){Gr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}Xr.prototype=Object.create(sr.prototype),Xr.prototype.constructor=Xr,Xr.prototype.isShaderMaterial=!0,Xr.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hr.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Xr.prototype.toJSON=function(e){var t=sr.prototype.toJSON.call(this,e);for(var r in t.uniforms={},this.uniforms){var n=this.uniforms[r].value;n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}return Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},qr.prototype=Object.assign(Object.create(p.prototype),{constructor:qr,copy:function(e,t){return p.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=p.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Yr.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Yr,isOrthographicCamera:!0,copy:function(e,t){return Gr.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,o=r+e,a=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=p.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}});var Jr={getDataURL:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var r=t.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Qr=0;function Zr(e,t,r,n,i,a,s,c,u,l){Object.defineProperty(this,"id",{value:Qr++}),this.uuid=o.generateUUID(),this.name="",this.image=void 0!==e?e:Zr.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Zr.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:Xe,this.wrapT=void 0!==n?n:Xe,this.magFilter=void 0!==i?i:Ze,this.minFilter=void 0!==a?a:$e,this.anisotropy=void 0!==u?u:1,this.format=void 0!==s?s:pt,this.type=void 0!==c?c:et,this.offset=new x(0,0),this.repeat=new x(1,1),this.center=new x(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new d,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Jt,this.version=0,this.onUpdate=null}function Kr(e,t,r){this.width=e,this.height=t,this.scissor=new S(0,0,e,t),this.scissorTest=!1,this.viewport=new S(0,0,e,t),void 0===(r=r||{}).minFilter&&(r.minFilter=Ze),this.texture=new Zr(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.generateMipmaps=void 0===r.generateMipmaps||r.generateMipmaps,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function $r(e,t,r,n){_.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new en(e,t,r,n)),this.mergeVertices()}function en(e,t,r,n){U.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(r)||1,u=Math.floor(n)||1,l=c+1,h=u+1,d=e/c,f=t/u,p=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<l;i++){var b=i*d-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/c),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<c;i++){var x=i+l*o,w=i+l*(o+1),_=i+1+l*(o+1),S=i+1+l*o;p.push(x,w,S),p.push(w,_,S)}this.setIndex(p),this.addAttribute("position",new N(m,3)),this.addAttribute("normal",new N(v,3)),this.addAttribute("uv",new N(g,2))}Zr.DEFAULT_IMAGE=void 0,Zr.DEFAULT_MAPPING=Ue,Zr.prototype=Object.assign(Object.create(u.prototype),{constructor:Zr,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=o.generateUUID()),!t&&void 0===e.images[n.uuid]){var i;if(Array.isArray(n)){i=[];for(var a=0,s=n.length;a<s;a++)i.push(Jr.getDataURL(n[a]))}else i=Jr.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==Ue)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case He:e.x=e.x-Math.floor(e.x);break;case Xe:e.x=e.x<0?0:1;break;case qe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case He:e.y=e.y-Math.floor(e.y);break;case Xe:e.y=e.y<0?0:1;break;case qe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Zr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Kr.prototype=Object.assign(Object.create(u.prototype),{constructor:Kr,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),$r.prototype=Object.create(_.prototype),$r.prototype.constructor=$r,en.prototype=Object.create(U.prototype),en.prototype.constructor=en;var tn={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:1},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","vec2 aspectcorrect = vec2( 1.0, aspect );","float viewZ = getViewZ( getDepth( vUv ) );","float factor = ( focus + viewZ );","vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","vec4 col = vec4( 0.0 );","col += texture2D( tColor, vUv.xy );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","gl_FragColor = col / 41.0;","gl_FragColor.a = 1.0;","}"].join("\n")},rn={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new x}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","//pentagonal shape","float scale = float(rings) - 1.3;","vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","vec4  one = vec4( 1.0 );","vec4 P = vec4((coords),vec2(scale, scale));","vec4 dist = vec4(0.0);","float inorout = -4.0;","dist.x = dot( P, HS0 );","dist.y = dot( P, HS1 );","dist.z = dot( P, HS2 );","dist.w = dot( P, HS3 );","dist = smoothstep( -feather, feather, dist );","inorout += dot( dist, one );","dist.x = dot( P, HS4 );","dist.y = HS5.w - abs( P.z );","dist = smoothstep( -feather, feather, dist );","inorout += dist.x;","return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","// Depth buffer blur","float d = 0.0;","float kernel[9];","vec2 offset[9];","vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","offset[0] = vec2(-wh.x,-wh.y);","offset[1] = vec2( 0.0, -wh.y);","offset[2] = vec2( wh.x -wh.y);","offset[3] = vec2(-wh.x,  0.0);","offset[4] = vec2( 0.0,   0.0);","offset[5] = vec2( wh.x,  0.0);","offset[6] = vec2(-wh.x, wh.y);","offset[7] = vec2( 0.0,  wh.y);","offset[8] = vec2( wh.x, wh.y);","kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","for( int i=0; i<9; i++ ) {","float tmp = texture2D(tDepth, coords + offset[i]).r;","d += tmp * kernel[i];","}","return d;","}","vec3 color(vec2 coords,float blur) {","//processing the sample","vec3 col = vec3(0.0);","vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","vec3 lumcoeff = vec3(0.299,0.587,0.114);","float lum = dot(col.rgb, lumcoeff);","float thresh = max((lum-threshold)*gain, 0.0);","return col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","float edge = 0.002*depth; //distance based edge smoothing","float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","return col;","}","float linearize(float depth) {","return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","float dist = distance(vUv.xy, vec2(0.5,0.5));","dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","return clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","float rings2 = float(rings);","float step = PI*2.0 / float(ringsamples);","float pw = cos(j*step)*i;","float ph = sin(j*step)*i;","float p = 1.0;","if (pentagon) {","p = penta(vec2(pw,ph));","}","col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","return 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","//scene depth calculation","float depth = linearize(texture2D(tDepth,vUv.xy).x);","// Blur depth?","if ( depthblur ) {","depth = linearize(bdepth(vUv.xy));","}","//focal plane calculation","float fDepth = focalDepth;","if (shaderFocus) {","fDepth = linearize(texture2D(tDepth,focusCoords).x);","}","// dof blur factor calculation","float blur = 0.0;","if (manualdof) {","float a = depth-fDepth; // Focal plane","float b = (a-fdofstart)/fdofdist; // Far DoF","float c = (-a-ndofstart)/ndofdist; // Near Dof","blur = (a>0.0) ? b : c;","} else {","float f = focalLength; // focal length in mm","float d = fDepth*1000.0; // focal plane in mm","float o = depth*1000.0; // depth in mm","float a = (o*f)/(o-f);","float b = (d*f)/(d-f);","float c = (d-f)/(d*fstop*CoC);","blur = abs(a-b)*c;","}","blur = clamp(blur,0.0,1.0);","// calculation of pattern for dithering","vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","// getting blur x and y step factor","float w = (1.0/textureWidth)*blur*maxblur+noise.x;","float h = (1.0/textureHeight)*blur*maxblur+noise.y;","// calculation of final color","vec3 col = vec3(0.0);","if(blur < 0.05) {","//some optimization thingy","col = texture2D(tColor, vUv.xy).rgb;","} else {","col = texture2D(tColor, vUv.xy).rgb;","float s = 1.0;","int ringsamples;","for (int i = 1; i <= rings; i++) {","","ringsamples = i * samples;","for (int j = 0 ; j < maxringsamples ; j++) {","if (j >= ringsamples) break;","s += gather(float(i), float(j), ringsamples, col, w, h, blur);","}","","}","col /= s; //divide by sample count","}","if (showFocus) {","col = debugFocus(col, blur, depth);","}","if (vignetting) {","col *= vignette();","}","gl_FragColor.rgb = col;","gl_FragColor.a = 1.0;","} "].join("\n")},nn={uniforms:{mNear:{value:1},mFar:{value:1e3}},vertexShader:["varying float vViewZDepth;","void main() {","\t#include <begin_vertex>","\t#include <project_vertex>","\tvViewZDepth = - mvPosition.z;","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","varying float vViewZDepth;","void main() {","\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );","\tgl_FragColor = vec4( vec3( color ), 1.0 );","} "].join("\n")},on=function(e,t,r,n){Wr.call(this,e,t,r,n),this.type="CinematicCamera",this.postprocessing={enabled:!0},this.shaderSettings={rings:3,samples:4};var i=nn;this.materialDepth=new Xr({uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),this.materialDepth.uniforms.mNear.value=r,this.materialDepth.uniforms.mFar.value=n,this.setLens(),this.initPostProcessing()};(on.prototype=Object.create(Wr.prototype)).constructor=on,on.prototype.setLens=function(e,t,r,n){void 0===e&&(e=35),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e),void 0===r&&(r=8),void 0===n&&(n=.019),this.fNumber=r,this.coc=n,this.aperture=e/this.fNumber,this.hyperFocal=e*e/(this.aperture*this.coc)},on.prototype.linearize=function(e){var t=this.far,r=this.near;return-t*r/(e*(t-r)-t)},on.prototype.smoothstep=function(e,t,r){var n=this.saturate((r-e)/(t-e));return n*n*(3-2*n)},on.prototype.saturate=function(e){return Math.max(0,Math.min(1,e))},on.prototype.focusAt=function(e){void 0===e&&(e=20);var t=this.getFocalLength();this.focus=e,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-t)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-t)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance},on.prototype.initPostProcessing=function(){if(this.postprocessing.enabled){this.postprocessing.scene=new qr,this.postprocessing.camera=new Yr(i.innerWidth/-2,i.innerWidth/2,i.innerHeight/2,i.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera);var e={minFilter:Ze,magFilter:Ze,format:ft};this.postprocessing.rtTextureDepth=new Kr(i.innerWidth,i.innerHeight,e),this.postprocessing.rtTextureColor=new Kr(i.innerWidth,i.innerHeight,e);var t=tn;this.postprocessing.bokeh_uniforms=Hr.clone(t.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=i.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=i.innerHeight,this.postprocessing.materialBokeh=new Xr({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples,DEPTH_PACKING:1}}),this.postprocessing.quad=new dr(new en(i.innerWidth,i.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}},on.prototype.renderCinematic=function(e,t){this.postprocessing.enabled&&(t.clear(),e.overrideMaterial=null,t.render(e,camera,this.postprocessing.rtTextureColor,!0),e.overrideMaterial=this.materialDepth,t.render(e,camera,this.postprocessing.rtTextureDepth,!0),t.render(this.postprocessing.scene,this.postprocessing.camera))};var an={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function sn(e,t,r){var n=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===i&&void 0!==n.onStart&&n.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var cn=new sn,un={};function ln(e){this.manager=void 0!==e?e:cn}function hn(e){ur.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function dn(e){sr.call(this),this.type="MeshDepthMaterial",this.depthPacking=rr,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function fn(e){sr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new s,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function pn(e){sr.call(this),this.type="MeshLambertMaterial",this.color=new v(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new v(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function mn(e){sr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ir,this.normalScale=new x(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vn(e){sr.call(this),this.type="MeshPhongMaterial",this.color=new v(16777215),this.specular=new v(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new v(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ir,this.normalScale=new x(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function gn(e){sr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new v(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new v(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ir,this.normalScale=new x(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function yn(e){gn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function bn(e){vn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function xn(e){sr.call(this),this.type="PointsMaterial",this.color=new v(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function wn(e){Xr.call(this,e),this.type="RawShaderMaterial"}function _n(e){sr.call(this),this.type="ShadowMaterial",this.color=new v(0),this.transparent=!0,this.setValues(e)}function Sn(e){sr.call(this),this.type="SpriteMaterial",this.color=new v(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function Mn(e){this.manager=void 0!==e?e:cn,this.textures={}}function Tn(e){this.manager=void 0!==e?e:cn}function An(e){this.manager=void 0!==e?e:cn}function En(){}Object.assign(ln.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,a=an.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout(function(){t&&t(a),o.manager.itemEnd(e)},0),a;if(void 0===un[e]){var s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var c=s[1],u=!!s[2],l=s[3];l=i.decodeURIComponent(l),u&&(l=i.atob(l));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),p=0;p<l.length;p++)f[p]=l.charCodeAt(p);h="blob"===d?new Blob([f.buffer],{type:c}):f.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(l,c);break;case"json":h=JSON.parse(l);break;default:h=l}i.setTimeout(function(){t&&t(h),o.manager.itemEnd(e)},0)}catch(t){i.setTimeout(function(){n&&n(t),o.manager.itemEnd(e),o.manager.itemError(e)},0)}}else{un[e]=[],un[e].push({onLoad:t,onProgress:r,onError:n});var v=new XMLHttpRequest;for(var g in v.open("GET",e,!0),v.addEventListener("load",function(t){var r=this.response;an.add(e,r);var n=un[e];if(delete un[e],200===this.status||0===this.status){0===this.status&&console.warn("FileLoader: HTTP Status 0 received.");for(var i=0,a=n.length;i<a;i++){(s=n[i]).onLoad&&s.onLoad(r)}o.manager.itemEnd(e)}else{for(i=0,a=n.length;i<a;i++){var s;(s=n[i]).onError&&s.onError(t)}o.manager.itemEnd(e),o.manager.itemError(e)}},!1),v.addEventListener("progress",function(t){for(var r=un[e],n=0,i=r.length;n<i;n++){var o=r[n];o.onProgress&&o.onProgress(t)}},!1),v.addEventListener("error",function(t){var r=un[e];delete un[e];for(var n=0,i=r.length;n<i;n++){var a=r[n];a.onError&&a.onError(t)}o.manager.itemEnd(e),o.manager.itemError(e)},!1),v.addEventListener("abort",function(t){var r=un[e];delete un[e];for(var n=0,i=r.length;n<i;n++){var a=r[n];a.onError&&a.onError(t)}o.manager.itemEnd(e),o.manager.itemError(e)},!1),void 0!==this.responseType&&(v.responseType=this.responseType),void 0!==this.withCredentials&&(v.withCredentials=this.withCredentials),v.overrideMimeType&&v.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)v.setRequestHeader(g,this.requestHeader[g]);v.send(null)}return o.manager.itemStart(e),v}un[e].push({onLoad:t,onProgress:r,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),hn.prototype=Object.create(ur.prototype),hn.prototype.constructor=hn,hn.prototype.isLineDashedMaterial=!0,hn.prototype.copy=function(e){return ur.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this},dn.prototype=Object.create(sr.prototype),dn.prototype.constructor=dn,dn.prototype.isMeshDepthMaterial=!0,dn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},fn.prototype=Object.create(sr.prototype),fn.prototype.constructor=fn,fn.prototype.isMeshDistanceMaterial=!0,fn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},pn.prototype=Object.create(sr.prototype),pn.prototype.constructor=pn,pn.prototype.isMeshLambertMaterial=!0,pn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},mn.prototype=Object.create(sr.prototype),mn.prototype.constructor=mn,mn.prototype.isMeshNormalMaterial=!0,mn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vn.prototype=Object.create(sr.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshPhongMaterial=!0,vn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},gn.prototype=Object.create(sr.prototype),gn.prototype.constructor=gn,gn.prototype.isMeshStandardMaterial=!0,gn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},yn.prototype=Object.create(gn.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshPhysicalMaterial=!0,yn.prototype.copy=function(e){return gn.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},bn.prototype=Object.create(vn.prototype),bn.prototype.constructor=bn,bn.prototype.isMeshToonMaterial=!0,bn.prototype.copy=function(e){return vn.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},xn.prototype=Object.create(sr.prototype),xn.prototype.constructor=xn,xn.prototype.isPointsMaterial=!0,xn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},wn.prototype=Object.create(Xr.prototype),wn.prototype.constructor=wn,wn.prototype.isRawShaderMaterial=!0,_n.prototype=Object.create(sr.prototype),_n.prototype.constructor=_n,_n.prototype.isShadowMaterial=!0,_n.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this},Sn.prototype=Object.create(sr.prototype),Sn.prototype.constructor=Sn,Sn.prototype.isSpriteMaterial=!0,Sn.prototype.copy=function(e){return sr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Object.assign(Mn.prototype,{load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function r(e){return void 0===t[e]&&console.warn("MaterialLoader: Undefined texture",e),t[e]}var n=new{LineBasicMaterial:ur,LineDashedMaterial:hn,MeshBasicMaterial:cr,MeshDepthMaterial:dn,MeshDistanceMaterial:fn,MeshLambertMaterial:pn,MeshNormalMaterial:mn,MeshPhongMaterial:vn,MeshPhysicalMaterial:yn,MeshStandardMaterial:gn,MeshToonMaterial:bn,PointsMaterial:xn,RawShaderMaterial:wn,ShaderMaterial:Xr,ShadowMaterial:_n,SpriteMaterial:Sn}[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(n.uniforms[i]={},o.type){case"t":n.uniforms[i].value=r(o.value);break;case"c":n.uniforms[i].value=(new v).setHex(o.value);break;case"v2":n.uniforms[i].value=(new x).fromArray(o.value);break;case"v3":n.uniforms[i].value=(new s).fromArray(o.value);break;case"v4":n.uniforms[i].value=(new S).fromArray(o.value);break;case"m4":n.uniforms[i].value=(new a).fromArray(o.value);break;default:n.uniforms[i].value=o.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var c=e.normalScale;!1===Array.isArray(c)&&(c=[c,c]),n.normalScale=(new x).fromArray(c)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),n}}),Object.assign(Tn.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=an.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),an.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(An.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new Zr,o=new Tn(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(r){i.image=r;var n=e.search(/\.jpe?g$/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=n?ft:pt,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),En.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],o=t[r+1];if(i.test(e))return o}return null}},Object.assign(En.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e={NoBlending:$,NormalBlending:ee,AdditiveBlending:te,SubtractiveBlending:re,MultiplyBlending:ne,CustomBlending:ie},t=new v,r=new An,n=new Mn;return function(i,a,s){var c={};function u(e,t,n,i,u){var l,h=a+e,d=En.Handlers.get(h);null!==d?l=d.load(h):(r.setCrossOrigin(s),l=r.load(h)),void 0!==t&&(l.repeat.fromArray(t),1!==t[0]&&(l.wrapS=He),1!==t[1]&&(l.wrapT=He)),void 0!==n&&l.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(l.wrapS=He),"mirror"===i[0]&&(l.wrapS=qe),"repeat"===i[1]&&(l.wrapT=He),"mirror"===i[1]&&(l.wrapT=qe)),void 0!==u&&(l.anisotropy=u);var f=o.generateUUID();return c[f]=l,f}var l={uuid:o.generateUUID(),type:"MeshLambertMaterial"};for(var h in i){var d=i[h];switch(h){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=d;break;case"blending":l.blending=e[d];break;case"colorAmbient":case"mapAmbient":console.warn("Loader.createMaterial:",h,"is no longer supported.");break;case"colorDiffuse":l.color=t.fromArray(d).getHex();break;case"colorSpecular":l.specular=t.fromArray(d).getHex();break;case"colorEmissive":l.emissive=t.fromArray(d).getHex();break;case"specularCoef":l.shininess=d;break;case"shading":"basic"===d.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===d.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===d.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=u(d,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=u(d,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=u(d,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=u(d,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=u(d,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=d;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=u(d,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=d;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=u(d,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=u(d,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=u(d,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=u(d,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=Y;break;case"doubleSided":l.side=J;break;case"transparency":console.warn("Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=d;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[h]=d;break;case"vertexColors":!0===d&&(l.vertexColors=K),"face"===d&&(l.vertexColors=Z);break;default:console.error("Loader.createMaterial: Unsupported",h,d)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),n.setTextures(c),n.parse(l)}}()});var Cn={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Ln(e){"boolean"==typeof e&&(console.warn("JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:cn,this.withCredentials=!1}Object.assign(Ln.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Cn.extractUrlBase(e),a=new ln(this.manager);a.setWithCredentials(this.withCredentials),a.load(e,function(r){var n=JSON.parse(r),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("JSONLoader: "+e+" should be loaded with ObjectLoader instead.")}var c=i.parse(n,o);t(c.geometry,c.materials)},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setTexturePath:function(e){return this.texturePath=e,this},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var r=new _;return function(e,t){function r(e,t){return e&1<<t}var n,i,o,a,c,u,l,h,d,f,p,m,y,b,w,_,S,M,T,A,E,C,L,P,O,N=e.faces,R=e.vertices,I=e.normals,D=e.colors,F=e.scale,U=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&U++;for(n=0;n<U;n++)t.faceVertexUvs[n]=[]}for(a=0,c=R.length;a<c;)(M=new s).x=R[a++]*F,M.y=R[a++]*F,M.z=R[a++]*F,t.vertices.push(M);for(a=0,c=N.length;a<c;)if(p=r(f=N[a++],0),m=r(f,1),y=r(f,3),b=r(f,4),w=r(f,5),_=r(f,6),S=r(f,7),p){if((A=new g).a=N[a],A.b=N[a+1],A.c=N[a+3],(E=new g).a=N[a+1],E.b=N[a+2],E.c=N[a+3],a+=4,m&&(d=N[a++],A.materialIndex=d,E.materialIndex=d),o=t.faces.length,y)for(n=0;n<U;n++)for(P=e.uvs[n],t.faceVertexUvs[n][o]=[],t.faceVertexUvs[n][o+1]=[],i=0;i<4;i++)O=new x(P[2*(h=N[a++])],P[2*h+1]),2!==i&&t.faceVertexUvs[n][o].push(O),0!==i&&t.faceVertexUvs[n][o+1].push(O);if(b&&(l=3*N[a++],A.normal.set(I[l++],I[l++],I[l]),E.normal.copy(A.normal)),w)for(n=0;n<4;n++)l=3*N[a++],L=new s(I[l++],I[l++],I[l]),2!==n&&A.vertexNormals.push(L),0!==n&&E.vertexNormals.push(L);if(_&&(C=D[u=N[a++]],A.color.setHex(C),E.color.setHex(C)),S)for(n=0;n<4;n++)C=D[u=N[a++]],2!==n&&A.vertexColors.push(new v(C)),0!==n&&E.vertexColors.push(new v(C));t.faces.push(A),t.faces.push(E)}else{if((T=new g).a=N[a++],T.b=N[a++],T.c=N[a++],m&&(d=N[a++],T.materialIndex=d),o=t.faces.length,y)for(n=0;n<U;n++)for(P=e.uvs[n],t.faceVertexUvs[n][o]=[],i=0;i<3;i++)O=new x(P[2*(h=N[a++])],P[2*h+1]),t.faceVertexUvs[n][o].push(O);if(b&&(l=3*N[a++],T.normal.set(I[l++],I[l++],I[l])),w)for(n=0;n<3;n++)l=3*N[a++],L=new s(I[l++],I[l++],I[l]),T.vertexNormals.push(L);if(_&&(u=N[a++],T.color.setHex(D[u])),S)for(n=0;n<3;n++)u=N[a++],T.vertexColors.push(new v(D[u]));t.faces.push(T)}}(e,r),function(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=r){var o=e.skinWeights[n],a=r>1?e.skinWeights[n+1]:0,s=r>2?e.skinWeights[n+2]:0,c=r>3?e.skinWeights[n+3]:0;t.skinWeights.push(new S(o,a,s,c))}if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=r){var u=e.skinIndices[n],l=r>1?e.skinIndices[n+1]:0,h=r>2?e.skinIndices[n+2]:0,d=r>3?e.skinIndices[n+3]:0;t.skinIndices.push(new S(u,l,h,d))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,r),function(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,c=0,u=a.length;c<u;c+=3){var l=new s;l.x=a[c]*r,l.y=a[c+1]*r,l.z=a[c+2]*r,o.push(l)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('JSONLoader: "morphColors" no longer supported. Using them as face colors.');var h=t.faces,d=e.morphColors[0].colors;for(n=0,i=h.length;n<i;n++)h[n].color.fromArray(d,3*n)}}(e,r),function(e,t){var r=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var o=Nr.parseAnimation(n[i],t.bones);o&&r.push(o)}if(t.morphTargets){var a=Nr.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(a)}r.length>0&&(t.animations=r)}(e,r),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:r}:{geometry:r,materials:En.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}()});var Pn=function(e){"boolean"==typeof e&&(console.warn("BinaryLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:cn};Pn.prototype={constructor:Pn,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this.texturePath||Cn.extractUrlBase(e),o=this.binaryPath||Cn.extractUrlBase(e),a=this;new ln(this.manager).load(e,function(e){var s=JSON.parse(e),c=o+s.buffers,u=new ln(a.manager);u.setResponseType("arraybuffer"),u.load(c,function(e){a.parse(e,t,i,s.materials)},r,n)},r,n)},setBinaryPath:function(e){return this.binaryPath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},setTexturePath:function(e){return this.texturePath=e,this},parse:function(e,t,r,n){var i=function(){var t,r,n,i,o,a,c,u,l,h,d,f,p,m,v,y,b,w,S=this,M=0,T=[],A=[];function E(e){return e%4?4-e%4:0}function C(e,t){return new Uint8Array(e,t,1)[0]}function L(e,t){return new Uint32Array(e,t,1)[0]}function P(t,r){var n,i,o,a,s,c,u,l,h,d,f=new Uint32Array(e,r,3*t);for(n=0;n<t;n++)i=f[3*n],o=f[3*n+1],a=f[3*n+2],s=A[2*i],l=A[2*i+1],c=A[2*o],h=A[2*o+1],u=A[2*a],d=A[2*a+1],S.faceVertexUvs[0].push([new x(s,l),new x(c,h),new x(u,d)])}function O(t,r){var n,i,o,a,s,c,u,l,h,d,f,p,m,v=new Uint32Array(e,r,4*t);for(n=0;n<t;n++)i=v[4*n],o=v[4*n+1],a=v[4*n+2],s=v[4*n+3],c=A[2*i],d=A[2*i+1],u=A[2*o],f=A[2*o+1],l=A[2*a],p=A[2*a+1],h=A[2*s],m=A[2*s+1],S.faceVertexUvs[0].push([new x(c,d),new x(u,f),new x(h,m)]),S.faceVertexUvs[0].push([new x(u,f),new x(l,p),new x(h,m)])}function N(t,r,n){var i,o,a,s,c,u=new Uint32Array(e,r,3*t),l=new Uint16Array(e,n,t);for(i=0;i<t;i++)o=u[3*i],a=u[3*i+1],s=u[3*i+2],c=l[i],S.faces.push(new g(o,a,s,null,null,c))}function R(t,r,n){var i,o,a,s,c,u,l=new Uint32Array(e,r,4*t),h=new Uint16Array(e,n,t);for(i=0;i<t;i++)o=l[4*i],a=l[4*i+1],s=l[4*i+2],c=l[4*i+3],u=h[i],S.faces.push(new g(o,a,c,null,null,u)),S.faces.push(new g(a,s,c,null,null,u))}function I(t,r,n,i){var o,a,c,u,l,h,d,f,p=new Uint32Array(e,r,3*t),m=new Uint32Array(e,n,3*t),v=new Uint16Array(e,i,t);for(o=0;o<t;o++){a=p[3*o],c=p[3*o+1],u=p[3*o+2],h=m[3*o],d=m[3*o+1],f=m[3*o+2],l=v[o];var y=T[3*h],b=T[3*h+1],x=T[3*h+2],w=T[3*d],_=T[3*d+1],M=T[3*d+2],A=T[3*f],E=T[3*f+1],C=T[3*f+2];S.faces.push(new g(a,c,u,[new s(y,b,x),new s(w,_,M),new s(A,E,C)],null,l))}}function D(t,r,n,i){var o,a,c,u,l,h,d,f,p,m,v=new Uint32Array(e,r,4*t),y=new Uint32Array(e,n,4*t),b=new Uint16Array(e,i,t);for(o=0;o<t;o++){a=v[4*o],c=v[4*o+1],u=v[4*o+2],l=v[4*o+3],d=y[4*o],f=y[4*o+1],p=y[4*o+2],m=y[4*o+3],h=b[o];var x=T[3*d],w=T[3*d+1],_=T[3*d+2],M=T[3*f],A=T[3*f+1],E=T[3*f+2],C=T[3*p],L=T[3*p+1],P=T[3*p+2],O=T[3*m],N=T[3*m+1],R=T[3*m+2];S.faces.push(new g(a,c,l,[new s(x,w,_),new s(M,A,E),new s(O,N,R)],null,h)),S.faces.push(new g(c,u,l,[new s(M,A,E),new s(C,L,P),new s(O,N,R)],null,h))}}_.call(this),M+=(t=function(e,t){return{signature:function(e,t,r){return Cn.decodeText(new Uint8Array(e,t,r))}(e,t,12),header_bytes:C(e,t+12),vertex_coordinate_bytes:C(e,t+13),normal_coordinate_bytes:C(e,t+14),uv_coordinate_bytes:C(e,t+15),vertex_index_bytes:C(e,t+16),normal_index_bytes:C(e,t+17),uv_index_bytes:C(e,t+18),material_index_bytes:C(e,t+19),nvertices:L(e,t+20),nnormals:L(e,t+20+4),nuvs:L(e,t+20+8),ntri_flat:L(e,t+20+12),ntri_smooth:L(e,t+20+16),ntri_flat_uv:L(e,t+20+20),ntri_smooth_uv:L(e,t+20+24),nquad_flat:L(e,t+20+28),nquad_smooth:L(e,t+20+32),nquad_flat_uv:L(e,t+20+36),nquad_smooth_uv:L(e,t+20+40)}}(e,M)).header_bytes,h=3*t.vertex_index_bytes+t.material_index_bytes,d=4*t.vertex_index_bytes+t.material_index_bytes,f=t.ntri_flat*h,p=t.ntri_smooth*(h+3*t.normal_index_bytes),m=t.ntri_flat_uv*(h+3*t.uv_index_bytes),v=t.ntri_smooth_uv*(h+3*t.normal_index_bytes+3*t.uv_index_bytes),y=t.nquad_flat*d,b=t.nquad_smooth*(d+4*t.normal_index_bytes),w=t.nquad_flat_uv*(d+4*t.uv_index_bytes),M+=function(r){var n,i,o,a,c=t.nvertices,u=new Float32Array(e,r,3*c);for(n=0;n<c;n++)i=u[3*n],o=u[3*n+1],a=u[3*n+2],S.vertices.push(new s(i,o,a));return 3*c*Float32Array.BYTES_PER_ELEMENT}(M),M+=function(r){var n=t.nnormals;if(n){var i,o,a,s,c=new Int8Array(e,r,3*n);for(i=0;i<n;i++)o=c[3*i],a=c[3*i+1],s=c[3*i+2],T.push(o/127,a/127,s/127)}return 3*n*Int8Array.BYTES_PER_ELEMENT}(M),M+=E(3*t.nnormals),l=(u=(c=(a=(o=(i=(n=(r=M+=function(r){var n=t.nuvs;if(n){var i,o,a,s=new Float32Array(e,r,2*n);for(i=0;i<n;i++)o=s[2*i],a=s[2*i+1],A.push(o,a)}return 2*n*Float32Array.BYTES_PER_ELEMENT}(M))+f+E(2*t.ntri_flat))+p+E(2*t.ntri_smooth))+m+E(2*t.ntri_flat_uv))+v+E(2*t.ntri_smooth_uv))+y+E(2*t.nquad_flat))+b+E(2*t.nquad_smooth))+w+E(2*t.nquad_flat_uv),function(e){var r=t.ntri_flat_uv;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*3,i=n+r*Uint32Array.BYTES_PER_ELEMENT*3;N(r,e,i),P(r,n)}}(i),function(e){var r=t.ntri_smooth_uv;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*3,i=n+r*Uint32Array.BYTES_PER_ELEMENT*3,o=i+r*Uint32Array.BYTES_PER_ELEMENT*3;I(r,e,n,o),P(r,i)}}(o),function(e){var r=t.nquad_flat_uv;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*4,i=n+r*Uint32Array.BYTES_PER_ELEMENT*4;R(r,e,i),O(r,n)}}(u),function(e){var r=t.nquad_smooth_uv;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*4,i=n+r*Uint32Array.BYTES_PER_ELEMENT*4,o=i+r*Uint32Array.BYTES_PER_ELEMENT*4;D(r,e,n,o),O(r,i)}}(l),function(e){var r=t.ntri_flat;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*3;N(r,e,n)}}(r),function(e){var r=t.ntri_smooth;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*3,i=n+r*Uint32Array.BYTES_PER_ELEMENT*3;I(r,e,n,i)}}(n),function(e){var r=t.nquad_flat;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*4;R(r,e,n)}}(a),function(e){var r=t.nquad_smooth;if(r){var n=e+r*Uint32Array.BYTES_PER_ELEMENT*4,i=n+r*Uint32Array.BYTES_PER_ELEMENT*4;D(r,e,n,i)}}(c),this.computeFaceNormals()};(i.prototype=Object.create(_.prototype)).constructor=i,t(new i,En.prototype.initMaterials(n,r,this.crossOrigin))}};function On(e,t){this.normal=void 0!==e?e:new s(1,0,0),this.constant=void 0!==t?t:0}function Nn(e,t,r,n){this.ray=new lr(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Rn(e,t){return e.distance-t.distance}function In(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,o=0,a=i.length;o<a;o++)In(i[o],t,r,!0)}Object.assign(On.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new s,t=new s;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("Plane: .projectPoint() target is now required"),t=new s),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new s;return function(t,r){void 0===r&&(console.warn("Plane: .intersectLine() target is now required"),r=new s);var n=t.delta(e),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?r.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:r.copy(n).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("Plane: .coplanarPoint() target is now required"),e=new s),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new s,t=new d;return function(r,n){var i=n||t.getNormalMatrix(r),o=this.coplanarPoint(e).applyMatrix4(r),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Nn.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){var n=r||[];return In(e,this,n,t),n.sort(Rn),n},intersectObjects:function(e,t,r){var n=r||[];if(!1===Array.isArray(e))return console.warn("Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,o=e.length;i<o;i++)In(e[i],this,n,t);return n.sort(Rn),n}});var Dn=function(e,t,r){if(e instanceof Gr){console.warn("DragControls: Constructor now expects ( objects, camera, domElement )");var n=e;e=t,t=n}var i=new On,o=new Nn,a=new x,c=new s,u=new s,l=null,h=null,d=this;function f(){r.addEventListener("mousemove",m,!1),r.addEventListener("mousedown",v,!1),r.addEventListener("mouseup",g,!1),r.addEventListener("mouseleave",g,!1),r.addEventListener("touchmove",y,!1),r.addEventListener("touchstart",b,!1),r.addEventListener("touchend",w,!1)}function p(){r.removeEventListener("mousemove",m,!1),r.removeEventListener("mousedown",v,!1),r.removeEventListener("mouseup",g,!1),r.removeEventListener("mouseleave",g,!1),r.removeEventListener("touchmove",y,!1),r.removeEventListener("touchstart",b,!1),r.removeEventListener("touchend",w,!1)}function m(n){n.preventDefault();var s=r.getBoundingClientRect();if(a.x=(n.clientX-s.left)/s.width*2-1,a.y=-(n.clientY-s.top)/s.height*2+1,o.setFromCamera(a,t),l&&d.enabled)return o.ray.intersectPlane(i,u)&&l.position.copy(u.sub(c)),void d.dispatchEvent({type:"drag",object:l});o.setFromCamera(a,t);var f=o.intersectObjects(e);if(f.length>0){var p=f[0].object;i.setFromNormalAndCoplanarPoint(t.getWorldDirection(i.normal),p.position),h!==p&&(d.dispatchEvent({type:"hoveron",object:p}),r.style.cursor="pointer",h=p)}else null!==h&&(d.dispatchEvent({type:"hoveroff",object:h}),r.style.cursor="auto",h=null)}function v(n){n.preventDefault(),o.setFromCamera(a,t);var s=o.intersectObjects(e);s.length>0&&(l=s[0].object,o.ray.intersectPlane(i,u)&&c.copy(u).sub(l.position),r.style.cursor="move",d.dispatchEvent({type:"dragstart",object:l}))}function g(e){e.preventDefault(),l&&(d.dispatchEvent({type:"dragend",object:l}),l=null),r.style.cursor=h?"pointer":"auto"}function y(e){e.preventDefault(),e=e.changedTouches[0];var n=r.getBoundingClientRect();if(a.x=(e.clientX-n.left)/n.width*2-1,a.y=-(e.clientY-n.top)/n.height*2+1,o.setFromCamera(a,t),l&&d.enabled)return o.ray.intersectPlane(i,u)&&l.position.copy(u.sub(c)),void d.dispatchEvent({type:"drag",object:l})}function b(n){n.preventDefault(),n=n.changedTouches[0];var s=r.getBoundingClientRect();a.x=(n.clientX-s.left)/s.width*2-1,a.y=-(n.clientY-s.top)/s.height*2+1,o.setFromCamera(a,t);var h=o.intersectObjects(e);h.length>0&&(l=h[0].object,i.setFromNormalAndCoplanarPoint(t.getWorldDirection(i.normal),l.position),o.ray.intersectPlane(i,u)&&c.copy(u).sub(l.position),r.style.cursor="move",d.dispatchEvent({type:"dragstart",object:l}))}function w(e){e.preventDefault(),l&&(d.dispatchEvent({type:"dragend",object:l}),l=null),r.style.cursor="auto"}f(),this.enabled=!0,this.activate=f,this.deactivate=p,this.dispose=function(){p()},this.setObjects=function(){console.error("DragControls: setObjects() has been removed.")},this.on=function(e,t){console.warn("DragControls: on() has been deprecated. Use addEventListener() instead."),d.addEventListener(e,t)},this.off=function(e,t){console.warn("DragControls: off() has been deprecated. Use removeEventListener() instead."),d.removeEventListener(e,t)},this.notify=function(e){console.error("DragControls: notify() has been deprecated. Use dispatchEvent() instead."),d.dispatchEvent({type:e})}};function Fn(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}(Dn.prototype=Object.create(u.prototype)).constructor=Dn,Object.assign(Fn.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(o.clamp(t/this.radius,-1,1))),this}});var Un=function(e,t){t=void 0!==t?t:document,this.enabled=!0,this.center=new s,this.panSpeed=.001,this.zoomSpeed=.1,this.rotationSpeed=.005;var r=this,n=new s,i=new s,o=new y,a={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},c=a.NONE,u=this.center,l=new d,h=new x,f=new x,p=new Fn,m={type:"change"};function v(e){!1!==r.enabled&&(0===e.button?c=a.ROTATE:1===e.button?c=a.ZOOM:2===e.button&&(c=a.PAN),f.set(e.clientX,e.clientY),t.addEventListener("mousemove",g,!1),t.addEventListener("mouseup",b,!1),t.addEventListener("mouseout",b,!1),t.addEventListener("dblclick",b,!1))}function g(e){if(!1!==r.enabled){h.set(e.clientX,e.clientY);var t=h.x-f.x,n=h.y-f.y;c===a.ROTATE?r.rotate(i.set(-t*r.rotationSpeed,-n*r.rotationSpeed,0)):c===a.ZOOM?r.zoom(i.set(0,0,n)):c===a.PAN&&r.pan(i.set(-t,n,0)),f.set(e.clientX,e.clientY)}}function b(e){t.removeEventListener("mousemove",g,!1),t.removeEventListener("mouseup",b,!1),t.removeEventListener("mouseout",b,!1),t.removeEventListener("dblclick",b,!1),c=a.NONE}function w(e){e.preventDefault(),r.zoom(i.set(0,0,e.deltaY>0?1:-1))}function _(e){e.preventDefault()}this.focus=function(t){var n;o.setFromObject(t),!1===o.isEmpty()?(u.copy(o.getCenter()),n=o.getBoundingSphere().radius):(u.setFromMatrixPosition(t.matrixWorld),n=.1),i.set(0,0,1),i.applyQuaternion(e.quaternion),i.multiplyScalar(4*n),e.position.copy(u).add(i),r.dispatchEvent(m)},this.pan=function(t){var n=e.position.distanceTo(u);t.multiplyScalar(n*r.panSpeed),t.applyMatrix3(l.getNormalMatrix(e.matrix)),e.position.add(t),u.add(t),r.dispatchEvent(m)},this.zoom=function(t){var n=e.position.distanceTo(u);t.multiplyScalar(n*r.zoomSpeed),t.length()>n||(t.applyMatrix3(l.getNormalMatrix(e.matrix)),e.position.add(t),r.dispatchEvent(m))},this.rotate=function(t){n.copy(e.position).sub(u),p.setFromVector3(n),p.theta+=t.x,p.phi+=t.y,p.makeSafe(),n.setFromSpherical(p),e.position.copy(u).add(n),e.lookAt(u),r.dispatchEvent(m)},this.dispose=function(){t.removeEventListener("contextmenu",_,!1),t.removeEventListener("mousedown",v,!1),t.removeEventListener("wheel",w,!1),t.removeEventListener("mousemove",g,!1),t.removeEventListener("mouseup",b,!1),t.removeEventListener("mouseout",b,!1),t.removeEventListener("dblclick",b,!1),t.removeEventListener("touchstart",A,!1),t.removeEventListener("touchmove",E,!1)},t.addEventListener("contextmenu",_,!1),t.addEventListener("mousedown",v,!1),t.addEventListener("wheel",w,!1);var S=[new s,new s,new s],M=[new s,new s,new s],T=null;function A(e){if(!1!==r.enabled){switch(e.touches.length){case 1:S[0].set(e.touches[0].pageX,e.touches[0].pageY,0),S[1].set(e.touches[0].pageX,e.touches[0].pageY,0);break;case 2:S[0].set(e.touches[0].pageX,e.touches[0].pageY,0),S[1].set(e.touches[1].pageX,e.touches[1].pageY,0),T=S[0].distanceTo(S[1])}M[0].copy(S[0]),M[1].copy(S[1])}}function E(e){if(!1!==r.enabled){switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:S[0].set(e.touches[0].pageX,e.touches[0].pageY,0),S[1].set(e.touches[0].pageX,e.touches[0].pageY,0),r.rotate(S[0].sub(a(S[0],M)).multiplyScalar(-r.rotationSpeed));break;case 2:S[0].set(e.touches[0].pageX,e.touches[0].pageY,0),S[1].set(e.touches[1].pageX,e.touches[1].pageY,0);var t=S[0].distanceTo(S[1]);r.zoom(i.set(0,0,T-t)),T=t;var n=S[0].clone().sub(a(S[0],M)),o=S[1].clone().sub(a(S[1],M));n.x=-n.x,o.x=-o.x,r.pan(n.add(o).multiplyScalar(.5))}M[0].copy(S[0]),M[1].copy(S[1])}function a(e,t){var r=t[0];for(var n in t)r.distanceTo(e)>t[n].distanceTo(e)&&(r=t[n]);return r}}t.addEventListener("touchstart",A,!1),t.addEventListener("touchmove",E,!1)};(Un.prototype=Object.create(u.prototype)).constructor=Un;var kn=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new s,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:j.LEFT,MIDDLE:j.MIDDLE,RIGHT:j.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),l=u.NONE},this.update=function(){var t=new s,i=(new c).setFromUnitVectors(e.up,new s(0,1,0)),o=i.clone().inverse(),a=new s,g=new c;return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(i),d.setFromVector3(t),r.autoRotate&&l===u.NONE&&R(2*Math.PI/60/60*r.autoRotateSpeed),d.theta+=f.theta,d.phi+=f.phi,d.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,d.theta)),d.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=p,d.radius=Math.max(r.minDistance,Math.min(r.maxDistance,d.radius)),r.target.add(m),t.setFromSpherical(d),t.applyQuaternion(o),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,m.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),m.set(0,0,0)),p=1,!!(v||a.distanceToSquared(r.object.position)>h||8*(1-g.dot(r.object.quaternion))>h)&&(r.dispatchEvent(n),a.copy(r.object.position),g.copy(r.object.quaternion),v=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",$,!1),r.domElement.removeEventListener("mousedown",H,!1),r.domElement.removeEventListener("wheel",Y,!1),r.domElement.removeEventListener("touchstart",Q,!1),r.domElement.removeEventListener("touchend",K,!1),r.domElement.removeEventListener("touchmove",Z,!1),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",q,!1),i.removeEventListener("keydown",J,!1)};var r=this,n={type:"change"},o={type:"start"},a={type:"end"},u={NONE:0,ROTATE_UP:1,ROTATE_LEFT:2,ROTATE:3,DOLLY:4,DOLLY_ROTATE:7,PAN:8,DOLLY_PAN:12},l=u.NONE,h=1e-6,d=new Fn,f=new Fn,p=1,m=new s,v=!1,g=new x,y=new x,b=new x,w=new x,_=new x,S=new x,M=new x,T=new x,A=new x,E=new x,C=new x,L=new x,P=new x,O=new x;function N(){return Math.pow(.95,r.zoomSpeed)}function R(e){f.theta-=e}function I(e){f.phi-=e}var D=function(){var e=new s;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),m.add(e)}}(),F=function(){var e=new s;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),m.add(e)}}(),U=function(){var e=new s;return function(t,n){var i=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),D(2*t*a/i.clientHeight,r.object.matrix),F(2*n*a/i.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(D(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),F(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: MapControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function k(e){r.object.isPerspectiveCamera?p/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function B(e){r.object.isPerspectiveCamera?p*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: MapControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function z(e){g.set(e.clientX,e.clientY)}function V(e){if(!1!==r.enableRotate&&0!=(l&u.ROTATE)){if(b.set(e.touches[0].pageX,e.touches[0].pageY),w.set(e.touches[1].pageX,e.touches[1].pageY),_.subVectors(b,g),S.subVectors(w,y),M.subVectors(y,g),T.subVectors(w,b),function(){if(!G(M))return!1;if(!G(T))return!1;if(!W(_))return!1;if(!W(S))return!1;return _.dot(S)>0}()){var t=r.domElement===document?r.domElement.body:r.domElement;I(2*Math.PI*_.y/t.clientHeight),l=u.ROTATE_UP}else 0!=(l&u.ROTATE_LEFT)&&R((M.angle()-T.angle())*r.rotateSpeed);g.copy(b),y.copy(w)}}var G=function(){var e=Math.sin(Math.PI/6);return function(t){return Math.abs(Math.sin(t.angle()))<e}}(),W=function(){var e=Math.cos(Math.PI/2-Math.PI/6);return function(t){return Math.abs(Math.cos(t.angle()))<e}}();function H(e){if(!1!==r.enabled){switch(e.preventDefault(),e.button){case r.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey){if(!1===r.enableRotate)return;z(e),l=u.ROTATE}else{if(!1===r.enablePan)return;!function(e){A.set(e.clientX,e.clientY)}(e),l=u.PAN}break;case r.mouseButtons.MIDDLE:if(!1===r.enableZoom)return;!function(e){L.set(e.clientX,e.clientY)}(e),l=u.DOLLY;break;case r.mouseButtons.RIGHT:if(!1===r.enableRotate)return;z(e),l=u.ROTATE}l!==u.NONE&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",q,!1),r.dispatchEvent(o))}}function X(e){if(!1!==r.enabled)switch(e.preventDefault(),l){case u.ROTATE:if(!1===r.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),_.subVectors(b,g).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;R(2*Math.PI*_.x/t.clientHeight),I(2*Math.PI*_.y/t.clientHeight),g.copy(b),r.update()}(e);break;case u.DOLLY:if(!1===r.enableZoom)return;!function(e){P.set(e.clientX,e.clientY),O.subVectors(P,L),O.y>0?k(N()):O.y<0&&B(N()),L.copy(P),r.update()}(e);break;case u.PAN:if(!1===r.enablePan)return;!function(e){E.set(e.clientX,e.clientY),C.subVectors(E,A).multiplyScalar(r.panSpeed),U(C.x,C.y),A.copy(E),r.update()}(e)}}function q(e){!1!==r.enabled&&(document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",q,!1),r.dispatchEvent(a),l=u.NONE)}function Y(e){!1===r.enabled||!1===r.enableZoom||l!==u.NONE&&l!==u.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(o),function(e){e.deltaY<0?B(N()):e.deltaY>0&&k(N()),r.update()}(e),r.dispatchEvent(a))}function J(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){switch(e.keyCode){case r.keys.UP:U(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:U(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:U(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:U(-r.keyPanSpeed,0),r.update()}}(e)}function Q(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enablePan)return;!function(e){r.enablePan&&A.set(e.touches[0].pageX,e.touches[0].pageY)}(e),l=u.PAN;break;case 2:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){g.set(e.touches[0].pageX,e.touches[0].pageY),y.set(e.touches[1].pageX,e.touches[1].pageY)}(e),function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);L.set(0,i)}}(e),l=u.DOLLY_ROTATE;break;default:l=u.NONE}l!==u.NONE&&r.dispatchEvent(o)}}function Z(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enablePan)return;if(l!==u.PAN)return;!function(e){!1!==r.enablePan&&0!=(l&u.PAN)&&(E.set(e.touches[0].pageX,e.touches[0].pageY),C.subVectors(E,A).multiplyScalar(r.panSpeed),U(C.x,C.y),A.copy(E))}(e),r.update();break;case 2:if(!1===r.enableZoom&&!1===r.enableRotate)return;if(0==(l&u.DOLLY_ROTATE))return;V(e),function(e){if(!1!==r.enableZoom&&0!=(l&u.DOLLY)){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);P.set(0,i),O.set(0,Math.pow(P.y/L.y,r.zoomSpeed)),k(O.y),L.copy(P)}}(e),r.update();break;default:l=u.NONE}}function K(e){!1!==r.enabled&&(r.dispatchEvent(a),l=u.NONE)}function $(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",$,!1),r.domElement.addEventListener("mousedown",H,!1),r.domElement.addEventListener("wheel",Y,!1),r.domElement.addEventListener("touchstart",Q,!1),r.domElement.addEventListener("touchend",K,!1),r.domElement.addEventListener("touchmove",Z,!1),i.addEventListener("keydown",J,!1),this.update()};(kn.prototype=Object.create(u.prototype)).constructor=kn,Object.defineProperties(kn.prototype,{center:{get:function(){return console.warn("MapControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("MapControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("MapControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("MapControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("MapControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("MapControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("MapControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("MapControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("MapControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("MapControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("MapControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("MapControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var Bn=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new s,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:j.LEFT,MIDDLE:j.MIDDLE,RIGHT:j.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),l=u.NONE},this.update=function(){var t=new s,i=(new c).setFromUnitVectors(e.up,new s(0,1,0)),o=i.clone().inverse(),a=new s,g=new c;return function(){var e=r.object.position;return t.copy(e).sub(r.target),t.applyQuaternion(i),d.setFromVector3(t),r.autoRotate&&l===u.NONE&&C(2*Math.PI/60/60*r.autoRotateSpeed),d.theta+=f.theta,d.phi+=f.phi,d.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,d.theta)),d.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=p,d.radius=Math.max(r.minDistance,Math.min(r.maxDistance,d.radius)),r.target.add(m),t.setFromSpherical(d),t.applyQuaternion(o),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,m.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),m.set(0,0,0)),p=1,!!(v||a.distanceToSquared(r.object.position)>h||8*(1-g.dot(r.object.quaternion))>h)&&(r.dispatchEvent(n),a.copy(r.object.position),g.copy(r.object.quaternion),v=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",H,!1),r.domElement.removeEventListener("mousedown",F,!1),r.domElement.removeEventListener("wheel",B,!1),r.domElement.removeEventListener("touchstart",V,!1),r.domElement.removeEventListener("touchend",W,!1),r.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",U,!1),document.removeEventListener("mouseup",k,!1),i.removeEventListener("keydown",z,!1)};var r=this,n={type:"change"},o={type:"start"},a={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},l=u.NONE,h=1e-6,d=new Fn,f=new Fn,p=1,m=new s,v=!1,g=new x,y=new x,b=new x,w=new x,_=new x,S=new x,M=new x,T=new x,A=new x;function E(){return Math.pow(.95,r.zoomSpeed)}function C(e){f.theta-=e}function L(e){f.phi-=e}var P=function(){var e=new s;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),m.add(e)}}(),O=function(){var e=new s;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),m.add(e)}}(),N=function(){var e=new s;return function(t,n){var i=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),P(2*t*a/i.clientHeight,r.object.matrix),O(2*n*a/i.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(P(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),O(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function R(e){r.object.isPerspectiveCamera?p/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function I(e){r.object.isPerspectiveCamera?p*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function D(e){w.set(e.clientX,e.clientY)}function F(e){if(!1!==r.enabled){switch(e.preventDefault(),e.button){case r.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey){if(!1===r.enablePan)return;D(e),l=u.PAN}else{if(!1===r.enableRotate)return;!function(e){g.set(e.clientX,e.clientY)}(e),l=u.ROTATE}break;case r.mouseButtons.MIDDLE:if(!1===r.enableZoom)return;!function(e){M.set(e.clientX,e.clientY)}(e),l=u.DOLLY;break;case r.mouseButtons.RIGHT:if(!1===r.enablePan)return;D(e),l=u.PAN}l!==u.NONE&&(document.addEventListener("mousemove",U,!1),document.addEventListener("mouseup",k,!1),r.dispatchEvent(o))}}function U(e){if(!1!==r.enabled)switch(e.preventDefault(),l){case u.ROTATE:if(!1===r.enableRotate)return;!function(e){y.set(e.clientX,e.clientY),b.subVectors(y,g).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;C(2*Math.PI*b.x/t.clientHeight),L(2*Math.PI*b.y/t.clientHeight),g.copy(y),r.update()}(e);break;case u.DOLLY:if(!1===r.enableZoom)return;!function(e){T.set(e.clientX,e.clientY),A.subVectors(T,M),A.y>0?R(E()):A.y<0&&I(E()),M.copy(T),r.update()}(e);break;case u.PAN:if(!1===r.enablePan)return;!function(e){_.set(e.clientX,e.clientY),S.subVectors(_,w).multiplyScalar(r.panSpeed),N(S.x,S.y),w.copy(_),r.update()}(e)}}function k(e){!1!==r.enabled&&(document.removeEventListener("mousemove",U,!1),document.removeEventListener("mouseup",k,!1),r.dispatchEvent(a),l=u.NONE)}function B(e){!1===r.enabled||!1===r.enableZoom||l!==u.NONE&&l!==u.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(o),function(e){e.deltaY<0?I(E()):e.deltaY>0&&R(E()),r.update()}(e),r.dispatchEvent(a))}function z(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){switch(e.keyCode){case r.keys.UP:N(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:N(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:N(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:N(-r.keyPanSpeed,0),r.update()}}(e)}function V(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enableRotate)return;!function(e){g.set(e.touches[0].pageX,e.touches[0].pageY)}(e),l=u.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);M.set(0,i)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(o,a)}}(e),l=u.TOUCH_DOLLY_PAN;break;default:l=u.NONE}l!==u.NONE&&r.dispatchEvent(o)}}function G(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enableRotate)return;if(l!==u.TOUCH_ROTATE)return;!function(e){y.set(e.touches[0].pageX,e.touches[0].pageY),b.subVectors(y,g).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;C(2*Math.PI*b.x/t.clientHeight),L(2*Math.PI*b.y/t.clientHeight),g.copy(y),r.update()}(e);break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;if(l!==u.TOUCH_DOLLY_PAN)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);T.set(0,i),A.set(0,Math.pow(T.y/M.y,r.zoomSpeed)),R(A.y),M.copy(T)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(o,a),S.subVectors(_,w).multiplyScalar(r.panSpeed),N(S.x,S.y),w.copy(_)}r.update()}(e);break;default:l=u.NONE}}function W(e){!1!==r.enabled&&(r.dispatchEvent(a),l=u.NONE)}function H(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",H,!1),r.domElement.addEventListener("mousedown",F,!1),r.domElement.addEventListener("wheel",B,!1),r.domElement.addEventListener("touchstart",V,!1),r.domElement.addEventListener("touchend",W,!1),r.domElement.addEventListener("touchmove",G,!1),i.addEventListener("keydown",z,!1),this.update()};(Bn.prototype=Object.create(u.prototype)).constructor=Bn,Object.defineProperties(Bn.prototype,{center:{get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var zn=function(e,t){var r=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new s;var o=!0,a=n.NONE,u=n.NONE,l=new s,h=new s,d=new s,f=new x,p=new x,m=0,v=0,g=new x,y=new x;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var b={type:"change"},w={type:"start"},_={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=i.innerWidth,this.screen.height=i.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+i.pageXOffset-t.clientLeft,this.screen.top=e.top+i.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom};var S=function(){var e=new x;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),M=function(){var e=new s,t=new s,n=new s;return function(i,o){n.set((i-.5*r.screen.width-r.screen.left)/r.radius,(.5*r.screen.height+r.screen.top-o)/r.radius,0);var a=n.length();return r.noRoll?a<Math.SQRT1_2?n.z=Math.sqrt(1-a*a):n.z=.5/a:a>1?n.normalize():n.z=Math.sqrt(1-a*a),l.copy(r.object.position).sub(r.target),e.copy(r.object.up).setLength(n.y),e.add(t.copy(r.object.up).cross(l).setLength(n.x)),e.add(l.setLength(n.z)),e}}();function T(e){!1!==r.enabled&&(i.removeEventListener("keydown",T),u=a,a===n.NONE&&(e.keyCode!==r.keys[n.ROTATE]||r.noRotate?e.keyCode!==r.keys[n.ZOOM]||r.noZoom?e.keyCode!==r.keys[n.PAN]||r.noPan||(a=n.PAN):a=n.ZOOM:a=n.ROTATE))}function A(e){!1!==r.enabled&&(a=u,i.addEventListener("keydown",T,!1))}function E(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a===n.NONE&&(a=e.button),a!==n.ROTATE||r.noRotate?a!==n.ZOOM||r.noZoom?a!==n.PAN||r.noPan||(g.copy(S(e.pageX,e.pageY)),y.copy(g)):(f.copy(S(e.pageX,e.pageY)),p.copy(f)):(h.copy(M(e.pageX,e.pageY)),d.copy(h)),document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",L,!1),r.dispatchEvent(w))}function C(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a!==n.ROTATE||r.noRotate?a!==n.ZOOM||r.noZoom?a!==n.PAN||r.noPan||y.copy(S(e.pageX,e.pageY)):p.copy(S(e.pageX,e.pageY)):d.copy(M(e.pageX,e.pageY)))}function L(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a=n.NONE,document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",L),r.dispatchEvent(_))}function P(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),f.y+=.01*e.deltaY,r.dispatchEvent(w),r.dispatchEvent(_))}function O(e){if(!1!==r.enabled){switch(e.touches.length){case 1:a=n.TOUCH_ROTATE,h.copy(M(e.touches[0].pageX,e.touches[0].pageY)),d.copy(h);break;case 2:a=n.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;v=m=Math.sqrt(t*t+i*i);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;g.copy(S(o,s)),y.copy(g);break;default:a=n.NONE}r.dispatchEvent(w)}}function N(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:d.copy(M(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;v=Math.sqrt(t*t+i*i);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;y.copy(S(o,s));break;default:a=n.NONE}}function R(e){if(!1!==r.enabled){switch(e.touches.length){case 1:d.copy(M(e.touches[0].pageX,e.touches[0].pageY)),h.copy(d);break;case 2:m=v=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;y.copy(S(t,i)),g.copy(y)}a=n.NONE,r.dispatchEvent(_)}}function I(e){e.preventDefault()}this.rotateCamera=function(){var e=new s,t=new c;return function(){var n=Math.acos(h.dot(d)/h.length()/d.length());n&&(e.crossVectors(h,d).normalize(),n*=r.rotateSpeed,t.setFromAxisAngle(e,-n),l.applyQuaternion(t),r.object.up.applyQuaternion(t),d.applyQuaternion(t),r.staticMoving?h.copy(d):(t.setFromAxisAngle(e,n*(r.dynamicDampingFactor-1)),h.applyQuaternion(t)),o=!0)}}(),this.zoomCamera=function(){if(a===n.TOUCH_ZOOM_PAN){var e=v/m;m=v,r.object.zoom*=e,o=!0}else{e=1+(p.y-f.y)*r.zoomSpeed;Math.abs(e-1)>1e-6&&e>0&&(r.object.zoom/=e,r.staticMoving?f.copy(p):f.y+=(p.y-f.y)*this.dynamicDampingFactor,o=!0)}},this.panCamera=function(){var e=new x,t=new s,n=new s;return function(){if(e.copy(y).sub(g),e.lengthSq()){var i=(r.object.right-r.object.left)/r.object.zoom,a=(r.object.top-r.object.bottom)/r.object.zoom;e.x*=i,e.y*=a,n.copy(l).cross(r.object.up).setLength(e.x),n.add(t.copy(r.object.up).setLength(e.y)),r.object.position.add(n),r.target.add(n),r.staticMoving?g.copy(y):g.add(e.subVectors(y,g).multiplyScalar(r.dynamicDampingFactor)),o=!0}}}(),this.update=function(){l.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||(r.zoomCamera(),o&&r.object.updateProjectionMatrix()),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,l),r.object.lookAt(r.target),o&&(r.dispatchEvent(b),o=!1)},this.reset=function(){a=n.NONE,u=n.NONE,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),l.subVectors(r.object.position,r.target),r.object.left=r.left0,r.object.right=r.right0,r.object.top=r.top0,r.object.bottom=r.bottom0,r.object.lookAt(r.target),r.dispatchEvent(b),o=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",I,!1),this.domElement.removeEventListener("mousedown",E,!1),this.domElement.removeEventListener("wheel",P,!1),this.domElement.removeEventListener("touchstart",O,!1),this.domElement.removeEventListener("touchend",R,!1),this.domElement.removeEventListener("touchmove",N,!1),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",L,!1),i.removeEventListener("keydown",T,!1),i.removeEventListener("keyup",A,!1)},this.domElement.addEventListener("contextmenu",I,!1),this.domElement.addEventListener("mousedown",E,!1),this.domElement.addEventListener("wheel",P,!1),this.domElement.addEventListener("touchstart",O,!1),this.domElement.addEventListener("touchend",R,!1),this.domElement.addEventListener("touchmove",N,!1),i.addEventListener("keydown",T,!1),i.addEventListener("keyup",A,!1),this.handleResize(),this.update()};(zn.prototype=Object.create(u.prototype)).constructor=zn;var jn=function(e,t){var r=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new s;var o=new s,a=n.NONE,u=n.NONE,l=new s,h=new x,d=new x,f=new s,p=0,m=new x,v=new x,g=0,y=0,b=new x,w=new x;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var _={type:"change"},S={type:"start"},M={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=i.innerWidth,this.screen.height=i.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+i.pageXOffset-t.clientLeft,this.screen.top=e.top+i.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}};var T=function(){var e=new x;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),A=function(){var e=new x;return function(t,n){return e.set((t-.5*r.screen.width-r.screen.left)/(.5*r.screen.width),(r.screen.height+2*(r.screen.top-n))/r.screen.width),e}}();function E(e){!1!==r.enabled&&(i.removeEventListener("keydown",E),u=a,a===n.NONE&&(e.keyCode!==r.keys[n.ROTATE]||r.noRotate?e.keyCode!==r.keys[n.ZOOM]||r.noZoom?e.keyCode!==r.keys[n.PAN]||r.noPan||(a=n.PAN):a=n.ZOOM:a=n.ROTATE))}function C(e){!1!==r.enabled&&(a=u,i.addEventListener("keydown",E,!1))}function L(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a===n.NONE&&(a=e.button),a!==n.ROTATE||r.noRotate?a!==n.ZOOM||r.noZoom?a!==n.PAN||r.noPan||(b.copy(T(e.pageX,e.pageY)),w.copy(b)):(m.copy(T(e.pageX,e.pageY)),v.copy(m)):(d.copy(A(e.pageX,e.pageY)),h.copy(d)),document.addEventListener("mousemove",P,!1),document.addEventListener("mouseup",O,!1),r.dispatchEvent(S))}function P(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a!==n.ROTATE||r.noRotate?a!==n.ZOOM||r.noZoom?a!==n.PAN||r.noPan||w.copy(T(e.pageX,e.pageY)):v.copy(T(e.pageX,e.pageY)):(h.copy(d),d.copy(A(e.pageX,e.pageY))))}function O(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),a=n.NONE,document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",O),r.dispatchEvent(M))}function N(e){if(!1!==r.enabled&&!0!==r.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:m.y-=.025*e.deltaY;break;case 1:m.y-=.01*e.deltaY;break;default:m.y-=25e-5*e.deltaY}r.dispatchEvent(S),r.dispatchEvent(M)}}function R(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:a=n.TOUCH_ROTATE,d.copy(A(e.touches[0].pageX,e.touches[0].pageY)),h.copy(d);break;default:a=n.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;y=g=Math.sqrt(t*t+i*i);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;b.copy(T(o,s)),w.copy(b)}r.dispatchEvent(S)}}function I(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:h.copy(d),d.copy(A(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;y=Math.sqrt(t*t+n*n);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;w.copy(T(i,o))}}function D(e){if(!1!==r.enabled){switch(e.touches.length){case 0:a=n.NONE;break;case 1:a=n.TOUCH_ROTATE,d.copy(A(e.touches[0].pageX,e.touches[0].pageY)),h.copy(d)}r.dispatchEvent(M)}}function F(e){!1!==r.enabled&&e.preventDefault()}this.rotateCamera=function(){var e,t=new s,n=new c,i=new s,o=new s,a=new s,u=new s;return function(){u.set(d.x-h.x,d.y-h.y,0),(e=u.length())?(l.copy(r.object.position).sub(r.target),i.copy(l).normalize(),o.copy(r.object.up).normalize(),a.crossVectors(o,i).normalize(),o.setLength(d.y-h.y),a.setLength(d.x-h.x),u.copy(o.add(a)),t.crossVectors(u,l).normalize(),e*=r.rotateSpeed,n.setFromAxisAngle(t,e),l.applyQuaternion(n),r.object.up.applyQuaternion(n),f.copy(t),p=e):!r.staticMoving&&p&&(p*=Math.sqrt(1-r.dynamicDampingFactor),l.copy(r.object.position).sub(r.target),n.setFromAxisAngle(f,p),l.applyQuaternion(n),r.object.up.applyQuaternion(n)),h.copy(d)}}(),this.zoomCamera=function(){var e;a===n.TOUCH_ZOOM_PAN?(e=g/y,g=y,l.multiplyScalar(e)):(1!==(e=1+(v.y-m.y)*r.zoomSpeed)&&e>0&&l.multiplyScalar(e),r.staticMoving?m.copy(v):m.y+=(v.y-m.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new x,t=new s,n=new s;return function(){e.copy(w).sub(b),e.lengthSq()&&(e.multiplyScalar(l.length()*r.panSpeed),n.copy(l).cross(r.object.up).setLength(e.x),n.add(t.copy(r.object.up).setLength(e.y)),r.object.position.add(n),r.target.add(n),r.staticMoving?b.copy(w):b.add(e.subVectors(w,b).multiplyScalar(r.dynamicDampingFactor)))}}(),this.checkDistances=function(){r.noZoom&&r.noPan||(l.lengthSq()>r.maxDistance*r.maxDistance&&(r.object.position.addVectors(r.target,l.setLength(r.maxDistance)),m.copy(v)),l.lengthSq()<r.minDistance*r.minDistance&&(r.object.position.addVectors(r.target,l.setLength(r.minDistance)),m.copy(v)))},this.update=function(){l.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||r.zoomCamera(),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,l),r.checkDistances(),r.object.lookAt(r.target),o.distanceToSquared(r.object.position)>1e-6&&(r.dispatchEvent(_),o.copy(r.object.position))},this.reset=function(){a=n.NONE,u=n.NONE,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),l.subVectors(r.object.position,r.target),r.object.lookAt(r.target),r.dispatchEvent(_),o.copy(r.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",F,!1),this.domElement.removeEventListener("mousedown",L,!1),this.domElement.removeEventListener("wheel",N,!1),this.domElement.removeEventListener("touchstart",R,!1),this.domElement.removeEventListener("touchend",D,!1),this.domElement.removeEventListener("touchmove",I,!1),document.removeEventListener("mousemove",P,!1),document.removeEventListener("mouseup",O,!1),i.removeEventListener("keydown",E,!1),i.removeEventListener("keyup",C,!1)},this.domElement.addEventListener("contextmenu",F,!1),this.domElement.addEventListener("mousedown",L,!1),this.domElement.addEventListener("wheel",N,!1),this.domElement.addEventListener("touchstart",R,!1),this.domElement.addEventListener("touchend",D,!1),this.domElement.addEventListener("touchmove",I,!1),i.addEventListener("keydown",E,!1),i.addEventListener("keyup",C,!1),this.handleResize(),this.update()};function Vn(e,t,r,n){_.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new Gn(e,t,r,n)),this.mergeVertices()}function Gn(e,t,r,n){U.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;var i=[],o=[];function a(e,t,r,n){var i,o,a=Math.pow(2,n),s=[];for(i=0;i<=a;i++){s[i]=[];var u=e.clone().lerp(r,i/a),l=t.clone().lerp(r,i/a),h=a-i;for(o=0;o<=h;o++)s[i][o]=0===o&&i===a?u:u.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var d=Math.floor(o/2);o%2==0?(c(s[i][d+1]),c(s[i+1][d]),c(s[i][d])):(c(s[i][d+1]),c(s[i+1][d+1]),c(s[i+1][d]))}}function c(e){i.push(e.x,e.y,e.z)}function u(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function l(e,t,r,n){n<0&&1===e.x&&(o[t]=e.x-1),0===r.x&&0===r.z&&(o[t]=n/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var r=new s,n=new s,i=new s,o=0;o<t.length;o+=3)u(t[o+0],r),u(t[o+1],n),u(t[o+2],i),a(r,n,i,e)}(n=n||0),function(e){for(var t=new s,r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){for(var e=new s,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var r=h(e)/2/Math.PI+.5,n=d(e)/Math.PI+.5;o.push(r,1-n)}(function(){for(var e=new s,t=new s,r=new s,n=new s,a=new x,c=new x,u=new x,d=0,f=0;d<i.length;d+=9,f+=6){e.set(i[d+0],i[d+1],i[d+2]),t.set(i[d+3],i[d+4],i[d+5]),r.set(i[d+6],i[d+7],i[d+8]),a.set(o[f+0],o[f+1]),c.set(o[f+2],o[f+3]),u.set(o[f+4],o[f+5]),n.copy(e).add(t).add(r).divideScalar(3);var p=h(n);l(a,f+0,e,p),l(c,f+2,t,p),l(u,f+4,r,p)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],r=o[e+2],n=o[e+4],i=Math.max(t,r,n),a=Math.min(t,r,n);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),r<.2&&(o[e+2]+=1),n<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new N(i,3)),this.addAttribute("normal",new N(i.slice(),3)),this.addAttribute("uv",new N(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Wn(e,t){_.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Hn(e,t)),this.mergeVertices()}function Hn(e,t){Gn.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Xn(e,t,r,n,i){_.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new qn(e,t,r,n,i)),this.mergeVertices()}function qn(e,t,r,n,i){U.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||1,t=t||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,a,c=[],u=[],l=[],h=[],d=new s,f=new s,p=new s;for(o=0;o<=r;o++)for(a=0;a<=n;a++){var m=a/n*i,v=o/r*Math.PI*2;f.x=(e+t*Math.cos(v))*Math.cos(m),f.y=(e+t*Math.cos(v))*Math.sin(m),f.z=t*Math.sin(v),u.push(f.x,f.y,f.z),d.x=e*Math.cos(m),d.y=e*Math.sin(m),p.subVectors(f,d).normalize(),l.push(p.x,p.y,p.z),h.push(a/n),h.push(o/r)}for(o=1;o<=r;o++)for(a=1;a<=n;a++){var g=(n+1)*o+a-1,y=(n+1)*(o-1)+a-1,b=(n+1)*(o-1)+a,x=(n+1)*o+a;c.push(g,y,x),c.push(y,b,x)}this.setIndex(c),this.addAttribute("position",new N(u,3)),this.addAttribute("normal",new N(l,3)),this.addAttribute("uv",new N(h,2))}(jn.prototype=Object.create(u.prototype)).constructor=jn,Vn.prototype=Object.create(_.prototype),Vn.prototype.constructor=Vn,Gn.prototype=Object.create(U.prototype),Gn.prototype.constructor=Gn,Wn.prototype=Object.create(_.prototype),Wn.prototype.constructor=Wn,Hn.prototype=Object.create(Gn.prototype),Hn.prototype.constructor=Hn,Xn.prototype=Object.create(_.prototype),Xn.prototype.constructor=Xn,qn.prototype=Object.create(U.prototype),qn.prototype.constructor=qn;var Yn=function(e,t){p.call(this),t=void 0!==t?t:document,this.visible=!1;var r=new Jn;this.add(r);var n=new Qn;this.add(n);var i=this;B("camera",e),B("object",void 0),B("enabled",!0),B("axis",null),B("mode","translate"),B("translationSnap",null),B("rotationSnap",null),B("space","world"),B("size",1),B("dragging",!1),B("showX",!0),B("showY",!0),B("showZ",!0);var o={type:"change"},a={type:"mouseDown"},u={type:"mouseUp",mode:i.mode},l={type:"objectChange"},h=new Nn,d=new s,f=new s,m=new c,v={X:new s(1,0,0),Y:new s(0,1,0),Z:new s(0,0,1)},g=new c,y=new s,b=new s,x=new s,w=new s,_=0,S=new s,M=new c,T=new s,A=new s,E=new c,C=new s,L=new s,P=new c,O=new s,N=new s,R=new c,I=new s,D=new s,F=new s,U=new c,k=new s;function B(e,t){var a=t;Object.defineProperty(i,e,{get:function(){return void 0!==a?a:t},set:function(t){a!==t&&(a=t,n[e]=t,r[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(o))}}),i[e]=t,n[e]=t,r[e]=t}function z(e){var r=e.changedTouches?e.changedTouches[0]:e,n=t.getBoundingClientRect();return{x:(r.clientX-n.left)/n.width*2-1,y:-(r.clientY-n.top)/n.height*2+1,button:e.button}}function j(e){e.preventDefault()}function V(e){i.enabled&&i.pointerHover(z(e))}function G(e){i.enabled&&(e.preventDefault(),i.pointerHover(z(e)),i.pointerDown(z(e)))}function W(e){i.enabled&&(e.preventDefault(),i.pointerMove(z(e)))}function H(e){i.enabled&&(e.preventDefault(),i.pointerUp(z(e)))}B("parentQuaternion",E),B("worldPosition",N),B("worldPositionStart",L),B("worldQuaternion",R),B("worldQuaternionStart",P),B("cameraPosition",S),B("cameraQuaternion",M),B("pointStart",b),B("pointEnd",x),B("rotationAxis",w),B("rotationAngle",_),B("eye",D),t.addEventListener("mousedown",G,!1),t.addEventListener("touchstart",G,!1),t.addEventListener("mousemove",V,!1),t.addEventListener("touchmove",V,!1),document.addEventListener("mousemove",W,!1),t.addEventListener("touchmove",W,!1),document.addEventListener("mouseup",H,!1),t.addEventListener("touchend",H,!1),t.addEventListener("touchcancel",H,!1),t.addEventListener("touchleave",H,!1),t.addEventListener("contextmenu",j,!1),this.dispose=function(){t.removeEventListener("mousedown",G),t.removeEventListener("touchstart",G),t.removeEventListener("mousemove",V),t.removeEventListener("touchmove",V),document.removeEventListener("mousemove",W),t.removeEventListener("touchmove",W),document.removeEventListener("mouseup",H),t.removeEventListener("touchend",H),t.removeEventListener("touchcancel",H),t.removeEventListener("touchleave",H),t.removeEventListener("contextmenu",j)},this.attach=function(e){this.object=e,this.visible=!0},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(A,E,C),this.object.matrixWorld.decompose(N,R,I)),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(S,M,T),this.camera instanceof Wr?D.copy(S).sub(N).normalize():this.camera instanceof Yr&&D.copy(S).normalize(),p.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){h.setFromCamera(e,this.camera);var t=h.intersectObjects(r.picker[this.mode].children,!0)[0]||!1;this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(!(void 0===this.object||!0===this.dragging||void 0!==e.button&&0!==e.button||0!==e.button&&void 0!==e.button||null===this.axis)){h.setFromCamera(e,this.camera);var t=h.intersectObjects([n],!0)[0]||!1;if(t){var r=this.space;if("scale"===this.mode?r="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(r="world"),"local"===r&&"rotate"===this.mode){var i=this.rotationSnap;"X"===this.axis&&i&&(this.object.rotation.x=Math.round(this.object.rotation.x/i)*i),"Y"===this.axis&&i&&(this.object.rotation.y=Math.round(this.object.rotation.y/i)*i),"Z"===this.axis&&i&&(this.object.rotation.z=Math.round(this.object.rotation.z/i)*i)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),F.copy(this.object.position),U.copy(this.object.quaternion),k.copy(this.object.scale),this.object.matrixWorld.decompose(L,P,O),b.copy(t.point).sub(L),"local"===r&&b.applyQuaternion(P.clone().inverse())}this.dragging=!0,a.mode=this.mode,this.dispatchEvent(a)}},this.pointerMove=function(e){var t=this.axis,r=this.mode,i=this.object,a=this.space;if("scale"===r?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==i&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){h.setFromCamera(e,this.camera);var s=h.intersectObjects([n],!0)[0]||!1;if(!1!==s){if(x.copy(s.point).sub(L),"local"===a&&x.applyQuaternion(P.clone().inverse()),"translate"===r)-1===t.search("X")&&(x.x=b.x),-1===t.search("Y")&&(x.y=b.y),-1===t.search("Z")&&(x.z=b.z),"local"===a?i.position.copy(x).sub(b).applyQuaternion(U):i.position.copy(x).sub(b),i.position.add(F),this.translationSnap&&("local"===a&&(i.position.applyQuaternion(m.copy(U).inverse()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(U)),"world"===a&&(i.parent&&i.position.add(d.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(d.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){var c=x.length()/b.length();x.dot(b)<0&&(c*=-1),d.set(c,c,c)}else d.copy(x).divide(b),-1===t.search("X")&&(d.x=1),-1===t.search("Y")&&(d.y=1),-1===t.search("Z")&&(d.z=1);i.scale.copy(k).multiply(d)}else if("rotate"===r){var u=20/N.distanceTo(d.setFromMatrixPosition(this.camera.matrixWorld)),p="local"===this.space?R:g,S=v[t];"E"===t?(d.copy(x).cross(b),w.copy(D),_=x.angleTo(b)*(d.dot(D)<0?1:-1)):"XYZE"===t?(d.copy(x).sub(b).cross(D).normalize(),w.copy(d),_=x.sub(b).dot(d.cross(D))*u):"X"!==t&&"Y"!==t&&"Z"!==t||(y.copy(S).applyQuaternion(p),w.copy(S),d=S.clone(),f=x.clone().sub(b),"local"===a&&(d.applyQuaternion(p),f.applyQuaternion(P)),_=f.dot(d.cross(D).normalize())*u),this.rotationSnap&&(_=Math.round(_/this.rotationSnap)*this.rotationSnap),this.rotationAngle=_,"local"===a?(i.quaternion.copy(U),i.quaternion.multiply(m.setFromAxisAngle(w,_))):(i.quaternion.copy(m.setFromAxisAngle(w,_)),i.quaternion.multiply(U))}this.dispatchEvent(o),this.dispatchEvent(l)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(u.mode=this.mode,this.dispatchEvent(u)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return i.mode},this.setMode=function(e){i.mode=e},this.setTranslationSnap=function(e){i.translationSnap=e},this.setRotationSnap=function(e){i.rotationSnap=e},this.setSize=function(e){i.size=e},this.setSpace=function(e){i.space=e},this.update=function(){console.warn("TransformControls: update function has been depricated.")}};Yn.prototype=Object.assign(Object.create(p.prototype),{constructor:Yn,isTransformControls:!0});var Jn=function(){p.call(this),this.type="TransformControlsGizmo";var e=new cr({depthTest:!1,depthWrite:!1,transparent:!0,side:J,fog:!1}),t=new ur({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),r=e.clone();r.opacity=.15;var n=e.clone();n.opacity=.33;var i=e.clone();i.color.set(16711680);var o=e.clone();o.color.set(65280);var u=e.clone();u.color.set(255);var h=e.clone();h.opacity=.25;var d=h.clone();d.color.set(16776960);var f=h.clone();f.color.set(65535);var m=h.clone();m.color.set(16711935),e.clone().color.set(16776960);var g=t.clone();g.color.set(16711680);var y=t.clone();y.color.set(65280);var b=t.clone();b.color.set(255);var x=t.clone();x.color.set(65535);var w=t.clone();w.color.set(16711935);var _=t.clone();_.color.set(16776960);var S=t.clone();S.color.set(7895160);var M=_.clone();M.opacity=.25;var T=new Br(0,.05,.2,12,1,!1),A=new Ur(.125,.125,.125),E=new U;E.addAttribute("position",new N([0,0,0,1,0,0],3));var C=function(e,t){for(var r=new U,n=[],i=0;i<=64*t;++i)n.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return r.addAttribute("position",new N(n,3)),r},L={X:[[new dr(T,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new dr(T,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new fr(E,g)]],Y:[[new dr(T,o),[0,1,0],null,null,"fwd"],[new dr(T,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new fr(E,y),null,[0,0,Math.PI/2]]],Z:[[new dr(T,u),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new dr(T,u),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new fr(E,b),null,[0,-Math.PI/2,0]]],XYZ:[[new dr(new Hn(.1,0),h),[0,0,0],[0,0,0]]],XY:[[new dr(new en(.295,.295),d),[.15,.15,0]],[new fr(E,_),[.18,.3,0],null,[.125,1,1]],[new fr(E,_),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new dr(new en(.295,.295),f),[0,.15,.15],[0,Math.PI/2,0]],[new fr(E,x),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new fr(E,x),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new dr(new en(.295,.295),m),[.15,0,.15],[-Math.PI/2,0,0]],[new fr(E,w),[.18,0,.3],null,[.125,1,1]],[new fr(E,w),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},P={X:[[new dr(new Br(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new dr(new Br(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new dr(new Br(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new dr(new Hn(.2,0),r)]],XY:[[new dr(new en(.4,.4),r),[.2,.2,0]]],YZ:[[new dr(new en(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new dr(new en(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},O={START:[[new dr(new Hn(.01,2),n),null,null,null,"helper"]],END:[[new dr(new Hn(.01,2),n),null,null,null,"helper"]],DELTA:[[new fr(function(e,t){var r=new U;return r.addAttribute("position",new N([0,0,0,1,1,1],3)),r}(),n),null,null,null,"helper"]],X:[[new fr(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new fr(E,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new fr(E,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},R={X:[[new fr(C(1,.5),g)],[new dr(new Hn(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new fr(C(1,.5),y),null,[0,0,-Math.PI/2]],[new dr(new Hn(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new fr(C(1,.5),b),null,[0,Math.PI/2,0]],[new dr(new Hn(.04,0),u),[.99,0,0],null,[1,3,1]]],E:[[new fr(C(1.25,1),M),null,[0,Math.PI/2,0]],[new dr(new Br(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new dr(new Br(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new dr(new Br(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new dr(new Br(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new fr(C(1,1),S),null,[0,Math.PI/2,0]]]},I={AXIS:[[new fr(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},D={X:[[new dr(new qn(1,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new dr(new qn(1,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new dr(new qn(1,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new dr(new qn(1.25,.1,2,24),r)]],XYZE:[[new dr(new B(.7,10,8),r)]]},F={X:[[new dr(A,i),[.8,0,0],[0,0,-Math.PI/2]],[new fr(E,g),null,null,[.8,1,1]]],Y:[[new dr(A,o),[0,.8,0]],[new fr(E,y),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new dr(A,u),[0,0,.8],[Math.PI/2,0,0]],[new fr(E,b),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new dr(A,d),[.85,.85,0],null,[2,2,.2]],[new fr(E,_),[.855,.98,0],null,[.125,1,1]],[new fr(E,_),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new dr(A,f),[0,.85,.85],null,[.2,2,2]],[new fr(E,x),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new fr(E,x),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new dr(A,m),[.85,0,.85],null,[2,.2,2]],[new fr(E,w),[.855,0,.98],null,[.125,1,1]],[new fr(E,w),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new dr(new Ur(.125,.125,.125),h),[1.1,0,0]]],XYZY:[[new dr(new Ur(.125,.125,.125),h),[0,1.1,0]]],XYZZ:[[new dr(new Ur(.125,.125,.125),h),[0,0,1.1]]]},k={X:[[new dr(new Br(.2,0,.8,4,1,!1),r),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new dr(new Br(.2,0,.8,4,1,!1),r),[0,.5,0]]],Z:[[new dr(new Br(.2,0,.8,4,1,!1),r),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new dr(A,r),[.85,.85,0],null,[3,3,.2]]],YZ:[[new dr(A,r),[0,.85,.85],null,[.2,3,3]]],XZ:[[new dr(A,r),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new dr(new Ur(.2,.2,.2),r),[1.1,0,0]]],XYZY:[[new dr(new Ur(.2,.2,.2),r),[0,1.1,0]]],XYZZ:[[new dr(new Ur(.2,.2,.2),r),[0,0,1.1]]]},z={X:[[new fr(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new fr(E,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new fr(E,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},j=function(e){var t=new p;for(var r in e)for(var n=e[r].length;n--;){var i=e[r][n][0].clone(),o=e[r][n][1],a=e[r][n][2],s=e[r][n][3],c=e[r][n][4];i.name=r,i.tag=c,o&&i.position.set(o[0],o[1],o[2]),a&&i.rotation.set(a[0],a[1],a[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();var u=i.geometry.clone();u.applyMatrix(i.matrix),i.geometry=u,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t},V=new s(0,0,0),G=new l,W=new s(0,1,0),H=new s(0,0,0),X=new a,q=new c,Y=new c,Q=new c,Z=new s(1,0,0),K=new s(0,1,0),$=new s(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=j(L)),this.add(this.gizmo.rotate=j(R)),this.add(this.gizmo.scale=j(F)),this.add(this.picker.translate=j(P)),this.add(this.picker.rotate=j(D)),this.add(this.picker.scale=j(k)),this.add(this.helper.translate=j(O)),this.add(this.helper.rotate=j(I)),this.add(this.helper.scale=j(z)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:Q;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var r=[];r=(r=(r=r.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<r.length;n++){var i=r[n];i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition);var o=this.worldPosition.distanceTo(this.cameraPosition);if(i.scale.set(1,1,1).multiplyScalar(o*this.size/7),"helper"!==i.tag){if(i.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==i.name&&"XYZX"!==i.name||Math.abs(W.copy(Z).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Y"!==i.name&&"XYZY"!==i.name||Math.abs(W.copy(K).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"Z"!==i.name&&"XYZZ"!==i.name||Math.abs(W.copy($).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XY"===i.name&&Math.abs(W.copy($).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"YZ"===i.name&&Math.abs(W.copy(Z).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XZ"===i.name&&Math.abs(W.copy(K).applyQuaternion(t).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),-1!==i.name.search("X")&&(W.copy(Z).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.x*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Y")&&(W.copy(K).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.y*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Z")&&(W.copy($).applyQuaternion(t).dot(this.eye)<-.4?"fwd"===i.tag?i.visible=!1:i.scale.z*=-1:"bwd"===i.tag&&(i.visible=!1))}else"rotate"===this.mode&&(Y.copy(t),W.copy(this.eye).applyQuaternion(q.copy(t).inverse()),-1!==i.name.search("E")&&i.quaternion.setFromRotationMatrix(X.lookAt(this.eye,H,K)),"X"===i.name&&(q.setFromAxisAngle(Z,Math.atan2(-W.y,W.z)),q.multiplyQuaternions(Y,q),i.quaternion.copy(q)),"Y"===i.name&&(q.setFromAxisAngle(K,Math.atan2(W.x,W.z)),q.multiplyQuaternions(Y,q),i.quaternion.copy(q)),"Z"===i.name&&(q.setFromAxisAngle($,Math.atan2(W.y,W.x)),q.multiplyQuaternions(Y,q),i.quaternion.copy(q)));i.visible=i.visible&&(-1===i.name.indexOf("X")||this.showX),i.visible=i.visible&&(-1===i.name.indexOf("Y")||this.showY),i.visible=i.visible&&(-1===i.name.indexOf("Z")||this.showZ),i.visible=i.visible&&(-1===i.name.indexOf("E")||this.showX&&this.showY&&this.showZ),i.material._opacity=i.material._opacity||i.material.opacity,i.material._color=i.material._color||i.material.color.clone(),i.material.color.copy(i.material._color),i.material.opacity=i.material._opacity,this.enabled?this.axis&&(i.name===this.axis?(i.material.opacity=1,i.material.color.lerp(new v(1,1,1),.5)):this.axis.split("").some(function(e){return i.name===e})?(i.material.opacity=1,i.material.color.lerp(new v(1,1,1),.5)):(i.material.opacity*=.25,i.material.color.lerp(new v(1,1,1),.5))):(i.material.opacity*=.5,i.material.color.lerp(new v(1,1,1),.5))}else i.visible=!1,"AXIS"===i.name?(i.position.copy(this.worldPositionStart),i.visible=!!this.axis,"X"===this.axis&&(q.setFromEuler(G.set(0,0,0)),i.quaternion.copy(t).multiply(q),Math.abs(W.copy(Z).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Y"===this.axis&&(q.setFromEuler(G.set(0,0,Math.PI/2)),i.quaternion.copy(t).multiply(q),Math.abs(W.copy(K).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Z"===this.axis&&(q.setFromEuler(G.set(0,Math.PI/2,0)),i.quaternion.copy(t).multiply(q),Math.abs(W.copy($).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"XYZE"===this.axis&&(q.setFromEuler(G.set(0,Math.PI/2,0)),W.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(X.lookAt(H,W,K)),i.quaternion.multiply(q),i.visible=this.dragging),"E"===this.axis&&(i.visible=!1)):"START"===i.name?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):"END"===i.name?(i.position.copy(this.worldPosition),i.visible=this.dragging):"DELTA"===i.name?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),V.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),V.applyQuaternion(this.worldQuaternionStart.clone().inverse()),i.scale.copy(V),i.visible=this.dragging):(i.quaternion.copy(t),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=-1!==this.axis.search(i.name)))}p.prototype.updateMatrixWorld.call(this)}};Jn.prototype=Object.assign(Object.create(p.prototype),{constructor:Jn,isTransformControlsGizmo:!0});var Qn=function(){dr.call(this,new en(1e5,1e5,2,2),new cr({visible:!1,wireframe:!0,side:J,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new s(1,0,0),t=new s(0,1,0),r=new s(0,0,1),n=new s,i=new s,o=new s,u=new a,l=new c;this.updateMatrixWorld=function(){var a=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(a="local"),e.set(1,0,0).applyQuaternion("local"===a?this.worldQuaternion:l),t.set(0,1,0).applyQuaternion("local"===a?this.worldQuaternion:l),r.set(0,0,1).applyQuaternion("local"===a?this.worldQuaternion:l),o.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":o.copy(this.eye).cross(e),i.copy(e).cross(o);break;case"Y":o.copy(this.eye).cross(t),i.copy(t).cross(o);break;case"Z":o.copy(this.eye).cross(r),i.copy(r).cross(o);break;case"XY":i.copy(r);break;case"YZ":i.copy(e);break;case"XZ":o.copy(r),i.copy(t);break;case"XYZ":case"E":i.set(0,0,0)}break;case"rotate":default:i.set(0,0,0)}0===i.length()?this.quaternion.copy(this.cameraQuaternion):(u.lookAt(n.set(0,0,0),i,o),this.quaternion.setFromRotationMatrix(u)),p.prototype.updateMatrixWorld.call(this)}};function Zn(e,t){this.start=void 0!==e?e:new s,this.end=void 0!==t?t:new s}Qn.prototype=Object.assign(Object.create(dr.prototype),{constructor:Qn,isTransformControlsPlane:!0}),Object.assign(Zn.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("Line3: .getCenter() target is now required"),e=new s),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("Line3: .delta() target is now required"),e=new s),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("Line3: .at() target is now required"),t=new s),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new s,t=new s;return function(r,n){e.subVectors(r,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),a=t.dot(e)/i;return n&&(a=o.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("Line3: .closestPointToPoint() target is now required"),r=new s),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});var Kn=0;function $n(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new ni,this.unassigned=new ni,this.vertices=[]}function ei(){this.normal=new s,this.midpoint=new s,this.area=0,this.constant=0,this.outside=null,this.mark=Kn,this.edge=null}function ti(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}function ri(e){this.point=e,this.prev=null,this.next=null,this.face=null}function ni(){this.head=null,this.tail=null}function ii(e){_.call(this),this.fromBufferGeometry(new oi(e)),this.mergeVertices()}function oi(e){U.call(this);var t=[],r=[];void 0===$n&&console.error("ConvexBufferGeometry: ConvexBufferGeometry relies on QuickHull");for(var n=(new $n).setFromPoints(e).faces,i=0;i<n.length;i++){var o=n[i],a=o.edge;do{var s=a.head().point;t.push(s.x,s.y,s.z),r.push(o.normal.x,o.normal.y,o.normal.z),a=a.next}while(a!==o.edge)}this.addAttribute("position",new N(t,3)),this.addAttribute("normal",new N(r,3))}Object.assign($n.prototype,{setFromPoints:function(e){!0!==Array.isArray(e)&&console.error("QuickHull: Points parameter is not an array."),e.length<4&&console.error("QuickHull: The algorithm needs at least four points."),this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.vertices.push(new ri(e[t]));return this.compute(),this},setFromObject:function(e){var t=[];return e.updateMatrixWorld(!0),e.traverse(function(e){var r,n,i,o=e.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(r=0,n=a.length;r<n;r++)(i=a[r].clone()).applyMatrix4(e.matrixWorld),t.push(i)}else if(o.isBufferGeometry){var c=o.attributes.position;if(void 0!==c)for(r=0,n=c.count;r<n;r++)(i=new s).fromBufferAttribute(c,r).applyMatrix4(e.matrixWorld),t.push(i)}}),this.setFromPoints(t)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this},removeVertexFromFace:function(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this},removeAllVerticesFromFace:function(e){if(null!==e.outside){for(var t=e.outside,r=e.outside;null!==r.next&&r.next.face===e;)r=r.next;return this.assigned.removeSubList(t,r),t.prev=r.next=null,e.outside=null,t}},deleteFaceVertices:function(e,t){var r=this.removeAllVerticesFromFace(e);if(void 0!==r)if(void 0===t)this.unassigned.appendChain(r);else{var n=r;do{var i=n.next;t.distanceToPoint(n.point)>this.tolerance?this.addVertexToFace(n,t):this.unassigned.append(n),n=i}while(null!==n)}return this},resolveUnassignedPoints:function(e){if(!1===this.unassigned.isEmpty()){var t=this.unassigned.first();do{for(var r=t.next,n=this.tolerance,i=null,o=0;o<e.length;o++){var a=e[o];if(a.mark===Kn){var s=a.distanceToPoint(t.point);if(s>n&&(n=s,i=a),n>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(t,i),t=r}while(null!==t)}return this},computeExtremes:function(){var e,t,r,n=new s,i=new s,o=[],a=[];for(e=0;e<3;e++)o[e]=a[e]=this.vertices[0];for(n.copy(this.vertices[0].point),i.copy(this.vertices[0].point),e=0,t=this.vertices.length;e<t;e++){var c=this.vertices[e],u=c.point;for(r=0;r<3;r++)u.getComponent(r)<n.getComponent(r)&&(n.setComponent(r,u.getComponent(r)),o[r]=c);for(r=0;r<3;r++)u.getComponent(r)>i.getComponent(r)&&(i.setComponent(r,u.getComponent(r)),a[r]=c)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(n.x),Math.abs(i.x))+Math.max(Math.abs(n.y),Math.abs(i.y))+Math.max(Math.abs(n.z),Math.abs(i.z))),{min:o,max:a}},computeInitialHull:function(){var e,t,r;return function(){void 0===e&&(e=new Zn,t=new On,r=new s);var n,i,o,a,c,u,l,h,d,f=this.vertices,p=this.computeExtremes(),m=p.min,v=p.max,g=0,y=0;for(u=0;u<3;u++)(d=v[u].point.getComponent(u)-m[u].point.getComponent(u))>g&&(g=d,y=u);for(i=m[y],o=v[y],g=0,e.set(i.point,o.point),u=0,l=this.vertices.length;u<l;u++)(n=f[u])!==i&&n!==o&&(e.closestPointToPoint(n.point,!0,r),(d=r.distanceToSquared(n.point))>g&&(g=d,a=n));for(g=-1,t.setFromCoplanarPoints(i.point,o.point,a.point),u=0,l=this.vertices.length;u<l;u++)(n=f[u])!==i&&n!==o&&n!==a&&(d=Math.abs(t.distanceToPoint(n.point)))>g&&(g=d,c=n);var b=[];if(t.distanceToPoint(c.point)<0)for(b.push(ei.create(i,o,a),ei.create(c,o,i),ei.create(c,a,o),ei.create(c,i,a)),u=0;u<3;u++)h=(u+1)%3,b[u+1].getEdge(2).setTwin(b[0].getEdge(h)),b[u+1].getEdge(1).setTwin(b[h+1].getEdge(0));else for(b.push(ei.create(i,a,o),ei.create(c,i,o),ei.create(c,o,a),ei.create(c,a,i)),u=0;u<3;u++)h=(u+1)%3,b[u+1].getEdge(2).setTwin(b[0].getEdge((3-u)%3)),b[u+1].getEdge(0).setTwin(b[h+1].getEdge(1));for(u=0;u<4;u++)this.faces.push(b[u]);for(u=0,l=f.length;u<l;u++)if((n=f[u])!==i&&n!==o&&n!==a&&n!==c){g=this.tolerance;var x=null;for(h=0;h<4;h++)(d=this.faces[h].distanceToPoint(n.point))>g&&(g=d,x=this.faces[h]);null!==x&&this.addVertexToFace(n,x)}return this}}(),reindexFaces:function(){for(var e=[],t=0;t<this.faces.length;t++){var r=this.faces[t];r.mark===Kn&&e.push(r)}return this.faces=e,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var e,t=0,r=this.assigned.first().face,n=r.outside;do{var i=r.distanceToPoint(n.point);i>t&&(t=i,e=n),n=n.next}while(null!==n&&n.face===r);return e}},computeHorizon:function(e,t,r,n){var i;this.deleteFaceVertices(r),r.mark=1,i=null===t?t=r.getEdge(0):t.next;do{var o=i.twin,a=o.face;a.mark===Kn&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,o,a,n):n.push(i)),i=i.next}while(i!==t);return this},addAdjoiningFace:function(e,t){var r=ei.create(e,t.tail(),t.head());return this.faces.push(r),r.getEdge(-1).setTwin(t.twin),r.getEdge(0)},addNewFaces:function(e,t){this.newFaces=[];for(var r=null,n=null,i=0;i<t.length;i++){var o=t[i],a=this.addAdjoiningFace(e,o);null===r?r=a:a.next.setTwin(n),this.newFaces.push(a.face),n=a}return r.next.setTwin(n),this},addVertexToHull:function(e){var t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(ei,{create:function(e,t,r){var n=new ei,i=new ti(e,n),o=new ti(t,n),a=new ti(r,n);return i.next=a.prev=o,o.next=i.prev=a,a.next=o.prev=i,n.edge=i,n.compute()}}),Object.assign(ei.prototype,{getEdge:function(e){for(var t=this.edge;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t},compute:function(){var e;return function(){void 0===e&&(e=new hr);var t=this.edge.tail(),r=this.edge.head(),n=this.edge.next.head();return e.set(t.point,r.point,n.point),e.getNormal(this.normal),e.getMidpoint(this.midpoint),this.area=e.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint:function(e){return this.normal.dot(e)-this.constant}}),Object.assign(ti.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1},lengthSquared:function(){var e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1},setTwin:function(e){return this.twin=e,e.twin=this,this}}),Object.assign(ni.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this},insertAfter:function(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this},append:function(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this},appendChain:function(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this},remove:function(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this},removeSubList:function(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this},isEmpty:function(){return null===this.head}}),ii.prototype=Object.create(_.prototype),ii.prototype.constructor=ii,oi.prototype=Object.create(U.prototype),oi.prototype.constructor=oi;var ai=function(e,t){this.minSizeForBreak=e||1.4,this.smallDelta=t||1e-4,this.tempLine1=new Zn,this.tempPlane1=new On,this.tempPlane2=new On,this.tempPlane_Cut=new On,this.tempCM1=new s,this.tempCM2=new s,this.tempVector3=new s,this.tempVector3_2=new s,this.tempVector3_3=new s,this.tempVector3_P0=new s,this.tempVector3_P1=new s,this.tempVector3_P2=new s,this.tempVector3_N0=new s,this.tempVector3_N1=new s,this.tempVector3_AB=new s,this.tempVector3_CB=new s,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var r=0;r<900;r++)this.segments[r]=!1};function si(){this.type="Curve",this.arcLengthDivisions=200}function ci(){si.call(this)}function ui(e){si.call(this),this.scale=void 0===e?5:e}function li(e){si.call(this),this.scale=void 0===e?70:e}function hi(){si.call(this)}function di(){si.call(this)}function fi(e){si.call(this),this.scale=void 0===e?10:e}function pi(e){si.call(this),this.scale=void 0===e?10:e}function mi(e){si.call(this),this.scale=void 0===e?10:e}function vi(e){si.call(this),this.scale=void 0===e?10:e}ai.prototype={constructor:ai,prepareBreakableObject:function(e,t,r,n,i){e.geometry.isBufferGeometry||console.error("ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var o=e.userData;o.mass=t,o.velocity=r.clone(),o.angularVelocity=n.clone(),o.breakable=i},subdivideByImpact:function(e,t,r,n,i){var o=[],a=this.tempPlane1,s=this.tempPlane2;this.tempVector3.addVectors(t,r),a.setFromCoplanarPoints(t,e.position,this.tempVector3);var c=i+n,u=this;return function i(l,h,d,f){if(Math.random()<.05*f||f>c)o.push(l);else{var p=Math.PI;0===f?(s.normal.copy(a.normal),s.constant=a.constant):f<=n?(p=(d-h)*(.2+.6*Math.random())+h,u.tempVector3_2.copy(e.position).sub(t).applyAxisAngle(r,p).add(t),s.setFromCoplanarPoints(t,u.tempVector3,u.tempVector3_2)):(p=(.5*(1&f)+.2*(2-Math.random()))*Math.PI,u.tempVector3_2.copy(t).sub(l.position).applyAxisAngle(r,p).add(l.position),u.tempVector3_3.copy(r).add(l.position),s.setFromCoplanarPoints(l.position,u.tempVector3_3,u.tempVector3_2)),u.cutByPlane(l,s,u.tempResultObjects);var m=u.tempResultObjects.object1,v=u.tempResultObjects.object2;m&&i(m,h,p,f+1),v&&i(v,p,d,f+1)}}(e,0,2*Math.PI,0),o},cutByPlane:function(e,t,r){var n=e.geometry,i=n.attributes.position.array,o=n.attributes.normal.array,a=i.length/3,c=a/3,u=n.getIndex();function l(e,t){var r=3*e+t;return u?u[r]:r}u&&(c=(u=u.array).length/3);for(var h=[],d=[],f=this.smallDelta,p=a*a,m=0;m<p;m++)this.segments[m]=!1;var v=this.tempVector3_P0,g=this.tempVector3_P1,y=this.tempVector3_N0,b=this.tempVector3_N1;for(m=0;m<c-1;m++){var x=l(m,0),w=l(m,1),_=l(m,2);y.set(o[x],o[x]+1,o[x]+2);for(var S=m+1;S<c;S++){var M=l(S,0),T=l(S,1),A=l(S,2);b.set(o[M],o[M]+1,o[M]+2),1-y.dot(b)<f&&(x===M||x===T||x===A?w===M||w===T||w===A?(this.segments[x*a+w]=!0,this.segments[w*a+x]=!0):(this.segments[_*a+x]=!0,this.segments[x*a+_]=!0):w!==M&&w!==T&&w!==A||(this.segments[_*a+w]=!0,this.segments[w*a+_]=!0))}}var E=this.tempPlane_Cut;e.updateMatrix(),ai.transformPlaneToLocalSpace(t,e.matrix,E);for(m=0;m<c;m++)for(var C=l(m,0),L=l(m,1),P=l(m,2),O=0;O<3;O++){var N=0===O?C:1===O?L:P,R=0===O?L:1===O?P:C;if(!this.segments[N*a+R]){this.segments[N*a+R]=!0,this.segments[R*a+N]=!0,v.set(i[3*N],i[3*N+1],i[3*N+2]),g.set(i[3*R],i[3*R+1],i[3*R+2]);var I=0;(D=E.distanceToPoint(v))>f?(I=2,d.push(v.clone())):D<-f?(I=1,h.push(v.clone())):(I=3,h.push(v.clone()),d.push(v.clone()));var D,F=0;if((D=E.distanceToPoint(g))>f?(F=2,d.push(g.clone())):D<-f?(F=1,h.push(g.clone())):(F=3,h.push(g.clone()),d.push(g.clone())),1===I&&2===F||2===I&&1===F){this.tempLine1.start.copy(v),this.tempLine1.end.copy(g);var U=new s;if(void 0===(U=E.intersectLine(this.tempLine1,U)))return console.error("Internal error: segment does not intersect plane."),r.segmentedObject1=null,r.segmentedObject2=null,0;h.push(U),d.push(U.clone())}}}var k=.5*e.userData.mass;this.tempCM1.set(0,0,0);var B=0,z=h.length;if(z>0){for(m=0;m<z;m++)this.tempCM1.add(h[m]);this.tempCM1.divideScalar(z);for(m=0;m<z;m++){(G=h[m]).sub(this.tempCM1),B=Math.max(B,G.x,G.y,G.z)}this.tempCM1.add(e.position)}this.tempCM2.set(0,0,0);var j=0,V=d.length;if(V>0){for(m=0;m<V;m++)this.tempCM2.add(d[m]);this.tempCM2.divideScalar(V);for(m=0;m<V;m++){var G;(G=d[m]).sub(this.tempCM2),j=Math.max(j,G.x,G.y,G.z)}this.tempCM2.add(e.position)}var W=null,H=null,X=0;return z>4&&((W=new dr(new oi(h),e.material)).position.copy(this.tempCM1),W.quaternion.copy(e.quaternion),this.prepareBreakableObject(W,k,e.userData.velocity,e.userData.angularVelocity,2*B>this.minSizeForBreak),X++),V>4&&((H=new dr(new oi(d),e.material)).position.copy(this.tempCM2),H.quaternion.copy(e.quaternion),this.prepareBreakableObject(H,k,e.userData.velocity,e.userData.angularVelocity,2*j>this.minSizeForBreak),X++),r.object1=W,r.object2=H,X}},ai.transformFreeVector=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[4]*n+o[8]*i,e.y=o[1]*r+o[5]*n+o[9]*i,e.z=o[2]*r+o[6]*n+o[10]*i,e},ai.transformFreeVectorInverse=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[1]*n+o[2]*i,e.y=o[4]*r+o[5]*n+o[6]*i,e.z=o[8]*r+o[9]*n+o[10]*i,e},ai.transformTiedVectorInverse=function(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements;return e.x=o[0]*r+o[1]*n+o[2]*i-o[12],e.y=o[4]*r+o[5]*n+o[6]*i-o[13],e.z=o[8]*r+o[9]*n+o[10]*i-o[14],e},ai.transformPlaneToLocalSpace=function(){var e=new s;return function(t,r,n){n.normal.copy(t.normal),n.constant=t.constant;var i=ai.transformTiedVectorInverse(t.coplanarPoint(e),r);ai.transformFreeVectorInverse(n.normal,r),n.constant=-i.dot(n.normal)}}(),Object.assign(si.prototype,{getPoint:function(){return console.warn("Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=e;r++)o+=(t=this.getPoint(r/e)).distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t||e*n[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=n[i=Math.floor(s+(c-s)/2)]-r)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(n[i=c]===r)return i/(o-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;t<0&&(t=0),r>1&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,c=new s,u=[],l=[],h=[],d=new s,f=new a;for(r=0;r<=e;r++)n=r/e,u[r]=this.getTangentAt(n),u[r].normalize();l[0]=new s,h[0]=new s;var p=Number.MAX_VALUE,m=Math.abs(u[0].x),v=Math.abs(u[0].y),g=Math.abs(u[0].z);for(m<=p&&(p=m,c.set(1,0,0)),v<=p&&(p=v,c.set(0,1,0)),g<=p&&c.set(0,0,1),d.crossVectors(u[0],c).normalize(),l[0].crossVectors(u[0],d),h[0].crossVectors(u[0],l[0]),r=1;r<=e;r++)l[r]=l[r-1].clone(),h[r]=h[r-1].clone(),d.crossVectors(u[r-1],u[r]),d.length()>Number.EPSILON&&(d.normalize(),i=Math.acos(o.clamp(u[r-1].dot(u[r]),-1,1)),l[r].applyMatrix4(f.makeRotationAxis(d,i))),h[r].crossVectors(u[r],l[r]);if(!0===t)for(i=Math.acos(o.clamp(l[0].dot(l[e]),-1,1)),i/=e,u[0].dot(d.crossVectors(l[0],l[e]))>0&&(i=-i),r=1;r<=e;r++)l[r].applyMatrix4(f.makeRotationAxis(u[r],i*r)),h[r].crossVectors(u[r],l[r]);return{tangents:u,normals:l,binormals:h}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),ci.prototype=Object.create(si.prototype),ci.prototype.constructor=ci,ci.prototype.getPoint=function(e,t){var r=t||new s;e=2*Math.PI*e;var n=-.22*Math.cos(e)-1.28*Math.sin(e)-.44*Math.cos(3*e)-.78*Math.sin(3*e),i=-.1*Math.cos(2*e)-.27*Math.sin(2*e)+.38*Math.cos(4*e)+.46*Math.sin(4*e),o=.7*Math.cos(3*e)-.4*Math.sin(3*e);return r.set(n,i,o).multiplyScalar(20)},ui.prototype=Object.create(si.prototype),ui.prototype.constructor=ui,ui.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=16*Math.pow(Math.sin(e),3),i=13*Math.cos(e)-5*Math.cos(2*e)-2*Math.cos(3*e)-Math.cos(4*e);return r.set(n,i,0).multiplyScalar(this.scale)},li.prototype=Object.create(si.prototype),li.prototype.constructor=li,li.prototype.getPoint=function(e,t){var r=t||new s;e=4*e*Math.PI;var n=this.scale/2,i=n*(1+Math.cos(e)),o=n*Math.sin(e),a=2*n*Math.sin(e/2);return r.set(i,o,a)},hi.prototype=Object.create(si.prototype),hi.prototype.constructor=hi,hi.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=50*Math.sin(e),i=Math.cos(e)*(10+50*Math.cos(e)),o=Math.sin(e)*(10+50*Math.cos(e));return r.set(n,i,o)},di.prototype=Object.create(si.prototype),di.prototype.constructor=di,di.prototype.getPoint=function(e,t){var r=t||new s,n=2*Math.PI*e*150/30,i=30*Math.cos(n),o=30*Math.sin(n),a=150*e;return r.set(i,o,a)},fi.prototype=Object.create(si.prototype),fi.prototype.constructor=fi,fi.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=(2+Math.cos(3*e))*Math.cos(2*e),i=(2+Math.cos(3*e))*Math.sin(2*e),o=Math.sin(3*e);return r.set(n,i,o).multiplyScalar(this.scale)},pi.prototype=Object.create(si.prototype),pi.prototype.constructor=pi,pi.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=(2+Math.cos(4*e))*Math.cos(3*e),i=(2+Math.cos(4*e))*Math.sin(3*e),o=Math.sin(4*e);return r.set(n,i,o).multiplyScalar(this.scale)},mi.prototype=Object.create(si.prototype),mi.prototype.constructor=mi,mi.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=(2+Math.cos(5*e))*Math.cos(2*e),i=(2+Math.cos(5*e))*Math.sin(2*e),o=Math.sin(5*e);return r.set(n,i,o).multiplyScalar(this.scale)},vi.prototype=Object.create(si.prototype),vi.prototype.constructor=vi,vi.prototype.getPoint=function(e,t){var r=t||new s;e=4*e-2;var n=Math.pow(e,3)-3*e,i=Math.pow(e,4)-4*e*e,o=.2*Math.pow(e,5)-2*e;return r.set(n,i,o).multiplyScalar(this.scale)};function gi(e){si.call(this),this.scale=void 0===e?1:e}function yi(e){si.call(this),this.scale=void 0===e?40:e}function bi(e){si.call(this),this.scale=void 0===e?40:e}function xi(e){si.call(this),this.scale=void 0===e?40:e}function wi(e){si.call(this),this.scale=void 0===e?40:e}gi.prototype=Object.create(si.prototype),gi.prototype.constructor=gi,gi.prototype.getPoint=function(e,t){var r=t||new s,n=.4*(e=function(e,t,r){return r*(t-e)+e}(-4,4,e))*(e*e-7)*(e*e-10),i=Math.pow(e,4)-13*e*e,o=.1*e*(e*e-4)*(e*e-9)*(e*e-12);return r.set(n,i,o).multiplyScalar(this.scale)},yi.prototype=Object.create(si.prototype),yi.prototype.constructor=yi,yi.prototype.getPoint=function(e,t){var r=t||new s;e*=2*Math.PI;var n=Math.cos(2*e)*(1+.6*(Math.cos(5*e)+.75*Math.cos(10*e))),i=Math.sin(2*e)*(1+.6*(Math.cos(5*e)+.75*Math.cos(10*e))),o=.35*Math.sin(5*e);return r.set(n,i,o).multiplyScalar(this.scale)},bi.prototype=Object.create(si.prototype),bi.prototype.constructor=bi,bi.prototype.getPoint=function(e,t){var r=t||new s,n=e*Math.PI*2,i=Math.cos(2*n)*(1+.45*Math.cos(3*n)+.4*Math.cos(9*n)),o=Math.sin(2*n)*(1+.45*Math.cos(3*n)+.4*Math.cos(9*n)),a=.2*Math.sin(9*n);return r.set(i,o,a).multiplyScalar(this.scale)},xi.prototype=Object.create(si.prototype),xi.prototype.constructor=xi,xi.prototype.getPoint=function(e,t){var r=t||new s,n=e*Math.PI*2,i=Math.cos(3*n)*(1+.3*Math.cos(5*n)+.5*Math.cos(10*n)),o=Math.sin(3*n)*(1+.3*Math.cos(5*n)+.5*Math.cos(10*n)),a=.2*Math.sin(20*n);return r.set(i,o,a).multiplyScalar(this.scale)},wi.prototype=Object.create(si.prototype),wi.prototype.constructor=wi,wi.prototype.getPoint=function(e,t){var r=t||new s,n=e*Math.PI*2,i=Math.cos(4*n)*(1+.5*(Math.cos(5*n)+.4*Math.cos(20*n))),o=Math.sin(4*n)*(1+.5*(Math.cos(5*n)+.4*Math.cos(20*n))),a=.35*Math.sin(15*n);return r.set(i,o,a).multiplyScalar(this.scale)};var _i={findSpan:function(e,t,r){var n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;for(var i=e,o=n,a=Math.floor((i+o)/2);t<r[a]||t>=r[a+1];)t<r[a]?o=a:i=a,a=Math.floor((i+o)/2);return a},calcBasisFunctions:function(e,t,r,n){var i=[],o=[],a=[];i[0]=1;for(var s=1;s<=r;++s){o[s]=t-n[e+1-s],a[s]=n[e+s]-t;for(var c=0,u=0;u<s;++u){var l=a[u+1],h=o[s-u],d=i[u]/(l+h);i[u]=c+l*d,c=h*d}i[s]=c}return i},calcBSplinePoint:function(e,t,r,n){for(var i=this.findSpan(e,n,t),o=this.calcBasisFunctions(i,n,e,t),a=new S(0,0,0,0),s=0;s<=e;++s){var c=r[i-e+s],u=o[s],l=c.w*u;a.x+=c.x*l,a.y+=c.y*l,a.z+=c.z*l,a.w+=c.w*u}return a},calcBasisFunctionDerivatives:function(e,t,r,n,i){for(var o=[],a=0;a<=r;++a)o[a]=0;var s=[];for(a=0;a<=n;++a)s[a]=o.slice(0);var c=[];for(a=0;a<=r;++a)c[a]=o.slice(0);c[0][0]=1;for(var u=o.slice(0),l=o.slice(0),h=1;h<=r;++h){u[h]=t-i[e+1-h],l[h]=i[e+h]-t;for(var d=0,f=0;f<h;++f){var p=l[f+1],m=u[h-f];c[h][f]=p+m;var v=c[f][h-1]/c[h][f];c[f][h]=d+p*v,d=m*v}c[h][h]=d}for(h=0;h<=r;++h)s[0][h]=c[h][r];for(f=0;f<=r;++f){var g=0,y=1,b=[];for(a=0;a<=r;++a)b[a]=o.slice(0);b[0][0]=1;for(var x=1;x<=n;++x){var w=0,_=f-x,S=r-x;f>=x&&(b[y][0]=b[g][0]/c[S+1][_],w=b[y][0]*c[_][S]);var M=f-1<=S?x-1:r-f;for(h=_>=-1?1:-_;h<=M;++h)b[y][h]=(b[g][h]-b[g][h-1])/c[S+1][_+h],w+=b[y][h]*c[_+h][S];f<=S&&(b[y][x]=-b[g][x-1]/c[S+1][f],w+=b[y][x]*c[f][S]),s[x][f]=w;h=g;g=y,y=h}}for(f=r,x=1;x<=n;++x){for(h=0;h<=r;++h)s[x][h]*=f;f*=r-x}return s},calcBSplineDerivatives:function(e,t,r,n,i){for(var o=i<e?i:e,a=[],s=this.findSpan(e,n,t),c=this.calcBasisFunctionDerivatives(s,n,e,o,t),u=[],l=0;l<r.length;++l){var h=(f=r[l].clone()).w;f.x*=h,f.y*=h,f.z*=h,u[l]=f}for(var d=0;d<=o;++d){for(var f=u[s-e].clone().multiplyScalar(c[d][0]),p=1;p<=e;++p)f.add(u[s-e+p].clone().multiplyScalar(c[d][p]));a[d]=f}for(d=o+1;d<=i+1;++d)a[d]=new S(0,0,0);return a},calcKoverI:function(e,t){for(var r=1,n=2;n<=e;++n)r*=n;var i=1;for(n=2;n<=t;++n)i*=n;for(n=2;n<=e-t;++n)i*=n;return r/i},calcRationalCurveDerivatives:function(e){for(var t=e.length,r=[],n=[],i=0;i<t;++i){var o=e[i];r[i]=new s(o.x,o.y,o.z),n[i]=o.w}for(var a=[],c=0;c<t;++c){var u=r[c].clone();for(i=1;i<=c;++i)u.sub(a[c-i].clone().multiplyScalar(this.calcKoverI(c,i)*n[i]));a[c]=u.divideScalar(n[0])}return a},calcNURBSDerivatives:function(e,t,r,n,i){var o=this.calcBSplineDerivatives(e,t,r,n,i);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(e,t,r,n,i,o,a,s){for(var c=this.findSpan(e,o,r),u=this.findSpan(t,a,n),l=this.calcBasisFunctions(c,o,e,r),h=this.calcBasisFunctions(u,a,t,n),d=[],f=0;f<=t;++f){d[f]=new S(0,0,0,0);for(var p=0;p<=e;++p){var m=i[c-e+p][u-t+f].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,d[f].add(m.multiplyScalar(l[p]))}}var g=new S(0,0,0,0);for(f=0;f<=t;++f)g.add(d[f].multiplyScalar(h[f]));g.divideScalar(g.w),s.set(g.x,g.y,g.z)}},Si=function(e,t,r,n,i){si.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(var o=0;o<r.length;++o){var a=r[o];this.controlPoints[o]=new S(a.x,a.y,a.z,a.w)}};(Si.prototype=Object.create(si.prototype)).constructor=Si,Si.prototype.getPoint=function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=_i.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r.w&&r.divideScalar(r.w),new s(r.x,r.y,r.z)},Si.prototype.getTangent=function(e){var t=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=_i.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,t,1)[1].clone();return r.normalize(),r};var Mi=function(e,t,r,n,i){this.degree1=e,this.degree2=t,this.knots1=r,this.knots2=n,this.controlPoints=[];for(var o=r.length-e-1,a=n.length-t-1,s=0;s<o;++s){this.controlPoints[s]=[];for(var c=0;c<a;++c){var u=i[s][c];this.controlPoints[s][c]=new S(u.x,u.y,u.z,u.w)}}};Mi.prototype={constructor:Mi,getPoint:function(e,t,r){var n=this.knots1[0]+e*(this.knots1[this.knots1.length-1]-this.knots1[0]),i=this.knots2[0]+t*(this.knots2[this.knots2.length-1]-this.knots2[0]);_i.calcSurfacePoint(this.degree1,this.degree2,this.knots1,this.knots2,this.controlPoints,n,i,r)}};var Ti={canvas:!!i.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!i.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),webgl2:function(){try{var e=document.createElement("canvas");return!(!i.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}}(),workers:!!i.Worker,fileapi:i.File&&i.FileReader&&i.FileList&&i.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=i.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,r,n;t=void 0!==(e=e||{}).parent?e.parent:document.body,r=void 0!==e.id?e.id:"oldie",(n=Ti.getWebGLErrorMessage()).id=r,t.appendChild(n)}};function Ai(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Wr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Wr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}Object.assign(Ai.prototype,{update:function(){var e,t,r,n,i,s,c,u,l=new a,h=new a;return function(a){if(e!==this||t!==a.focus||r!==a.fov||n!==a.aspect*this.aspect||i!==a.near||s!==a.far||c!==a.zoom||u!==this.eyeSep){e=this,t=a.focus,r=a.fov,n=a.aspect*this.aspect,i=a.near,s=a.far,c=a.zoom;var d,f,p=a.projectionMatrix.clone(),m=(u=this.eyeSep/2)*i/t,v=i*Math.tan(o.DEG2RAD*r*.5)/c;h.elements[12]=-u,l.elements[12]=u,d=-v*n+m,f=v*n+m,p.elements[0]=2*i/(f-d),p.elements[8]=(f+d)/(f-d),this.cameraL.projectionMatrix.copy(p),d=-v*n-m,f=v*n-m,p.elements[0]=2*i/(f-d),p.elements[8]=(f+d)/(f-d),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(l)}}()});var Ei={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit(  ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit(  );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance(  const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance(  const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance(  geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance(  geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance(  geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\t\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\t\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},Ci={common:{diffuse:{value:new v(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new d},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new x(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new v(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new v(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new d}},sprite:{diffuse:{value:new v(15658734)},opacity:{value:1},center:{value:new x(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new d}}},Li={basic:{uniforms:Hr.merge([Ci.common,Ci.specularmap,Ci.envmap,Ci.aomap,Ci.lightmap,Ci.fog]),vertexShader:Ei.meshbasic_vert,fragmentShader:Ei.meshbasic_frag},lambert:{uniforms:Hr.merge([Ci.common,Ci.specularmap,Ci.envmap,Ci.aomap,Ci.lightmap,Ci.emissivemap,Ci.fog,Ci.lights,{emissive:{value:new v(0)}}]),vertexShader:Ei.meshlambert_vert,fragmentShader:Ei.meshlambert_frag},phong:{uniforms:Hr.merge([Ci.common,Ci.specularmap,Ci.envmap,Ci.aomap,Ci.lightmap,Ci.emissivemap,Ci.bumpmap,Ci.normalmap,Ci.displacementmap,Ci.gradientmap,Ci.fog,Ci.lights,{emissive:{value:new v(0)},specular:{value:new v(1118481)},shininess:{value:30}}]),vertexShader:Ei.meshphong_vert,fragmentShader:Ei.meshphong_frag},standard:{uniforms:Hr.merge([Ci.common,Ci.envmap,Ci.aomap,Ci.lightmap,Ci.emissivemap,Ci.bumpmap,Ci.normalmap,Ci.displacementmap,Ci.roughnessmap,Ci.metalnessmap,Ci.fog,Ci.lights,{emissive:{value:new v(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag},points:{uniforms:Hr.merge([Ci.points,Ci.fog]),vertexShader:Ei.points_vert,fragmentShader:Ei.points_frag},dashed:{uniforms:Hr.merge([Ci.common,Ci.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ei.linedashed_vert,fragmentShader:Ei.linedashed_frag},depth:{uniforms:Hr.merge([Ci.common,Ci.displacementmap]),vertexShader:Ei.depth_vert,fragmentShader:Ei.depth_frag},normal:{uniforms:Hr.merge([Ci.common,Ci.bumpmap,Ci.normalmap,Ci.displacementmap,{opacity:{value:1}}]),vertexShader:Ei.normal_vert,fragmentShader:Ei.normal_frag},sprite:{uniforms:Hr.merge([Ci.sprite,Ci.fog]),vertexShader:Ei.sprite_vert,fragmentShader:Ei.sprite_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ei.cube_vert,fragmentShader:Ei.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ei.equirect_vert,fragmentShader:Ei.equirect_frag},distanceRGBA:{uniforms:Hr.merge([Ci.common,Ci.displacementmap,{referencePosition:{value:new s},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ei.distanceRGBA_vert,fragmentShader:Ei.distanceRGBA_frag},shadow:{uniforms:Hr.merge([Ci.lights,Ci.fog,{color:{value:new v(0)},opacity:{value:1}}]),vertexShader:Ei.shadow_vert,fragmentShader:Ei.shadow_frag}};Li.physical={uniforms:Hr.merge([Li.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag};var Pi=function(){};Pi.prototype={constructor:Pi,parse:function(e,t,r){void 0===r&&(r={}),""!==(r=Object.assign({version:"1.4.1",author:null,textureDirectory:""},r)).textureDirectory&&(r.textureDirectory=(r.textureDirectory+"/").replace(/\\/g,"/").replace(/\/+/g,"/"));var n,i,o=r.version;if("1.4.1"!==o&&"1.5.0"!==o)return console.warn("ColladaExporter : Version "+o+" not supported for export. Only 1.4.1 and 1.5.0."),null;function s(e,t){return n=n||document.createElement("canvas"),i=i||n.getContext("2d"),n.width=e.naturalWidth,n.height=e.naturalHeight,i.drawImage(e,0,0),function(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0,i=r.length;n<i;n++)r[n]=t.charCodeAt(n);return r}(n.toDataURL("image/"+t,1).replace(/^data:image\/(png|jpg);base64,/,""))}var c,u=["getX","getY","getZ","getW"];function l(e){if(e.isInterleavedBufferAttribute){for(var t=new e.array.constructor(e.count*e.itemSize),r=e.itemSize,n=0,i=e.count;n<i;n++)for(var o=0;o<r;o++)t[n*r+o]=e[u[o]](n);return t}return e.array}function h(e,t,r){return Array.isArray(e)?e.slice(t,t+r):new e.constructor(e.buffer,t*e.BYTES_PER_ELEMENT,r)}function d(e,t,r,n){var i=l(e);return'<source id="'+t+'"><float_array id="'+t+'-array" count="'+i.length+'">'+i.join(" ")+'</float_array><technique_common><accessor source="#'+t+'-array" count="'+Math.floor(i.length/e.itemSize)+'" stride="'+e.itemSize+'">'+r.map(function(e){return'<param name="'+e+'" type="'+n+'" />'}).join("")+"</accessor></technique_common></source>"}function f(e){var t=g.get(e);if(null==t){t="image-"+(b.length+1);var n=e.name||t,i='<image id="'+t+'" name="'+n+'">';i+="1.5.0"===o?"<init_from><ref>"+r.textureDirectory+n+".png</ref></init_from>":"<init_from>"+r.textureDirectory+n+".png</init_from>",i+="</image>",b.push(i),g.set(e,t),y.push({directory:r.textureDirectory,name:n,ext:"png",data:s(e.image,"png"),original:e})}return t}var p=new WeakMap,m=new WeakMap,g=new WeakMap,y=[],b=[],x=[],w=[],S=[],M=function e(t){var r='<node name="'+t.name+'">';if(r+=function(e){return e.updateMatrix(),(c=c||new a).copy(e.matrix),c.transpose(),"<matrix>"+c.toArray().join(" ")+"</matrix>"}(t),t instanceof dr&&null!=t.geometry){var n=function(e){var t=p.get(e);if(!t){var r=e;r instanceof _&&(r=(new U).fromGeometry(r));var n="Mesh"+(x.length+1),i=r.index?r.index.count*r.index.itemSize:r.attributes.position.count,o=null!=r.groups&&0!==r.groups.length?r.groups:[{start:0,count:i,materialIndex:0}],a='<geometry id="'+n+'" name="'+e.name+'"><mesh>',s=n+"-position",c=n+"-vertices";a+=d(r.attributes.position,s,["X","Y","Z"],"float"),a+='<vertices id="'+c+'"><input semantic="POSITION" source="#'+s+'" /></vertices>';var u='<input semantic="VERTEX" source="#'+c+'" offset="0" />';if("normal"in r.attributes){var f=n+"-normal";a+=d(r.attributes.normal,f,["X","Y","Z"],"float"),u+='<input semantic="NORMAL" source="#'+f+'" offset="0" />'}if("uv"in r.attributes){var m=n+"-texcoord";a+=d(r.attributes.uv,m,["S","T"],"float"),u+='<input semantic="TEXCOORD" source="#'+m+'" offset="0" set="0" />'}if("color"in r.attributes){var v=n+"-color";a+=d(r.attributes.color,v,["X","Y","Z"],"uint8"),u+='<input semantic="COLOR" source="#'+v+'" offset="0" />'}var g=null;if(r.index)g=l(r.index);else for(var y=0,b=(g=new Array(i)).length;y<b;y++)g[y]=y;for(y=0,b=o.length;y<b;y++){var w=o[y],S=h(g,w.start,w.count),M=S.length/3;a+='<triangles material="MESH_MATERIAL_'+w.materialIndex+'" count="'+M+'">',a+=u,a+="<p>"+S.join(" ")+"</p>",a+="</triangles>"}a+="</mesh></geometry>",x.push(a),t={meshid:n,bufferGeometry:r},p.set(e,t)}return t}(t.geometry),i=n.meshid,o=n.bufferGeometry,s=null,u=t.material||new cr,g=Array.isArray(u)?u:[u];s=new Array(o.groups.length).fill().map(function(e,t){return function(e){var t=m.get(e);if(null==t){t="Mat"+(w.length+1);var r="phong";e instanceof pn?r="lambert":e instanceof cr&&(r="constant");var n=e.emissive?e.emissive:new v(0,0,0),i=e.color?e.color:new v(0,0,0),o=e.specular?e.specular:new v(1,1,1),a=e.shininess||0,s=e.reflectivity||0,c="";!0===e.transparent&&(c+="<transparent>"+(e.map?'<texture texture="diffuse-sampler"></texture>':"<float>1</float>")+"</transparent>",e.opacity<1&&(c+="<transparency><float>"+e.opacity+"</float></transparency>"));var u='<technique sid="common"><'+r+"><emission>"+(e.emissiveMap?'<texture texture="emissive-sampler" texcoord="TEXCOORD" />':'<color sid="emission">'+n.r+" "+n.g+" "+n.b+" 1</color>")+"</emission><diffuse>"+(e.map?'<texture texture="diffuse-sampler" texcoord="TEXCOORD" />':'<color sid="diffuse">'+i.r+" "+i.g+" "+i.b+" 1</color>")+'</diffuse><specular><color sid="specular">'+o.r+" "+o.g+" "+o.b+" 1</color></specular><shininess>"+(e.specularMap?'<texture texture="specular-sampler" texcoord="TEXCOORD" />':'<float sid="shininess">'+a+"</float>")+"</shininess><reflective><color>"+i.r+" "+i.g+" "+i.b+" 1</color></reflective><reflectivity><float>"+s+"</float></reflectivity>"+c+"</"+r+"></technique>",l='<effect id="'+t+'-effect"><profile_COMMON>'+(e.map?'<newparam sid="diffuse-surface"><surface type="2D"><init_from>'+f(e.map)+'</init_from></surface></newparam><newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>':"")+(e.specularMap?'<newparam sid="specular-surface"><surface type="2D"><init_from>'+f(e.specularMap)+'</init_from></surface></newparam><newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>':"")+(e.emissiveMap?'<newparam sid="emissive-surface"><surface type="2D"><init_from>'+f(e.emissiveMap)+'</init_from></surface></newparam><newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>':"")+u+(e.side===J?'<extra><technique><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>':"")+"</profile_COMMON></effect>";S.push('<material id="'+t+'" name="'+e.name+'"><instance_effect url="#'+t+'-effect" /></material>'),w.push(l),m.set(e,t)}return t}(g[t%g.length])}),r+='<instance_geometry url="#'+i+'">'+(null!=s?"<bind_material><technique_common>"+s.map(function(e,t){return'<instance_material symbol="MESH_MATERIAL_'+t+'" target="#'+e+'" ><bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" /></instance_material>'}).join("")+"</technique_common></bind_material>":"")+"</instance_geometry>"}return t.children.forEach(function(t){return r+=e(t)}),r+="</node>"}(e),T='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><COLLADA xmlns="'+("1.4.1"===o?"http://www.collada.org/2005/11/COLLADASchema":"https://www.khronos.org/collada/")+'" version="'+o+'"><asset><contributor><authoring_tool>js Collada Exporter</authoring_tool>'+(null!==r.author?"<author>"+r.author+"</author>":"")+"</contributor><created>"+(new Date).toISOString()+"</created><modified>"+(new Date).toISOString()+"</modified><up_axis>Y_UP</up_axis></asset>";T+="<library_images>"+b.join("")+"</library_images>",T+="<library_effects>"+w.join("")+"</library_effects>",T+="<library_materials>"+S.join("")+"</library_materials>",T+="<library_geometries>"+x.join("")+"</library_geometries>",T+='<library_visual_scenes><visual_scene id="Scene" name="scene">'+M+"</visual_scene></library_visual_scenes>",T+='<scene><instance_visual_scene url="#Scene"/></scene>';var A={data:function(e){var t=/^<\//,r=/(\?>$)|(\/>$)/,n=/<[^>]+>[^<]*<\/[^<]+>/,i=function(e,t){return t>0?e+i(e,t-1):""},o=0;return e.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map(function(e){n.test(e)||r.test(e)||!t.test(e)||o--;var a=""+i("  ",o)+e;return n.test(e)||r.test(e)||t.test(e)||o++,a}).join("\n")}(T+="</COLLADA>"),textures:y};return"function"==typeof t&&requestAnimationFrame(function(){return t(A)}),A}};var Oi={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},Ni={1003:Oi.NEAREST,1004:Oi.NEAREST_MIPMAP_NEAREST,1005:Oi.NEAREST_MIPMAP_LINEAR,1006:Oi.LINEAR,1007:Oi.LINEAR_MIPMAP_NEAREST,1008:Oi.LINEAR_MIPMAP_LINEAR},Ri={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ii=function(){};Ii.prototype={constructor:Ii,parse:function(e,t,r){(r=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1},r)).animations.length>0&&(r.trs=!0);var n,a={asset:{version:"2.0",generator:"GLTFExporter"}},c=0,u=[],l=[],h=new Map,d=[],f={},p={attributes:new Map,materials:new Map,textures:new Map,images:new Map};function m(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function v(e){return 4*Math.ceil(e/4)}function g(e,t){t=t||0;var r=v(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n.buffer}return e}function y(e){try{return JSON.parse(JSON.stringify(e.userData))}catch(t){return console.warn("GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message),{}}}function b(e){return a.buffers||(a.buffers=[{byteLength:0}]),u.push(e),0}function x(e,t,n,i){var o;if(e.array.constructor===Float32Array)o=Oi.FLOAT;else if(e.array.constructor===Uint32Array)o=Oi.UNSIGNED_INT;else if(e.array.constructor===Uint16Array)o=Oi.UNSIGNED_SHORT;else{if(e.array.constructor!==Uint8Array)throw new Error("GLTFExporter: Unsupported bufferAttribute component type.");o=Oi.UNSIGNED_BYTE}if(void 0===n&&(n=0),void 0===i&&(i=e.count),r.truncateDrawRange&&void 0!==t&&null===t.index){var s=n+i,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),(i=Math.min(s,u)-n)<0&&(i=0)}if(0===i)return null;var l,h=function(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+r;i++)for(var o=0;o<e.itemSize;o++){var a=e.array[i*e.itemSize+o];n.min[o]=Math.min(n.min[o],a),n.max[o]=Math.max(n.max[o],a)}return n}(e,n,i);void 0!==t&&(l=e===t.index?Oi.ELEMENT_ARRAY_BUFFER:Oi.ARRAY_BUFFER);var d=function(e,t,r,n,i){var o;a.bufferViews||(a.bufferViews=[]),o=t===Oi.UNSIGNED_BYTE?1:t===Oi.UNSIGNED_SHORT?2:4;for(var s=v(n*e.itemSize*o),u=new DataView(new ArrayBuffer(s)),l=0,h=r;h<r+n;h++)for(var d=0;d<e.itemSize;d++){var f=e.array[h*e.itemSize+d];t===Oi.FLOAT?u.setFloat32(l,f,!0):t===Oi.UNSIGNED_INT?u.setUint32(l,f,!0):t===Oi.UNSIGNED_SHORT?u.setUint16(l,f,!0):t===Oi.UNSIGNED_BYTE&&u.setUint8(l,f),l+=o}var p={buffer:b(u.buffer),byteOffset:c,byteLength:s};return void 0!==i&&(p.target=i),i===Oi.ARRAY_BUFFER&&(p.byteStride=e.itemSize*o),c+=s,a.bufferViews.push(p),{id:a.bufferViews.length-1,byteLength:0}}(e,o,n,i,l),f={bufferView:d.id,byteOffset:d.byteOffset,componentType:o,count:i,max:h.max,min:h.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return a.accessors||(a.accessors=[]),a.accessors.push(f),a.accessors.length-1}function w(e,t,s){p.images.has(e)||p.images.set(e,{});var u=p.images.get(e),h=t===pt?"image/png":"image/jpeg",d=h+":flipY/"+s.toString();if(void 0!==u[d])return u[d];a.images||(a.images=[]);var f={mimeType:h};if(r.embedImages){var m=n=n||document.createElement("canvas");m.width=e.width,m.height=e.height,r.forcePowerOfTwoTextures&&!function(e){return o.isPowerOfTwo(e.width)&&o.isPowerOfTwo(e.height)}(e)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e),m.width=o.floorPowerOfTwo(m.width),m.height=o.floorPowerOfTwo(m.height));var v=m.getContext("2d");!0===s&&(v.translate(0,m.height),v.scale(1,-1)),v.drawImage(e,0,0,m.width,m.height),!0===r.binary?l.push(new Promise(function(e){m.toBlob(function(t){(function(e){return a.bufferViews||(a.bufferViews=[]),new Promise(function(t){var r=new i.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=g(r.result),n={buffer:b(e),byteOffset:c,byteLength:e.byteLength};c+=e.byteLength,a.bufferViews.push(n),t(a.bufferViews.length-1)}})})(t).then(function(t){f.bufferView=t,e()})},h)})):f.uri=m.toDataURL(h)}else f.uri=e.src;a.images.push(f);var y=a.images.length-1;return u[d]=y,y}function _(e){if(p.textures.has(e))return p.textures.get(e);a.textures||(a.textures=[]);var t={sampler:function(e){a.samplers||(a.samplers=[]);var t={magFilter:Ni[e.magFilter],minFilter:Ni[e.minFilter],wrapS:Ni[e.wrapS],wrapT:Ni[e.wrapT]};return a.samplers.push(t),a.samplers.length-1}(e),source:w(e.image,e.format,e.flipY)};a.textures.push(t);var r=a.textures.length-1;return p.textures.set(e,r),r}function S(e){if(p.materials.has(e))return p.materials.get(e);if(a.materials||(a.materials=[]),e.isShaderMaterial)return console.warn("GLTFExporter: ShaderMaterial not supported."),null;var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},f.KHR_materials_unlit=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(m(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),(e.metalnessMap||e.roughnessMap)&&(e.metalnessMap===e.roughnessMap?t.pbrMetallicRoughness.metallicRoughnessTexture={index:_(e.metalnessMap)}:console.warn("GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.")),e.map&&(t.pbrMetallicRoughness.baseColorTexture={index:_(e.map)}),e.isMeshBasicMaterial||e.isLineBasicMaterial||e.isPointsMaterial);else{var n=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();m(n,[0,0,0])||(t.emissiveFactor=n),e.emissiveMap&&(t.emissiveTexture={index:_(e.emissiveMap)})}e.normalMap&&(t.normalTexture={index:_(e.normalMap)},-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),t.normalTexture.scale=e.normalScale.x)),e.aoMap&&(t.occlusionTexture={index:_(e.aoMap)},1!==e.aoMapIntensity&&(t.occlusionTexture.strength=e.aoMapIntensity)),(e.transparent||e.alphaTest>0)&&(t.alphaMode=e.opacity<1?"BLEND":"MASK",e.alphaTest>0&&.5!==e.alphaTest&&(t.alphaCutoff=e.alphaTest)),e.side===J&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),Object.keys(e.userData).length>0&&(t.extras=y(e)),a.materials.push(t);var i=a.materials.length-1;return p.materials.set(e,i),i}function T(e){var t,n=e.geometry;if(e.isLineSegments)t=Oi.LINES;else if(e.isLineLoop)t=Oi.LINE_LOOP;else if(e.isLine)t=Oi.LINE_STRIP;else if(e.isPoints)t=Oi.POINTS;else{if(!n.isBufferGeometry){var i=new U;i.fromGeometry(n),n=i}e.drawMode===Yt?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),t=Oi.TRIANGLE_FAN):t=e.drawMode===qt?e.material.wireframe?Oi.LINE_STRIP:Oi.TRIANGLE_STRIP:e.material.wireframe?Oi.LINES:Oi.TRIANGLES}var o={},c={},u=[],l=[],h={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},d=n.getAttribute("normal");for(var f in void 0===d||function(e){if(p.attributes.has(e))return!1;for(var t=new s,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromArray(e.array,3*r).length()-1)>5e-4)return!1;return!0}(d)||(console.warn("GLTFExporter: Creating normalized normal attribute from the non-normalized one."),n.addAttribute("normal",function(e){if(p.attributes.has(e))return p.attributes.get(e);for(var t=e.clone(),r=new s,n=0,i=t.count;n<i;n++)r.fromArray(t.array,3*n),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*n);return p.attributes.set(e,t),t}(d))),n.attributes){var m=n.attributes[f];f=h[f]||f.toUpperCase();var v=m.array;if("JOINTS_0"!==f||v instanceof Uint16Array||v instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),m=new M(new Uint16Array(v),m.itemSize,m.normalized)),"MORPH"!==f.substr(0,5)){var g=x(m,n);null!==g&&(c[f]=g)}}if(void 0!==d&&n.addAttribute("normal",d),0===Object.keys(c).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var b=[],w=[],_={};if(void 0!==e.morphTargetDictionary)for(var T in e.morphTargetDictionary)_[e.morphTargetDictionary[T]]=T;for(var A=0;A<e.morphTargetInfluences.length;++A){var E={},C=!1;for(var f in n.morphAttributes)if("position"===f||"normal"===f){m=n.morphAttributes[f][A];for(var L=n.attributes[f],P=m.clone(),O=0,N=m.count;O<N;O++)P.setXYZ(O,m.getX(O)-L.getX(O),m.getY(O)-L.getY(O),m.getZ(O)-L.getZ(O));E[f.toUpperCase()]=x(P,n)}else C||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),C=!0);l.push(E),b.push(e.morphTargetInfluences[A]),void 0!==e.morphTargetDictionary&&w.push(_[A])}o.weights=b,w.length>0&&(o.extras={},o.extras.targetNames=w)}var R=Object.keys(n.userData).length>0?y(n):void 0,I=r.forceIndices,D=Array.isArray(e.material);if(D&&0===n.groups.length)return null;!I&&null===n.index&&D&&(console.warn("GLTFExporter: Creating index for non-indexed multi-material mesh."),I=!0);var F=!1;if(null===n.index&&I){for(var k=[],B=(A=0,n.attributes.position.count);A<B;A++)k[A]=A;n.setIndex(k),F=!0}var z=D?e.material:[e.material],j=D?n.groups:[{materialIndex:0,start:void 0,count:void 0}];for(A=0,B=j.length;A<B;A++){var V={mode:t,attributes:c};R&&(V.extras=R),l.length>0&&(V.targets=l),null!==n.index&&(V.indices=x(n.index,n,j[A].start,j[A].count));var G=S(z[j[A].materialIndex]);null!==G&&(V.material=G),u.push(V)}return F&&n.setIndex(null),o.primitives=u,a.meshes||(a.meshes=[]),a.meshes.push(o),a.meshes.length-1}function A(e,t){a.animations||(a.animations=[]);for(var r=[],n=[],i=0;i<e.tracks.length;++i){var o=e.tracks[i],s=br.parseTrackName(o.name),c=br.findNode(t,s.nodeName),u=Ri[s.propertyName];if("bones"===s.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(s.objectIndex):void 0),!c||!u)return console.warn('GLTFExporter: Could not export animation track "%s".',o.name),null;var l,d=o.values.length/o.times.length;if(u===Ri.morphTargetInfluences){if(1!==c.morphTargetInfluences.length&&void 0!==s.propertyIndex){console.warn('GLTFExporter: Skipping animation track "%s". Morph target keyframe tracks must target all available morph targets for the given mesh.',o.name);continue}d/=c.morphTargetInfluences.length}!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(l="CUBICSPLINE",d/=3):l=o.getInterpolation()===Wt?"STEP":"LINEAR",n.push({input:x(new M(o.times,1)),output:x(new M(o.values,d)),interpolation:l}),r.push({sampler:n.length-1,target:{node:h.get(c),path:u}})}return a.animations.push({name:e.name||"clip_"+a.animations.length,samplers:n,channels:r}),a.animations.length-1}function E(e){var t=a.nodes[h.get(e)],r=e.skeleton,n=e.skeleton.bones[0];if(void 0===n)return null;for(var i=[],o=new Float32Array(16*r.bones.length),s=0;s<r.bones.length;++s)i.push(h.get(r.bones[s])),r.boneInverses[s].toArray(o,16*s);return void 0===a.skins&&(a.skins=[]),a.skins.push({inverseBindMatrices:x(new M(o,16)),joints:i,skeleton:h.get(n)}),t.skin=a.skins.length-1}function C(e){if(e.isLight)return console.warn("GLTFExporter: Unsupported node type:",e.constructor.name),null;a.nodes||(a.nodes=[]);var t={};if(r.trs){var n=e.quaternion.toArray(),i=e.position.toArray(),s=e.scale.toArray();m(n,[0,0,0,1])||(t.rotation=n),m(i,[0,0,0])||(t.translation=i),m(s,[1,1,1])||(t.scale=s)}else e.updateMatrix(),m(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),e.userData&&Object.keys(e.userData).length>0&&(t.extras=y(e)),e.isMesh||e.isLine||e.isPoints){var c=T(e);null!==c&&(t.mesh=c)}else e.isCamera&&(t.camera=function(e){a.cameras||(a.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:o.degToRad(e.fov)/e.aspect,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),a.cameras.push(r),a.cameras.length-1}(e));if(e.isSkinnedMesh&&d.push(e),e.children.length>0){for(var u=[],l=0,f=e.children.length;l<f;l++){var p=e.children[l];if(p.visible||!1===r.onlyVisible){var v=C(p);null!==v&&u.push(v)}}u.length>0&&(t.children=u)}a.nodes.push(t);var g=a.nodes.length-1;return h.set(e,g),g}function L(e){a.scenes||(a.scenes=[],a.scene=0);var t={nodes:[]};""!==e.name&&(t.name=e.name),a.scenes.push(t);for(var n=[],i=0,o=e.children.length;i<o;i++){var s=e.children[i];if(s.visible||!1===r.onlyVisible){var c=C(s);null!==c&&n.push(c)}}n.length>0&&(t.nodes=n)}!function(e){e=e instanceof Array?e:[e];for(var t=[],n=0;n<e.length;n++)e[n]instanceof qr?L(e[n]):t.push(e[n]);for(t.length>0&&function(e){var t=new qr;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);L(t)}(t),n=0;n<d.length;++n)E(d[n]);for(n=0;n<r.animations.length;++n)A(r.animations[n],e[0])}(e),Promise.all(l).then(function(){var e=new Blob(u,{type:"application/octet-stream"}),n=Object.keys(f);if(n.length>0&&(a.extensionsUsed=n),a.buffers&&a.buffers.length>0){a.buffers[0].byteLength=e.size;var o=new i.FileReader;if(!0===r.binary){o.readAsArrayBuffer(e),o.onloadend=function(){var e=g(o.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,e.byteLength,!0),r.setUint32(4,5130562,!0);var n=g(function(e){if(void 0!==i.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var o=e.charCodeAt(r);t[r]=o>255?32:o}return t.buffer}(JSON.stringify(a)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,n.byteLength,!0),s.setUint32(4,1313821514,!0);var c=new ArrayBuffer(12),u=new DataView(c);u.setUint32(0,1179937895,!0),u.setUint32(4,2,!0);var l=12+s.byteLength+n.byteLength+r.byteLength+e.byteLength;u.setUint32(8,l,!0);var h=new Blob([c,s,n,r,e],{type:"application/octet-stream"}),d=new i.FileReader;d.readAsArrayBuffer(h),d.onloadend=function(){t(d.result)}}}else o.readAsDataURL(e),o.onloadend=function(){var e=o.result;a.buffers[0].uri=e,t(a)}}else t(a)})}};var Di=function(){};Di.prototype={constructor:Di,parse:function(e){var t,r,n,i,o,a="",c=0,u=0,l=0,h=new s,f=new s,p=new x,m=[];return e.traverse(function(e){e instanceof dr&&function(e){var n=0,s=0,v=0,g=e.geometry,y=new d;if(g instanceof _&&(g=(new U).setFromObject(e)),g instanceof U){var b=g.getAttribute("position"),x=g.getAttribute("normal"),w=g.getAttribute("uv"),S=g.getIndex();if(a+="o "+e.name+"\n",e.material&&e.material.name&&(a+="usemtl "+e.material.name+"\n"),void 0!==b)for(t=0,i=b.count;t<i;t++,n++)h.x=b.getX(t),h.y=b.getY(t),h.z=b.getZ(t),h.applyMatrix4(e.matrixWorld),a+="v "+h.x+" "+h.y+" "+h.z+"\n";if(void 0!==w)for(t=0,i=w.count;t<i;t++,v++)p.x=w.getX(t),p.y=w.getY(t),a+="vt "+p.x+" "+p.y+"\n";if(void 0!==x)for(y.getNormalMatrix(e.matrixWorld),t=0,i=x.count;t<i;t++,s++)f.x=x.getX(t),f.y=x.getY(t),f.z=x.getZ(t),f.applyMatrix3(y),a+="vn "+f.x+" "+f.y+" "+f.z+"\n";if(null!==S)for(t=0,i=S.count;t<i;t+=3){for(o=0;o<3;o++)r=S.getX(t+o)+1,m[o]=c+r+(x||w?"/"+(w?u+r:"")+(x?"/"+(l+r):""):"");a+="f "+m.join(" ")+"\n"}else for(t=0,i=b.count;t<i;t+=3){for(o=0;o<3;o++)r=t+o+1,m[o]=c+r+(x||w?"/"+(w?u+r:"")+(x?"/"+(l+r):""):"");a+="f "+m.join(" ")+"\n"}}else console.warn("OBJExporter.parseMesh(): geometry type unsupported",g);c+=n,u+=v,l+=s}(e),e instanceof fr&&function(e){var o=0,s=e.geometry,u=e.type;if(s instanceof _&&(s=(new U).setFromObject(e)),s instanceof U){var l=s.getAttribute("position");if(a+="o "+e.name+"\n",void 0!==l)for(t=0,i=l.count;t<i;t++,o++)h.x=l.getX(t),h.y=l.getY(t),h.z=l.getZ(t),h.applyMatrix4(e.matrixWorld),a+="v "+h.x+" "+h.y+" "+h.z+"\n";if("Line"===u){for(a+="l ",r=1,i=l.count;r<=i;r++)a+=c+r+" ";a+="\n"}if("LineSegments"===u)for(n=1+(r=1),i=l.count;r<i;n=(r+=2)+1)a+="l "+(c+r)+" "+(c+n)+"\n"}else console.warn("OBJExporter.parseLine(): geometry type unsupported",s);c+=o}(e)}),a}};var Fi=function(){};Fi.prototype={constructor:Fi,parse:function(e,t,r){function n(t){e.traverse(function(e){if(!0===e.isMesh){var r=e,n=r.geometry;!0===n.isGeometry&&(n=o.get(n)),!0===n.isBufferGeometry&&void 0!==n.getAttribute("position")&&t(r,n)}})}t&&"object"==typeof t&&(console.warn('PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),r=t,t=void 0);var i=(r=Object.assign({binary:!1,excludeAttributes:[]},r)).excludeAttributes,o=new WeakMap,a=!1,c=!1,u=!1,l=0,h=0;e.traverse(function(e){if(!0===e.isMesh){var t=e,r=t.geometry;if(!0===r.isGeometry){var n=o.get(r)||(new U).setFromObject(t);o.set(r,n),r=n}if(!0===r.isBufferGeometry){var i=r.getAttribute("position"),s=r.getAttribute("normal"),d=r.getAttribute("uv"),f=r.getAttribute("color"),p=r.getIndex();if(void 0===i)return;l+=i.count,h+=p?p.count/3:i.count/3,void 0!==s&&(a=!0),void 0!==d&&(u=!0),void 0!==f&&(c=!0)}}});var f=-1===i.indexOf("index");if(a=a&&-1===i.indexOf("normal"),c=c&&-1===i.indexOf("color"),u=u&&-1===i.indexOf("uv"),f&&h!==Math.floor(h))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var p=1;l>256&&(p=2),l>65536&&(p=4);var m="ply\nformat "+(r.binary?"binary_big_endian":"ascii")+" 1.0\nelement vertex "+l+"\nproperty float x\nproperty float y\nproperty float z\n";!0===a&&(m+="property float nx\nproperty float ny\nproperty float nz\n"),!0===u&&(m+="property float s\nproperty float t\n"),!0===c&&(m+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===f&&(m+="element face "+h+"\nproperty list uchar uint"+8*p+" vertex_index\n"),m+="end_header\n";var v=new s,g=new d,y=null;if(!0===r.binary){var b=(new TextEncoder).encode(m),x=l*(12+(a?12:0)+(c?3:0)+(u?8:0)),w=f?h*(3*p+1):0,_=new DataView(new ArrayBuffer(b.length+x+w));new Uint8Array(_.buffer).set(b,0);var S=b.length,M=b.length+x,T=0;n(function(e,t){var r=t.getAttribute("position"),n=t.getAttribute("normal"),i=t.getAttribute("uv"),o=t.getAttribute("color"),s=t.getIndex();g.getNormalMatrix(e.matrixWorld);for(var l=0,h=r.count;l<h;l++)v.x=r.getX(l),v.y=r.getY(l),v.z=r.getZ(l),v.applyMatrix4(e.matrixWorld),_.setFloat32(S,v.x),S+=4,_.setFloat32(S,v.y),S+=4,_.setFloat32(S,v.z),S+=4,!0===a&&(null!=n?(v.x=n.getX(l),v.y=n.getY(l),v.z=n.getZ(l),v.applyMatrix3(g),_.setFloat32(S,v.x),S+=4,_.setFloat32(S,v.y),S+=4,_.setFloat32(S,v.z),S+=4):(_.setFloat32(S,0),S+=4,_.setFloat32(S,0),S+=4,_.setFloat32(S,0),S+=4)),!0===u&&(null!=i?(_.setFloat32(S,i.getX(l)),S+=4,_.setFloat32(S,i.getY(l)),S+=4):!1!==u&&(_.setFloat32(S,0),S+=4,_.setFloat32(S,0),S+=4)),!0===c&&(null!=o?(_.setUint8(S,Math.floor(255*o.getX(l))),S+=1,_.setUint8(S,Math.floor(255*o.getY(l))),S+=1,_.setUint8(S,Math.floor(255*o.getZ(l))),S+=1):(_.setUint8(S,255),S+=1,_.setUint8(S,255),S+=1,_.setUint8(S,255),S+=1));if(!0===f){var d="setUint"+8*p;if(null!==s)for(l=0,h=s.count;l<h;l+=3)_.setUint8(M,3),M+=1,_[d](M,s.getX(l+0)+T),M+=p,_[d](M,s.getX(l+1)+T),M+=p,_[d](M,s.getX(l+2)+T),M+=p;else for(l=0,h=r.count;l<h;l+=3)_.setUint8(M,3),M+=1,_[d](M,T+l),M+=p,_[d](M,T+l+1),M+=p,_[d](M,T+l+2),M+=p}T+=r.count}),y=_.buffer}else{T=0;var A="",E="";n(function(e,t){var r=t.getAttribute("position"),n=t.getAttribute("normal"),i=t.getAttribute("uv"),o=t.getAttribute("color"),s=t.getIndex();g.getNormalMatrix(e.matrixWorld);for(var l=0,d=r.count;l<d;l++){v.x=r.getX(l),v.y=r.getY(l),v.z=r.getZ(l),v.applyMatrix4(e.matrixWorld);var p=v.x+" "+v.y+" "+v.z;!0===a&&(null!=n?(v.x=n.getX(l),v.y=n.getY(l),v.z=n.getZ(l),v.applyMatrix3(g),p+=" "+v.x+" "+v.y+" "+v.z):p+=" 0 0 0"),!0===u&&(null!=i?p+=" "+i.getX(l)+" "+i.getY(l):!1!==u&&(p+=" 0 0")),!0===c&&(p+=null!=o?" "+Math.floor(255*o.getX(l))+" "+Math.floor(255*o.getY(l))+" "+Math.floor(255*o.getZ(l)):" 255 255 255"),A+=p+"\n"}if(!0===f){if(null!==s)for(l=0,d=s.count;l<d;l+=3)E+="3 "+(s.getX(l+0)+T),E+=" "+(s.getX(l+1)+T),E+=" "+(s.getX(l+2)+T)+"\n";else for(l=0,d=r.count;l<d;l+=3)E+="3 "+(T+l)+" "+(T+l+1)+" "+(T+l+2)+"\n";h+=s?s.count/3:r.count/3}T+=r.count}),y=""+m+A+"\n"+(f?E+"\n":"")}return"function"==typeof t&&requestAnimationFrame(function(){return t(y)}),y}};var Ui=function(){};Ui.prototype={constructor:Ui,parse:function(){var e=new s,t=new d;return function(r,n){void 0===n&&(n={});var i=void 0!==n.binary&&n.binary,o=[],a=0;if(r.traverse(function(e){if(e.isMesh){var t=e.geometry;t.isBufferGeometry&&(t=(new _).fromBufferGeometry(t)),t.isGeometry&&(a+=t.faces.length,o.push({geometry:t,matrixWorld:e.matrixWorld}))}}),i){var s=80,c=new ArrayBuffer(2*a+3*a*4*4+80+4);(b=new DataView(c)).setUint32(s,a,!0),s+=4;for(var u=0,l=o.length;u<l;u++){var h=(x=o[u]).geometry.vertices,d=x.geometry.faces,f=x.matrixWorld;t.getNormalMatrix(f);for(var p=0,m=d.length;p<m;p++){var v=d[p];e.copy(v.normal).applyMatrix3(t).normalize(),b.setFloat32(s,e.x,!0),s+=4,b.setFloat32(s,e.y,!0),s+=4,b.setFloat32(s,e.z,!0),s+=4;for(var g=[v.a,v.b,v.c],y=0;y<3;y++)e.copy(h[g[y]]).applyMatrix4(f),b.setFloat32(s,e.x,!0),s+=4,b.setFloat32(s,e.y,!0),s+=4,b.setFloat32(s,e.z,!0),s+=4;b.setUint16(s,0,!0),s+=2}}return b}var b="";b+="solid exported\n";for(u=0,l=o.length;u<l;u++){var x;h=(x=o[u]).geometry.vertices,d=x.geometry.faces,f=x.matrixWorld;t.getNormalMatrix(f);for(p=0,m=d.length;p<m;p++){v=d[p];e.copy(v.normal).applyMatrix3(t).normalize(),b+="\tfacet normal "+e.x+" "+e.y+" "+e.z+"\n",b+="\t\touter loop\n";for(g=[v.a,v.b,v.c],y=0;y<3;y++)e.copy(h[g[y]]).applyMatrix4(f),b+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n";b+="\t\tendloop\n",b+="\tendfacet\n"}}return b+="endsolid exported\n"}}()};var ki=function(){};function Bi(e,t,r,n){U.call(this);var i=[],o=[],c=[],u=new s,l=new a;l.makeRotationFromEuler(r),l.setPosition(t);var h=(new a).getInverse(l);function d(t,r,n){r.applyMatrix4(e.matrixWorld),r.applyMatrix4(h),t.push(new zi(r.clone(),n.clone()))}function f(e,t){for(var r=[],i=.5*Math.abs(n.dot(t)),o=0;o<e.length;o+=3){var a,s,c,u,l,h,d,f=e[o+0].position.dot(t)-i;switch(s=e[o+1].position.dot(t)-i>0,c=e[o+2].position.dot(t)-i>0,((a=f>0)?1:0)+(s?1:0)+(c?1:0)){case 0:r.push(e[o]),r.push(e[o+1]),r.push(e[o+2]);break;case 1:if(a&&(u=e[o+1],l=e[o+2],h=p(e[o],u,t,i),d=p(e[o],l,t,i)),s){u=e[o],l=e[o+2],h=p(e[o+1],u,t,i),d=p(e[o+1],l,t,i),r.push(h),r.push(l.clone()),r.push(u.clone()),r.push(l.clone()),r.push(h.clone()),r.push(d);break}c&&(u=e[o],l=e[o+1],h=p(e[o+2],u,t,i),d=p(e[o+2],l,t,i)),r.push(u.clone()),r.push(l.clone()),r.push(h),r.push(d),r.push(h.clone()),r.push(l.clone());break;case 2:a||(l=p(u=e[o].clone(),e[o+1],t,i),h=p(u,e[o+2],t,i),r.push(u),r.push(l),r.push(h)),s||(l=p(u=e[o+1].clone(),e[o+2],t,i),h=p(u,e[o],t,i),r.push(u),r.push(l),r.push(h)),c||(l=p(u=e[o+2].clone(),e[o],t,i),h=p(u,e[o+1],t,i),r.push(u),r.push(l),r.push(h))}}return r}function p(e,t,r,n){var i=e.position.dot(r)-n,o=i/(i-(t.position.dot(r)-n));return new zi(new s(e.position.x+o*(t.position.x-e.position.x),e.position.y+o*(t.position.y-e.position.y),e.position.z+o*(t.position.z-e.position.z)),new s(e.normal.x+o*(t.normal.x-e.normal.x),e.normal.y+o*(t.normal.y-e.normal.y),e.normal.z+o*(t.normal.z-e.normal.z)))}!function(){var t,r=new U,a=[],h=new s,p=new s;e.geometry.isGeometry?r.fromGeometry(e.geometry):r.copy(e.geometry);var m=r.attributes.position,v=r.attributes.normal;if(null!==r.index){var g=r.index;for(t=0;t<g.count;t++)h.fromBufferAttribute(m,g.getX(t)),p.fromBufferAttribute(v,g.getX(t)),d(a,h,p)}else for(t=0;t<m.count;t++)h.fromBufferAttribute(m,t),p.fromBufferAttribute(v,t),d(a,h,p);for(a=f(a=f(a=f(a=f(a=f(a=f(a,u.set(1,0,0)),u.set(-1,0,0)),u.set(0,1,0)),u.set(0,-1,0)),u.set(0,0,1)),u.set(0,0,-1)),t=0;t<a.length;t++){var y=a[t];c.push(.5+y.position.x/n.x,.5+y.position.y/n.y),y.position.applyMatrix4(l),i.push(y.position.x,y.position.y,y.position.z),o.push(y.normal.x,y.normal.y,y.normal.z)}}(),this.addAttribute("position",new N(i,3)),this.addAttribute("normal",new N(o,3)),this.addAttribute("uv",new N(c,2))}function zi(e,t){this.position=e,this.normal=t}ki.prototype={constructor:ki,parse:function(e){var t={metadata:{version:4,type:"TypedGeometry",generator:"TypedGeometryExporter"}},r=["vertices","normals","uvs"];for(var n in r){for(var i=r[n],o=e[i],a=[],s=0,c=o.length;s<c;s++)a[s]=o[s];t[i]=a}var u=e.boundingSphere;return null!==u&&(t.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}},Bi.prototype=Object.create(U.prototype),Bi.prototype.constructor=Bi,zi.prototype.clone=function(){return new zi(this.position.clone(),this.normal.clone())};var ji=function(e,t,r,n,i,o,c){var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],l=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];U.call(this),e=e||50,t=void 0!==t?Math.max(2,Math.floor(t)||10):10,r=void 0===r||r,n=void 0===n||n,i=void 0===i||i,o=void 0===o||o;var h=3.15*((c=void 0===c||c)?1:1.3)/2,d=e/h,f=r?(8*t-4)*t:0;f+=n?(16*t-4)*t:0,f+=i?40*t*t:0;var p=new Uint32Array(3*f),m=r?4:0;m+=n?8:0,m+=i?20:0,m*=(t+1)*(t+1);var v=new Float32Array(3*m),g=new Float32Array(3*m),y=new Float32Array(2*m),b=new a;b.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);var x,w,_,T,A,E,C,L,P,O,N,R,I,D,F,k,B=[],z=[],j=[],V=[],G=[],W=[],H=[],X=[],q=[],Y=new s,J=0,Q=0,Z=new s,K=new a,$=new a,ee=new S,te=new S,re=new S,ne=new S,ie=new s,oe=new s,ae=b.clone();ae.transpose();var se=function(e,t,r){return!(v[3*e]===v[3*t]&&v[3*e+1]===v[3*t+1]&&v[3*e+2]===v[3*t+2]||v[3*e]===v[3*r]&&v[3*e+1]===v[3*r+1]&&v[3*e+2]===v[3*r+2]||v[3*t]===v[3*r]&&v[3*t+1]===v[3*r+1]&&v[3*t+2]===v[3*r+2])};for(x=0;x<3;x++)W[x]=new a;var ce=r?32:28;C=t+1;for(var ue=0,le=0,he=0,de=0,fe=0,pe=i?0:20;pe<ce;pe++)if(n||pe<20||pe>=28){for(x=0;x<3;x++){for(w=0;w<4;w++)for(_=0;_<4;_++)B[4*_+w]=l[3*u[16*pe+4*w+_]+x],o&&pe>=20&&pe<28&&2!==x&&(B[4*_+w]*=1.077),c||2!==x||(B[4*_+w]*=1.3);K.set(B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]),$.multiplyMatrices(K,b),W[x].multiplyMatrices(ae,$)}for(A=0;A<=t;A++)for(L=A/t,E=0;E<=t;E++){for(P=E/t,R=4,O=N=1;R--;)z[R]=O,j[R]=N,O*=L,N*=P,3===R?(V[R]=G[R]=0,J=Q=1):(V[R]=J*(3-R),G[R]=Q*(3-R),J*=L,Q*=P);for(ee.fromArray(z),te.fromArray(j),re.fromArray(V),ne.fromArray(G),x=0;x<3;x++)(T=ee.clone()).applyMatrix4(W[x]),H[x]=T.dot(te),(T=re.clone()).applyMatrix4(W[x]),X[x]=T.dot(te),(T=ee.clone()).applyMatrix4(W[x]),q[x]=T.dot(ne);ie.fromArray(X),oe.fromArray(q),Y.crossVectors(oe,ie),Y.normalize(),0===H[0]&&0===H[1]?Z.set(0,H[2]>h?1:-1,0):Z.set(Y.x,Y.z,-Y.y),v[le++]=d*H[0],v[le++]=d*(H[2]-h),v[le++]=-d*H[1],g[he++]=Z.x,g[he++]=Z.y,g[he++]=Z.z,y[de++]=1-P,y[de++]=1-L}for(A=0;A<t;A++)for(E=0;E<t;E++)k=(I=ue*C*C+A*C+E)+C,se(I,D=I+1,F=D+C)&&(p[fe++]=I,p[fe++]=D,p[fe++]=F),se(I,F,k)&&(p[fe++]=I,p[fe++]=F,p[fe++]=k);ue++}this.setIndex(new M(p,1)),this.addAttribute("position",new M(v,3)),this.addAttribute("normal",new M(g,3)),this.addAttribute("uv",new M(y,2)),this.computeBoundingSphere()};function Vi(e,t,r,n,i,o,a,s,c,u,l,h){Zr.call(this,null,o,a,s,c,u,n,i,l,h),this.image={data:e,width:t,height:r},this.magFilter=void 0!==c?c:Ye,this.minFilter=void 0!==u?u:Ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Gi(e,t){p.call(this),this.type="Points",this.geometry=void 0!==e?e:new U,this.material=void 0!==t?t:new xn({color:16777215*Math.random()})}(ji.prototype=Object.create(U.prototype)).constructor=ji,Vi.prototype=Object.create(Zr.prototype),Vi.prototype.constructor=Vi,Vi.prototype.isDataTexture=!0,Gi.prototype=Object.assign(Object.create(p.prototype),{constructor:Gi,isPoints:!0,raycast:function(){var e=new a,t=new lr,r=new b;return function(n,i){var o=this,a=this.geometry,c=this.matrixWorld,u=n.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(c),r.radius+=u,!1!==n.ray.intersectsSphere(r)){e.getInverse(c),t.copy(n.ray).applyMatrix4(e);var l=u/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,d=new s,f=new s;if(a.isBufferGeometry){var p=a.index,m=a.attributes.position.array;if(null!==p)for(var v=p.array,g=0,y=v.length;g<y;g++){var b=v[g];d.fromArray(m,3*b),_(d,b)}else{g=0;for(var x=m.length/3;g<x;g++)d.fromArray(m,3*g),_(d,g)}}else{var w=a.vertices;for(g=0,x=w.length;g<x;g++)_(w[g],g)}}function _(e,r){var a=t.distanceSqToPoint(e);if(a<h){t.closestPointToPoint(e,f),f.applyMatrix4(c);var s=n.ray.origin.distanceTo(f);if(s<n.near||s>n.far)return;i.push({distance:s,distanceToRay:Math.sqrt(a),point:f.clone(),index:r,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Wi=function(e){p.apply(this,arguments),e=e||{},this.PARTICLE_COUNT=e.maxParticles||1e6,this.PARTICLE_CONTAINERS=e.containerCount||1,this.PARTICLE_NOISE_TEXTURE=e.particleNoiseTex||null,this.PARTICLE_SPRITE_TEXTURE=e.particleSpriteTex||null,this.PARTICLES_PER_CONTAINER=Math.ceil(this.PARTICLE_COUNT/this.PARTICLE_CONTAINERS),this.PARTICLE_CURSOR=0,this.time=0,this.particleContainers=[],this.rand=[];var t,r={vertexShader:["uniform float uTime;","uniform float uScale;","uniform sampler2D tNoise;","attribute vec3 positionStart;","attribute float startTime;","attribute vec3 velocity;","attribute float turbulence;","attribute vec3 color;","attribute float size;","attribute float lifeTime;","varying vec4 vColor;","varying float lifeLeft;","void main() {","\tvColor = vec4( color, 1.0 );","\tvec3 newPosition;","\tvec3 v;","\tfloat timeElapsed = uTime - startTime;","\tlifeLeft = 1.0 - ( timeElapsed / lifeTime );","\tgl_PointSize = ( uScale * size ) * lifeLeft;","\tv.x = ( velocity.x - 0.5 ) * 3.0;","\tv.y = ( velocity.y - 0.5 ) * 3.0;","\tv.z = ( velocity.z - 0.5 ) * 3.0;","\tnewPosition = positionStart + ( v * 10.0 ) * timeElapsed;","\tvec3 noise = texture2D( tNoise, vec2( newPosition.x * 0.015 + ( uTime * 0.05 ), newPosition.y * 0.02 + ( uTime * 0.015 ) ) ).rgb;","\tvec3 noiseVel = ( noise.rgb - 0.5 ) * 30.0;","\tnewPosition = mix( newPosition, newPosition + vec3( noiseVel * ( turbulence * 5.0 ) ), ( timeElapsed / lifeTime ) );","\tif( v.y > 0. && v.y < .05 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( v.x < - 1.45 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( timeElapsed > 0.0 ) {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );","\t} else {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\t\tlifeLeft = 0.0;","\t\tgl_PointSize = 0.;","\t}","}"].join("\n"),fragmentShader:["float scaleLinear( float value, vec2 valueDomain ) {","\treturn ( value - valueDomain.x ) / ( valueDomain.y - valueDomain.x );","}","float scaleLinear( float value, vec2 valueDomain, vec2 valueRange ) {","\treturn mix( valueRange.x, valueRange.y, scaleLinear( value, valueDomain ) );","}","varying vec4 vColor;","varying float lifeLeft;","uniform sampler2D tSprite;","void main() {","\tfloat alpha = 0.;","\tif( lifeLeft > 0.995 ) {","\t\talpha = scaleLinear( lifeLeft, vec2( 1.0, 0.995 ), vec2( 0.0, 1.0 ) );","\t} else {","\t\talpha = lifeLeft * 0.75;","\t}","\tvec4 tex = texture2D( tSprite, gl_PointCoord );","\tgl_FragColor = vec4( vColor.rgb * tex.a, alpha * tex.a );","}"].join("\n")};for(t=1e5;t>0;t--)this.rand.push(Math.random()-.5);this.random=function(){return++t>=this.rand.length?this.rand[t=1]:this.rand[t]};var n=new An;this.particleNoiseTex=this.PARTICLE_NOISE_TEXTURE||n.load("textures/perlin-512.png"),this.particleNoiseTex.wrapS=this.particleNoiseTex.wrapT=He,this.particleSpriteTex=this.PARTICLE_SPRITE_TEXTURE||n.load("textures/particle2.png"),this.particleSpriteTex.wrapS=this.particleSpriteTex.wrapT=He,this.particleShaderMat=new Xr({transparent:!0,depthWrite:!1,uniforms:{uTime:{value:0},uScale:{value:1},tNoise:{value:this.particleNoiseTex},tSprite:{value:this.particleSpriteTex}},blending:te,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.particleShaderMat.defaultAttributeValues.particlePositionsStartTime=[0,0,0,0],this.particleShaderMat.defaultAttributeValues.particleVelColSizeLife=[0,0,0,0],this.init=function(){for(var e=0;e<this.PARTICLE_CONTAINERS;e++){var t=new Hi(this.PARTICLES_PER_CONTAINER,this);this.particleContainers.push(t),this.add(t)}},this.spawnParticle=function(e){this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=1),this.particleContainers[Math.floor(this.PARTICLE_CURSOR/this.PARTICLES_PER_CONTAINER)].spawnParticle(e)},this.update=function(e){for(var t=0;t<this.PARTICLE_CONTAINERS;t++)this.particleContainers[t].update(e)},this.dispose=function(){this.particleShaderMat.dispose(),this.particleNoiseTex.dispose(),this.particleSpriteTex.dispose();for(var e=0;e<this.PARTICLE_CONTAINERS;e++)this.particleContainers[e].dispose()},this.init()};(Wi.prototype=Object.create(p.prototype)).constructor=Wi;var Hi=function(e,t){p.apply(this,arguments),this.PARTICLE_COUNT=e||1e5,this.PARTICLE_CURSOR=0,this.time=0,this.offset=0,this.count=0,this.DPR=i.devicePixelRatio,this.GPUParticleSystem=t,this.particleUpdate=!1,this.particleShaderGeo=new U,this.particleShaderGeo.addAttribute("position",new M(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("positionStart",new M(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("startTime",new M(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("velocity",new M(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("turbulence",new M(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("color",new M(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("size",new M(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("lifeTime",new M(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderMat=this.GPUParticleSystem.particleShaderMat;var r=new s,n=new s,a=new v;this.spawnParticle=function(e){var i=this.particleShaderGeo.getAttribute("positionStart"),s=this.particleShaderGeo.getAttribute("startTime"),c=this.particleShaderGeo.getAttribute("velocity"),u=this.particleShaderGeo.getAttribute("turbulence"),l=this.particleShaderGeo.getAttribute("color"),h=this.particleShaderGeo.getAttribute("size"),d=this.particleShaderGeo.getAttribute("lifeTime");r=void 0!==(e=e||{}).position?r.copy(e.position):r.set(0,0,0),n=void 0!==e.velocity?n.copy(e.velocity):n.set(0,0,0),a=void 0!==e.color?a.set(e.color):a.set(16777215);var f=void 0!==e.positionRandomness?e.positionRandomness:0,p=void 0!==e.velocityRandomness?e.velocityRandomness:0,m=void 0!==e.colorRandomness?e.colorRandomness:1,v=void 0!==e.turbulence?e.turbulence:1,g=void 0!==e.lifetime?e.lifetime:5,y=void 0!==e.size?e.size:10,b=void 0!==e.sizeRandomness?e.sizeRandomness:0,x=void 0!==e.smoothPosition&&e.smoothPosition;void 0!==this.DPR&&(y*=this.DPR);var w=this.PARTICLE_CURSOR;i.array[3*w+0]=r.x+t.random()*f,i.array[3*w+1]=r.y+t.random()*f,i.array[3*w+2]=r.z+t.random()*f,!0===x&&(i.array[3*w+0]+=-n.x*t.random(),i.array[3*w+1]+=-n.y*t.random(),i.array[3*w+2]+=-n.z*t.random());var _=n.x+t.random()*p,S=n.y+t.random()*p,M=n.z+t.random()*p;_=o.clamp((_- -2)/4,0,1),S=o.clamp((S- -2)/4,0,1),M=o.clamp((M- -2)/4,0,1),c.array[3*w+0]=_,c.array[3*w+1]=S,c.array[3*w+2]=M,a.r=o.clamp(a.r+t.random()*m,0,1),a.g=o.clamp(a.g+t.random()*m,0,1),a.b=o.clamp(a.b+t.random()*m,0,1),l.array[3*w+0]=a.r,l.array[3*w+1]=a.g,l.array[3*w+2]=a.b,u.array[w]=v,h.array[w]=y+t.random()*b,d.array[w]=g,s.array[w]=this.time+.02*t.random(),0===this.offset&&(this.offset=this.PARTICLE_CURSOR),this.count++,this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=0),this.particleUpdate=!0},this.init=function(){this.particleSystem=new Gi(this.particleShaderGeo,this.particleShaderMat),this.particleSystem.frustumCulled=!1,this.add(this.particleSystem)},this.update=function(e){this.time=e,this.particleShaderMat.uniforms.uTime.value=e,this.geometryUpdate()},this.geometryUpdate=function(){if(!0===this.particleUpdate){this.particleUpdate=!1;var e=this.particleShaderGeo.getAttribute("positionStart"),t=this.particleShaderGeo.getAttribute("startTime"),r=this.particleShaderGeo.getAttribute("velocity"),n=this.particleShaderGeo.getAttribute("turbulence"),i=this.particleShaderGeo.getAttribute("color"),o=this.particleShaderGeo.getAttribute("size"),a=this.particleShaderGeo.getAttribute("lifeTime");this.offset+this.count<this.PARTICLE_COUNT?(e.updateRange.offset=this.offset*e.itemSize,t.updateRange.offset=this.offset*t.itemSize,r.updateRange.offset=this.offset*r.itemSize,n.updateRange.offset=this.offset*n.itemSize,i.updateRange.offset=this.offset*i.itemSize,o.updateRange.offset=this.offset*o.itemSize,a.updateRange.offset=this.offset*a.itemSize,e.updateRange.count=this.count*e.itemSize,t.updateRange.count=this.count*t.itemSize,r.updateRange.count=this.count*r.itemSize,n.updateRange.count=this.count*n.itemSize,i.updateRange.count=this.count*i.itemSize,o.updateRange.count=this.count*o.itemSize,a.updateRange.count=this.count*a.itemSize):(e.updateRange.offset=0,t.updateRange.offset=0,r.updateRange.offset=0,n.updateRange.offset=0,i.updateRange.offset=0,o.updateRange.offset=0,a.updateRange.offset=0,e.updateRange.count=-1,t.updateRange.count=-1,r.updateRange.count=-1,n.updateRange.count=-1,i.updateRange.count=-1,o.updateRange.count=-1,a.updateRange.count=-1),e.needsUpdate=!0,t.needsUpdate=!0,r.needsUpdate=!0,n.needsUpdate=!0,i.needsUpdate=!0,o.needsUpdate=!0,a.needsUpdate=!0,this.offset=0,this.count=0}},this.dispose=function(){this.particleShaderGeo.dispose()},this.init()};Hi.prototype=Object.create(p.prototype),Hi.prototype.constructor=Hi;var Xi=function(){p.call(this)};(Xi.prototype=Object.create(p.prototype)).constructor=Xi,Xi.prototype.updateMatrixWorld=function(){var e=new s,t=new c,r=new s,n=new s,i=new c,o=new s;return function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(n,i,o),this.matrix.decompose(e,t,r),this.matrixWorld.compose(n,t,o)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var s=0,c=this.children.length;s<c;s++)this.children[s].updateMatrixWorld(a)}}();function qi(){U.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Yi(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Ji(e,t,r){Yi.call(this,e,t),this.meshPerAttribute=r||1}function Qi(e,t,r,n){this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function Zi(e){U.call(this),this.type="WireframeGeometry";var t,r,n,i,o,a,c,u,l,h,d=[],f=[0,0],p={},m=["a","b","c"];if(e&&e.isGeometry){var v=e.faces;for(t=0,n=v.length;t<n;t++){var g=v[t];for(r=0;r<3;r++)c=g[m[r]],u=g[m[(r+1)%3]],f[0]=Math.min(c,u),f[1]=Math.max(c,u),void 0===p[l=f[0]+","+f[1]]&&(p[l]={index1:f[0],index2:f[1]})}for(l in p)a=p[l],h=e.vertices[a.index1],d.push(h.x,h.y,h.z),h=e.vertices[a.index2],d.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var y,b,x,w,_,S,M;if(h=new s,null!==e.index){for(y=e.attributes.position,b=e.index,0===(x=e.groups).length&&(x=[{start:0,count:b.count,materialIndex:0}]),i=0,o=x.length;i<o;++i)for(t=_=(w=x[i]).start,n=_+w.count;t<n;t+=3)for(r=0;r<3;r++)c=b.getX(t+r),u=b.getX(t+(r+1)%3),f[0]=Math.min(c,u),f[1]=Math.max(c,u),void 0===p[l=f[0]+","+f[1]]&&(p[l]={index1:f[0],index2:f[1]});for(l in p)a=p[l],h.fromBufferAttribute(y,a.index1),d.push(h.x,h.y,h.z),h.fromBufferAttribute(y,a.index2),d.push(h.x,h.y,h.z)}else for(t=0,n=(y=e.attributes.position).count/3;t<n;t++)for(r=0;r<3;r++)S=3*t+r,h.fromBufferAttribute(y,S),d.push(h.x,h.y,h.z),M=3*t+(r+1)%3,h.fromBufferAttribute(y,M),d.push(h.x,h.y,h.z)}this.addAttribute("position",new N(d,3))}qi.prototype=Object.assign(Object.create(U.prototype),{constructor:qi,isInstancedBufferGeometry:!0,copy:function(e){return U.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperty(Yi.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Yi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Ji.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Ji,isInstancedInterleavedBuffer:!0,copy:function(e){return Yi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.defineProperties(Qi.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Qi.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),Zi.prototype=Object.create(U.prototype),Zi.prototype.constructor=Zi;var Ki=function(){qi.call(this),this.type="LineSegmentsGeometry";new U;this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.addAttribute("position",new N([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.addAttribute("uv",new N([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))};Ki.prototype=Object.assign(Object.create(qi.prototype),{constructor:Ki,isLineSegmentsGeometry:!0,applyMatrix:function(e){var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(e.applyToBufferAttribute(t),e.applyToBufferAttribute(r),t.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var r=new Ji(t,6,1);return this.addAttribute("instanceStart",new Qi(r,3,0)),this.addAttribute("instanceEnd",new Qi(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var r=new Ji(t,6,1);return this.addAttribute("instanceColorStart",new Qi(r,3,0)),this.addAttribute("instanceColorEnd",new Qi(r,3,3)),this},fromWireframeGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromEdgesGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromMesh:function(e){return this.fromWireframeGeometry(new Zi(e.geometry)),this},fromLineSegements:function(e){var t=e.geometry;return t.isGeometry?this.setPositions(t.vertices):t.isBufferGeometry&&this.setPositions(t.position.array),this},computeBoundingBox:function(){var e=new y;return function(){null===this.boundingBox&&(this.boundingBox=new y);var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;void 0!==t&&void 0!==r&&(this.boundingBox.setFromBufferAttribute(t),e.setFromBufferAttribute(r),this.boundingBox.union(e))}}(),computeBoundingSphere:function(){var e=new s;return function(){null===this.boundingSphere&&(this.boundingSphere=new b),null===this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,r=this.attributes.instanceEnd;if(void 0!==t&&void 0!==r){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var i=0,o=0,a=t.count;o<a;o++)e.fromBufferAttribute(t,o),i=Math.max(i,n.distanceToSquared(e)),e.fromBufferAttribute(r,o),i=Math.max(i,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},clone:function(){},copy:function(e){return this}}),Ci.line={linewidth:{value:1},resolution:{value:new x(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},Li.line={uniforms:Hr.merge([Ci.common,Ci.fog,Ci.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"};var $i=function(e){Xr.call(this,{type:"LineMaterial",uniforms:Hr.clone(Li.line.uniforms),vertexShader:Li.line.vertexShader,fragmentShader:Li.line.fragmentShader}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}}}),this.setValues(e)};($i.prototype=Object.create(Xr.prototype)).constructor=$i,$i.prototype.isLineMaterial=!0,$i.prototype.copy=function(e){return Xr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.resolution=e.resolution,this};var eo=function(e,t){dr.call(this),this.type="LineSegments2",this.geometry=void 0!==e?e:new Ki,this.material=void 0!==t?t:new $i({color:16777215*Math.random()})};eo.prototype=Object.assign(Object.create(dr.prototype),{constructor:eo,isLineSegments2:!0,computeLineDistances:function(){var e=new s,t=new s;return function(){for(var r=this.geometry,n=r.attributes.instanceStart,i=r.attributes.instanceEnd,o=new Float32Array(2*n.data.count),a=0,s=0,c=n.data.count;a<c;a++,s+=2)e.fromBufferAttribute(n,a),t.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+e.distanceTo(t);var u=new Ji(o,2,1);return r.addAttribute("instanceDistanceStart",new Qi(u,1,0)),r.addAttribute("instanceDistanceEnd",new Qi(u,1,1)),this}}(),copy:function(e){return this}});var to=function(){Ki.call(this),this.type="LineGeometry"};to.prototype=Object.assign(Object.create(Ki.prototype),{constructor:to,isLineGeometry:!0,setPositions:function(e){for(var t=e.length-3,r=new Float32Array(2*t),n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return Ki.prototype.setPositions.call(this,r),this},setColors:function(e){for(var t=e.length-3,r=new Float32Array(2*t),n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return Ki.prototype.setColors.call(this,r),this},fromLine:function(e){var t=e.geometry;return t.isGeometry?this.setPositions(t.vertices):t.isBufferGeometry&&this.setPositions(t.position.array),this},copy:function(e){return this}});var ro=function(e,t){eo.call(this),this.type="Line2",this.geometry=void 0!==e?e:new to,this.material=void 0!==t?t:new $i({color:16777215*Math.random()})};ro.prototype=Object.assign(Object.create(eo.prototype),{constructor:ro,isLine2:!0,copy:function(e){return this}});var no=function(e,t){dr.call(this),this.type="Wireframe",this.geometry=void 0!==e?e:new Ki,this.material=void 0!==t?t:new $i({color:16777215*Math.random()})};no.prototype=Object.assign(Object.create(dr.prototype),{constructor:no,isWireframe:!0,computeLineDistances:function(){var e=new s,t=new s;return function(){for(var r=this.geometry,n=r.attributes.instanceStart,i=r.attributes.instanceEnd,o=new Float32Array(2*n.data.count),a=0,s=0,c=n.data.count;a<c;a++,s+=2)e.fromBufferAttribute(n,a),t.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+e.distanceTo(t);var u=new Ji(o,2,1);return r.addAttribute("instanceDistanceStart",new Qi(u,1,0)),r.addAttribute("instanceDistanceEnd",new Qi(u,1,1)),this}}(),copy:function(e){return this}});var io=function(e){Ki.call(this),this.type="WireframeGeometry2",this.fromWireframeGeometry(new Zi(e))};function oo(){p.call(this),this.type="Group"}io.prototype=Object.assign(Object.create(Ki.prototype),{constructor:io,isWireframeGeometry2:!0,copy:function(e){return this}}),oo.prototype=Object.assign(Object.create(p.prototype),{constructor:oo,isGroup:!0});var ao=function(e){this.manager=void 0!==e?e:cn,this.availableExtensions=[]};ao.prototype={constructor:ao,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){var t=this;function r(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var n=e.getAttribute("pid");n&&(t.pid=n);var i=e.getAttribute("pindex");i&&(t.pindex=i);var o=e.getAttribute("thumbnail");o&&(t.thumbnail=o);var a=e.getAttribute("partnumber");a&&(t.partnumber=a);var s=e.getAttribute("name");s&&(t.name=s);var c=e.querySelector("mesh");c&&(t.mesh=function(e,t){for(var r={},n=[],i=e.querySelectorAll("vertices vertex"),o=0;o<i.length;o++){var a=i[o],s=a.getAttribute("x"),c=a.getAttribute("y"),u=a.getAttribute("z");n.push(parseFloat(s),parseFloat(c),parseFloat(u))}for(r.vertices=new Float32Array(n.length),o=0;o<n.length;o++)r.vertices[o]=n[o];var l=[],h=[],d=e.querySelectorAll("triangles triangle");for(o=0;o<d.length;o++){var f=d[o],p=f.getAttribute("v1"),m=f.getAttribute("v2"),v=f.getAttribute("v3"),g=f.getAttribute("p1"),y=f.getAttribute("p2"),b=f.getAttribute("p3"),x=f.getAttribute("pid");h.push(parseInt(p,10),parseInt(m,10),parseInt(v,10));var w={};g&&(w.p1=parseInt(g,10)),y&&(w.p2=parseInt(y,10)),b&&(w.p3=parseInt(b,10)),x&&(w.pid=x),0<Object.keys(w).length&&l.push(w)}for(r.triangleProperties=l,r.triangles=new Uint32Array(h.length),o=0;o<h.length;o++)r.triangles[o]=h[o];return r}(c));var u=e.querySelector("components");return u&&(t.components=void 0),t}function n(e){var t={unit:e.getAttribute("unit")||"millimeter"},n=e.querySelectorAll("metadata");n&&(t.metadata=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],i=n.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(i)&&(t[i]=n.textContent)}return t}(n));var i=e.querySelector("resources");i&&(t.resources=function(e){var t={},n=e.querySelector("basematerials");n&&(t.basematerial=void 0),t.object={};for(var i=e.querySelectorAll("object"),o=0;o<i.length;o++){var a=r(i[o]);t.object[a.id]=a}return t}(i));var o=e.querySelector("build");return o&&(t.build=function(e){for(var t=[],r=e.querySelectorAll("item"),n=0;n<r.length;n++){var i=r[n],o={objectid:i.getAttribute("objectid")},s=i.getAttribute("transform");if(s){var c=[];s.split(" ").forEach(function(e){c.push(parseFloat(e))});var u=new a;o.transform=u.set(c[0],c[3],c[6],c[9],c[1],c[4],c[7],c[10],c[2],c[5],c[8],c[11],0,0,0,1)}t.push(o)}return t}(o)),t}function i(e,t){var r=new U;r.setIndex(new M(e.triangles,1)),r.addAttribute("position",new M(e.vertices,3)),e.colors&&r.addAttribute("color",new M(e.colors,3)),r.computeBoundingSphere();var n={flatShading:!0};return e.colors&&0<e.colors.length?n.vertexColors=K:n.color=11184895,new dr(r,new vn(n))}function o(e,r,n,i){if(e){for(var o=[],a=Object.keys(e),s=0;s<a.length;s++)for(var c=a[s],u=0;u<t.availableExtensions.length;u++){(l=t.availableExtensions[u]).ns===c&&o.push(l)}for(s=0;s<o.length;s++){var l;(l=o[s]).apply(n,e[l.ns],r)}}}var s=function(e){var t,r,i=null,o=null,a=[],s=[],c={},u={};try{i=new JSZip(e)}catch(e){if(e instanceof ReferenceError)return console.error("ThreeMFLoader: jszip missing and file is compressed."),null}for(o in i.files)o.match(/\.rels$/)?t=o:o.match(/^3D\/.*\.model$/)?a.push(o):o.match(/^3D\/Metadata\/.*\.xml$/)||(o.match(/^3D\/Textures\/.*/)?s.push(o):o.match(/^3D\/Other\/.*/));var l=new Uint8Array(i.file(t).asArrayBuffer());r=function(e){var t=(new DOMParser).parseFromString(e,"application/xml").querySelector("Relationship"),r=t.getAttribute("Target"),n=t.getAttribute("Id"),i=t.getAttribute("Type");return{target:r,id:n,type:i}}(Cn.decodeText(l));for(var h=0;h<a.length;h++){var d=a[h],f=new Uint8Array(i.file(d).asArrayBuffer()),p=Cn.decodeText(f),m=(new DOMParser).parseFromString(p,"application/xml");"model"!==m.documentElement.nodeName.toLowerCase()&&console.error("ThreeMFLoader: Error loading 3MF - no 3MF document found: ",d);var v=m.querySelector("model"),g={};for(h=0;h<v.attributes.length;h++){var y=v.attributes[h];y.name.match(/^xmlns:(.+)$/)&&(g[y.value]=RegExp.$1)}var b=n(v);b.xml=v,0<Object.keys(g).length&&(b.extensions=g),c[d]=b}for(h=0;h<s.length;h++){var x=s[h];u[x]=i.file(x).asBinary()}return{rels:r,model:c,printTicket:{},texture:u,other:{}}}(e);return function(e,t,r){for(var n=new oo,i=r.model[t.target.substring(1)].build,o=0;o<i.length;o++){var a=i[o],s=e[a.objectid];a.transform&&s.geometry.applyMatrix(a.transform),n.add(s)}return n}(function(e){for(var t=e.model,r={},n=Object.keys(t),a=0;a<n.length;a++)for(var s=t[n[a]],c=s.xml,u=s.extensions,l=Object.keys(s.resources.object),h=0;h<l.length;h++){var d=l[h],f=s.resources.object[d].mesh;o(u,f,c),r[d]=i(f)}return r}(s),s.rels,s)},addExtension:function(e){this.availableExtensions.push(e)}};var so=function(e){this.manager=void 0!==e?e:cn};so.prototype={constructor:so,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e){for(var t="AMF Material",n=e.attributes.id.textContent,i={r:1,g:1,b:1,a:1},o=null,a=0;a<e.childNodes.length;a++){var s=e.childNodes[a];"metadata"===s.nodeName&&void 0!==s.attributes.type?"name"===s.attributes.type.value&&(t=s.textContent):"color"===s.nodeName&&(i=r(s))}return o=new vn({flatShading:!0,color:new v(i.r,i.g,i.b),name:t}),1!==i.a&&(o.transparent=!0,o.opacity=i.a),{id:n,material:o}}function r(e){for(var t={r:1,g:1,b:1,a:1},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];"r"===n.nodeName?t.r=n.textContent:"g"===n.nodeName?t.g=n.textContent:"b"===n.nodeName?t.b=n.textContent:"a"===n.nodeName&&(t.a=n.textContent)}return t}function n(e){var t={name:"",triangles:[],materialid:null},r=e.firstElementChild;for(void 0!==e.attributes.materialid&&(t.materialId=e.attributes.materialid.nodeValue);r;){if("metadata"===r.nodeName)void 0!==r.attributes.type&&"name"===r.attributes.type.value&&(t.name=r.textContent);else if("triangle"===r.nodeName){var n=r.getElementsByTagName("v1")[0].textContent,i=r.getElementsByTagName("v2")[0].textContent,o=r.getElementsByTagName("v3")[0].textContent;t.triangles.push(n,i,o)}r=r.nextElementSibling}return t}function i(e){for(var t=[],r=[],n=e.firstElementChild;n;){if("vertex"===n.nodeName)for(var i=n.firstElementChild;i;){if("coordinates"===i.nodeName){var o=i.getElementsByTagName("x")[0].textContent,a=i.getElementsByTagName("y")[0].textContent,s=i.getElementsByTagName("z")[0].textContent;t.push(o,a,s)}else if("normal"===i.nodeName){var c=i.getElementsByTagName("nx")[0].textContent,u=i.getElementsByTagName("ny")[0].textContent,l=i.getElementsByTagName("nz")[0].textContent;r.push(c,u,l)}i=i.nextElementSibling}n=n.nextElementSibling}return{vertices:t,normals:r}}function o(e){for(var t=e.attributes.id.textContent,o={name:"amfobject",meshes:[]},a=null,s=e.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(o.name=s.textContent);else if("color"===s.nodeName)a=r(s);else if("mesh"===s.nodeName){for(var c=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:a};c;){if("vertices"===c.nodeName){var l=i(c);u.normals=u.normals.concat(l.normals),u.vertices=u.vertices.concat(l.vertices)}else"volume"===c.nodeName&&u.volumes.push(n(c));c=c.nextElementSibling}o.meshes.push(u)}s=s.nextElementSibling}return{id:t,obj:o}}var a,s,c=function(e){var t=new DataView(e);if("PK"===String.fromCharCode(t.getUint8(0),t.getUint8(1))){var r=null,n=null;console.log("AMFLoader: Loading Zip");try{r=new JSZip(e)}catch(e){if(e instanceof ReferenceError)return console.log("AMFLoader: jszip missing and file is compressed."),null}for(n in r.files)if(".amf"===n.toLowerCase().substr(-4))break;console.log("AMFLoader: Trying to load file asset: "+n),t=new DataView(r.file(n).asArrayBuffer())}var i=Cn.decodeText(t),o=(new DOMParser).parseFromString(i,"application/xml");return"amf"!==o.documentElement.nodeName.toLowerCase()?(console.log("AMFLoader: Error loading AMF - no AMF document found."),null):o}(e),u="",l="",h=function(e){var t=1,r="millimeter";void 0!==e.documentElement.attributes.unit&&(r=e.documentElement.attributes.unit.value.toLowerCase());var n={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==n[r]&&(t=n[r]),console.log("AMFLoader: Unit scale: "+t),t}(c),d={},f={},p=c.documentElement.childNodes;for(a=0;a<p.length;a++){var m=p[a];if("metadata"===m.nodeName)void 0!==m.attributes.type&&("name"===m.attributes.type.value?u=m.textContent:"author"===m.attributes.type.value&&(l=m.textContent));else if("material"===m.nodeName){var g=t(m);d[g.id]=g.material}else if("object"===m.nodeName){var y=o(m);f[y.id]=y.obj}}var b=new oo,x=new vn({color:11184895,flatShading:!0});for(var w in b.name=u,b.userData.author=l,b.userData.loader="AMF",f){var _=f[w],S=_.meshes,M=new oo;for(M.name=_.name||"",a=0;a<S.length;a++){var T=x,A=S[a],E=new N(A.vertices,3),C=null;if(A.normals.length&&(C=new N(A.normals,3)),A.color){var L=A.color;(T=x.clone()).color=new v(L.r,L.g,L.b),1!==L.a&&(T.transparent=!0,T.opacity=L.a)}var P=A.volumes;for(s=0;s<P.length;s++){var O=P[s],R=new U,I=T;R.setIndex(O.triangles),R.addAttribute("position",E.clone()),C&&R.addAttribute("normal",C.clone()),void 0!==d[O.materialId]&&(I=d[O.materialId]),R.scale(h,h,h),M.add(new dr(R,I.clone()))}}b.add(M)}return b}};var co=function(e){this.manager=void 0!==e?e:cn};function uo(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new a)}}function lo(e,t){dr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new a,this.bindMatrixInverse=new a;var r=new uo(this.initBones());this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}co.prototype={constructor:co,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=Cn.extractUrlBase(e);new ln(this.manager).load(e,function(e){var r=JSON.parse(e),a=r.__metadata__;if(void 0!==a){if("assimp2json"!==a.format)return void n("AssimpJSONLoader: Not an assimp2json scene.");if(a.version<100&&a.version>=200)return void n("AssimpJSONLoader: Unsupported assimp2json file format version.")}t(i.parse(r,o))},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=new Array(e.length),n=0;n<e.length;++n)r[n]=t.call(this,e[n]);return r}var n=new An(this.manager);n.setPath(t).setCrossOrigin(this.crossOrigin);var i=r(e.meshes,function(e){var t,r,n,i=new U,o=[],a=e.vertices||[],s=e.normals||[],c=e.texturecoords||[],u=e.colors||[];for(c=c[0]||[],t=0,r=e.faces.length;t<r;t++)n=e.faces[t],o.push(n[0],n[1],n[2]);return i.setIndex(o),i.addAttribute("position",new N(a,3)),s.length>0&&i.addAttribute("normal",new N(s,3)),c.length>0&&i.addAttribute("uv",new N(c,2)),u.length>0&&i.addAttribute("color",new N(u,3)),i.computeBoundingSphere(),i}),o=r(e.materials,function(e){var t=new vn;for(var r in e.properties){var i=e.properties[r],o=i.key,a=i.value;switch(o){case"$tex.file":var s=i.semantic;if(1===s||2===s||5===s||6===s){var c;switch(s){case 1:c="map";break;case 2:c="specularMap";break;case 5:c="bumpMap";break;case 6:c="normalMap"}var u=n.load(a);u.wrapS=u.wrapT=He,t[c]=u}break;case"?mat.name":t.name=a;break;case"$clr.diffuse":t.color.fromArray(a);break;case"$clr.specular":t.specular.fromArray(a);break;case"$clr.emissive":t.emissive.fromArray(a);break;case"$mat.shininess":t.shininess=a;break;case"$mat.shadingm":t.flatShading=1===a;break;case"$mat.opacity":a<1&&(t.opacity=a,t.transparent=!0)}}return t});return function e(t,r,n,i){var o,s,c=new p;for(c.name=r.name||"",c.matrix=(new a).fromArray(r.transformation).transpose(),c.matrix.decompose(c.position,c.quaternion,c.scale),o=0;r.meshes&&o<r.meshes.length;o++)s=r.meshes[o],c.add(new dr(n[s],i[t.meshes[s].materialindex]));for(o=0;r.children&&o<r.children.length;o++)c.add(e(t,r.children[o],n,i));return c}(e,e.rootnode,i,o)}},Object.assign(uo.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new a;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new a,t=new a;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=r.length;a<s;a++){var c=r[a]?r[a].matrixWorld:t;e.multiplyMatrices(c,n[a]),e.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new uo(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,r=this.bones.length;t<r;t++){var n=this.bones[t];if(n.name===e)return n}}}),lo.prototype=Object.assign(Object.create(dr.prototype),{constructor:lo,isSkinnedMesh:!0,initBones:function(){var e,t,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)t=this.geometry.bones[r],e=new Dr,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)-1!==(t=this.geometry.bones[r]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new S,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){dr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ho=function(e){this.manager=void 0!==e?e:cn};ho.prototype={constructor:ho,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=Cn.extractUrlBase(e),a=new ln(this.manager);a.setResponseType("arraybuffer"),a.load(e,function(e){t(i.parse(e,o))},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=new An(this.manager);r.setPath(t).setCrossOrigin(this.crossOrigin);var n={KeyFrame:function(e,t){this.time=e,this.matrix=t.clone(),this.position=new s,this.quaternion=new c,this.scale=new s(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new n.KeyFrame(this.time,this.matrix)},this.lerp=function(e,t){var r=(t-=this.time)/(e.time-this.time),i=1-r,o=this.position,a=this.quaternion,s=e.position,c=e.quaternion;return n.KeyFrame.tempAniPos.x=o.x*i+s.x*r,n.KeyFrame.tempAniPos.y=o.y*i+s.y*r,n.KeyFrame.tempAniPos.z=o.z*i+s.z*r,n.KeyFrame.tempAniQuat.set(a.x,a.y,a.z,a.w),n.KeyFrame.tempAniQuat.slerp(c,r),n.KeyFrame.tempAniMatrix.compose(n.KeyFrame.tempAniPos,n.KeyFrame.tempAniQuat,n.KeyFrame.tempAniScale)}}};n.KeyFrame.tempAniPos=new s,n.KeyFrame.tempAniQuat=new c,n.KeyFrame.tempAniScale=new s(1,1,1),n.KeyFrame.tempAniMatrix=new a,n.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(e){this.keys.push(e)},this.init=function(){if(this.sortKeys(),this.keys.length>0?this.length=this.keys[this.keys.length-1].time:this.length=0,this.fps)for(var e=0;e<this.length*this.fps;e++)for(var t=0;t<this.keys.length;t++){if(this.keys[t].time==e){this._accelTable[e]=t;break}if(this.keys[t].time<e/this.fps&&this.keys[t+1]&&this.keys[t+1].time>=e/this.fps){this._accelTable[e]=t;break}}},this.parseFromThree=function(e){var t=e.fps;this.target=e.node;for(var r=e.hierarchy[0].keys,i=0;i<r.length;i++)this.addKey(new n.KeyFrame(i/t||r[i].time,r[i].targets[0].data));this.init()},this.parseFromCollada=function(e){for(var t=e.keys,r=this.fps,i=0;i<t.length;i++)this.addKey(new n.KeyFrame(i/r||t[i].time,t[i].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(e,t){return e.time-t.time},this.clone=function(){var e=new n.KeyFrameTrack;e.target=this.target,e.time=this.time,e.length=this.length;for(var t=0;t<this.keys.length;t++)e.addKey(this.keys[t].clone());return e.init(),e},this.reTarget=function(e,t){t||(t=n.TrackTargetNodeNameCompare),this.target=t(e,this.target)},this.keySearchAccel=function(e){return e*=this.fps,e=Math.floor(e),this._accelTable[e]||0},this.setTime=function(e){e=Math.abs(e),this.length&&(e=e%this.length+.05);for(var t=null,r=null,n=this.keySearchAccel(e);n<this.keys.length;n++){if(this.keys[n].time==e){t=this.keys[n],r=this.keys[n];break}if(this.keys[n].time<e&&this.keys[n+1]&&this.keys[n+1].time>e){t=this.keys[n],r=this.keys[n+1];break}if(this.keys[n].time<e&&n==this.keys.length-1){t=this.keys[n],(r=this.keys[0].clone()).time+=this.length+.05;break}}return t&&r&&t!==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.lerp(r,e)),void(this.target.matrixWorldNeedsUpdate=!0)):t&&r&&t==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},n.TrackTargetNodeNameCompare=function(e,t){return function e(t,r){if(t.name==r)return t;for(var n=0;n<t.children.length;n++){var i=e(t.children[n],r);if(i)return i}return null}(e,t.name)},n.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(e){this.tracks.push(e),this.length=Math.max(e.length,this.length)},this.setTime=function(e){this.time=e;for(var t=0;t<this.tracks.length;t++)this.tracks[t].setTime(e)},this.clone=function(e,t){t||(t=n.TrackTargetNodeNameCompare);var r=new n.Animation;r.target=e;for(var i=0;i<this.tracks.length;i++){var o=this.tracks[i].clone();o.reTarget(e,t),r.addTrack(o)}return r}};var i=4660,o=4661,u=4662,l=4663,h=4664,d=4665,f=4666,m=4667,g=4668,y=4669,b=4670,x=1,w=2,_=4,S=256,T=65536,A=1,E=4,C=1,L=3,P=1,O=6,N=8,R=10,I=4;function D(e){return S<<e}function F(e){return T<<e}function k(e,t){var r=new Dr;for(var n in r.matrix.copy(e.matrix),r.matrixWorld.copy(e.matrixWorld),r.position.copy(e.position),r.quaternion.copy(e.quaternion),r.scale.copy(e.scale),t.nodeCount++,r.name="bone_"+e.name+t.nodeCount.toString(),t.nodeToBoneMap[e.name]||(t.nodeToBoneMap[e.name]=[]),t.nodeToBoneMap[e.name].push(r),e.children){var i=k(e.children[n],t);i&&r.add(i)}return r}function B(e,t){for(var r=[],n=0;n<e.length;n++)r.push({i:e[n],w:t[n]});for(r.sort(function(e,t){return t.w-e.w});r.length<4;)r.push({i:0,w:0});r.length>4&&(r.length=4);var i=0;for(n=0;n<4;n++)i+=r[n].w*r[n].w;i=Math.sqrt(i);for(n=0;n<4;n++)r[n].w=r[n].w/i,e[n]=r[n].i,t[n]=r[n].w}function z(e,t){if(0==e.name.indexOf("bone_"+t))return e;for(var r in e.children){var n=z(e.children[r],t);if(n)return n}}function j(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(e,t){if(0!=this.mBones.length){for(var r=[],n=[],i=e.findNode(this.mBones[0].mName);i.mParent&&i.mParent.isBone;)i=i.mParent;var o=k(u=i.toTHREE(e),e);this.threeNode.add(o);for(var s=0;s<this.mBones.length;s++){if(l=z(o,this.mBones[s].mName)){var c=l;r.push(c),n.push(this.mBones[s].mOffsetMatrix.toTHREE())}else{if(!(i=e.findNode(this.mBones[s].mName)))return;var u;(u=i.toTHREE(e)).parent,o=k(u,e);this.threeNode.add(o);var l;c=l=z(o,this.mBones[s].mName);r.push(c),n.push(this.mBones[s].mOffsetMatrix.toTHREE())}}var h=new uo(r,n);this.threeNode.bind(h,new a),this.threeNode.material.skinning=!0}},this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t,r,n=new U;if(t=e.mMaterials[this.mMaterialIndex]?e.mMaterials[this.mMaterialIndex].toTHREE(e):new pn,n.setIndex(new M(new Uint32Array(this.mIndexArray),1)),n.addAttribute("position",new M(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&n.addAttribute("normal",new M(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&n.addAttribute("color",new M(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&n.addAttribute("uv",new M(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&n.addAttribute("uv1",new M(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&n.addAttribute("tangents",new M(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&n.addAttribute("bitangents",new M(this.mBitangentBuffer,3)),this.mBones.length>0){for(var i=[],o=[],a=0;a<this.mBones.length;a++)for(var s=0;s<this.mBones[a].mWeights.length;s++){var c=this.mBones[a].mWeights[s];c&&(i[c.mVertexId]||(i[c.mVertexId]=[]),o[c.mVertexId]||(o[c.mVertexId]=[]),i[c.mVertexId].push(c.mWeight),o[c.mVertexId].push(parseInt(a)))}for(var a in o)B(o[a],i[a]);var u=[],l=[];for(a=0;a<i.length;a++)for(s=0;s<4;s++)i[a]&&o[a]?(u.push(i[a][s]),l.push(o[a][s])):(u.push(0),l.push(0));n.addAttribute("skinWeight",new M(new Float32Array(u),I)),n.addAttribute("skinIndex",new M(new Float32Array(l),I))}return 0==this.mBones.length&&(r=new dr(n,t)),this.mBones.length>0&&(r=new lo(n,t)),this.threeNode=r,r}}function V(){this.mNumIndices=0,this.mIndices=[]}function G(){this.data=[],this.toString=function(){var e="";return this.data.forEach(function(t){e+=String.fromCharCode(t)}),e.replace(/[^\x20-\x7E]+/g,"")}}function W(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t=new p;t.name=this.mName,t.matrix=this.mTransformation.toTHREE();for(var r=0;r<this.mChildren.length;r++)t.add(this.mChildren[r].toTHREE(e));for(r=0;r<this.mMeshes.length;r++)t.add(e.mMeshes[this.mMeshes[r]].toTHREE(e));return this.threeNode=t,t.matrix.decompose(t.position,t.quaternion,t.scale),t}}function H(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function X(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var e=new Uint8Array(this.mData).buffer,t=new DataView(e);return new v(t.getFloat32(0,!0),t.getFloat32(4,!0),t.getFloat32(8,!0))},this.dataAsFloat=function(){var e=new Uint8Array(this.mData).buffer;return new DataView(e).getFloat32(0,!0)},this.dataAsBool=function(){var e=new Uint8Array(this.mData).buffer;return!!new DataView(e).getFloat32(0,!0)},this.dataAsString=function(){var e=new G;return e.data=this.mData,e.toString()},this.dataAsMap=function(){var e=new G;e.data=this.mData;var t=e.toString();return-1!=(t=t.replace(/\\/g,"/")).indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),r.load(t)}}var q={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},Y={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"};function J(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(e){this.mProperties[0].dataAsString();for(var t=new vn,r=0;r<this.mProperties.length;r++)if("float"==Y[this.mProperties[r].mKey]&&(t[q[this.mProperties[r].mKey]]=this.mProperties[r].dataAsFloat()),"color"==Y[this.mProperties[r].mKey]&&(t[q[this.mProperties[r].mKey]]=this.mProperties[r].dataAsColor()),"bool"==Y[this.mProperties[r].mKey]&&(t[q[this.mProperties[r].mKey]]=this.mProperties[r].dataAsBool()),"string"==Y[this.mProperties[r].mKey]&&(t[q[this.mProperties[r].mKey]]=this.mProperties[r].dataAsString()),"map"==Y[this.mProperties[r].mKey]){var n=this.mProperties[r];n.mSemantic==P&&(t.map=this.mProperties[r].dataAsMap()),n.mSemantic==O&&(t.normalMap=this.mProperties[r].dataAsMap()),n.mSemantic==R&&(t.lightMap=this.mProperties[r].dataAsMap()),n.mSemantic==N&&(t.alphaMap=this.mProperties[r].dataAsMap())}return t.ambient.r=.53,t.ambient.g=.53,t.ambient.b=.53,t.color.r=1,t.color.g=1,t.color.b=1,t}}function Q(e,t,r){var n=new s,i=1-r;return n.x=e.x*r+t.x*i,n.y=e.y*r+t.y*i,n.z=e.z*r+t.z*i,n}function Z(e,t,r){return e.clone().slerp(t,1-r)}function K(e,t,r,n){if(1==e.length)return e[0].mValue.toTHREE();for(var i=1/0,o=null,a=null,s=0;s<e.length;s++){var c=Math.abs(e[s].mTime-t);c<i&&e[s].mTime<=t&&(i=c,o=e[s],a=e[s+1])}if(o){if(a){var u=a.mTime-o.mTime,l=(o.mTime-t)/u;return n(o.mValue.toTHREE(),a.mValue.toTHREE(),l)}(a=e[0].clone()).mTime+=r;u=a.mTime-o.mTime,l=(o.mTime-t)/u;return n(o.mValue.toTHREE(),a.mValue.toTHREE(),l)}return null}function $(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(e){function t(t){t.mTime/=e}e||(e=1),this.mPositionKeys.forEach(t),this.mRotationKeys.forEach(t),this.mScalingKeys.forEach(t)},this.sortKeys=function(){function e(e,t){return e.mTime-t.mTime}this.mPositionKeys.sort(e),this.mRotationKeys.sort(e),this.mScalingKeys.sort(e)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(e){return e.mTime})))},this.toTHREE=function(e,t){this.sortKeys();for(var r=this.getLength(),i=new n.KeyFrameTrack,o=0;o<r;o+=.05){var s=new a,c=o,u=K(this.mPositionKeys,c,r,Q),l=K(this.mScalingKeys,c,r,Q),h=K(this.mRotationKeys,c,r,Z);s.compose(u,h,l);var d=new n.KeyFrame(c,s);i.addKey(d)}i.target=e.findNode(this.mNodeName).toTHREE();var f=[i];if(e.nodeToBoneMap[this.mNodeName])for(o=0;o<e.nodeToBoneMap[this.mNodeName].length;o++){var p=i.clone();p.target=e.nodeToBoneMap[this.mNodeName][o],f.push(p)}return f}}function ee(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(e){var t=new n.Animation;for(var r in this.mChannels){this.mChannels[r].init(this.mTicksPerSecond);var i=this.mChannels[r].toTHREE(e);for(var o in i)i[o].init(),t.addTrack(i[o])}return t.length=Math.max.apply(null,t.tracks.map(function(e){return e.length})),t}}function te(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function re(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function ne(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}var ie=!0;function oe(e){var t=e.getFloat32(e.readOffset,ie);return e.readOffset+=4,t}function ae(e){var t=e.getFloat64(e.readOffset,ie);return e.readOffset+=8,t}function se(e){var t=e.getUint8(e.readOffset);return e.readOffset+=1,t}function ce(e){var t=e.getUint16(e.readOffset,ie);return e.readOffset+=2,t}function ue(e){var t=e.getUint32(e.readOffset,ie);return e.readOffset+=4,t}function le(e){var t=e.getUint32(e.readOffset,ie);return e.readOffset+=4,t}function he(e){var t=new function(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new s(this.x,this.y,this.z)}};return t.x=oe(e),t.y=oe(e),t.z=oe(e),t}function de(e){var t=new function(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new v(this.r,this.g,this.b,1)}};return t.r=oe(e),t.g=oe(e),t.b=oe(e),t}function fe(e){var t=new function(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new c(this.x,this.y,this.z,this.w)}};return t.w=oe(e),t.x=oe(e),t.y=oe(e),t.z=oe(e),t}function pe(e){var t=new G,r=ue(e);return e.ReadBytes(t.data,1,r),t.toString()}function me(e){var t=new function(){this.mVertexId=0,this.mWeight=0};return t.mVertexId=ue(e),t.mWeight=oe(e),t}function ve(e){for(var t=new function(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var e=new a,t=0;t<4;++t)for(var r=0;r<4;++r)e.elements[4*t+r]=this.elements[r][t];return e}},r=0;r<4;++r)for(var n=0;n<4;++n)t.elements[r][n]=oe(e);return t}function ge(e){var t=new function(){this.mTime=0,this.mValue=null};return t.mTime=ae(e),t.mValue=he(e),t}function ye(e){var t=new function(){this.mTime=0,this.mValue=null};return t.mTime=ae(e),t.mValue=fe(e),t}function be(e,t,r){for(var n=0;n<r;n++)t[n]=ge(e)}function xe(e,t,r){return e.Seek(sizeof(t)*r,Ie)}function we(e){if(!e)throw"asset failed"}function _e(e,t){return we(le(e)==f),le(e),t.mName=pe(e),t.mNumWeights=ue(e),t.mOffsetMatrix=ve(e),Ne?xe(e,t.mWeights,t.mNumWeights):(t.mWeights=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=me(e)}(e,t.mWeights,t.mNumWeights)),t}function Se(e,t){we(le(e)==l),le(e),t.mPrimitiveTypes=ue(e),t.mNumVertices=ue(e),t.mNumFaces=ue(e),t.mNumBones=ue(e),t.mMaterialIndex=ue(e),t.mNumUVComponents=[];var r=ue(e);r&x&&(Ne?xe(e,t.mVertices,t.mNumVertices):(t.mVertices=[],t.mVertexBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ie))),r&w&&(Ne?xe(e,t.mNormals,t.mNumVertices):(t.mNormals=[],t.mNormalBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ie))),r&_&&(Ne?(xe(e,t.mTangents,t.mNumVertices),xe(e,t.mBitangents,t.mNumVertices)):(t.mTangents=[],t.mTangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ie),t.mBitangents=[],t.mBitangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ie)));for(var n=0;n<A&&r&F(n);++n)Ne?xe(e,t.mColors[n],t.mNumVertices):(t.mColors[n]=[],t.mColorBuffer=e.subArray32(e.readOffset,e.readOffset+4*t.mNumVertices*4),e.Seek(4*t.mNumVertices*4,Ie));t.mTexCoordsBuffers=[];for(n=0;n<E&&r&D(n);++n)if(t.mNumUVComponents[n]=ue(e),Ne)xe(e,t.mTextureCoords[n],t.mNumVertices);else{t.mTextureCoords[n]=[],t.mTexCoordsBuffers[n]=[];for(var i=0;i<t.mNumVertices;i++)t.mTexCoordsBuffers[n].push(oe(e)),t.mTexCoordsBuffers[n].push(oe(e)),oe(e)}if(Ne)ue(e);else{t.mFaces=[],t.mIndexArray=[];for(var o=0;o<t.mNumFaces;++o){var a=t.mFaces[o]=new V;a.mNumIndices=ce(e),a.mIndices=[];for(var s=0;s<a.mNumIndices;++s)t.mNumVertices<65536?a.mIndices[s]=ce(e):a.mIndices[s]=ue(e);if(3===a.mNumIndices)t.mIndexArray.push(a.mIndices[0]),t.mIndexArray.push(a.mIndices[1]),t.mIndexArray.push(a.mIndices[2]);else{if(4!==a.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");t.mIndexArray.push(a.mIndices[0]),t.mIndexArray.push(a.mIndices[1]),t.mIndexArray.push(a.mIndices[2]),t.mIndexArray.push(a.mIndices[2]),t.mIndexArray.push(a.mIndices[3]),t.mIndexArray.push(a.mIndices[0])}}}if(t.mNumBones){t.mBones=[];for(s=0;s<t.mNumBones;++s)t.mBones[s]=new H,_e(e,t.mBones[s])}}function Me(e,t){we(le(e)==b),le(e),t.mKey=pe(e),t.mSemantic=ue(e),t.mIndex=ue(e),t.mDataLength=ue(e),t.mType=ue(e),t.mData=[],e.ReadBytes(t.mData,1,t.mDataLength)}function Te(e,t){if(we(le(e)==y),le(e),t.mNumAllocated=t.mNumProperties=ue(e),t.mNumProperties){t.mProperties&&delete t.mProperties,t.mProperties=[];for(var r=0;r<t.mNumProperties;++r)t.mProperties[r]=new X,Me(e,t.mProperties[r])}}function Ae(e,t){we(le(e)==h),le(e),t.mNodeName=pe(e),t.mNumPositionKeys=ue(e),t.mNumRotationKeys=ue(e),t.mNumScalingKeys=ue(e),t.mPreState=ue(e),t.mPostState=ue(e),t.mNumPositionKeys&&(Ne?xe(e,t.mPositionKeys,t.mNumPositionKeys):(t.mPositionKeys=[],be(e,t.mPositionKeys,t.mNumPositionKeys))),t.mNumRotationKeys&&(Ne?xe(e,t.mRotationKeys,t.mNumRotationKeys):(t.mRotationKeys=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=ye(e)}(e,t.mRotationKeys,t.mNumRotationKeys))),t.mNumScalingKeys&&(Ne?xe(e,t.mScalingKeys,t.mNumScalingKeys):(t.mScalingKeys=[],be(e,t.mScalingKeys,t.mNumScalingKeys)))}function Ee(e,t){if(we(le(e)==m),le(e),t.mName=pe(e),t.mDuration=ae(e),t.mTicksPerSecond=ae(e),t.mNumChannels=ue(e),t.mNumChannels){t.mChannels=[];for(var r=0;r<t.mNumChannels;++r)t.mChannels[r]=new $,Ae(e,t.mChannels[r])}}function Ce(e,t){we(le(e)==u),le(e),t.mWidth=ue(e),t.mHeight=ue(e),e.ReadBytes(t.achFormatHint,1,4),Ne||(t.mHeight?(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth*t.mHeight*4)):(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth)))}function Le(e,t){we(le(e)==o),le(e),t.mName=pe(e),t.mType=ue(e),t.mType!=C&&(t.mAttenuationConstant=oe(e),t.mAttenuationLinear=oe(e),t.mAttenuationQuadratic=oe(e)),t.mColorDiffuse=de(e),t.mColorSpecular=de(e),t.mColorAmbient=de(e),t.mType==L&&(t.mAngleInnerCone=oe(e),t.mAngleOuterCone=oe(e))}function Pe(e,t){we(le(e)==i),le(e),t.mName=pe(e),t.mPosition=he(e),t.mLookAt=he(e),t.mUp=he(e),t.mHorizontalFOV=oe(e),t.mClipPlaneNear=oe(e),t.mClipPlaneFar=oe(e),t.mAspect=oe(e)}function Oe(e,t){if(we(le(e)==d),le(e),t.mFlags=ue(e),t.mNumMeshes=ue(e),t.mNumMaterials=ue(e),t.mNumAnimations=ue(e),t.mNumTextures=ue(e),t.mNumLights=ue(e),t.mNumCameras=ue(e),t.mRootNode=new W,t.mRootNode=function e(t,r,n){we(le(t)==g),le(t);var i=new W;if(i.mParent=r,i.mDepth=n,i.mName=pe(t),i.mTransformation=ve(t),i.mNumChildren=ue(t),i.mNumMeshes=ue(t),i.mNumMeshes){i.mMeshes=[];for(var o=0;o<i.mNumMeshes;++o)i.mMeshes[o]=ue(t)}if(i.mNumChildren)for(i.mChildren=[],o=0;o<i.mNumChildren;++o){var a=e(t,i,n++);i.mChildren[o]=a}return i}(e,null,0),t.mNumMeshes){t.mMeshes=[];for(var r=0;r<t.mNumMeshes;++r)t.mMeshes[r]=new j,Se(e,t.mMeshes[r])}if(t.mNumMaterials){t.mMaterials=[];for(r=0;r<t.mNumMaterials;++r)t.mMaterials[r]=new J,Te(e,t.mMaterials[r])}if(t.mNumAnimations){t.mAnimations=[];for(r=0;r<t.mNumAnimations;++r)t.mAnimations[r]=new ee,Ee(e,t.mAnimations[r])}if(t.mNumTextures){t.mTextures=[];for(r=0;r<t.mNumTextures;++r)t.mTextures[r]=new te,Ce(e,t.mTextures[r])}if(t.mNumLights){t.mLights=[];for(r=0;r<t.mNumLights;++r)t.mLights[r]=new re,Le(e,t.mLights[r])}if(t.mNumCameras){t.mCameras=[];for(r=0;r<t.mNumCameras;++r)t.mCameras[r]=new ne,Pe(e,t.mCameras[r])}}var Ne,Re,Ie=0,De=1;return function(e){var t=new function(){this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(e,t){if(t||(t=this.mRootNode),t.mName==e)return t;for(var r=0;r<t.mChildren.length;r++){var n=this.findNode(e,t.mChildren[r]);if(n)return n}return null},this.toTHREE=function(){this.nodeCount=0,function(e){for(var t in e.mMeshes){var r=e.mMeshes[t];for(var n in r.mBones){var i=e.findNode(r.mBones[n].mName);i&&(i.isBone=!0)}}}(this);var e=this.mRootNode.toTHREE(this);for(var t in this.mMeshes)this.mMeshes[t].hookupSkeletons(this,e);if(this.mAnimations.length>0)var r=this.mAnimations[0].toTHREE(this);return{object:e,animation:r}}},r=new DataView(e);if(function(e){e.readOffset=0,e.Seek=function(t,r){r==Ie&&(e.readOffset+=t),r==De&&(e.readOffset=t)},e.ReadBytes=function(e,t,r){for(var n=t*r,i=0;i<n;i++)e[i]=se(this)},e.subArray32=function(e,t){var r=this.buffer.slice(e,t);return new Float32Array(r)},e.subArrayUint16=function(e,t){var r=this.buffer.slice(e,t);return new Uint16Array(r)},e.subArrayUint8=function(e,t){var r=this.buffer.slice(e,t);return new Uint8Array(r)},e.subArrayUint32=function(e,t){var r=this.buffer.slice(e,t);return new Uint32Array(r)}}(r),r.Seek(44,Ie),ue(r),ue(r),ue(r),ue(r),Ne=ce(r)>0,Re=ce(r)>0,Ne)throw"Shortened binaries are not supported!";if(r.Seek(256,Ie),r.Seek(128,Ie),r.Seek(64,Ie),!Re)return Oe(r,t),t.toTHREE();var n=le(r),i=r.FileSize()-r.Tell(),o=[];r.Read(o,1,i);var a=[];uncompress(a,n,o,i),Oe(new ArrayBuffer(a),t)}(e)}};function fo(){this.id=0,this.data=null}function po(){}po.prototype={set:function(e,t){this[e]=t},get:function(e,t){return this.hasOwnProperty(e)?this[e]:t}};var mo=function(e){this.manager=void 0!==e?e:cn,this.trunk=new p,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new fo],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};function vo(e,t){p.call(this),this.type="Light",this.color=new v(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function go(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new x(512,512),this.map=null,this.matrix=new a}function yo(e,t,r,n){vo.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new go(new Wr(90,1,.5,500))}function bo(){go.call(this,new Yr(-5,5,5,-5,.5,500))}function xo(e,t){vo.call(this,e,t),this.type="DirectionalLight",this.position.copy(p.DefaultUp),this.updateMatrix(),this.target=new p,this.shadow=new bo}function wo(){go.call(this,new Wr(50,1,.5,500))}function _o(e,t,r,n,i,o){vo.call(this,e,t),this.type="SpotLight",this.position.copy(p.DefaultUp),this.updateMatrix(),this.target=new p,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new wo}function So(e,t,r){vo.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(p.DefaultUp),this.updateMatrix(),this.groundColor=new v(t)}mo.prototype={constructor:mo,load:function(e,t,r,n){var i=this;this._url=e,this._baseDir=e.substr(0,e.lastIndexOf("/")+1);var o=new ln(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){var t=e.byteLength;for(this._ptr=0,this._data=new DataView(e),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),this._streaming||this._bodylen==e.byteLength-this._ptr||console.error("AWDLoader: body len does not match file length",this._bodylen,t-this._ptr);this._ptr<t;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var e,t,r=this.readU32(),n=(this.readU8(),this.readU8()),i=(this.readU8(),this.readU32());switch(n){case 1:e=this.parseMeshData(i);break;case 22:e=this.parseContainer(i);break;case 23:e=this.parseMeshInstance(i);break;case 81:e=this.parseMaterial(i);break;case 82:e=this.parseTexture(i);break;case 101:e=this.parseSkeleton(i);break;case 112:e=this.parseMeshPoseAnimation(i,!1);break;case 113:e=this.parseVertexAnimationSet(i);break;case 102:e=this.parseSkeletonPose(i);break;case 103:e=this.parseSkeletonAnimation(i);break;case 122:e=this.parseAnimatorSet(i);break;default:this._ptr+=i}this._blocks[r]=t=new fo,t.data=e,t.id=r},_parseHeader:function(){var e=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");e[0]=this.readU8(),e[1]=this.readU8();var t=this.readU16();this._streaming=1==(1&t),2===e[0]&&1===e[1]&&(this._accuracyMatrix=2==(2&t),this._accuracyGeo=4==(4&t),this._accuracyProps=8==(8&t)),this._geoNrType=this._accuracyGeo?8:7,this._matrixNrType=this._accuracyMatrix?8:7,this._propsNrType=this._accuracyProps?8:7,this._optimized_for_accuracy=2==(2&t),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(e){var t=new p,r=this.readU32(),n=this.parseMatrix4();return t.name=this.readUTF(),t.applyMatrix(n),(this._blocks[r].data||this.trunk).add(t),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:4}),t.extra=this.parseUserAttributes(),t},parseMeshInstance:function(e){var t,r,n,i,o,a,s,c,u,l,h,d,f;for(a=this.readU32(),c=this.parseMatrix4(),t=this.readUTF(),s=this.readU32(),d=this.readU16(),n=this.getBlock(s),u=[],f=0;f<d;f++)h=this.readU32(),l=this.getBlock(h),u.push(l);if(o=[],(i=n.length)>1)for(r=new p,f=0;f<i;f++){var m=new dr(n[f]);o.push(m),r.add(m)}else r=new dr(n[0]),o.push(r);r.applyMatrix(c),r.name=t,(this.getBlock(a)||this.trunk).add(r);var v=u.length,g=Math.max(i,v);for(f=0;f<g;f++)o[f%i].material=u[f%v];return this.parseProperties(null),r.extra=this.parseUserAttributes(),r},parseMaterial:function(e){var t,r,n,i,o,a;for(t=this.readUTF(),r=this.readU8(),a=this.readU8(),n=this.parseProperties({1:3,2:23,11:21,12:7,13:21}),0;0<a;){this.readU16();this.parseProperties(null),this.parseUserAttributes()}if(o=this.parseUserAttributes(),void 0!==this.materialFactory&&(i=this.materialFactory(t)))return i;if(i=new vn,1===r)i.color.setHex(n.get(1,13421772));else if(2===r){var s=n.get(2,0);i.map=this.getBlock(s)}return i.extra=o,i.alphaThreshold=n.get(12,0),i.repeat=n.get(13,!1),i},parseTexture:function(e){var t,r;this.readUTF();if(0===this.readU8()){r=this.readU32();var n=this.readUTFBytes(r);console.log(n),t=this.loadTexture(n)}return this.parseProperties(null),this.parseUserAttributes(),t},loadTexture:function(e){var t=new Zr;return new Tn(this.manager).load(this._baseDir+e,function(e){t.image=e,t.needsUpdate=!0}),t},parseSkeleton:function(e){this.readUTF();var t=this.readU16(),r=[],n=0;for(this.parseProperties(null);n<t;){var i,o;this.readU16(),(i=new Dr).parent=this.readU16()-1,i.name=this.readUTF(),o=this.parseMatrix4(),i.skinMatrix=o,this.parseProperties(null),this.parseUserAttributes(),r.push(i),n++}return this.parseUserAttributes(),r},parseSkeletonPose:function(e){this.readUTF();var t=this.readU16();this.parseProperties(null);for(var r=[],n=0;n<t;){var i;i=1===this.readU8()?this.parseMatrix4():new a,r[n]=i,n++}return this.parseUserAttributes(),r},parseSkeletonAnimation:function(e){this.readUTF();var t,r,n,i=[],o=this.readU16();this.parseProperties(null);for(var a=0;a<o;)r=this.readU32(),t=this.readU16(),n=this._blocks[r].data,i.push({pose:n,duration:t}),a++;if(0!==i.length)return this.parseUserAttributes(),i},parseVertexAnimationSet:function(e){this.readUTF();for(var t,r=this.readU16(),n=(this.parseProperties({1:5}),0),i=[];n<r;)t=this.readU32(),i.push(this._blocks[t].data),n++;return this.parseUserAttributes(),i},parseAnimatorSet:function(e){this.readUTF();var t,r,n=this.readU16(),i=this.parseProperties({1:23});t=this.readU32();for(var o=this.readU16(),a=[],s=0;s<o;s++)a.push(this.readU32());this.readU16(),Boolean(this.readU8());this.parseUserAttributes(),this.parseUserAttributes();var c,u=[];for(s=0;s<a.length;s++)u.push(this._blocks[a[s]].data);for(r=this._blocks[t].data,1==n&&(c={animationSet:r,skeleton:this._blocks[i.get(1,0)].data}),s=0;s<u.length;s++)u[s].animator=c;return c},parseMeshData:function(e){var t,r,n=this.readUTF(),i=this.readU16(),o=0,a=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});o<i;){var s,c,u;for((t=new U).name=n,a.push(t),s=this.readU32(),c=this._ptr+s,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<c;){var l=0,h=this.readU8(),d=(this.readU8(),this.readU32()),f=d+this._ptr;if(1===h)for(u=new M(r=new Float32Array(d/12*3),3),t.addAttribute("position",u),l=0;this._ptr<f;)r[l]=-this.readF32(),r[l+1]=this.readF32(),r[l+2]=this.readF32(),l+=3;else if(2===h)for(u=new M(r=new Uint16Array(d/2),1),t.setIndex(u),l=0;this._ptr<f;)r[l+1]=this.readU16(),r[l]=this.readU16(),r[l+2]=this.readU16(),l+=3;else if(3===h)for(u=new M(r=new Float32Array(d/8*2),2),t.addAttribute("uv",u),l=0;this._ptr<f;)r[l]=this.readF32(),r[l+1]=1-this.readF32(),l+=2;else if(4===h)for(u=new M(r=new Float32Array(d/12*3),3),t.addAttribute("normal",u),l=0;this._ptr<f;)r[l]=-this.readF32(),r[l+1]=this.readF32(),r[l+2]=this.readF32(),l+=3;else this._ptr=f}this.parseUserAttributes(),t.computeBoundingSphere(),o++}return this.parseUserAttributes(),a},parseMeshPoseAnimation:function(e,t){var r,n,i,o,a,s,c,u,l,h=1,d=0,f={},p=[],m=(this.readUTF(),this.readU32()),v=this.getBlock(m);if(null!==v){for((s=v.geometry).morphTargets=[],t||(h=this.readU16()),r=this.readU16(),c=this.readU16(),u=0;u<c;)p.push(this.readU16()),u++;for(l=this.parseProperties({1:21,2:21}),f.looping=l.get(1,!0),f.stitchFinalFrame=l.get(2,!1),n=0;n<h;){for(this.readU16(),i=0;i<r;)for(u=0,o=this.readU32(),a=this._ptr+o;u<c;){if(1===p[u]){var g=new Float32Array(o/4);for(s.morphTargets.push({array:g}),d=0;this._ptr<a;)g[d]=this.readF32(),g[d+1]=this.readF32(),g[d+2]=this.readF32(),d+=3;i++}else this._ptr=a;u++}n++}return this.parseUserAttributes(),null}console.log("parseMeshPoseAnimation target mesh not found at:",m)},getBlock:function(e){return this._blocks[e].data},parseMatrix4:function(){var e=new a,t=e.elements;return t[0]=this.readF32(),t[1]=this.readF32(),t[2]=this.readF32(),t[3]=0,t[4]=this.readF32(),t[5]=this.readF32(),t[6]=this.readF32(),t[7]=0,t[8]=this.readF32(),t[9]=this.readF32(),t[10]=this.readF32(),t[11]=0,t[12]=-this.readF32(),t[13]=this.readF32(),t[14]=this.readF32(),t[15]=1,e},parseProperties:function(e){var t=this.readU32(),r=this._ptr+t,n=new po;if(e)for(;this._ptr<r;){var i,o=this.readU16(),a=this.readU32();e.hasOwnProperty(o)?(i=e[o],n.set(o,this.parseAttrValue(i,a))):this._ptr+=a}return n},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(e,t){var r,n;switch(e){case 1:r=1,n=this.readI8;break;case 2:r=2,n=this.readI16;break;case 3:r=4,n=this.readI32;break;case 21:case 4:r=1,n=this.readU8;break;case 5:r=2,n=this.readU16;break;case 6:case 23:r=4,n=this.readU32;break;case 7:r=4,n=this.readF32;break;case 8:r=8,n=this.readF64;break;case 41:case 42:case 43:case 44:case 45:case 46:case 47:r=8,n=this.readF64}if(r<t){var i,o,a;for(i=[],o=0,a=t/r;o<a;)i.push(n.call(this)),o++;return i}return n.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var e=this._data.getUint16(this._ptr,!0);return this._ptr+=2,e},readI16:function(){var e=this._data.getInt16(this._ptr,!0);return this._ptr+=2,e},readU32:function(){var e=this._data.getUint32(this._ptr,!0);return this._ptr+=4,e},readI32:function(){var e=this._data.getInt32(this._ptr,!0);return this._ptr+=4,e},readF32:function(){var e=this._data.getFloat32(this._ptr,!0);return this._ptr+=4,e},readF64:function(){var e=this._data.getFloat64(this._ptr,!0);return this._ptr+=8,e},readUTF:function(){var e=this.readU16();return this.readUTFBytes(e)},readUTFBytes:function(e){for(var t=[],r=0;t.length<e;){var n=this._data.getUint8(this._ptr++,!0);if(n<128)t[r++]=String.fromCharCode(n);else if(n>191&&n<224){var i=this._data.getUint8(this._ptr++,!0);t[r++]=String.fromCharCode((31&n)<<6|63&i)}else{i=this._data.getUint8(this._ptr++,!0);var o=this._data.getUint8(this._ptr++,!0);t[r++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o)}}return t.join("")}},vo.prototype=Object.assign(Object.create(p.prototype),{constructor:vo,isLight:!0,copy:function(e){return p.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=p.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Object.assign(go.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),yo.prototype=Object.assign(Object.create(vo.prototype),{constructor:yo,isPointLight:!0,copy:function(e){return vo.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),bo.prototype=Object.assign(Object.create(go.prototype),{constructor:bo}),xo.prototype=Object.assign(Object.create(vo.prototype),{constructor:xo,isDirectionalLight:!0,copy:function(e){return vo.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),wo.prototype=Object.assign(Object.create(go.prototype),{constructor:wo,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*o.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),_o.prototype=Object.assign(Object.create(vo.prototype),{constructor:_o,isSpotLight:!0,copy:function(e){return vo.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),So.prototype=Object.assign(Object.create(vo.prototype),{constructor:So,isHemisphereLight:!0,copy:function(e){return vo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});var Mo=function(e){this.manager=void 0!==e?e:cn};Mo.prototype={constructor:Mo,load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){function t(e){var t=new U,r=e.indices,n=e.positions,i=e.normals,o=e.uvs;t.setIndex(r);for(var a=2,s=n.length;a<s;a+=3)n[a]=-n[a];if(t.addAttribute("position",new N(n,3)),i){for(a=2,s=i.length;a<s;a+=3)i[a]=-i[a];t.addAttribute("normal",new N(i,3))}o&&t.addAttribute("uv",new N(o,2));var c=e.subMeshes;if(c)for(a=0,s=c.length;a<s;a++){var u=c[a];t.addGroup(u.indexStart,u.indexCount)}return t}return function(e,r){for(var n={},i=new qr,o=e.cameras,a=0,s=o.length;a<s;a++){var c=new Wr((d=o[a]).fov/Math.PI*180,1.33,d.minZ,d.maxZ);c.name=d.name,c.position.fromArray(d.position),d.rotation&&c.rotation.fromArray(d.rotation),n[d.id]=c}var u=e.lights;for(a=0,s=u.length;a<s;a++){var l;switch((d=u[a]).type){case 0:l=new yo;break;case 1:l=new xo;break;case 2:l=new _o;break;case 3:l=new So}l.name=d.name,d.position&&l.position.set(d.position[0],d.position[1],-d.position[2]),l.color.fromArray(d.diffuse),d.groundColor&&l.groundColor.fromArray(d.groundColor),d.intensity&&(l.intensity=d.intensity),n[d.id]=l,i.add(l)}var h=e.meshes;for(a=0,s=h.length;a<s;a++){var d,f;(f=(d=h[a]).indices?new dr(t(d),r[d.materialId]):new oo).name=d.name,f.position.set(d.position[0],d.position[1],-d.position[2]),f.rotation.fromArray(d.rotation),d.rotationQuaternion&&f.quaternion.fromArray(d.rotationQuaternion),f.scale.fromArray(d.scaling),d.parentId?n[d.parentId].add(f):i.add(f),n[d.id]=f}return i}(e,function(e){for(var t={},r=0,n=e.materials.length;r<n;r++){var i=e.materials[r],o=new vn;o.name=i.name,o.color.fromArray(i.diffuse),o.emissive.fromArray(i.emissive),o.specular.fromArray(i.specular),o.shininess=i.specularPower,o.opacity=i.alpha,t[i.id]=o}if(e.multiMaterials)for(r=0,n=e.multiMaterials.length;r<n;r++)i=e.multiMaterials[r],console.warn("BabylonLoader: Multi materials not yet supported."),t[i.id]=new vn;return t}(e))}};var To=function(e){this.manager=void 0!==e?e:cn,this.animateBonePositions=!0,this.animateBoneRotations=!0};function Ao(e,t){vo.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Eo(e,t){fr.call(this,e,t),this.type="LineSegments"}To.prototype={constructor:To,load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e,r,n){if("ENDSITE"!==n.type){var i={time:r,position:new s,rotation:new c};n.frames.push(i);for(var o=new c,a=new s(1,0,0),u=new s(0,1,0),l=new s(0,0,1),h=0;h<n.channels.length;h++)switch(n.channels[h]){case"Xposition":i.position.x=parseFloat(e.shift().trim());break;case"Yposition":i.position.y=parseFloat(e.shift().trim());break;case"Zposition":i.position.z=parseFloat(e.shift().trim());break;case"Xrotation":o.setFromAxisAngle(a,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Yrotation":o.setFromAxisAngle(u,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Zrotation":o.setFromAxisAngle(l,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;default:console.warn("BVHLoader: Invalid channel type.")}for(h=0;h<n.children.length;h++)t(e,r,n.children[h])}}function r(e){for(var t;0===(t=e.shift().trim()).length;);return t}var n=this,i=function(e){"HIERARCHY"!==r(e)&&console.error("BVHLoader: HIERARCHY expected.");var n=[],i=function e(t,n,i){var o={name:"",type:"",frames:[]};i.push(o);var a=n.split(/[\s]+/);"END"===a[0].toUpperCase()&&"SITE"===a[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=a[1],o.type=a[0].toUpperCase()),"{"!==r(t)&&console.error("BVHLoader: Expected opening { after type & name"),"OFFSET"!==(a=r(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected OFFSET but got: "+a[0]),4!==a.length&&console.error("BVHLoader: Invalid number of values for OFFSET.");var c=new s(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));if((isNaN(c.x)||isNaN(c.y)||isNaN(c.z))&&console.error("BVHLoader: Invalid values of OFFSET."),o.offset=c,"ENDSITE"!==o.type){"CHANNELS"!==(a=r(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected CHANNELS definition.");var u=parseInt(a[1]);o.channels=a.splice(2,u),o.children=[]}for(;;){var l=r(t);if("}"===l)return o;o.children.push(e(t,l,i))}}(e,r(e),n);"MOTION"!==r(e)&&console.error("BVHLoader: MOTION expected.");var o=r(e).split(/[\s]+/),a=parseInt(o[1]);isNaN(a)&&console.error("BVHLoader: Failed to read number of frames."),o=r(e).split(/[\s]+/);var c=parseFloat(o[2]);isNaN(c)&&console.error("BVHLoader: Failed to read frame time.");for(var u=0;u<a;u++)t(o=r(e).split(/[\s]+/),u*c,i);return n}(e.split(/[\r\n]+/g)),o=[];!function e(t,r){var n=new Dr;if(r.push(n),n.position.add(t.offset),n.name=t.name,"ENDSITE"!==t.type)for(var i=0;i<t.children.length;i++)n.add(e(t.children[i],r));return n}(i[0],o);var a=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];if("ENDSITE"!==i.type){for(var o=[],a=[],s=[],c=0;c<i.frames.length;c++){var u=i.frames[c];o.push(u.time),a.push(u.position.x+i.offset.x),a.push(u.position.y+i.offset.y),a.push(u.position.z+i.offset.z),s.push(u.rotation.x),s.push(u.rotation.y),s.push(u.rotation.z),s.push(u.rotation.w)}n.animateBonePositions&&t.push(new Or(".bones["+i.name+"].position",o,a)),n.animateBoneRotations&&t.push(new Lr(".bones["+i.name+"].quaternion",o,s))}}return new Nr("animation",-1,t)}(i);return{skeleton:new uo(o),clip:a}}},Ao.prototype=Object.assign(Object.create(vo.prototype),{constructor:Ao,isAmbientLight:!0}),Eo.prototype=Object.assign(Object.create(fr.prototype),{constructor:Eo,isLineSegments:!0,computeLineDistances:function(){var e=new s,t=new s;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],o=0,a=n.count;o<a;o+=2)e.fromBufferAttribute(n,o),t.fromBufferAttribute(n,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);r.addAttribute("lineDistance",new N(i,1))}else console.warn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;for(i=r.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()});var Co=function(e){this.manager=void 0!==e?e:cn};Co.prototype={constructor:Co,load:function(e,t,r,n){var i=this,o=new Zr,a=new ln(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){o.image=i.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)},r,n),o},parse:function(e){var t=0,r=1,n=2,i=3,o=9,a=10,s=11,c=48,u=4,l=0,h=1,d=2,f=3;e.length<19&&console.error("TGALoader: Not enough data to contain header.");var p=new Uint8Array(e),m=0,v={id_length:p[m++],colormap_type:p[m++],image_type:p[m++],colormap_index:p[m++]|p[m++]<<8,colormap_length:p[m++]|p[m++]<<8,colormap_size:p[m++],origin:[p[m++]|p[m++]<<8,p[m++]|p[m++]<<8],width:p[m++]|p[m++]<<8,height:p[m++]|p[m++]<<8,pixel_size:p[m++],flags:p[m++]};!function(e){switch(e.image_type){case r:case o:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("TGALoader: Invalid type colormap data for indexed type.");break;case n:case i:case a:case s:e.colormap_type&&console.error("TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("TGALoader: No data.");default:console.error('TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('TGALoader: Invalid pixel size "%s".',e.pixel_size)}(v),v.id_length+m>e.length&&console.error("TGALoader: No data."),m+=v.id_length;var g=!1,y=!1,b=!1;switch(v.image_type){case o:g=!0,y=!0;break;case r:y=!0;break;case a:g=!0;break;case n:break;case s:g=!0,b=!0;break;case i:b=!0}var x=document.createElement("canvas");x.width=v.width,x.height=v.height;var w=x.getContext("2d"),_=w.createImageData(v.width,v.height),S=function(e,t,r,n,i){var o,a,s,c;if(a=r.pixel_size>>3,s=r.width*r.height*a,t&&(c=i.subarray(n,n+=r.colormap_length*(r.colormap_size>>3))),e){var u,l,h;o=new Uint8Array(s);for(var d=0,f=new Uint8Array(a);d<s;)if(l=1+(127&(u=i[n++])),128&u){for(h=0;h<a;++h)f[h]=i[n++];for(h=0;h<l;++h)o.set(f,d+h*a);d+=a*l}else{for(l*=a,h=0;h<l;++h)o[d+h]=i[n++];d+=l}}else o=i.subarray(n,n+=t?r.width*r.height:s);return{pixel_data:o,palettes:c}}(g,y,v,m,p);!function(e,t,r,n,i){var o,a,s,p,m,g;switch((v.flags&c)>>u){default:case d:o=0,s=1,m=t,a=0,p=1,g=r;break;case l:o=0,s=1,m=t,a=r-1,p=-1,g=-1;break;case f:o=t-1,s=-1,m=-1,a=0,p=1,g=r;break;case h:o=t-1,s=-1,m=-1,a=r-1,p=-1,g=-1}if(b)switch(v.pixel_size){case 8:!function(e,t,r,n,i,o,a,s){var c,u,l,h=0,d=v.width;for(l=t;l!==n;l+=r)for(u=i;u!==a;u+=o,h++)c=s[h],e[4*(u+d*l)+0]=c,e[4*(u+d*l)+1]=c,e[4*(u+d*l)+2]=c,e[4*(u+d*l)+3]=255}(e,a,p,g,o,s,m,n);break;case 16:!function(e,t,r,n,i,o,a,s){var c,u,l=0,h=v.width;for(u=t;u!==n;u+=r)for(c=i;c!==a;c+=o,l+=2)e[4*(c+h*u)+0]=s[l+0],e[4*(c+h*u)+1]=s[l+0],e[4*(c+h*u)+2]=s[l+0],e[4*(c+h*u)+3]=s[l+1]}(e,a,p,g,o,s,m,n);break;default:console.error("TGALoader: Format not supported.")}else switch(v.pixel_size){case 8:!function(e,t,r,n,i,o,a,s,c){var u,l,h,d=c,f=0,p=v.width;for(h=t;h!==n;h+=r)for(l=i;l!==a;l+=o,f++)u=s[f],e[4*(l+p*h)+3]=255,e[4*(l+p*h)+2]=d[3*u+0],e[4*(l+p*h)+1]=d[3*u+1],e[4*(l+p*h)+0]=d[3*u+2]}(e,a,p,g,o,s,m,n,i);break;case 16:!function(e,t,r,n,i,o,a,s){var c,u,l,h=0,d=v.width;for(l=t;l!==n;l+=r)for(u=i;u!==a;u+=o,h+=2)c=s[h+0]+(s[h+1]<<8),e[4*(u+d*l)+0]=(31744&c)>>7,e[4*(u+d*l)+1]=(992&c)>>2,e[4*(u+d*l)+2]=(31&c)>>3,e[4*(u+d*l)+3]=32768&c?0:255}(e,a,p,g,o,s,m,n);break;case 24:!function(e,t,r,n,i,o,a,s){var c,u,l=0,h=v.width;for(u=t;u!==n;u+=r)for(c=i;c!==a;c+=o,l+=3)e[4*(c+h*u)+3]=255,e[4*(c+h*u)+2]=s[l+0],e[4*(c+h*u)+1]=s[l+1],e[4*(c+h*u)+0]=s[l+2]}(e,a,p,g,o,s,m,n);break;case 32:!function(e,t,r,n,i,o,a,s){var c,u,l=0,h=v.width;for(u=t;u!==n;u+=r)for(c=i;c!==a;c+=o,l+=4)e[4*(c+h*u)+2]=s[l+0],e[4*(c+h*u)+1]=s[l+1],e[4*(c+h*u)+0]=s[l+2],e[4*(c+h*u)+3]=s[l+3]}(e,a,p,g,o,s,m,n);break;default:console.error("TGALoader: Format not supported.")}}(_.data,v.width,v.height,S.pixel_data,S.palettes);return w.putImageData(_,0,0),x},setPath:function(e){return this.path=e,this}};var Lo=function(e){this.manager=void 0!==e?e:cn};function Po(e,t,r,n,i,o,a,s,c,u,l,h){Zr.call(this,null,o,a,s,c,u,n,i,l,h),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Oo(e){this.manager=void 0!==e?e:cn,this._parser=null}Lo.prototype={constructor:Lo,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?Cn.extractUrlBase(e):i.path;new ln(i.manager).load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},options:{set convertUpAxis(e){console.warn("ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=[],n=e.childNodes,i=0,o=n.length;i<o;i++){var a=n[i];a.nodeName===t&&r.push(a)}return r}function n(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=t[n];return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseFloat(t[n]);return r}function u(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseInt(t[n]);return r}function h(e){return e.substring(1)}function d(e){return 0===Object.keys(e).length}function f(e,t,n,i){var o=r(e,t)[0];if(void 0!==o)for(var a=r(o,n),s=0;s<a.length;s++)i(a[s])}function p(e,t){for(var r in e){e[r].build=t(e[r])}}function m(e,t){return void 0!==e.build?e.build:(e.build=t(e),e.build)}function g(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=h(i.getAttribute("source")),a=i.getAttribute("semantic");t.inputs[a]=o}}return t}function y(e){var t={},r=e.getAttribute("target").split("/"),n=r.shift(),i=r.shift(),o=-1!==i.indexOf("("),a=-1!==i.indexOf(".");if(a)i=(r=i.split(".")).shift(),t.member=r.shift();else if(o){var s=i.split("(");i=s.shift();for(var c=0;c<s.length;c++)s[c]=parseInt(s[c].replace(/\)/,""));t.indices=s}return t.id=n,t.sid=i,t.arraySyntax=o,t.memberSyntax=a,t.sampler=h(e.getAttribute("source")),t}function b(e){var t=[],r=e.channels,n=e.samplers,i=e.sources;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],s=n[a.sampler],c=s.inputs.INPUT,u=s.inputs.OUTPUT;T(w(a,i[c],i[u]),t)}return t}function x(e){return m(rt.animations[e],b)}function w(e,t,r){var n,i,o,a,s,c,u=rt.nodes[e.id],l=Ve(u.id),h=u.transforms[e.sid],d=u.matrix.clone().transpose(),f={};switch(h){case"matrix":for(o=0,a=t.array.length;o<a;o++)if(n=t.array[o],i=o*r.stride,void 0===f[n]&&(f[n]={}),!0===e.arraySyntax){var p=r.array[i],m=e.indices[0]+4*e.indices[1];f[n][m]=p}else for(s=0,c=r.stride;s<c;s++)f[n][s]=r.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var v=function(e,t){var r=[];for(var n in e)r.push({time:parseFloat(n),value:e[n]});r.sort(function(e,t){return e.time-t.time});for(var i=0;i<16;i++)A(r,i,t.elements[i]);return r}(f,d);return{name:l.uuid,keyframes:v}}var _=new s,S=new s,M=new c;function T(e,t){for(var r=e.keyframes,n=e.name,i=[],o=[],a=[],s=[],c=0,u=r.length;c<u;c++){var l=r[c],h=l.time,d=l.value;Oe.fromArray(d).transpose(),Oe.decompose(_,M,S),i.push(h),o.push(_.x,_.y,_.z),a.push(M.x,M.y,M.z,M.w),s.push(S.x,S.y,S.z)}return o.length>0&&t.push(new Or(n+".position",i,o)),a.length>0&&t.push(new Lr(n+".quaternion",i,a)),s.length>0&&t.push(new Or(n+".scale",i,s)),t}function A(e,t,r){var n,i,o,a=!0;for(i=0,o=e.length;i<o;i++)void 0===(n=e[i]).value[t]?n.value[t]=null:a=!1;if(!0===a)for(i=0,o=e.length;i<o;i++)(n=e[i]).value[t]=r;else!function(e,t){for(var r,n,i=0,o=e.length;i<o;i++){var a=e[i];if(null===a.value[t]){if(r=E(e,i,t),n=C(e,i,t),null===r){a.value[t]=n.value[t];continue}if(null===n){a.value[t]=r.value[t];continue}L(a,r,n,t)}}}(e,t)}function E(e,t,r){for(;t>=0;){var n=e[t];if(null!==n.value[r])return n;t--}return null}function C(e,t,r){for(;t<e.length;){var n=e[t];if(null!==n.value[r])return n;t++}return null}function L(e,t,r,n){r.time-t.time!=0?e.value[n]=(e.time-t.time)*(r.value[n]-t.value[n])/(r.time-t.time)+t.value[n]:e.value[n]=t.value[n]}function P(e){for(var t=[],r=e.name,n=e.end-e.start||-1,i=e.animations,o=0,a=i.length;o<a;o++)for(var s=x(i[o]),c=0,u=s.length;c<u;c++)t.push(s[c]);return new Nr(r,n,t)}function O(e){return m(rt.clips[e],P)}function R(e){for(var t={sources:{}},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=i(o.textContent);break;case"source":var a=o.getAttribute("id");t.sources[a]=de(o);break;case"joints":t.joints=I(o);break;case"vertex_weights":t.vertexWeights=D(o)}}return t}function I(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),a=h(i.getAttribute("source"));t.inputs[o]=a}}return t}function D(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),a=h(i.getAttribute("source")),s=parseInt(i.getAttribute("offset"));t.inputs[o]={id:a,offset:s};break;case"vcount":t.vcount=u(i.textContent);break;case"v":t.v=u(i.textContent)}}return t}function F(e){var t={id:e.id},r=rt.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){var t,r,n,i={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},o=e.sources,s=e.vertexWeights,c=s.vcount,u=s.v,l=s.inputs.JOINT.offset,h=s.inputs.WEIGHT.offset,d=e.sources[e.joints.inputs.JOINT],f=e.sources[e.joints.inputs.INV_BIND_MATRIX],p=o[s.inputs.WEIGHT.id].array,m=0;for(t=0,n=c.length;t<n;t++){var v=c[t],g=[];for(r=0;r<v;r++){var y=u[m+l],b=u[m+h],x=p[b];g.push({index:y,weight:x}),m+=2}for(g.sort(M),r=0;r<4;r++){var w=g[r];void 0!==w?(i.indices.array.push(w.index),i.weights.array.push(w.weight)):(i.indices.array.push(0),i.weights.array.push(0))}}e.bindShapeMatrix?i.bindMatrix=(new a).fromArray(e.bindShapeMatrix).transpose():i.bindMatrix=(new a).identity();for(t=0,n=d.array.length;t<n;t++){var _=d.array[t],S=(new a).fromArray(f.array,t*f.stride).transpose();i.joints.push({name:_,boneInverse:S})}return i;function M(e,t){return t.weight-e.weight}}(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function k(e){return m(rt.controllers[e],F)}function B(e){return void 0!==e.build?e.build:e.init_from}function z(e){var t=rt.images[e];return void 0!==t?m(t,B):(console.warn("ColladaLoader: Couldn't find image with ID:",e),null)}function j(e){for(var t={surfaces:{},samplers:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"newparam":V(i,t);break;case"technique":t.technique=H(i);break;case"extra":t.extra=K(i)}}return t}function V(e,t){for(var r=e.getAttribute("sid"),n=0,i=e.childNodes.length;n<i;n++){var o=e.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"surface":t.surfaces[r]=G(o);break;case"sampler2D":t.samplers[r]=W(o)}}}function G(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":t.init_from=i.textContent}}return t}function W(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"source":t.source=i.textContent}}return t}function H(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=X(i)}}return t}function X(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"shininess":case"transparency":t[i.nodeName]=q(i);break;case"transparent":t[i.nodeName]={opaque:i.getAttribute("opaque"),data:q(i)}}}return t}function q(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":t[o.nodeName]=i(o.textContent);break;case"float":t[o.nodeName]=parseFloat(o.textContent);break;case"texture":t[o.nodeName]={id:o.getAttribute("texture"),extra:Y(o)}}}return t}function Y(e){for(var t={technique:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"extra":Q(i,t)}}return t}function Q(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":Z(i,t)}}}function Z(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent)}}}function K(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":t.technique=$(i)}}return t}function $(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent)}}return t}function ee(e){return e}function te(e){var t,r=function(e){return m(rt.effects[e],ee)}(e.url),n=r.profile.technique,i=r.profile.extra;switch(n.type){case"phong":case"blinn":t=new vn;break;case"lambert":t=new pn;break;default:t=new cr}function o(e){var t=r.profile.samplers[e.id],n=null;void 0!==t?n=z(r.profile.surfaces[t.source].init_from):(console.warn("ColladaLoader: Undefined sampler. Access image directly (see #12530)."),n=z(e.id));if(null!==n){var i=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=Qe;break;default:t=Ke}return t}(n);if(void 0!==i){var o=i.load(n),a=e.extra;if(void 0!==a&&void 0!==a.technique&&!1===d(a.technique)){var s=a.technique;o.wrapS=s.wrapU?He:Xe,o.wrapT=s.wrapV?He:Xe,o.offset.set(s.offsetU||0,s.offsetV||0),o.repeat.set(s.repeatU||1,s.repeatV||1)}else o.wrapS=He,o.wrapT=He;return o}return console.warn("ColladaLoader: Loader for texture %s not found.",n),null}return console.warn("ColladaLoader: Couldn't create texture with ID:",e.id),null}t.name=e.name;var a=n.parameters;for(var s in a){var c=a[s];switch(s){case"diffuse":c.color&&t.color.fromArray(c.color),c.texture&&(t.map=o(c.texture));break;case"specular":c.color&&t.specular&&t.specular.fromArray(c.color),c.texture&&(t.specularMap=o(c.texture));break;case"shininess":c.float&&t.shininess&&(t.shininess=c.float);break;case"emission":c.color&&t.emissive&&t.emissive.fromArray(c.color),c.texture&&(t.emissiveMap=o(c.texture))}}var u=a.transparent,l=a.transparency;if(void 0===l&&u&&(l={float:1}),void 0===u&&l&&(u={opaque:"A_ONE",data:{color:[1,1,1,1]}}),u&&l)if(u.data.texture)t.transparent=!0;else{var h=u.data.color;switch(u.opaque){case"A_ONE":t.opacity=h[3]*l.float;break;case"RGB_ZERO":t.opacity=1-h[0]*l.float;break;case"A_ZERO":t.opacity=1-h[3]*l.float;break;case"RGB_ONE":t.opacity=h[0]*l.float;break;default:console.warn('ColladaLoader: Invalid opaque type "%s" of transparent tag.',u.opaque)}t.opacity<1&&(t.transparent=!0)}return void 0!==i&&void 0!==i.technique&&1===i.technique.double_sided&&(t.side=J),t}function re(e){return m(rt.materials[e],te)}function ne(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return ie(r)}}return{}}function ie(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"perspective":case"orthographic":t.technique=n.nodeName,t.parameters=oe(n)}}return t}function oe(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[n.nodeName]=parseFloat(n.textContent)}}return t}function ae(e){var t;switch(e.optics.technique){case"perspective":t=new Wr(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,n=e.optics.parameters.xmag,i=e.optics.parameters.aspect_ratio;n=void 0===n?r*i:n,r=void 0===r?n/i:r,t=new Yr(-(n*=.5),n,r*=.5,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new Wr}return t.name=e.name,t}function se(e){var t=rt.cameras[e];return void 0!==t?m(t,ae):(console.warn("ColladaLoader: Couldn't find camera with ID:",e),null)}function ce(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=ue(i)}}return t}function ue(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":var a=i(o.textContent);t.color=(new v).fromArray(a);break;case"falloff_angle":t.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var s=parseFloat(o.textContent);t.distance=s?Math.sqrt(1/s):0}}return t}function le(e){var t;switch(e.technique){case"directional":t=new xo;break;case"point":t=new yo;break;case"spot":t=new _o;break;case"ambient":t=new Ao}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function he(e){var t=rt.lights[e];return void 0!==t?m(t,le):(console.warn("ColladaLoader: Couldn't find light with ID:",e),null)}function de(e){for(var t={array:[],stride:3},o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"float_array":t.array=i(a.textContent);break;case"Name_array":t.array=n(a.textContent);break;case"technique_common":var s=r(a,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function fe(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];1===n.nodeType&&(t[n.getAttribute("semantic")]=h(n.getAttribute("source")))}return t}function pe(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var o=h(i.getAttribute("source")),a=i.getAttribute("semantic"),s=parseInt(i.getAttribute("offset"));t.inputs[a]={id:o,offset:s},t.stride=Math.max(t.stride,s+1),"TEXCOORD"===a&&(t.hasUV=!0);break;case"vcount":t.vcount=u(i.textContent);break;case"p":t.p=u(i.textContent)}}return t}function me(e){for(var t=0,r=0,n=e.length;r<n;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function ve(e){var t={},r=e.sources,n=e.vertices,i=e.primitives;if(0===i.length)return{};var o=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];void 0===t[n.type]&&(t[n.type]=[]),t[n.type].push(n)}return t}(i);for(var a in o){var s=o[a];me(s),t[a]=ge(s,r,n)}return t}function ge(e,t,r){for(var n={},i={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},s={array:[],stride:0},c=[],u=4,l=[],h=4,d=new U,f=[],p=0,m=0;m<e.length;m++){var v=e[m],g=v.inputs,y=0;switch(v.type){case"lines":case"linestrips":y=2*v.count;break;case"triangles":y=3*v.count;break;case"polylist":for(var b=0;b<v.count;b++){var x=v.vcount[b];switch(x){case 3:y+=3;break;case 4:y+=6;break;default:y+=3*(x-2)}}break;default:console.warn("ColladaLoader: Unknow primitive type:",v.type)}for(var w in d.addGroup(p,y,m),p+=y,v.material&&f.push(v.material),g){var _=g[w];switch(w){case"VERTEX":for(var S in r){var M=r[S];switch(S){case"POSITION":var T=i.array.length;if(ye(v,t[M],_.offset,i.array),i.stride=t[M].stride,t.skinWeights&&t.skinIndices&&(ye(v,t.skinIndices,_.offset,c),ye(v,t.skinWeights,_.offset,l)),!1===v.hasUV&&!0===e.uvsNeedsFix){y=(i.array.length-T)/i.stride;for(var A=0;A<y;A++)a.array.push(0,0)}break;case"NORMAL":ye(v,t[M],_.offset,o.array),o.stride=t[M].stride;break;case"COLOR":ye(v,t[M],_.offset,s.array),s.stride=t[M].stride;break;case"TEXCOORD":ye(v,t[M],_.offset,a.array),a.stride=t[M].stride;break;default:console.warn('ColladaLoader: Semantic "%s" not handled in geometry build process.',S)}}break;case"NORMAL":ye(v,t[_.id],_.offset,o.array),o.stride=t[_.id].stride;break;case"COLOR":ye(v,t[_.id],_.offset,s.array),s.stride=t[_.id].stride;break;case"TEXCOORD":ye(v,t[_.id],_.offset,a.array),a.stride=t[_.id].stride}}}return i.array.length>0&&d.addAttribute("position",new N(i.array,i.stride)),o.array.length>0&&d.addAttribute("normal",new N(o.array,o.stride)),s.array.length>0&&d.addAttribute("color",new N(s.array,s.stride)),a.array.length>0&&d.addAttribute("uv",new N(a.array,a.stride)),c.length>0&&d.addAttribute("skinIndex",new N(c,u)),l.length>0&&d.addAttribute("skinWeight",new N(l,h)),n.data=d,n.type=e[0].type,n.materialKeys=f,n}function ye(e,t,r,n){var i=e.p,o=e.stride,a=e.vcount;function s(e){for(var t=i[e+r]*u,o=t+u;t<o;t++)n.push(c[t])}var c=t.array,u=t.stride;if(void 0!==e.vcount)for(var l=0,h=0,d=a.length;h<d;h++){var f=a[h];if(4===f){var p=l+1*o,m=l+2*o,v=l+3*o;s(l+0*o),s(p),s(v),s(p),s(m),s(v)}else if(3===f){p=l+1*o,m=l+2*o;s(l+0*o),s(p),s(m)}else if(f>4)for(var g=1,y=f-2;g<=y;g++){p=l+o*g,m=l+o*(g+1);s(l+0*o),s(p),s(m)}l+=o*f}else for(h=0,d=i.length;h<d;h+=o)s(h)}function be(e){return m(rt.geometries[e],ve)}function xe(e){return void 0!==e.build?e.build:e}function we(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"joint":t.joints[n.getAttribute("sid")]=_e(n);break;case"link":t.links.push(Me(n))}}}function _e(e){for(var t,r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"prismatic":case"revolute":t=Se(n)}}return t}function Se(e,t){t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new s,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"axis":var o=i(n.textContent);t.axis.fromArray(o);break;case"limits":var a=n.getElementsByTagName("max")[0],c=n.getElementsByTagName("min")[0];t.limits.max=parseFloat(a.textContent),t.limits.min=parseFloat(c.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function Me(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"attachment_full":t.attachments.push(Te(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ae(n))}}return t}function Te(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"link":t.links.push(Me(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ae(n))}}return t}function Ae(e){var t={type:e.nodeName},r=i(e.textContent);switch(t.type){case"matrix":t.obj=new a,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new s,t.obj.fromArray(r);break;case"rotate":t.obj=new s,t.obj.fromArray(r),t.angle=o.degToRad(r[3])}return t}function Ee(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":Ce(n,t)}}}function Ce(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"inertia":t.inertia=i(n.textContent);break;case"mass":t.mass=i(n.textContent)[0]}}}function Le(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"axis":var i=n.getElementsByTagName("param")[0];t.axis=i.textContent;var o=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=o.substr(0,o.length-1)}}return t}function Pe(e){return void 0!==e.build?e.build:e}var Oe=new a,Ne=new s;function Re(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new a,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"node":t.nodes.push(n.getAttribute("id")),Re(n);break;case"instance_camera":t.instanceCameras.push(h(n.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(Ie(n));break;case"instance_light":t.instanceLights.push(h(n.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(Ie(n));break;case"instance_node":t.instanceNodes.push(h(n.getAttribute("url")));break;case"matrix":var s=i(n.textContent);t.matrix.multiply(Oe.fromArray(s).transpose()),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":s=i(n.textContent);Ne.fromArray(s),t.matrix.multiply(Oe.makeTranslation(Ne.x,Ne.y,Ne.z)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":s=i(n.textContent);var c=o.degToRad(s[3]);t.matrix.multiply(Oe.makeRotationAxis(Ne.fromArray(s),c)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":s=i(n.textContent);t.matrix.scale(Ne.fromArray(s)),t.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return je(t.id)?console.warn("ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):rt.nodes[t.id]=t,t}function Ie(e){for(var t={id:h(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"bind_material":for(var i=n.getElementsByTagName("instance_material"),o=0;o<i.length;o++){var a=i[o],s=a.getAttribute("symbol"),c=a.getAttribute("target");t.materials[s]=h(c)}break;case"skeleton":t.skeletons.push(h(n.textContent))}}return t}function De(e,t){var r,n,i=[],o=[];for(r=0;r<e.length;r++){var a=e[r];if(je(a))Fe(Ve(a),t,i);else if(We(a))for(var s=rt.visualScenes[a].children,c=0;c<s.length;c++){var u=s[c];if("JOINT"===u.type)Fe(Ve(u.id),t,i)}else console.error("ColladaLoader: Unable to find root bone of skeleton with ID:",a)}for(r=0;r<t.length;r++)for(c=0;c<i.length;c++)if((n=i[c]).bone.name===t[r].name){o[r]=n,n.processed=!0;break}for(r=0;r<i.length;r++)!1===(n=i[r]).processed&&(o.push(n),n.processed=!0);var l=[],h=[];for(r=0;r<o.length;r++)n=o[r],l.push(n.bone),h.push(n.boneInverse);return new uo(l,h)}function Fe(e,t,r){e.traverse(function(e){if(!0===e.isBone){for(var n,i=0;i<t.length;i++){var o=t[i];if(o.name===e.name){n=o.boneInverse;break}}void 0===n&&(n=new a),r.push({bone:e,boneInverse:n,processed:!1})}})}function Ue(e){for(var t=[],r=e.matrix,n=e.nodes,i=e.type,o=e.instanceCameras,a=e.instanceControllers,s=e.instanceLights,c=e.instanceGeometries,u=e.instanceNodes,l=0,h=n.length;l<h;l++)t.push(Ve(n[l]));for(l=0,h=o.length;l<h;l++){var d=se(o[l]);null!==d&&t.push(d.clone())}for(l=0,h=a.length;l<h;l++)for(var f=k((x=a[l]).id),p=ze(be(f.id),x.materials),m=De(x.skeletons,f.skin.joints),v=0,g=p.length;v<g;v++){var y;(y=p[v]).isSkinnedMesh&&(y.bind(m,f.skin.bindMatrix),y.normalizeSkinWeights()),t.push(y)}for(l=0,h=s.length;l<h;l++){var b=he(s[l]);null!==b&&t.push(b.clone())}for(l=0,h=c.length;l<h;l++){var x;for(v=0,g=(p=ze(be((x=c[l]).id),x.materials)).length;v<g;v++)t.push(p[v])}for(l=0,h=u.length;l<h;l++)t.push(Ve(u[l]).clone());if(0===n.length&&1===t.length)y=t[0];else{y="JOINT"===i?new Dr:new oo;for(l=0;l<t.length;l++)y.add(t[l])}return""===y.name&&(y.name="JOINT"===i?e.sid:e.name),y.matrix.copy(r),y.matrix.decompose(y.position,y.quaternion,y.scale),y}var ke=new cr({color:16711935});function Be(e,t){for(var r=[],n=0,i=e.length;n<i;n++){var o=t[e[n]];void 0===o?(console.warn("ColladaLoader: Material with key %s not found. Apply fallback material.",e[n]),r.push(ke)):r.push(re(o))}return r}function ze(e,t){var r=[];for(var n in e){var i=e[n],o=Be(i.materialKeys,t);0===o.length&&("lines"===n||"linestrips"===n?o.push(new ur):o.push(new vn));var a=void 0!==i.data.attributes.skinIndex;if(a)for(var s=0,c=o.length;s<c;s++)o[s].skinning=!0;var u,l=1===o.length?o[0]:o;switch(n){case"lines":u=new Eo(i.data,l);break;case"linestrips":u=new fr(i.data,l);break;case"triangles":case"polylist":u=a?new lo(i.data,l):new dr(i.data,l)}r.push(u)}return r}function je(e){return void 0!==rt.nodes[e]}function Ve(e){return m(rt.nodes[e],Ue)}function Ge(e){var t=new oo;t.name=e.name;for(var r=e.children,n=0;n<r.length;n++){var i=r[n];t.add(Ve(i.id))}return t}function We(e){return void 0!==rt.visualScenes[e]}function qe(e){return m(rt.visualScenes[e],Ge)}if(0===e.length)return{scene:new qr};var Ye=r((new DOMParser).parseFromString(e,"application/xml"),"COLLADA")[0],Je=Ye.getAttribute("version");console.log("ColladaLoader: File version",Je);var Qe,Ze=function(e){return{unit:function(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}(r(e,"unit")[0]),upAxis:function(e){return void 0!==e?e.textContent:"Y_UP"}(r(e,"up_axis")[0])}}(r(Ye,"asset")[0]),Ke=new An(this.manager);Ke.setPath(t).setCrossOrigin(this.crossOrigin),Co&&(Qe=new Co(this.manager)).setPath(t);var $e=[],et={},tt=0,rt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};f(Ye,"library_animations","animation",function(e){for(var t={sources:{},samplers:{},channels:{}},r=0,n=e.childNodes.length;r<n;r++){var i,o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"source":i=o.getAttribute("id"),t.sources[i]=de(o);break;case"sampler":i=o.getAttribute("id"),t.samplers[i]=g(o);break;case"channel":i=o.getAttribute("target"),t.channels[i]=y(o);break;default:console.log(o)}}rt.animations[e.getAttribute("id")]=t}),f(Ye,"library_animation_clips","animation_clip",function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":t.animations.push(h(i.getAttribute("url")))}}rt.clips[e.getAttribute("id")]=t}),f(Ye,"library_controllers","controller",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=h(i.getAttribute("source")),t.skin=R(i);break;case"morph":t.id=h(i.getAttribute("source")),console.warn("ColladaLoader: Morph target animation not supported yet.")}}rt.controllers[e.getAttribute("id")]=t}),f(Ye,"library_images","image",function(e){var t={init_from:r(e,"init_from")[0].textContent};rt.images[e.getAttribute("id")]=t}),f(Ye,"library_effects","effect",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":t.profile=j(i)}}rt.effects[e.getAttribute("id")]=t}),f(Ye,"library_materials","material",function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":t.url=h(i.getAttribute("url"))}}rt.materials[e.getAttribute("id")]=t}),f(Ye,"library_cameras","camera",function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"optics":t.optics=ne(i)}}rt.cameras[e.getAttribute("id")]=t}),f(Ye,"library_lights","light",function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":t=ce(i)}}rt.lights[e.getAttribute("id")]=t}),f(Ye,"library_geometries","geometry",function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},n=r(e,"mesh")[0];if(void 0!==n){for(var i=0;i<n.childNodes.length;i++){var o=n.childNodes[i];if(1===o.nodeType){var a=o.getAttribute("id");switch(o.nodeName){case"source":t.sources[a]=de(o);break;case"vertices":t.vertices=fe(o);break;case"polygons":console.warn("ColladaLoader: Unsupported primitive type: ",o.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(pe(o));break;default:console.log(o)}}}rt.geometries[e.getAttribute("id")]=t}}),f(Ye,"library_nodes","node",Re),f(Ye,"library_visual_scenes","visual_scene",function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var n=t[r];!1===n.hasAttribute("id")&&n.setAttribute("id","three_default_"+tt++)}}(e);for(var n=r(e,"node"),i=0;i<n.length;i++)t.children.push(Re(n[i]));rt.visualScenes[e.getAttribute("id")]=t}),f(Ye,"library_kinematics_models","kinematics_model",function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":we(n,t)}}rt.kinematicsModels[e.getAttribute("id")]=t}),f(Ye,"library_physics_models","physics_model",function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"rigid_body":t.rigidBodies[n.getAttribute("name")]={},Ee(n,t.rigidBodies[n.getAttribute("name")])}}rt.physicsModels[e.getAttribute("id")]=t}),f(Ye,"scene","instance_kinematics_scene",function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"bind_joint_axis":t.bindJointAxis.push(Le(n))}}rt.kinematicsScenes[h(e.getAttribute("url"))]=t}),p(rt.animations,b),p(rt.clips,P),p(rt.controllers,F),p(rt.images,B),p(rt.effects,ee),p(rt.materials,te),p(rt.cameras,ae),p(rt.lights,le),p(rt.geometries,ve),p(rt.visualScenes,Ge),function(){var e=rt.clips;if(!0===d(e)){if(!1===d(rt.animations)){var t=[];for(var r in rt.animations)for(var n=x(r),i=0,o=n.length;i<o;i++)t.push(n[i]);$e.push(new Nr("default",-1,t))}}else for(var r in e)$e.push(O(r))}(),function(){var e=Object.keys(rt.kinematicsModels)[0],t=Object.keys(rt.kinematicsScenes)[0],r=Object.keys(rt.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var n=function(e){return m(rt.kinematicsModels[e],xe)}(e),c=function(e){return m(rt.kinematicsScenes[e],Pe)}(t),u=qe(r),l=c.bindJointAxis,h={},d=0,f=l.length;d<f;d++){var p=l[d],v=Ye.querySelector('[sid="'+p.target+'"]');if(v){var g=v.parentElement;b(p.jointIndex,g)}}var y=new a;et={joints:n&&n.joints,getJointValue:function(e){var t=h[e];if(t)return t.position;console.warn("ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=h[e];if(r){var n=r.joint;if(t>n.limits.max||t<n.limits.min)console.warn("ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+").");else if(n.static)console.warn("ColladaLoader: Joint "+e+" is static.");else{var i=r.object,a=n.axis,s=r.transforms;Oe.identity();for(var c=0;c<s.length;c++){var u=s[c];if(u.sid&&-1!==u.sid.indexOf(e))switch(n.type){case"revolute":Oe.multiply(y.makeRotationAxis(a,o.degToRad(t)));break;case"prismatic":Oe.multiply(y.makeTranslation(a.x*t,a.y*t,a.z*t));break;default:console.warn("ColladaLoader: Unknown joint type: "+n.type)}else switch(u.type){case"matrix":Oe.multiply(u.obj);break;case"translate":Oe.multiply(y.makeTranslation(u.obj.x,u.obj.y,u.obj.z));break;case"scale":Oe.scale(u.obj);break;case"rotate":Oe.multiply(y.makeRotationAxis(u.obj,u.angle))}}i.matrix.copy(Oe),i.matrix.decompose(i.position,i.quaternion,i.scale),h[e].position=t}}else console.log("ColladaLoader: "+e+" does not exist.")}}}function b(e,t){var r=t.getAttribute("name"),c=n.joints[e];u.traverse(function(n){n.name===r&&(h[e]={object:n,transforms:function(e){for(var t=[],r=Ye.querySelector('[id="'+e.id+'"]'),n=0;n<r.childNodes.length;n++){var c=r.childNodes[n];if(1===c.nodeType)switch(c.nodeName){case"matrix":var u=i(c.textContent),l=(new a).fromArray(u).transpose();t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:l});break;case"translate":case"scale":var u=i(c.textContent),h=(new s).fromArray(u);t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:h});break;case"rotate":var u=i(c.textContent),h=(new s).fromArray(u),d=o.degToRad(u[3]);t.push({sid:c.getAttribute("sid"),type:c.nodeName,obj:h,angle:d})}}return t}(t),joint:c,position:c.zeroPosition})})}}();var nt=function(e){return qe(h(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(Ye,"scene")[0]);return"Z_UP"===Ze.upAxis&&nt.quaternion.setFromEuler(new l(-Math.PI/2,0,0)),nt.scale.multiplyScalar(Ze.unit),{animations:$e,kinematics:et,library:rt,scene:nt}}},Po.prototype=Object.create(Zr.prototype),Po.prototype.constructor=Po,Po.prototype.isCompressedTexture=!0,Object.assign(Oo.prototype,{load:function(e,t,r,n){var i=this,o=[],a=new Po;a.image=o;var s=new ln(this.manager);function c(c){s.load(e[c],function(e){var r=i._parser(e,!0);o[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(u+=1)&&(1===r.mipmapCount&&(a.minFilter=Ze),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,l=0,h=e.length;l<h;++l)c(l);else s.load(e,function(e){var r=i._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var c=0;c<r.mipmapCount;c++)o[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+c]),o[s].format=r.format,o[s].width=r.width,o[s].height=r.height}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=Ze),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,n);return a},setPath:function(e){return this.path=e,this}});var No=function(e){Oo.call(this,e),this._parser=No.parse};function Ro(e,t){fr.call(this,e,t),this.type="LineLoop"}No.prototype=Object.create(Oo.prototype),No.prototype.constructor=No,No.parse=function(e,t){var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function i(e,t,r,n){for(var i=r*n*4,o=new Uint8Array(e,t,i),a=new Uint8Array(i),s=0,c=0,u=0;u<n;u++)for(var l=0;l<r;l++){var h=o[c],d=o[++c],f=o[++c],p=o[++c];c++,a[s]=f,a[++s]=d,a[++s]=h,a[++s]=p,s++}return a}var o,a=n("DXT1"),s=n("DXT3"),c=n("DXT5"),u=n("ETC1"),l=new Int32Array(e,0,31);if(542327876!==l[0])return console.error("DDSLoader.parse: Invalid magic number in DDS header."),r;if(4&!l[20])return console.error("DDSLoader.parse: Unsupported format, must contain a FourCC code."),r;var h=l[21],d=!1;switch(h){case a:o=8,r.format=xt;break;case s:o=16,r.format=_t;break;case c:o=16,r.format=St;break;case u:o=8,r.format=Ct;break;default:if(!(32===l[22]&&16711680&l[23]&&65280&l[24]&&255&l[25]&&4278190080&l[26]))return console.error("DDSLoader.parse: Unsupported FourCC code ",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(h)),r;d=!0,o=64,r.format=pt}r.mipmapCount=1,131072&l[2]&&!1!==t&&(r.mipmapCount=Math.max(1,l[7]));var f=l[28];if(r.isCubemap=!!(512&f),r.isCubemap&&(!(1024&f)||!(2048&f)||!(4096&f)||!(8192&f)||!(16384&f)||!(32768&f)))return console.error("DDSLoader.parse: Incomplete cubemap faces"),r;r.width=l[4],r.height=l[3];for(var p=l[1]+4,m=r.isCubemap?6:1,v=0;v<m;v++)for(var g=r.width,y=r.height,b=0;b<r.mipmapCount;b++){if(d)var x=(w=i(e,p,g,y)).length;else{x=Math.max(4,g)/4*Math.max(4,y)/4*o;var w=new Uint8Array(e,p,x)}var _={data:w,width:g,height:y};r.mipmaps.push(_),p+=x,g=Math.max(g>>1,1),y=Math.max(y>>1,1)}return r},Ro.prototype=Object.assign(Object.create(fr.prototype),{constructor:Ro,isLineLoop:!0});var Io=function(){function e(e){this.manager=void 0!==e?e:cn}function t(e,t){var r={},n=e.material.uniforms;for(var i in n){var o=n[i];if(o.semantic){var s=o.node,c=e;s&&(c=t[s]),r[i]={semantic:o.semantic,sourceNode:c,targetNode:e,uniform:o}}}this.boundUniforms=r,this._m4=new a}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=this.path&&"string"==typeof this.path?this.path:Cn.extractUrlBase(e),a=new ln(i.manager);a.setResponseType("arraybuffer"),a.load(e,function(e){i.parse(e,o,t)},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){this.path=e},parse:function(e,t,i){var o,a={};Cn.decodeText(new Uint8Array(e,0,4))===n.magic?(a[r.KHR_BINARY_GLTF]=new u(e),o=a[r.KHR_BINARY_GLTF].content):o=Cn.decodeText(new Uint8Array(e));var s=JSON.parse(o);s.extensionsUsed&&s.extensionsUsed.indexOf(r.KHR_MATERIALS_COMMON)>=0&&(a[r.KHR_MATERIALS_COMMON]=new function(e){this.name=r.KHR_MATERIALS_COMMON,this.lights={};var t=(e.extensions&&e.extensions[r.KHR_MATERIALS_COMMON]||{}).lights||{};for(var n in t){var i,o=t[n],a=o[o.type],s=(new v).fromArray(a.color);switch(o.type){case"directional":(i=new xo(s)).position.set(0,0,1);break;case"point":i=new yo(s);break;case"spot":(i=new _o(s)).position.set(0,0,1);break;case"ambient":i=new Ao(s)}i&&(this.lights[n]=i)}}(s)),new I(s,a,{crossOrigin:this.crossOrigin,manager:this.manager,path:t||this.path}).parse(function(e,t,r,n){i({scene:e,scenes:t,cameras:r,animations:n})})}},e.Shaders={update:function(){console.warn("LegacyGLTFLoader.Shaders has been deprecated, and now updates automatically.")}},t.prototype.update=function(e,t){var r=this.boundUniforms;for(var n in r){var i=r[n];switch(i.semantic){case"MODELVIEW":i.uniform.value.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var o=i.uniform.value;this._m4.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld),o.getNormalMatrix(this._m4);break;case"PROJECTION":i.uniform.value.copy(t.projectionMatrix);break;case"JOINTMATRIX":for(var a=i.uniform.value,s=0;s<a.length;s++)a[s].getInverse(i.sourceNode.matrixWorld).multiply(i.targetNode.skeleton.bones[s].matrixWorld).multiply(i.targetNode.skeleton.boneInverses[s]).multiply(i.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+i.semantic)}}},e.Animations={update:function(){console.warn("LegacyGLTFLoader.Animation has been deprecated. Use AnimationMixer instead.")}};var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"};var n={magic:"glTF",version:1,contentFormat:0},c=20;function u(e){this.name=r.KHR_BINARY_GLTF;var t=new DataView(e,0,c),i={magic:Cn.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0),contentLength:t.getUint32(12,!0),contentFormat:t.getUint32(16,!0)};for(var o in n){var a=n[o];if(i[o]!==a)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',o,a)}var s=new Uint8Array(e,c,i.contentLength);this.header=i,this.content=Cn.decodeText(s),this.body=e.slice(c+i.contentLength,i.length)}u.prototype.loadShader=function(e,t){var n=t[e.extensions[r.KHR_BINARY_GLTF].bufferView],i=new Uint8Array(n);return Cn.decodeText(i)};var l={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},h={5126:Number,35675:d,35676:a,35664:x,35665:s,35666:S,35678:Zr},f={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},m={9728:Ye,9729:Ze,9984:Je,9985:Ke,9986:Qe,9987:$e},g={33071:Xe,33648:qe,10497:He},y={6406:dt,6407:ft,6408:pt,6409:mt,6410:vt},b={5121:et,32819:ct,32820:ut,33635:lt},w={1028:Y,1029:q},_={512:we,513:Se,514:Te,515:Me,516:Ae,517:Ce,518:Ae,519:_e},T={32774:oe,32778:ae,32779:se},A={0:le,1:he,768:de,769:fe,770:pe,771:me,772:ve,773:ge,774:ye,775:be,776:xe},E={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C={scale:"scale",translation:"position",rotation:"quaternion"},L={LINEAR:2301,STEP:Wt},P={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};function O(e,t,r){var n;if(!e)return Promise.resolve();var i=[];if("[object Array]"===Object.prototype.toString.call(e)){n=[];for(var o=e.length,a=0;a<o;a++){(c=t.call(r||this,e[a],a))&&(i.push(c),c instanceof Promise?c.then(function(e,t){n[e]=t}.bind(this,a)):n[a]=c)}}else for(var s in n={},e){var c;if(e.hasOwnProperty(s))(c=t.call(r||this,e[s],s))&&(i.push(c),c instanceof Promise?c.then(function(e,t){n[e]=t}.bind(this,s)):n[s]=c)}return Promise.all(i).then(function(){return n})}function N(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e}function R(e){this.isDeferredShaderMaterial=!0,this.params=e}function I(e,t,r){this.json=e||{},this.extensions=t||{},this.options=r||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}},update:function(t,r){for(var n in e){var i=e[n];i.update&&i.update(t,r)}}}}}return R.prototype.create=function(){var e=Hr.clone(this.params.uniforms);for(var t in this.params.uniforms){var r=this.params.uniforms[t];r.value instanceof Zr&&(e[t].value=r.value,e[t].value.needsUpdate=!0),e[t].semantic=r.semantic,e[t].node=r.node}return this.params.uniforms=e,new wn(this.params)},I.prototype._withDependencies=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],i="load"+n.charAt(0).toUpperCase()+n.slice(1),o=this.cache.get(n);if(void 0!==o)t[n]=o;else if(this[i]){var a=this[i]();this.cache.add(n,a),t[n]=a}}return O(t,function(e){return e})},I.prototype.parse=function(e){var t=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(r){var n=[];for(var i in r.scenes)n.push(r.scenes[i]);var o=void 0!==t.scene?r.scenes[t.scene]:n[0],a=[];for(var i in r.cameras){var s=r.cameras[i];a.push(s)}var c=[];for(var i in r.animations)c.push(r.animations[i]);e(o,n,a,c)})},I.prototype.loadShaders=function(){var e=this.json,t=this.extensions,n=this.options;return this._withDependencies(["bufferViews"]).then(function(i){return O(e.shaders,function(e){return e.extensions&&e.extensions[r.KHR_BINARY_GLTF]?t[r.KHR_BINARY_GLTF].loadShader(e,i.bufferViews):new Promise(function(t){var r=new ln(n.manager);r.setResponseType("text"),r.load(N(e.uri,n.path),function(e){t(e)})})})})},I.prototype.loadBuffers=function(){var e=this.json,t=this.extensions,n=this.options;return O(e.buffers,function(e,i){return"binary_glTF"===i?t[r.KHR_BINARY_GLTF].body:"arraybuffer"===e.type||void 0===e.type?new Promise(function(t){var r=new ln(n.manager);r.setResponseType("arraybuffer"),r.load(N(e.uri,n.path),function(e){t(e)})}):void console.warn("LegacyGLTFLoader: "+e.type+" buffer type is not supported")})},I.prototype.loadBufferViews=function(){var e=this.json;return this._withDependencies(["buffers"]).then(function(t){return O(e.bufferViews,function(e){var r=t.buffers[e.buffer],n=void 0!==e.byteLength?e.byteLength:0;return r.slice(e.byteOffset,e.byteOffset+n)})})},I.prototype.loadAccessors=function(){var e=this.json;return this._withDependencies(["bufferViews"]).then(function(t){return O(e.accessors,function(e){var r=t.bufferViews[e.bufferView],n=E[e.type],i=f[e.componentType],o=i.BYTES_PER_ELEMENT,a=o*n;if(e.byteStride&&e.byteStride!==a){var s=new i(r);return new Qi(new Yi(s,e.byteStride/o),n,e.byteOffset/o)}return new M(s=new i(r,e.byteOffset,e.count*n),n)})})},I.prototype.loadTextures=function(){var e=this.json,t=(this.extensions,this.options);return this._withDependencies(["bufferViews"]).then(function(n){return O(e.textures,function(i){if(i.source)return new Promise(function(o){var a=e.images[i.source],s=a.uri,c=!1;if(a.extensions&&a.extensions[r.KHR_BINARY_GLTF]){var u=a.extensions[r.KHR_BINARY_GLTF],l=n.bufferViews[u.bufferView],h=new Blob([l],{type:u.mimeType});s=URL.createObjectURL(h),c=!0}var d=En.Handlers.get(s);null===d&&(d=new An(t.manager)),d.setCrossOrigin(t.crossOrigin),d.load(N(s,t.path),function(t){if(c&&URL.revokeObjectURL(s),t.flipY=!1,void 0!==i.name&&(t.name=i.name),t.format=void 0!==i.format?y[i.format]:pt,void 0!==i.internalFormat&&t.format!==y[i.internalFormat]&&console.warn("LegacyGLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==i.type?b[i.type]:et,i.sampler){var r=e.samplers[i.sampler];t.magFilter=m[r.magFilter]||Ze,t.minFilter=m[r.minFilter]||Qe,t.wrapS=g[r.wrapS]||He,t.wrapT=g[r.wrapT]||He}o(t)},void 0,function(){c&&URL.revokeObjectURL(s),o()})})})})},I.prototype.loadMaterials=function(){var e=this.json;return this._withDependencies(["shaders","textures"]).then(function(t){return O(e.materials,function(n){var i,o,a={},s={};if(n.extensions&&n.extensions[r.KHR_MATERIALS_COMMON]&&(o=n.extensions[r.KHR_MATERIALS_COMMON]),o){var c=["ambient","emission","transparent","transparency","doubleSided"];switch(o.technique){case"BLINN":case"PHONG":i=vn,c.push("diffuse","specular","shininess");break;case"LAMBERT":i=pn,c.push("diffuse");break;case"CONSTANT":default:i=cr}c.forEach(function(e){void 0!==o.values[e]&&(a[e]=o.values[e])}),(o.doubleSided||a.doubleSided)&&(s.side=J),(o.transparent||a.transparent)&&(s.transparent=!0,s.opacity=void 0!==a.transparency?a.transparency:1)}else if(void 0===n.technique)i=vn,Object.assign(a,n.values);else{i=R;var u=e.techniques[n.technique];s.uniforms={};var d=e.programs[u.program];if(d){s.fragmentShader=t.shaders[d.fragmentShader],s.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",d.fragmentShader),i=vn);var f=t.shaders[d.vertexShader];f||(console.warn("ERROR: Missing vertex shader definition:",d.vertexShader),i=vn),s.vertexShader=function(e,t){var r={};for(var n in t.attributes){var i=t.attributes[n],o=(h=t.parameters[i]).type,a=h.semantic;r[n]={type:o,semantic:a}}var s=t.parameters,c=t.attributes,u={};for(var n in r){var l=s[i=c[n]];(a=l.semantic)&&(u[n]=l)}for(var i in u){a=(h=u[i]).semantic;var h,d=new RegExp("\\b"+i+"\\b","g");switch(a){case"POSITION":e=e.replace(d,"position");break;case"NORMAL":e=e.replace(d,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(d,"uv");break;case"TEXCOORD_1":e=e.replace(d,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(d,"color");break;case"WEIGHT":e=e.replace(d,"skinWeight");break;case"JOINT":e=e.replace(d,"skinIndex")}}return e}(f,u);var p=u.uniforms;for(var m in p){var g=p[m],y=u.parameters[g],b=y.type;if(!h[b])throw new Error("Unknown shader uniform param type: "+b);var x,S=y.count;void 0!==n.values&&(x=n.values[g]);var M=new h[b],E=y.semantic,C=y.node;switch(b){case l.FLOAT:M=y.value,"transparency"==g&&(s.transparent=!0),void 0!==x&&(M=x);break;case l.FLOAT_VEC2:case l.FLOAT_VEC3:case l.FLOAT_VEC4:case l.FLOAT_MAT3:y&&y.value&&M.fromArray(y.value),x&&M.fromArray(x);break;case l.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case l.FLOAT_MAT4:if(S){M=new Array(S);for(var L=0;L<S;L++)M[L]=new h[b];if(y&&y.value){var O=y.value;M.fromArray(O)}x&&M.fromArray(x)}else{if(y&&y.value){var N=y.value;M.fromArray(N)}x&&M.fromArray(x)}break;case l.SAMPLER_2D:M=void 0!==x?t.textures[x]:void 0!==y.value?t.textures[y.value]:null}s.uniforms[m]={value:M,semantic:E,node:C}}for(var I=u.states||{},D=I.enable||[],F=I.functions||{},U=!1,k=!1,B=!1,z=0,j=D.length;z<j;z++){var V=D[z];switch(P[V]){case"CULL_FACE":U=!0;break;case"DEPTH_TEST":k=!0;break;case"BLEND":B=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+V)}}s.side=U?void 0!==F.cullFace?w[F.cullFace]:q:J,s.depthTest=k,s.depthFunc=void 0!==F.depthFunc?_[F.depthFunc]:Se,s.depthWrite=void 0===F.depthMask||F.depthMask[0],s.blending=B?ie:$,s.transparent=B;var G=F.blendEquationSeparate;void 0!==G?(s.blendEquation=T[G[0]],s.blendEquationAlpha=T[G[1]]):(s.blendEquation=oe,s.blendEquationAlpha=oe);var W=F.blendFuncSeparate;void 0!==W?(s.blendSrc=A[W[0]],s.blendDst=A[W[1]],s.blendSrcAlpha=A[W[2]],s.blendDstAlpha=A[W[3]]):(s.blendSrc=he,s.blendDst=le,s.blendSrcAlpha=he,s.blendDstAlpha=le)}}Array.isArray(a.diffuse)?s.color=(new v).fromArray(a.diffuse):"string"==typeof a.diffuse&&(s.map=t.textures[a.diffuse]),delete s.diffuse,"string"==typeof a.reflective&&(s.envMap=t.textures[a.reflective]),"string"==typeof a.bump&&(s.bumpMap=t.textures[a.bump]),Array.isArray(a.emission)?i===cr?s.color=(new v).fromArray(a.emission):s.emissive=(new v).fromArray(a.emission):"string"==typeof a.emission&&(i===cr?s.map=t.textures[a.emission]:s.emissiveMap=t.textures[a.emission]),Array.isArray(a.specular)?s.specular=(new v).fromArray(a.specular):"string"==typeof a.specular&&(s.specularMap=t.textures[a.specular]),void 0!==a.shininess&&(s.shininess=a.shininess);var H=new i(s);return void 0!==n.name&&(H.name=n.name),H})})},I.prototype.loadMeshes=function(){var e=this.json;return this._withDependencies(["accessors","materials"]).then(function(t){return O(e.meshes,function(r){var n=new oo;void 0!==r.name&&(n.name=r.name),r.extras&&(n.userData=r.extras);var i=r.primitives||[];for(var o in i){var a=i[o];if(a.mode===l.TRIANGLES||void 0===a.mode){var s=new U,c=a.attributes;for(var u in c){if(!(p=c[u]))return;var h=t.accessors[p];switch(u){case"POSITION":s.addAttribute("position",h);break;case"NORMAL":s.addAttribute("normal",h);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":s.addAttribute("uv",h);break;case"TEXCOORD_1":s.addAttribute("uv2",h);break;case"COLOR_0":case"COLOR0":case"COLOR":s.addAttribute("color",h);break;case"WEIGHT":s.addAttribute("skinWeight",h);break;case"JOINT":s.addAttribute("skinIndex",h);break;default:if(!a.material)break;if(!(v=e.materials[a.material]).technique)break;var d=e.techniques[v.technique].parameters||{};for(var f in d)d[f].semantic===u&&s.addAttribute(f,h)}}a.indices&&s.setIndex(t.accessors[a.indices]),(m=new dr(s,v=void 0!==t.materials?t.materials[a.material]:new vn({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:q}))).castShadow=!0,m.name="0"===o?n.name:n.name+o,a.extras&&(m.userData=a.extras),n.add(m)}else if(a.mode===l.LINES){s=new U,c=a.attributes;for(var u in c){var p;if(!(p=c[u]))return;h=t.accessors[p];switch(u){case"POSITION":s.addAttribute("position",h);break;case"COLOR_0":case"COLOR0":case"COLOR":s.addAttribute("color",h)}}var m,v=t.materials[a.material];a.indices?(s.setIndex(t.accessors[a.indices]),m=new Eo(s,v)):m=new fr(s,v),m.name="0"===o?n.name:n.name+o,a.extras&&(m.userData=a.extras),n.add(m)}else console.warn("Only triangular and line primitives are supported")}return n})})},I.prototype.loadCameras=function(){return O(this.json.cameras,function(e){if("perspective"==e.type&&e.perspective){var t=e.perspective.yfov,r=void 0!==e.perspective.aspectRatio?e.perspective.aspectRatio:1,n=t*r,a=new Wr(o.radToDeg(n),r,e.perspective.znear||1,e.perspective.zfar||2e6);return void 0!==e.name&&(a.name=e.name),e.extras&&(a.userData=e.extras),a}if("orthographic"==e.type&&e.orthographic){a=new Yr(i.innerWidth/-2,i.innerWidth/2,i.innerHeight/2,i.innerHeight/-2,e.orthographic.znear,e.orthographic.zfar);return void 0!==e.name&&(a.name=e.name),e.extras&&(a.userData=e.extras),a}})},I.prototype.loadSkins=function(){var e=this.json;return this._withDependencies(["accessors"]).then(function(t){return O(e.skins,function(e){var r=new a;return void 0!==e.bindShapeMatrix&&r.fromArray(e.bindShapeMatrix),{bindShapeMatrix:r,jointNames:e.jointNames,inverseBindMatrices:t.accessors[e.inverseBindMatrices]}})})},I.prototype.loadAnimations=function(){var e=this.json;return this._withDependencies(["accessors","nodes"]).then(function(t){return O(e.animations,function(e,r){var n=[];for(var i in e.channels){var o=e.channels[i],a=e.samplers[o.sampler];if(a){var s=o.target,c=s.id,u=void 0!==e.parameters?e.parameters[a.input]:a.input,l=void 0!==e.parameters?e.parameters[a.output]:a.output,h=t.accessors[u],d=t.accessors[l],f=t.nodes[c];if(f){f.updateMatrix(),f.matrixAutoUpdate=!0;var p=C[s.path]===C.rotation?Lr:Or,m=f.name?f.name:f.uuid,v=void 0!==a.interpolation?L[a.interpolation]:2301;n.push(new p(m+"."+C[s.path],wr.arraySlice(h.array,0),wr.arraySlice(d.array,0),v))}}}return new Nr(c=void 0!==e.name?e.name:"animation_"+r,void 0,n)})})},I.prototype.loadNodes=function(){var e=this.json,t=this.extensions,n=this;return O(e.nodes,function(e){var t,r=new a;return e.jointName?((t=new Dr).name=void 0!==e.name?e.name:e.jointName,t.jointName=e.jointName):(t=new p,void 0!==e.name&&(t.name=e.name)),e.extras&&(t.userData=e.extras),void 0!==e.matrix?(r.fromArray(e.matrix),t.applyMatrix(r)):(void 0!==e.translation&&t.position.fromArray(e.translation),void 0!==e.rotation&&t.quaternion.fromArray(e.rotation),void 0!==e.scale&&t.scale.fromArray(e.scale)),t}).then(function(i){return n._withDependencies(["meshes","skins","cameras"]).then(function(n){return O(i,function(o,s){var c=e.nodes[s];if(void 0!==c.meshes)for(var u in c.meshes){var l=c.meshes[u],h=n.meshes[l];if(void 0!==h)for(var d in h.children){var f,p=h.children[d],m=p.material,v=p.geometry,g=p.userData,y=p.name;switch(m.isDeferredShaderMaterial?m=b=m.create():b=m,p.type){case"LineSegments":p=new Eo(v,b);break;case"LineLoop":p=new Ro(v,b);break;case"Line":p=new fr(v,b);break;default:p=new dr(v,b)}if(p.castShadow=!0,p.userData=g,p.name=y,c.skin&&(f=n.skins[c.skin]),f){var b,x=function(e){for(var t=Object.keys(i),r=0,n=t.length;r<n;r++){var o=i[t[r]];if(o.jointName===e)return o}return null},w=v;(b=m).skinning=!0,(p=new lo(w,b)).castShadow=!0,p.userData=g,p.name=y;for(var _=[],S=[],M=0,T=f.jointNames.length;M<T;M++){var A=f.jointNames[M],E=x(A);if(E){_.push(E);var C=f.inverseBindMatrices.array,L=(new a).fromArray(C,16*M);S.push(L)}else console.warn("WARNING: joint: '"+A+"' could not be found")}p.bind(new uo(_,S),f.bindShapeMatrix);var P=function(t,r,n){var o=t[n];if(void 0!==o)for(var a=0,s=o.length;a<s;a++){var c=o[a],u=i[c],l=e.nodes[c];void 0!==u&&!0===u.isBone&&void 0!==l&&(r.add(u),P(l,u,"children"))}};P(c,p,"skeletons")}o.add(p)}else console.warn("LegacyGLTFLoader: Couldn't find node \""+l+'".')}if(void 0!==c.camera){var O=n.cameras[c.camera];o.add(O)}if(c.extensions&&c.extensions[r.KHR_MATERIALS_COMMON]&&c.extensions[r.KHR_MATERIALS_COMMON].light){var N=t[r.KHR_MATERIALS_COMMON].lights[c.extensions[r.KHR_MATERIALS_COMMON].light];o.add(N)}return o})})})},I.prototype.loadScenes=function(){var e=this.json;function r(t,n,i){var o=i[t];n.add(o);var a=e.nodes[t];if(a.children)for(var s=a.children,c=0,u=s.length;c<u;c++){r(s[c],o,i)}}return this._withDependencies(["nodes"]).then(function(n){return O(e.scenes,function(e){var i=new qr;void 0!==e.name&&(i.name=e.name),e.extras&&(i.userData=e.extras);for(var o=e.nodes||[],a=0,s=o.length;a<s;a++){r(o[a],i,n.nodes)}return i.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new t(e,n.nodes),e.onBeforeRender=function(e,t,r){this.gltfShader.update(t,r)})}),i})})},e}(),Do=function(e){this.timeLoaded=0,this.manager=e||cn,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=Xt,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};function Fo(e,t,r){Kr.call(this,e,t,r),this.activeCubeFace=0,this.activeMipMapLevel=0}Do.prototype={constructor:Do,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){i.decodeDracoFile(e,t)},r,n)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var r=!0;return void 0!==t&&(r=t),this.getAttributeOptions(e).skipDequantization=r,this},decodeDracoFile:function(e,t,r,n){var i=this;Do.getDecoderModule().then(function(o){i.decodeDracoFileInternal(e,o.decoder,t,r||{},n||{})})},decodeDracoFileInternal:function(e,t,r,n,i){var o=new t.DecoderBuffer;o.Init(new Int8Array(e),e.byteLength);var a=new t.Decoder,s=a.GetEncodedGeometryType(o);if(s==t.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(s!=t.POINT_CLOUD){var c="DRACOLoader: Unknown geometry type.";throw console.error(c),new Error(c)}this.verbosity>0&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,a,s,o,n,i))},addAttributeToGeometry:function(e,t,r,n,i,o,a,s){if(0===o.ptr){var c="DRACOLoader: No attribute "+n;throw console.error(c),new Error(c)}var u,l,h=o.num_components(),d=r.num_points()*h;switch(i){case Float32Array:u=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,o,u),s[n]=new Float32Array(d),l=N;break;case Int8Array:u=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,o,u),s[n]=new Int8Array(d),l=T;break;case Int16Array:u=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,o,u),s[n]=new Int16Array(d),l=C;break;case Int32Array:u=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,o,u),s[n]=new Int32Array(d),l=P;break;case Uint8Array:u=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,o,u),s[n]=new Uint8Array(d),l=A;break;case Uint16Array:u=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,o,u),s[n]=new Uint16Array(d),l=L;break;case Uint32Array:u=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,o,u),s[n]=new Uint32Array(d),l=O;break;default:c="DRACOLoader: Unexpected attribute type.";throw console.error(c),new Error(c)}for(var f=0;f<d;f++)s[n][f]=u.GetValue(f);a.addAttribute(n,new l(s[n],h)),e.destroy(u)},convertDracoGeometryTo3JS:function(e,t,r,n,i,o){var a,s;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var c=performance.now();if(r===e.TRIANGULAR_MESH?(a=new e.Mesh,s=t.DecodeBufferToMesh(n,a)):(a=new e.PointCloud,s=t.DecodeBufferToPointCloud(n,a)),!s.ok()||0==a.ptr){var u="DRACOLoader: Decoding failed: ";throw u+=s.error_msg(),console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var l,h=performance.now();e.destroy(n),r==e.TRIANGULAR_MESH?(l=a.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+l.toString())):l=0;var d=a.num_points(),f=a.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+d.toString()),console.log("Number of attributes loaded: "+f.toString()));var p=t.GetAttributeId(a,e.POSITION);if(-1==p){u="DRACOLoader: No position attribute found.";throw console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var m=t.GetAttribute(a,p),v={},g=new U;for(var y in this.nativeAttributeMap)if(void 0===i[y]){var b=t.GetAttributeId(a,e[this.nativeAttributeMap[y]]);if(-1!==b){this.verbosity>0&&console.log("Loaded "+y+" attribute.");var x=t.GetAttribute(a,b);this.addAttributeToGeometry(e,t,a,y,Float32Array,x,g,v)}}for(var y in i){var w=o[y]||Float32Array,_=i[y];x=t.GetAttributeByUniqueId(a,_);this.addAttributeToGeometry(e,t,a,y,w,x,g,v)}if(r==e.TRIANGULAR_MESH)if(this.drawMode===qt){var S=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(a,S);v.indices=new Uint32Array(S.size());for(var M=0;M<S.size();++M)v.indices[M]=S.GetValue(M);e.destroy(S)}else{var T=3*l;v.indices=new Uint32Array(T);var A=new e.DracoInt32Array;for(M=0;M<l;++M){t.GetFaceFromMesh(a,M,A);var E=3*M;v.indices[E]=A.GetValue(0),v.indices[E+1]=A.GetValue(1),v.indices[E+2]=A.GetValue(2)}e.destroy(A)}g.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&g.setIndex(new(v.indices.length>65535?O:L)(v.indices,1));var C=new e.AttributeQuantizationTransform;if(C.InitFromAttribute(m)){g.attributes.position.isQuantized=!0,g.attributes.position.maxRange=C.range(),g.attributes.position.numQuantizationBits=C.quantization_bits(),g.attributes.position.minValues=new Float32Array(3);for(M=0;M<3;++M)g.attributes.position.minValues[M]=C.min_value(M)}return e.destroy(C),e.destroy(t),e.destroy(a),this.decode_time=h-c,this.import_time=performance.now()-h,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),g},isVersionSupported:function(e,t){Do.getDecoderModule().then(function(r){t(r.decoder.isVersionSupported(e))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},Do.decoderPath="./",Do.decoderConfig={},Do.decoderModulePromise=null,Do.setDecoderPath=function(e){Do.decoderPath=e},Do.setDecoderConfig=function(e){var t=Do.decoderConfig.wasmBinary;Do.decoderConfig=e||{},Do.releaseDecoderModule(),t&&(Do.decoderConfig.wasmBinary=t)},Do.releaseDecoderModule=function(){Do.decoderModulePromise=null},Do.getDecoderModule=function(){var e=this,t=Do.decoderPath,r=Do.decoderConfig,n=Do.decoderModulePromise;return n||("undefined"!=typeof DracoDecoderModule?n=Promise.resolve():"object"!=typeof WebAssembly||"js"===r.type?n=Do._loadScript(t+"draco_decoder.js"):(r.wasmBinaryFile=t+"draco_decoder.wasm",n=Do._loadScript(t+"draco_wasm_wrapper.js").then(function(){return Do._loadArrayBuffer(r.wasmBinaryFile)}).then(function(e){r.wasmBinary=e})),n=n.then(function(){return new Promise(function(t){r.onModuleLoaded=function(r){e.timeLoaded=performance.now(),t({decoder:r})},DracoDecoderModule(r)})}),Do.decoderModulePromise=n,n)},Do._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],n=document.createElement("script");return n.id="decoder_script",n.type="text/javascript",n.src=e,new Promise(function(e){n.onload=e,r.appendChild(n)})},Do._loadArrayBuffer=function(e){var t=new ln;return t.setResponseType("arraybuffer"),new Promise(function(r,n){t.load(e,r,void 0,n)})},Fo.prototype=Object.create(Kr.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isWebGLRenderTargetCube=!0;var Uo=function(e,t){this.sourceTexture=e,this.resolution=t.resolution||512,this.views=[{t:[1,0,0],u:[0,-1,0]},{t:[-1,0,0],u:[0,-1,0]},{t:[0,1,0],u:[0,0,1]},{t:[0,-1,0],u:[0,0,-1]},{t:[0,0,1],u:[0,-1,0]},{t:[0,0,-1],u:[0,-1,0]}],this.camera=new Wr(90,1,.1,10),this.boxMesh=new dr(new Ur(1,1,1),this.getShader()),this.boxMesh.material.side=Y,this.scene=new qr,this.scene.add(this.boxMesh);var r={format:t.format||this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:t.type||this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.renderTarget=new Fo(this.resolution,this.resolution,r)};function ko(e){this.manager=void 0!==e?e:cn,this._parser=null}Uo.prototype={constructor:Uo,update:function(e){for(var t=0;t<6;t++){this.renderTarget.activeCubeFace=t;var r=this.views[t];this.camera.position.set(0,0,0),this.camera.up.set(r.u[0],r.u[1],r.u[2]),this.camera.lookAt(r.t[0],r.t[1],r.t[2]),e.render(this.scene,this.camera,this.renderTarget,!0)}return this.renderTarget.texture},getShader:function(){var e=new Xr({uniforms:{equirectangularMap:{value:this.sourceTexture}},vertexShader:"varying vec3 localPosition;\n\t\t\t\t\n\t\t\t\tvoid main() {\n\t\t\t\t\tlocalPosition = position;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec3 localPosition;\n\t\t\t\tuniform sampler2D equirectangularMap;\n\t\t\t\t\n\t\t\t\tvec2 EquirectangularSampleUV(vec3 v) {\n\t\t\t    vec2 uv = vec2(atan(v.z, v.x), asin(v.y));\n\t\t\t    uv *= vec2(0.1591, 0.3183); // inverse atan\n\t\t\t    uv += 0.5;\n\t\t\t    return uv;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 uv = EquirectangularSampleUV(normalize(localPosition));\n    \t\t\tvec3 color = texture2D(equirectangularMap, uv).rgb;\n    \t\t\t\n\t\t\t\t\tgl_FragColor = vec4( color, 1.0 );\n\t\t\t\t}",blending:$});return e.type="EquirectangularToCubeGenerator",e},dispose:function(){this.boxMesh.geometry.dispose(),this.boxMesh.material.dispose(),this.renderTarget.dispose()}},Object.assign(ko.prototype,{load:function(e,t,r,n){var i=this,o=new Vi,a=new ln(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var r=i._parser(e);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:Xe,o.wrapT=void 0!==r.wrapT?r.wrapT:Xe,o.magFilter=void 0!==r.magFilter?r.magFilter:Ze,o.minFilter=void 0!==r.minFilter?r.minFilter:$e,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=Ze),o.needsUpdate=!0,t&&t(o,r))},r,n),o}});var Bo=function(e){this.manager=void 0!==e?e:cn};(Bo.prototype=Object.create(ko.prototype))._parser=function(e){var t=65536,r=t>>3,n=14,i=65537,o=1<<n,a=o-1,s=59,c=63,u=2+c-s,l=8,h=4,d=4,f=2,p=1;var m={l:0,c:0,lc:0};function v(e,t,r,n,i){for(;r<e;)t=t<<8|I(n,i),r+=8;r-=e,m.l=t>>r&(1<<e)-1,m.c=t,m.lc=r}var g=new Array(59);function y(e,t,r,n,o,a,l){for(var h=r,d=0,f=0;o<=a;o++){if(h.value-r.value>n)return!1;v(6,d,f,e,h);var p=m.l;if(d=m.c,f=m.lc,l[o]=p,p==c){if(h.value-r.value>n)throw"Something wrong with hufUnpackEncTable";v(8,d,f,e,h);var y=m.l+u;if(d=m.c,f=m.lc,o+y>a+1)throw"Something wrong with hufUnpackEncTable";for(;y--;)l[o++]=0;o--}else if(p>=s){if(o+(y=p-s+2)>a+1)throw"Something wrong with hufUnpackEncTable";for(;y--;)l[o++]=0;o--}}!function(e){for(var t=0;t<=58;++t)g[t]=0;for(t=0;t<i;++t)g[e[t]]+=1;var r=0;for(t=58;t>0;--t){var n=r+g[t]>>1;g[t]=r,r=n}for(t=0;t<i;++t){var o=e[t];o>0&&(e[t]=o|g[o]++<<6)}}(l)}function b(e){return 63&e}function x(e){return e>>6}var w={c:0,lc:0};function _(e,t,r,n){e=e<<8|I(r,n),t+=8,w.c=e,w.lc=t}var S={c:0,lc:0};function M(e,t,r,n,i,o,a,s,c,u){if(e==t){n<8&&(_(r,n,i,a),r=w.c,n=w.lc);var l=r>>(n-=8);l=new Uint8Array([l])[0];if(c.value+l>u)return!1;for(var h=s[c.value-1];l-- >0;)s[c.value++]=h}else{if(!(c.value<u))return!1;s[c.value++]=e}S.c=r,S.lc=n}function T(e){var t=function(e){return 65535&e}(e);return t>32767?t-65536:t}var A={a:0,b:0};function E(e,t){var r=T(e),n=T(t),i=r+(1&n)+(n>>1),o=i,a=i-n;A.a=o,A.b=a}function C(e,t,r,n,i,o,a){for(var s,c=r>i?i:r,u=1;u<=c;)u<<=1;for(s=u>>=1,u>>=1;u>=1;){for(var l,h,d,f,p=0,m=p+o*(i-s),v=o*u,g=o*s,y=n*u,b=n*s;p<=m;p+=g){for(var x=p,w=p+n*(r-s);x<=w;x+=b){var _=x+y,S=(M=x+v)+y;E(t[x+e],t[M+e]),l=A.a,d=A.b,E(t[_+e],t[S+e]),h=A.a,f=A.b,E(l,h),t[x+e]=A.a,t[_+e]=A.b,E(d,f),t[M+e]=A.a,t[S+e]=A.b}if(r&u){var M=x+v;E(t[x+e],t[M+e]),l=A.a,t[M+e]=A.b,t[x+e]=l}}if(i&u)for(x=p,w=p+n*(r-s);x<=w;x+=b){_=x+y;E(t[x+e],t[_+e]),l=A.a,t[_+e]=A.b,t[x+e]=l}s=u,u>>=1}return p}function L(e,t,r,s,c,u,l){var h=r.value,d=R(t,r),f=R(t,r);r.value+=4;var p=R(t,r);if(r.value+=4,d<0||d>=i||f<0||f>=i)throw"Something wrong with HUF_ENCSIZE";var m=new Array(i),v=new Array(o);if(function(e){for(var t=0;t<o;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(v),y(e,0,r,s-(r.value-h),d,f,m),p>8*(s-(r.value-h)))throw"Something wrong with hufUncompress";!function(e,t,r,i){for(;t<=r;t++){var o=x(e[t]),a=b(e[t]);if(o>>a)throw"Invalid table entry";if(a>n){if((l=i[o>>a-n]).len)throw"Invalid table entry";if(l.lit++,l.p){var s=l.p;l.p=new Array(l.lit);for(var c=0;c<l.lit-1;++c)l.p[c]=s[c]}else l.p=new Array(1);l.p[l.lit-1]=t}else if(a){var u=0;for(c=1<<n-a;c>0;c--){var l;if((l=i[(o<<n-a)+u]).len||l.p)throw"Invalid table entry";l.len=a,l.lit=t,u++}}}}(m,d,f,v),function(e,t,r,i,o,s,c,u,l,h){for(var d=0,f=0,p=u,m=Math.trunc(o.value+(s+7)/8);o.value<m;)for(_(d,f,r,o),d=w.c,f=w.lc;f>=n;)if((T=t[d>>f-n&a]).len)f-=T.len,M(T.lit,c,d,f,r,0,o,l,h,p),d=S.c,f=S.lc;else{if(!T.p)throw"hufDecode issues";var v;for(v=0;v<T.lit;v++){for(var g=b(e[T.p[v]]);f<g&&o.value<m;)_(d,f,r,o),d=w.c,f=w.lc;if(f>=g&&x(e[T.p[v]])==(d>>f-g&(1<<g)-1)){f-=g,M(T.p[v],c,d,f,r,0,o,l,h,p),d=S.c,f=S.lc;break}}if(v==T.lit)throw"hufDecode issues"}var y=8-s&7;for(d>>=y,f-=y;f>0;){var T;if(!(T=t[d<<n-f&a]).len)throw"hufDecode issues";f-=T.len,M(T.lit,c,d,f,r,0,o,l,h,p),d=S.c,f=S.lc}}(m,v,e,0,r,p,f,l,c,u)}function P(e,n,i,o,a,s,c,u,l,h){var d=new Uint8Array(r),f=k(o,a),p=k(o,a);if(p>=r)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(f<=p)for(var m=0;m<p-f+1;m++)d[m+f]=D(o,a);var v=new Uint16Array(t);!function(e,r){for(var n=0,i=0;i<t;++i)(0==i||e[i>>3]&1<<(7&i))&&(r[n++]=i);for(var o=n-1;n<t;)r[n++]=0}(d,v);L(i,o,a,R(o,a),e,n,s);var g=new Array(c),y=0;for(m=0;m<c;m++){u[m];g[m]={},g[m].start=y,g[m].end=g[m].start,g[m].nx=l,g[m].ny=h,g[m].size=1,y+=g[m].nx*g[m].ny*g[m].size}var b=0;for(m=0;m<c;m++)for(var x=0;x<g[m].size;++x)b+=C(x+b,e,g[m].nx,g[m].size,g[m].ny,g[m].nx*g[m].size);return function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(v,e,y),!0}function O(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=(new TextDecoder).decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function N(e,t){var r=e.getUint32(0,!0);return t.value=t.value+l,r}function R(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+d,r}function I(e,t){var r=e[t.value];return t.value=t.value+p,r}function D(e,t){var r=e.getUint8(t.value);return t.value=t.value+p,r}function F(e,t){var r=e.getFloat32(t.value,!0);return t.value+=h,r}function U(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function k(e,t){var r=e.getUint16(t.value,!0);return t.value+=f,r}function B(e,t){return U(k(e,t))}function z(e,t,r,n,i){if("string"===n||"iccProfile"===n)return function(e,t,r){var n=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,n}(t,r,i);if("chlist"===n)return function(e,t,r,n){for(var i=r.value,o=[];r.value<i+n-1;){var a=O(t,r),s=R(e,r),c=D(e,r);r.value+=3;var u=R(e,r),l=R(e,r);o.push({name:a,pixelType:s,pLinear:c,xSampling:u,ySampling:l})}return r.value+=1,o}(e,t,r,i);if("chromaticities"===n)return function(e,t){return{redX:F(e,t),redY:F(e,t),greenX:F(e,t),greenY:F(e,t),blueX:F(e,t),blueY:F(e,t),whiteX:F(e,t),whiteY:F(e,t)}}(e,r);if("compression"===n)return function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION"][D(e,t)]}(e,r);if("box2i"===n)return function(e,t){return{xMin:R(e,t),yMin:R(e,t),xMax:R(e,t),yMax:R(e,t)}}(e,r);if("lineOrder"===n)return function(e,t){return["INCREASING_Y"][D(e,t)]}(e,r);if("float"===n)return F(e,r);if("v2f"===n)return function(e,t){return[F(e,t),F(e,t)]}(e,r);if("int"===n)return R(e,r);throw"Cannot parse value for unsupported type: "+n}for(var j=new DataView(e),V=new Uint8Array(e),G={},W=(j.getUint32(0,!0),j.getUint8(4,!0),j.getUint8(5,!0),{value:8}),H=!0;H;){var X=O(e,W);if(0==X)H=!1;else{var q=z(j,e,W,O(e,W),R(j,W));G[X]=q}}var Y=G.dataWindow.yMax+1,J=1;"PIZ_COMPRESSION"===G.compression&&(J=32);for(var Q=Y/J,Z=0;Z<Q;Z++)N(j,W);var K=G.dataWindow.xMax-G.dataWindow.xMin+1,$=G.dataWindow.yMax-G.dataWindow.yMin+1,ee=G.channels.length,te=new Float32Array(K*$*ee),re={R:0,G:1,B:2,A:3};if("NO_COMPRESSION"===G.compression)for(var ne=0;ne<$;ne++)for(var ie=R(j,W),oe=(R(j,W),0);oe<G.channels.length;oe++){var ae=re[G.channels[oe].name];if(1!==G.channels[oe].pixelType)throw"Only supported pixel format is HALF";for(var se=0;se<K;se++){var ce=B(j,W);te[K*ee*($-ie)+se*ee+ae]=ce}}else{if("PIZ_COMPRESSION"!==G.compression)throw"Cannot decompress unsupported compression";for(var ue=0;ue<$/J;ue++){R(j,W),R(j,W);var le=K*J*(2*G.channels.length),he=new Uint16Array(le);P(he,{value:0},V,j,W,le,ee,G.channels,K,J);for(var de=0;de<J;de++)for(oe=0;oe<G.channels.length;oe++){ae=re[G.channels[oe].name];if(1!==G.channels[oe].pixelType)throw"Only supported pixel format is HALF";for(se=0;se<K;se++){ce=U(he[oe*(J*K)+de*K+se]);te[K*ee*($-(de+ue*J))+se*ee+ae]=ce}}}}return{header:G,width:K,height:$,data:te,format:4==G.channels.length?pt:ft,type:at}};var zo=function(){var e,t,r;function n(e){this.manager=void 0!==e?e:cn}function u(e){this.textureLoader=e}function h(){}function f(){}function m(){}function g(){}function y(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function b(){}function x(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("FBXLoader: Cannot find the version number for the file given.")}function w(e){return e/46186158e3}n.prototype={constructor:n,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=Cn.extractUrlBase(e),a=new ln(this.manager);a.setResponseType("arraybuffer"),a.load(e,function(r){try{var a=i.parse(r,o);t(a)}catch(t){setTimeout(function(){n&&n(t),i.manager.itemError(e)},0)}},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(t,r){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===F(e,0,t.length)}(t))e=(new g).parse(t);else{var n=F(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function n(t){var n=e[t-1];return e=e.slice(r+t),r++,n}for(var i=0;i<t.length;++i){var o=n(1);if(o===t[i])return!1}return!0}(n))throw new Error("FBXLoader: Unknown format.");if(x(n)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+x(n));e=(new m).parse(n)}return new u(new An(this.manager).setPath(r).setCrossOrigin(this.crossOrigin)).parse(e)}},u.prototype={constructor:u,parse:function(){t=this.parseConnections();var e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),o=this.parseDeformers(),a=(new h).parse(o);return this.parseScene(o,a,i),r},parseConnections:function(){var t=new Map;"Connections"in e&&e.Connections.connections.forEach(function(e){var r=e[0],n=e[1],i=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var o={ID:n,relationship:i};t.get(r).parents.push(o),t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:r,relationship:i};t.get(n).children.push(a)});return t},parseImages:function(){var t={},r={};if("Video"in e.Objects){var n=e.Objects.Video;for(var i in n){var o=n[i];if(t[u=parseInt(i)]=o.RelativeFilename||o.Filename,"Content"in o){var a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,s="string"==typeof o.Content&&""!==o.Content;if(a||s){var c=this.parseImage(n[i]);r[o.RelativeFilename||o.Filename]=c}}}}for(var u in t){var l=t[u];void 0!==r[l]?t[u]=r[l]:t[u]=t[u].split("\\").pop()}return t},parseImage:function(e){var t,r=e.Content,n=e.RelativeFilename||e.Filename,o=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(o){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===Loader.Handlers.get(".tga")&&Loader.Handlers.add(/\.tga$/i,new Co),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+o+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var a=new Uint8Array(r);return i.URL.createObjectURL(new Blob([a],{type:t}))},parseTextures:function(t){var r=new Map;if("Texture"in e.Objects){var n=e.Objects.Texture;for(var i in n){var o=this.parseTexture(n[i],t);r.set(parseInt(i),o)}}return r},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var n=e.WrapModeU,i=e.WrapModeV,o=void 0!==n?n.value:0,a=void 0!==i?i.value:0;if(r.wrapS=0===o?He:Xe,r.wrapT=0===a?He:Xe,"Scaling"in e){var s=e.Scaling.value;r.repeat.x=s[0],r.repeat.y=s[1]}return r},loadTexture:function(e,r){var n,i,o=this.textureLoader.path,a=t.get(e.id).children;void 0!==a&&a.length>0&&void 0!==r[a[0].ID]&&(0!==(n=r[a[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var c=Loader.Handlers.get(".tga");null===c?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",n),i=new Zr):i=c.load(n)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",n),i=new Zr):i=this.textureLoader.load(n);return this.textureLoader.setPath(o),i},parseMaterials:function(t){var r=new Map;if("Material"in e.Objects){var n=e.Objects.Material;for(var i in n){var o=this.parseMaterial(n[i],t);null!==o&&r.set(parseInt(i),o)}}return r},parseMaterial:function(e,r){var n=e.id,i=e.attrName,o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!t.has(n))return null;var a,s=this.parseParameters(e,r,n);switch(o.toLowerCase()){case"phong":a=new vn;break;case"lambert":a=new pn;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new vn({color:3342591})}return a.setValues(s),a.name=i,a},parseParameters:function(e,r,n){var i={};e.BumpFactor&&(i.bumpScale=e.BumpFactor.value),e.Diffuse?i.color=(new v).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(i.color=(new v).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(i.displacementScale=e.DisplacementFactor.value),e.Emissive?i.emissive=(new v).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(i.emissive=(new v).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(i.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(i.opacity=parseFloat(e.Opacity.value)),i.opacity<1&&(i.transparent=!0),e.ReflectionFactor&&(i.reflectivity=e.ReflectionFactor.value),e.Shininess&&(i.shininess=e.Shininess.value),e.Specular?i.specular=(new v).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(i.specular=(new v).fromArray(e.SpecularColor.value));var o=this;return t.get(n).children.forEach(function(e){var t=e.relationship;switch(t){case"Bump":i.bumpMap=o.getTexture(r,e.ID);break;case"DiffuseColor":i.map=o.getTexture(r,e.ID);break;case"DisplacementColor":i.displacementMap=o.getTexture(r,e.ID);break;case"EmissiveColor":i.emissiveMap=o.getTexture(r,e.ID);break;case"NormalMap":i.normalMap=o.getTexture(r,e.ID);break;case"ReflectionColor":i.envMap=o.getTexture(r,e.ID),i.envMap.mapping=ze;break;case"SpecularColor":i.specularMap=o.getTexture(r,e.ID);break;case"TransparentColor":i.alphaMap=o.getTexture(r,e.ID),i.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",t)}}),i},getTexture:function(r,n){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=t.get(n).children[0].ID),r.get(n)},parseDeformers:function(){var r={},n={};if("Deformer"in e.Objects){var i=e.Objects.Deformer;for(var o in i){var a=i[o],s=t.get(parseInt(o));if("Skin"===a.attrType){var c=this.parseSkeleton(s,i);c.ID=o,s.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=s.parents[0].ID,r[o]=c}else if("BlendShape"===a.attrType){var u={id:o};u.rawTargets=this.parseMorphTargets(s,i),u.id=o,s.parents.length>1&&console.warn("FBXLoader: morph target attached to more than one geometry is not supported."),n[o]=u}}}return{skeletons:r,morphTargets:n}},parseSkeleton:function(e,t){var r=[];return e.children.forEach(function(e){var n=t[e.ID];if("Cluster"===n.attrType){var i={ID:e.ID,indices:[],weights:[],transform:(new a).fromArray(n.Transform.a),transformLink:(new a).fromArray(n.TransformLink.a),linkMode:n.Mode};"Indexes"in n&&(i.indices=n.Indexes.a,i.weights=n.Weights.a),r.push(i)}}),{rawBones:r,bones:[]}},parseMorphTargets:function(e,r){for(var n=[],i=0;i<e.children.length;i++){if(8===i){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var o=e.children[i],a=r[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;t.get(parseInt(o.ID)).children.forEach(function(e){void 0===e.relationship&&(s.geoID=e.ID)}),n.push(s)}return n},parseScene:function(n,i,o){r=new oo;var a=this.parseModels(n.skeletons,i,o),s=e.Objects.Model,c=this;a.forEach(function(e){var n=s[e.ID];c.setLookAtProperties(e,n),t.get(e.ID).parents.forEach(function(t){var r=a.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&r.add(e)}),this.bindSkeleton(n.skeletons,i,a),this.createAmbientLight(),this.setupMorphMaterials();var u=(new f).parse();1===r.children.length&&r.children[0].isGroup&&(r.children[0].animations=u,r=r.children[0]),r.animations=u},parseModels:function(r,n,i){var o=new Map,a=e.Objects.Model;for(var s in a){var c=parseInt(s),u=a[s],l=t.get(c),h=this.buildSkeleton(l,r,c,u.attrName);if(!h){switch(u.attrType){case"Camera":h=this.createCamera(l);break;case"Light":h=this.createLight(l);break;case"Mesh":h=this.createMesh(l,n,i);break;case"NurbsCurve":h=this.createCurve(l,n);break;case"LimbNode":case"Null":default:h=new oo}h.name=br.sanitizeNodeName(u.attrName),h.ID=c}this.setModelTransforms(h,u),o.set(c,h)}return o},buildSkeleton:function(e,t,r,n){var i=null;return e.parents.forEach(function(e){for(var o in t){var a=t[o];a.rawBones.forEach(function(t,o){if(t.ID===e.ID){var s=i;(i=new Dr).matrixWorld.copy(t.transformLink),i.name=br.sanitizeNodeName(n),i.ID=r,a.bones[o]=i,null!==s&&i.add(s)}})}}),i},createCamera:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new p;else{var o=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(o=1);var a=1;void 0!==n.NearPlane&&(a=n.NearPlane.value/1e3);var s=1e3;void 0!==n.FarPlane&&(s=n.FarPlane.value/1e3);var c=i.innerWidth,u=i.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(c=n.AspectWidth.value,u=n.AspectHeight.value);var l=c/u,h=45;void 0!==n.FieldOfView&&(h=n.FieldOfView.value);var d=n.FocalLength?n.FocalLength.value:null;switch(o){case 0:r=new Wr(h,l,a,s),null!==d&&r.setFocalLength(d);break;case 1:r=new Yr(-c/2,c/2,u/2,-u/2,a,s);break;default:console.warn("FBXLoader: Unknown camera type "+o+"."),r=new p}}return r},createLight:function(t){var r,n;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)}),void 0===n)r=new p;else{var i;i=void 0===n.LightType?0:n.LightType.value;var a=16777215;void 0!==n.Color&&(a=(new v).fromArray(n.Color.value));var s=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(s=0);var c=0;void 0!==n.FarAttenuationEnd&&(c=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(i){case 0:r=new yo(a,s,c,1);break;case 1:r=new xo(a,s);break;case 2:var u=Math.PI/3;void 0!==n.InnerAngle&&(u=o.degToRad(n.InnerAngle.value));var l=0;void 0!==n.OuterAngle&&(l=o.degToRad(n.OuterAngle.value),l=Math.max(l,1)),r=new _o(a,s,c,u,l,1);break;default:console.warn("FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),r=new yo(a,s)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(r.castShadow=!0)}return r},createMesh:function(e,t,r){var n,i=null,o=null,a=[];return e.children.forEach(function(e){t.has(e.ID)&&(i=t.get(e.ID)),r.has(e.ID)&&a.push(r.get(e.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new vn({color:13421772}),a.push(o)),"color"in i.attributes&&a.forEach(function(e){e.vertexColors=K}),i.FBX_Deformer?(a.forEach(function(e){e.skinning=!0}),n=new lo(i,o)):n=new dr(i,o),n},createCurve:function(e,t){return new fr(e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),new ur({color:3342591,linewidth:1}))},setModelTransforms:function(e,t){var r={};"RotationOrder"in t&&(r.eulerOrder=parseInt(t.RotationOrder.value)),"Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value);var n=R(r);e.applyMatrix(n)},setLookAtProperties:function(n,i){"LookAtProperty"in i&&t.get(n.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){var i=e.Objects.Model[t.ID];if("Lcl_Translation"in i){var o=i.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(o),r.add(n.target)):n.lookAt((new s).fromArray(o))}}})},bindSkeleton:function(e,r,n){var i=this.parsePoseNodes();for(var o in e){var a=e[o];t.get(parseInt(a.ID)).parents.forEach(function(e){if(r.has(e.ID)){var o=e.ID;t.get(o).parents.forEach(function(e){n.has(e.ID)&&n.get(e.ID).bind(new uo(a.bones),i[e.ID])})}})}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var n in r)if("BindPose"===r[n].attrType){var i=r[n].PoseNode;Array.isArray(i)?i.forEach(function(e){t[e.Node]=(new a).fromArray(e.Matrix.a)}):t[i.Node]=(new a).fromArray(i.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,n=t[0],i=t[1],o=t[2];if(0!==n||0!==i||0!==o){var a=new v(n,i,o);r.add(new Ao(a,1))}}},setupMorphMaterials:function(){r.traverse(function(e){if(e.isMesh&&(e.geometry.morphAttributes.position||e.geometry.morphAttributes.normal)){var t=e.uuid,n=e.material.uuid,i=!1;r.traverse(function(e){e.isMesh&&e.material.uuid===n&&e.uuid!==t&&(i=!0)}),!0===i&&(e.material=e.material.clone()),e.material.morphTargets=!0}})}},h.prototype={constructor:h,parse:function(r){var n=new Map;if("Geometry"in e.Objects){var i=e.Objects.Geometry;for(var o in i){var a=t.get(parseInt(o)),s=this.parseGeometry(a,i[o],r);n.set(parseInt(o),s)}}return n},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,r,n){var i=n.skeletons,o=n.morphTargets,a=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0!==a.length){var s=t.children.reduce(function(e,t){return void 0!==i[t.ID]&&(e=i[t.ID]),e},null),c=t.children.reduce(function(e,t){return void 0!==o[t.ID]&&(e=o[t.ID]),e},null),u=a[0],l={};"RotationOrder"in u&&(l.eulerOrder=u.RotationOrder.value),"GeometricTranslation"in u&&(l.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(l.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(l.scale=u.GeometricScaling.value);var h=R(l);return this.genGeometry(r,s,c,h)}},genGeometry:function(e,t,r,n){var i=new U;e.attrName&&(i.name=e.attrName);var o=this.parseGeoNode(e,t),a=this.genBuffers(o),s=new N(a.vertex,3);if(n.applyToBufferAttribute(s),i.addAttribute("position",s),a.colors.length>0&&i.addAttribute("color",new N(a.colors,3)),t&&(i.addAttribute("skinIndex",new L(a.weightsIndices,4)),i.addAttribute("skinWeight",new N(a.vertexWeights,4)),i.FBX_Deformer=t),a.normal.length>0){var c=new N(a.normal,3);(new d).getNormalMatrix(n).applyToBufferAttribute(c),i.addAttribute("normal",c)}if(a.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),i.addAttribute(r,new N(a.uvs[t],2))}),o.material&&"AllSame"!==o.material.mappingType){var u=a.materialIndex[0],l=0;if(a.materialIndex.forEach(function(e,t){e!==u&&(i.addGroup(l,t-l,u),u=e,l=t)}),i.groups.length>0){var h=i.groups[i.groups.length-1],f=h.start+h.count;f!==a.materialIndex.length&&i.addGroup(f,a.materialIndex.length-f,u)}0===i.groups.length&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,e,r,n),i},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var n=0;e.LayerElementUV[n];)r.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})})})),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,o=[],a=[],s=[],c=[],u=[],l=[],h=this;return e.vertexIndices.forEach(function(d,f){var p=!1;d<0&&(d^=-1,p=!0);var m=[],v=[];if(o.push(3*d,3*d+1,3*d+2),e.color){var g=T(f,r,d,e.color);s.push(g[0],g[1],g[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach(function(e){v.push(e.weight),m.push(e.id)}),v.length>4){i||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var y=[0,0,0,0],b=[0,0,0,0];v.forEach(function(e,t){var r=e,n=m[t];b.forEach(function(e,t,i){if(r>e){i[t]=r,r=e;var o=y[t];y[t]=n,n=o}})}),m=y,v=b}for(;v.length<4;)v.push(0),m.push(0);for(var x=0;x<4;++x)u.push(v[x]),l.push(m[x])}if(e.normal){g=T(f,r,d,e.normal);a.push(g[0],g[1],g[2])}if(e.material&&"AllSame"!==e.material.mappingType)var w=T(f,r,d,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var n=T(f,r,d,e);void 0===c[t]&&(c[t]=[]),c[t].push(n[0]),c[t].push(n[1])}),n++,p&&(h.genFace(t,e,o,w,a,s,c,u,l,n),r++,n=0,o=[],a=[],s=[],c=[],u=[],l=[])}),t},genFace:function(e,t,r,n,i,o,a,s,c,u){for(var l=2;l<u;l++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(l-1)]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+2]]),e.vertex.push(t.vertexPositions[r[3*l]]),e.vertex.push(t.vertexPositions[r[3*l+1]]),e.vertex.push(t.vertexPositions[r[3*l+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(l-1)]),e.vertexWeights.push(s[4*(l-1)+1]),e.vertexWeights.push(s[4*(l-1)+2]),e.vertexWeights.push(s[4*(l-1)+3]),e.vertexWeights.push(s[4*l]),e.vertexWeights.push(s[4*l+1]),e.vertexWeights.push(s[4*l+2]),e.vertexWeights.push(s[4*l+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(l-1)]),e.weightsIndices.push(c[4*(l-1)+1]),e.weightsIndices.push(c[4*(l-1)+2]),e.weightsIndices.push(c[4*(l-1)+3]),e.weightsIndices.push(c[4*l]),e.weightsIndices.push(c[4*l+1]),e.weightsIndices.push(c[4*l+2]),e.weightsIndices.push(c[4*l+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(l-1)]),e.colors.push(o[3*(l-1)+1]),e.colors.push(o[3*(l-1)+2]),e.colors.push(o[3*l]),e.colors.push(o[3*l+1]),e.colors.push(o[3*l+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(l-1)]),e.normal.push(i[3*(l-1)+1]),e.normal.push(i[3*(l-1)+2]),e.normal.push(i[3*l]),e.normal.push(i[3*l+1]),e.normal.push(i[3*l+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(a[r][0]),e.uvs[r].push(a[r][1]),e.uvs[r].push(a[r][2*(l-1)]),e.uvs[r].push(a[r][2*(l-1)+1]),e.uvs[r].push(a[r][2*l]),e.uvs[r].push(a[r][2*l+1])})},addMorphTargets:function(t,r,n,i){if(null!==n){t.morphAttributes.position=[],t.morphAttributes.normal=[];var o=this;n.rawTargets.forEach(function(n){var a=e.Objects.Geometry[n.geoID];void 0!==a&&o.genMorphGeometry(t,r,a,i)})}},genMorphGeometry:function(e,t,r,n){var i=new U;r.attrName&&(i.name=r.attrName);for(var o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==t.Vertices?t.Vertices.a.slice():[],s=void 0!==r.Vertices?r.Vertices.a:[],c=void 0!==r.Indexes?r.Indexes.a:[],u=0;u<c.length;u++){var l=3*c[u];a[l]+=s[3*u],a[l+1]+=s[3*u+1],a[l+2]+=s[3*u+2]}var h={vertexIndices:o,vertexPositions:a},d=new N(this.genBuffers(h).vertex,3);d.name=r.attrName,n.applyToBufferAttribute(d),e.morphAttributes.position.push(d)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.Materials.a,i=[],o=0;o<n.length;++o)i.push(o);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===Si)return console.error("FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new U;var t=parseInt(e.Order);if(isNaN(t))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new U;for(var r,n,i=t-1,o=e.KnotVector.a,a=[],s=e.Points.a,c=0,u=s.length;c<u;c+=4)a.push((new S).fromArray(s,c));if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){r=i,n=o.length-1-r;for(c=0;c<i;++c)a.push(a[c])}var l=new Si(i,o,a,r,n).getPoints(7*a.length),h=new Float32Array(3*l.length);l.forEach(function(e,t){e.toArray(h,3*t)});var d=new U;return d.addAttribute("position",new M(h,3)),d}},f.prototype={constructor:f,parse:function(){var e=[],t=this.parseClips();if(void 0!==t){for(var r in t){var n=t[r],i=this.addClip(n);e.push(i)}return e}},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,r=new Map;for(var n in t){var i=t[n];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){var o={id:i.id,attr:i.attrName,curves:{}};r.set(o.id,o)}}return r},parseAnimationCurves:function(r){var n=e.Objects.AnimationCurve;for(var i in n){var o={id:n[i].id,times:n[i].KeyTime.a.map(w),values:n[i].KeyValueFloat.a},a=t.get(o.id);if(void 0!==a){var s=a.parents[0].ID,c=a.parents[0].relationship;c.match(/X/)?r.get(s).curves.x=o:c.match(/Y/)?r.get(s).curves.y=o:c.match(/Z/)?r.get(s).curves.z=o:c.match(/d|DeformPercent/)&&r.has(s)&&(r.get(s).curves.morph=o)}}},parseAnimationLayers:function(r){var n=e.Objects.AnimationLayer,i=new Map;for(var o in n){var a=[],s=t.get(parseInt(o));if(void 0!==s){var c=this;s.children.forEach(function(n,i){if(r.has(n.ID)){var o=r.get(n.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===a[i]){t.get(n.ID).parents.forEach(function(e){void 0!==e.relationship&&(f=e.ID)});var s=e.Objects.Model[f.toString()],u={modelName:br.sanitizeNodeName(s.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1],transform:c.getModelAnimTransform(s)};"PreRotation"in s&&(u.preRotations=s.PreRotation.value),"PostRotation"in s&&(u.postRotations=s.PostRotation.value),a[i]=u}a[i][o.attr]=o}else if(void 0!==o.curves.morph){if(void 0===a[i]){var l;t.get(n.ID).parents.forEach(function(e){void 0!==e.relationship&&(l=e.ID)});var h=t.get(l).parents[0].ID,d=t.get(h).parents[0].ID,f=t.get(d).parents[0].ID;s=e.Objects.Model[f],u={modelName:br.sanitizeNodeName(s.attrName),morphName:e.Objects.Deformer[l].attrName};a[i]=u}a[i][o.attr]=o}}}),i.set(parseInt(o),a)}}return i},getModelAnimTransform:function(e){var t={};return"RotationOrder"in e&&(t.eulerOrder=parseInt(e.RotationOrder.value)),"Lcl_Translation"in e&&(t.translation=e.Lcl_Translation.value),"RotationOffset"in e&&(t.rotationOffset=e.RotationOffset.value),"Lcl_Rotation"in e&&(t.rotation=e.Lcl_Rotation.value),"PreRotation"in e&&(t.preRotation=e.PreRotation.value),"PostRotation"in e&&(t.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(t.scale=e.Lcl_Scaling.value),R(t)},parseAnimStacks:function(r){var n=e.Objects.AnimationStack,i={};for(var o in n){var a=t.get(parseInt(o)).children;a.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(a[0].ID);i[o]={name:n[o].attrName,layer:s}}return i},addClip:function(e){var t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new Nr(e.name,-1,t)},generateTracks:function(e){var t=[],r=new s,n=new c,i=new s;if(e.transform&&e.transform.decompose(r,n,i),r=r.toArray(),n=(new l).setFromQuaternion(n).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var a=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotations,e.postRotations);void 0!==a&&t.push(a)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var u=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==u&&t.push(u)}if(void 0!==e.DeformPercent){var h=this.generateMorphTrack(e);void 0!==h&&t.push(h)}return t},generateVectorTrack:function(e,t,r,n){var i=this.getTimesForAllAxes(t);return new Or(e+"."+n,i,this.getKeyframeTrackValues(i,t,r))},generateRotationTrack:function(e,t,r,n,i){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(o.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(o.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(o.degToRad));var a=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(a,t,r);void 0!==n&&((n=n.map(o.degToRad)).push("ZYX"),n=(new l).fromArray(n),n=(new c).setFromEuler(n)),void 0!==i&&((i=i.map(o.degToRad)).push("ZYX"),i=(new l).fromArray(i),i=(new c).setFromEuler(i).inverse());for(var u=new c,h=new l,d=[],f=0;f<s.length;f+=3)h.set(s[f],s[f+1],s[f+2],"ZYX"),u.setFromEuler(h),void 0!==n&&u.premultiply(n),void 0!==i&&u.multiply(i),u.toArray(d,f/3*4);return new Lr(e+".quaternion",a,d)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map(function(e){return e/100}),i=r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Er(e.modelName+".morphTargetInfluences["+i+"]",t.times,n)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})},getKeyframeTrackValues:function(e,t,r){var n=r,i=[],o=-1,a=-1,s=-1;return e.forEach(function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==o){var r=t.x.values[o];i.push(r),n[0]=r}else i.push(n[0]);if(-1!==a){var c=t.y.values[a];i.push(c),n[1]=c}else i.push(n[1]);if(-1!==s){var u=t.z.values[s];i.push(u),n[2]=u}else i.push(n[2])}),i},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(i>=180){for(var o=i/180,a=n/o,s=r+a,c=e.times[t-1],u=(e.times[t]-c)/o,l=c+u,h=[],d=[];l<e.times[t];)h.push(l),l+=u,d.push(s),s+=a;e.times=k(e.times,t,h),e.values=k(e.values,t,d)}}}},m.prototype={constructor:m,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,console.log("FBXTree: ",b),this.allNodes=new b,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){var i=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(!i&&!o){var a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,r[++n]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:r},o=this.parseNodeAttr(n),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in a?("PoseNode"===r?a.PoseNode.push(i):void 0!==a[r].id&&(a[r]={},a[r][a[r].id]=a[r]),""!==o.id&&(a[r][o.id]=i)):"number"==typeof o.id?(a[r]={},a[r][o.id]=i):"Properties70"!==r&&(a[r]="PoseNode"===r?[i]:i),"number"==typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===n){var a=i.split(",").slice(1),s=parseInt(a[0]),c=parseInt(a[1]),u=i.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[s,c],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===o[n]&&(o[n]=[])}"Node"===n&&(o.id=i),n in o&&Array.isArray(o[n])?o[n].push(i):"a"!==n?o[n]=i:o.a=i,this.setCurrentProp(o,n),"a"===n&&","!==i.slice(-1)&&(o.a=D(i))}else this.parseNodeSpecialProperty(e,n,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=D(t.a))},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=n[0],o=n[1],a=n[2],s=n[3],c=n[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=D(c)}this.getPrevNode()[i]={type:o,type2:a,flag:s,value:c},this.setCurrentProp(this.getPrevNode(),i)}},g.prototype={constructor:g,parse:function(e){var t=new y(e);t.skip(23);var r=t.getUint32();console.log("FBXLoader: FBX binary version: "+r);for(var n=new b;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&n.add(i.name,i)}return n},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},n=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32(),o=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),a=e.getString(o);if(0===n)return null;for(var s=[],c=0;c<i;c++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",l=s.length>1?s[1]:"",h=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){var d=this.parseNode(e,t);null!==d&&this.parseSubNode(a,r,d)}return r.propertyList=s,"number"==typeof u&&(r.id=u),""!==l&&(r.attrName=l),""!==h&&(r.attrType=h),""!==a&&(r.name=a),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var n=r.propertyList[0];Array.isArray(n)?(t[r.name]=r,r.a=n):t[r.name]=n}else if("Connections"===e&&"C"===r.name){var i=[];r.propertyList.forEach(function(e,t){0!==t&&i.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===r.name){Object.keys(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var o,a=r.propertyList[0],s=r.propertyList[1],c=r.propertyList[2],u=r.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[a]={type:s,type2:c,flag:u,value:o}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),i=e.getUint32(),o=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}"undefined"==typeof Zlib&&console.error("FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new y(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(o))).decompress().buffer);switch(t){case"b":case"c":return a.getBooleanArray(n);case"d":return a.getFloat64Array(n);case"f":return a.getFloat32Array(n);case"i":return a.getInt32Array(n);case"l":return a.getInt64Array(n)}default:throw new Error("FBXLoader: Unknown property type "+t)}}},y.prototype={constructor:y,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),Cn.decodeText(new Uint8Array(t))}},b.prototype={constructor:b,add:function(e,t){this[e]=t}};var _=[];function T(e,t,r,n){var i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);var o=i*n.dataSize,a=o+n.dataSize;return function(e,t,r,n){for(var i=r,o=0;i<n;i++,o++)e[o]=t[i];return e}(_,n.buffer,o,a)}var A=new a,E=new l,C=new s,P=new s,O=new a;function R(e){var t=new a;P.set(0,0,0),O.identity();var r,n=e.eulerOrder?I(e.eulerOrder):I(0);(e.translation&&P.fromArray(e.translation),e.rotationOffset&&P.add(C.fromArray(e.rotationOffset)),e.rotation)&&((r=e.rotation.map(o.degToRad)).push(n),O.makeRotationFromEuler(E.fromArray(r)));e.preRotation&&((r=e.preRotation.map(o.degToRad)).push(n),A.makeRotationFromEuler(E.fromArray(r)),O.premultiply(A));e.postRotation&&((r=e.postRotation.map(o.degToRad)).push(n),A.makeRotationFromEuler(E.fromArray(r)),A.getInverse(A),O.multiply(A));return e.scale&&t.scale(C.fromArray(e.scale)),t.setPosition(P),t.multiply(O),t}function I(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===e?(console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function D(e){return e.split(",").map(function(e){return parseFloat(e)})}function F(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),Cn.decodeText(new Uint8Array(e,t,r))}function k(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return n}(),jo=function(e){this.manager=void 0!==e?e:cn,this.splitLayer=!1};jo.prototype.load=function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(e))},r,n)},jo.prototype.parse=function(e){var t={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},r=[],n=void 0,i=new ur({color:16711680});i.name="path";var o=new ur({color:65280});function a(e){n={vertex:[],pathVertex:[],z:e.z},r.push(n)}function s(e,t){void 0===n&&a(e),v.extruding?(n.vertex.push(e.x,e.y,e.z),n.vertex.push(t.x,t.y,t.z)):(n.pathVertex.push(e.x,e.y,e.z),n.pathVertex.push(t.x,t.y,t.z))}function c(e,r){return t.relative?r:r-e}function u(e,r){return t.relative?e+r:r}o.name="extruded";for(var h=e.replace(/;.+/g,"").split("\n"),d=0;d<h.length;d++){var f=h[d].split(" "),p=f[0].toUpperCase(),m={};if(f.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));m[t]=r}}),"G0"===p||"G1"===p){var v={x:void 0!==m.x?u(t.x,m.x):t.x,y:void 0!==m.y?u(t.y,m.y):t.y,z:void 0!==m.z?u(t.z,m.z):t.z,e:void 0!==m.e?u(t.e,m.e):t.e,f:void 0!==m.f?u(t.f,m.f):t.f};c(t.e,v.e)>0&&(v.extruding=c(t.e,v.e)>0,void 0!=n&&v.z==n.z||a(v)),s(t,v),t=v}else if("G2"===p||"G3"===p)console.warn("GCodeLoader: Arc command not supported");else if("G90"===p)t.relative=!1;else if("G91"===p)t.relative=!0;else if("G92"===p){(v=t).x=void 0!==m.x?m.x:v.x,v.y=void 0!==m.y?m.y:v.y,v.z=void 0!==m.z?m.z:v.z,v.e=void 0!==m.e?m.e:v.e,t=v}else console.warn("GCodeLoader: Command not supported:"+p)}function g(e,t){var r=new U;r.addAttribute("position",new N(e,3));var n=new Eo(r,t?o:i);n.name="layer"+d,y.add(n)}var y=new oo;if(y.name="gcode",this.splitLayer)for(d=0;d<r.length;d++){g((w=r[d]).vertex,!0),g(w.pathVertex,!1)}else{var b=[],x=[];for(d=0;d<r.length;d++){var w=r[d];b=b.concat(w.vertex),x=x.concat(w.pathVertex)}g(b,!0),g(x,!1)}return y.quaternion.setFromEuler(new l(-Math.PI/2,0,0)),y};var Vo={computeTangents:function(e){var t=e.index,r=e.attributes;if(null!==t&&void 0!==r.position&&void 0!==r.normal&&void 0!==r.uv){var n=t.array,i=r.position.array,o=r.normal.array,a=r.uv.array,c=i.length/3;void 0===r.tangent&&e.addAttribute("tangent",new M(new Float32Array(4*c),4));for(var u=r.tangent.array,l=[],h=[],d=0;d<c;d++)l[d]=new s,h[d]=new s;var f=new s,p=new s,m=new s,v=new x,g=new x,y=new x,b=new s,w=new s,_=e.groups;0===_.length&&(_=[{start:0,count:n.length}]);d=0;for(var S=_.length;d<S;++d)for(var T=D=(I=_[d]).start,A=D+I.count;T<A;T+=3)F(n[T+0],n[T+1],n[T+2]);var E,C,L,P=new s,O=new s,N=new s,R=new s;for(d=0,S=_.length;d<S;++d){var I,D;for(T=D=(I=_[d]).start,A=D+I.count;T<A;T+=3)U(n[T+0]),U(n[T+1]),U(n[T+2])}}else console.warn("BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function F(e,t,r){f.fromArray(i,3*e),p.fromArray(i,3*t),m.fromArray(i,3*r),v.fromArray(a,2*e),g.fromArray(a,2*t),y.fromArray(a,2*r);var n=p.x-f.x,o=m.x-f.x,s=p.y-f.y,c=m.y-f.y,u=p.z-f.z,d=m.z-f.z,x=g.x-v.x,_=y.x-v.x,S=g.y-v.y,M=y.y-v.y,T=1/(x*M-_*S);b.set((M*n-S*o)*T,(M*s-S*c)*T,(M*u-S*d)*T),w.set((x*o-_*n)*T,(x*c-_*s)*T,(x*d-_*u)*T),l[e].add(b),l[t].add(b),l[r].add(b),h[e].add(w),h[t].add(w),h[r].add(w)}function U(e){N.fromArray(o,3*e),R.copy(N),C=l[e],P.copy(C),P.sub(N.multiplyScalar(N.dot(C))).normalize(),O.crossVectors(R,C),L=O.dot(h[e]),E=L<0?-1:1,u[4*e]=P.x,u[4*e+1]=P.y,u[4*e+2]=P.z,u[4*e+3]=E}},mergeBufferGeometries:function(e,t){for(var r=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),o={},a={},s=new U,c=0,u=0;u<e.length;++u){var l=e[u];if(r!==(null!==l.index))return null;for(var h in l.attributes){if(!n.has(h))return null;void 0===o[h]&&(o[h]=[]),o[h].push(l.attributes[h])}for(var h in l.morphAttributes){if(!i.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(l.morphAttributes[h])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(l.userData),t){var d;if(r)d=l.index.count;else{if(void 0===l.attributes.position)return null;d=l.attributes.position.count}s.addGroup(c,d,u),c+=d}}if(r){var f=0,p=[];for(u=0;u<e.length;++u){for(var m=e[u].index,v=0;v<m.count;++v)p.push(m.getX(v)+f);f+=e[u].attributes.position.count}s.setIndex(p)}for(var h in o){var g=this.mergeBufferAttributes(o[h]);if(!g)return null;s.addAttribute(h,g)}for(var h in a){var y=a[h][0].length;if(0===y)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[h]=[];for(u=0;u<y;++u){var b=[];for(v=0;v<a[h].length;++v)b.push(a[h][v][u]);var x=this.mergeBufferAttributes(b);if(!x)return null;s.morphAttributes[h].push(x)}}return s},mergeBufferAttributes:function(e){for(var t,r,n,i=0,o=0;o<e.length;++o){var a=e[o];if(a.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return null;if(void 0===r&&(r=a.itemSize),r!==a.itemSize)return null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return null;i+=a.array.length}var s=new t(i),c=0;for(o=0;o<e.length;++o)s.set(e[o].array,c),c+=e[o].array.length;return new M(s,r,n)}},Go=function(){function e(e){this.manager=void 0!==e?e:cn,this.dracoLoader=null}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0!==this.path?this.path:Cn.extractUrlBase(e);i.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),i.manager.itemEnd(e),i.manager.itemError(e)},s=new ln(i.manager);s.setResponseType("arraybuffer"),s.load(e,function(r){try{i.parse(r,o,function(r){t(r),i.manager.itemEnd(e)},a)}catch(e){a(e)}},r,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,i,o,a){var f,p={};if("string"==typeof e)f=e;else if(Cn.decodeText(new Uint8Array(e,0,4))===c){try{p[t.KHR_BINARY_GLTF]=new function(e){this.name=t.KHR_BINARY_GLTF,this.content=null,this.body=null;var r=new DataView(e,0,u);if(this.header={magic:Cn.decodeText(new Uint8Array(e.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==c)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");var n=new DataView(e,u),i=0;for(;i<n.byteLength;){var o=n.getUint32(i,!0);i+=4;var a=n.getUint32(i,!0);if(i+=4,a===l.JSON){var s=new Uint8Array(e,u+i,o);this.content=Cn.decodeText(s)}else if(a===l.BIN){var h=u+i;this.body=e.slice(h,h+o)}i+=o}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}(e)}catch(e){return void(a&&a(e))}f=p[t.KHR_BINARY_GLTF].content}else f=Cn.decodeText(new Uint8Array(e));var m=JSON.parse(f);if(void 0===m.asset||m.asset.version[0]<2)a&&a(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var v=0;v<m.extensionsUsed.length;++v){var g=m.extensionsUsed[v],y=m.extensionsRequired||[];switch(g){case t.KHR_LIGHTS_PUNCTUAL:p[g]=new n(m);break;case t.KHR_MATERIALS_UNLIT:p[g]=new s(m);break;case t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:p[g]=new d;break;case t.KHR_DRACO_MESH_COMPRESSION:p[g]=new h(m,this.dracoLoader);break;case t.MSFT_TEXTURE_DDS:p[t.MSFT_TEXTURE_DDS]=new r;break;default:y.indexOf(g)>=0&&console.warn('GLTFLoader: Unknown extension "'+g+'".')}}var b=new X(m,p,{path:i||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager});b.parse(function(e,t,r,n,i){var a={scene:e,scenes:t,cameras:r,animations:n,asset:i.asset,parser:b,userData:{}};k(p,a,i),o(a)},a)}}};var t={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(){if(!No)throw new Error("GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=t.MSFT_TEXTURE_DDS,this.ddsLoader=new No}function n(e){this.name=t.KHR_LIGHTS_PUNCTUAL,this.lights=[];for(var r=(e.extensions&&e.extensions[t.KHR_LIGHTS_PUNCTUAL]||{}).lights||[],n=0;n<r.length;n++){var i,o=r[n],a=new v(16777215);void 0!==o.color&&a.fromArray(o.color);var s=void 0!==o.range?o.range:0;switch(o.type){case"directional":(i=new xo(a)).target.position.set(0,0,1),i.add(i.target);break;case"point":(i=new yo(a)).distance=s;break;case"spot":(i=new _o(a)).distance=s,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,1),i.add(i.target);break;default:throw new Error('GLTFLoader: Unexpected light type, "'+o.type+'".')}i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=o.name||"light_"+n,this.lights.push(i)}}function s(e){this.name=t.KHR_MATERIALS_UNLIT}s.prototype.getMaterialType=function(e){return cr},s.prototype.extendParams=function(e,t,r){var n=[];e.color=new v(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture.index))}return Promise.all(n)};var c="glTF",u=12,l={JSON:1313821514,BIN:5130562};function h(e,r){if(!r)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=t.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=r}function d(){return{name:t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return Xr},extendParams:function(e,t,r){var n=t.extensions[this.name],i=Li.standard,o=Hr.clone(i.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",l);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new v).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=h,e.uniforms=o,e.defines={STANDARD:""},e.color=new v(1,1,1),e.opacity=1;var d=[];if(Array.isArray(n.diffuseFactor)){var f=n.diffuseFactor;e.color.fromArray(f),e.opacity=f[3]}if(void 0!==n.diffuseTexture&&d.push(r.assignTexture(e,"map",n.diffuseTexture.index)),e.emissive=new v(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new v(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var p=n.specularGlossinessTexture.index;d.push(r.assignTexture(e,"glossinessMap",p)),d.push(r.assignTexture(e,"specularMap",p))}return Promise.all(d)},createMaterial:function(e){var t=new Xr({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,n=0,i=r.length;n<i;n++)t[r[n]]=e[r[n]];return t},refreshUniforms:function(e,t,r,n,i,o){if(!0===i.isGLTFSpecularGlossinessMaterial){var a,s=i.uniforms,c=i.defines;s.opacity.value=i.opacity,s.diffuse.value.copy(i.color),s.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),s.map.value=i.map,s.specularMap.value=i.specularMap,s.alphaMap.value=i.alphaMap,s.lightMap.value=i.lightMap,s.lightMapIntensity.value=i.lightMapIntensity,s.aoMap.value=i.aoMap,s.aoMapIntensity.value=i.aoMapIntensity,i.map?a=i.map:i.specularMap?a=i.specularMap:i.displacementMap?a=i.displacementMap:i.normalMap?a=i.normalMap:i.bumpMap?a=i.bumpMap:i.glossinessMap?a=i.glossinessMap:i.alphaMap?a=i.alphaMap:i.emissiveMap&&(a=i.emissiveMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),s.uvTransform.value.copy(a.matrix)),s.envMap.value=i.envMap,s.envMapIntensity.value=i.envMapIntensity,s.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,s.refractionRatio.value=i.refractionRatio,s.specular.value.copy(i.specular),s.glossiness.value=i.glossiness,s.glossinessMap.value=i.glossinessMap,s.emissiveMap.value=i.emissiveMap,s.bumpMap.value=i.bumpMap,s.normalMap.value=i.normalMap,s.displacementMap.value=i.displacementMap,s.displacementScale.value=i.displacementScale,s.displacementBias.value=i.displacementBias,null!==s.glossinessMap.value&&void 0===c.USE_GLOSSINESSMAP&&(c.USE_GLOSSINESSMAP="",c.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==c.USE_GLOSSINESSMAP&&(delete c.USE_GLOSSINESSMAP,delete c.USE_ROUGHNESSMAP)}}}}function f(e,t,r,n){vr.call(this,e,t,r,n)}h.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},c={};for(var u in o)u in L&&(a[L[u]]=o[u]);for(u in e.attributes)if(void 0!==L[u]&&void 0!==o[u]){var l=r.accessors[e.attributes[u]],h=T[l.componentType];c[L[u]]=h,s[L[u]]=!0===l.normalized}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)},a,c)})})},f.prototype=Object.create(vr.prototype),f.prototype.constructor=f,f.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,o=0;o!==n;o++)t[o]=r[i+o];return t},f.prototype.beforeStart_=f.prototype.copySampleValue_,f.prototype.afterEnd_=f.prototype.copySampleValue_,f.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,c=3*a,u=n-t,l=(r-t)/u,h=l*l,d=h*l,f=e*c,p=f-c,m=2*d-3*h+1,v=d-2*h+l,g=-2*d+3*h,y=d-h,b=0;b!==a;b++){var x=o[p+b+a],w=o[p+b+s]*u,_=o[f+b+a],S=o[f+b]*u;i[b]=m*x+v*w+g*_+y*S}return i};var m=0,g=1,y=2,b=3,w=4,_=5,S=6,T={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},A={9728:Ye,9729:Ze,9984:Je,9985:Ke,9986:Qe,9987:$e},E={33071:Xe,33648:qe,10497:He},C={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},P={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},O={CUBICSPLINE:2302,LINEAR:2301,STEP:Wt},N="OPAQUE",R="MASK",I="BLEND",D={"image/png":pt,"image/jpeg":ft};function F(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function k(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function B(e,t){void 0!==t.extras&&("object"==typeof t.extras?e.userData=t.extras:console.warn("GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function z(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function j(e,t){return e.indices===t.indices&&V(e.attributes,t.attributes)}function V(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(e[r]!==t[r])return!1;return!0}function G(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function W(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r];if(j(i.primitive,t))return i.promise}return null}function H(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,n=e.array.slice(0,t*r),i=0;i<t;++i)n[i]=e.getX(i),r>=2&&(n[i+1]=e.getY(i)),r>=3&&(n[i+2]=e.getZ(i)),r>=4&&(n[i+3]=e.getW(i));return new M(n,r,e.normalized)}return e.clone()}function X(e,t,r){this.json=e||{},this.extensions=t||{},this.options=r||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}},this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new An(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new ln(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function Y(e,t,r){var n=t.attributes;for(var i in n){var o=L[i],a=r[n[i]];o&&(o in e.attributes||e.addAttribute(o,a))}void 0===t.indices||e.index||e.setIndex(r[t.indices]),void 0!==t.targets&&function(e,t,r){for(var n=!1,i=!1,o=0,a=t.length;o<a&&(void 0!==(u=t[o]).POSITION&&(n=!0),void 0!==u.NORMAL&&(i=!0),!n||!i);o++);if(n||i){var s=[],c=[];for(o=0,a=t.length;o<a;o++){var u=t[o],l="morphTarget"+o;if(n){if(void 0!==u.POSITION){var h=H(r[u.POSITION]);h.name=l;for(var d=e.attributes.position,f=0,p=h.count;f<p;f++)h.setXYZ(f,h.getX(f)+d.getX(f),h.getY(f)+d.getY(f),h.getZ(f)+d.getZ(f))}else h=e.attributes.position;s.push(h)}if(i){if(void 0!==u.NORMAL){var m;(m=H(r[u.NORMAL])).name=l;var v=e.attributes.normal;for(f=0,p=m.count;f<p;f++)m.setXYZ(f,m.getX(f)+v.getX(f),m.getY(f)+v.getY(f),m.getZ(f)+v.getZ(f))}else m=e.attributes.normal;c.push(m)}}n&&(e.morphAttributes.position=s),i&&(e.morphAttributes.normal=c)}}(e,t.targets,r),B(e,t)}return X.prototype.parse=function(e,t){var r=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var n=t.scenes||[],i=n[r.scene||0],o=t.animations||[],a=t.cameras||[];e(i,n,a,o,r)}).catch(t)},X.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},i={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,c=0,u=s.length;c<u;c++)e[s[c]].isBone=!0;for(var l=0,h=e.length;l<h;l++){var d=e[l];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=i[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=i},X.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},X.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},X.prototype.getMultiDependencies=function(e){for(var t={},r=[],n=0,i=e.length;n<i;n++){var o=e[n],a=this.getDependencies(o);a=a.then(function(e,r){t[e]=r}.bind(this,o+("mesh"===o?"es":"s"))),r.push(a)}return Promise.all(r).then(function(){return t})},X.prototype.loadBuffer=function(e){var r=this.json.buffers[e],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===e)return Promise.resolve(this.extensions[t.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,t){n.load(F(r.uri,i.path),e,void 0,function(){t(new Error('GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},X.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},X.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return null;var i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){var i,o=e[0],a=C[n.type],s=T[n.componentType],c=s.BYTES_PER_ELEMENT,u=c*a,l=n.byteOffset||0,h=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;if(h&&h!==u){var f="InterleavedBuffer:"+n.bufferView+":"+n.componentType,p=t.cache.get(f);p||(p=new Yi(new s(o),h/c),t.cache.add(f,p)),i=new Qi(p,a,l/c,d)}else i=new M(null===o?new s(n.count*a):new s(o,l,n.count*a),a,d);if(void 0!==n.sparse){var m=C.SCALAR,v=T[n.sparse.indices.componentType],g=n.sparse.indices.byteOffset||0,y=n.sparse.values.byteOffset||0,b=new v(e[1],g,n.sparse.count*m),x=new s(e[2],y,n.sparse.count*a);null!==o&&i.setArray(i.array.slice());for(var w=0,_=b.length;w<_;w++){var S=b[w];if(i.setX(S,x[w*a]),a>=2&&i.setY(S,x[w*a+1]),a>=3&&i.setZ(S,x[w*a+2]),a>=4&&i.setW(S,x[w*a+3]),a>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},X.prototype.loadTexture=function(e){var r,n=this,o=this.json,a=this.options,s=this.textureLoader,c=i.URL||i.webkitURL,u=o.textures[e],l=u.extensions||{},h=(r=l[t.MSFT_TEXTURE_DDS]?o.images[l[t.MSFT_TEXTURE_DDS].source]:o.images[u.source]).uri,d=!1;return void 0!==r.bufferView&&(h=n.getDependency("bufferView",r.bufferView).then(function(e){d=!0;var t=new Blob([e],{type:r.mimeType});return h=c.createObjectURL(t)})),Promise.resolve(h).then(function(e){var r=En.Handlers.get(e);return r||(r=l[t.MSFT_TEXTURE_DDS]?n.extensions[t.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise(function(t,n){r.load(F(e,a.path),t,void 0,n)})}).then(function(e){!0===d&&c.revokeObjectURL(h),e.flipY=!1,void 0!==u.name&&(e.name=u.name),r.mimeType in D&&(e.format=D[r.mimeType]);var t=(o.samplers||{})[u.sampler]||{};return e.magFilter=A[t.magFilter]||Ze,e.minFilter=A[t.minFilter]||$e,e.wrapS=E[t.wrapS]||He,e.wrapT=E[t.wrapT]||He,e})},X.prototype.assignTexture=function(e,t,r){return this.getDependency("texture",r).then(function(r){e[t]=r})},X.prototype.loadMaterial=function(e){var r,n=this.json,i=this.extensions,o=n.materials[e],a={},s=o.extensions||{},c=[];if(s[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=u.getMaterialType(o),c.push(u.extendParams(a,o,this))}else if(s[t.KHR_MATERIALS_UNLIT]){var l=i[t.KHR_MATERIALS_UNLIT];r=l.getMaterialType(o),c.push(l.extendParams(a,o,this))}else{r=gn;var h=o.pbrMetallicRoughness||{};if(a.color=new v(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){var d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}if(void 0!==h.baseColorTexture&&c.push(this.assignTexture(a,"map",h.baseColorTexture.index)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture){var f=h.metallicRoughnessTexture.index;c.push(this.assignTexture(a,"metalnessMap",f)),c.push(this.assignTexture(a,"roughnessMap",f))}}!0===o.doubleSided&&(a.side=J);var p=o.alphaMode||N;return p===I?a.transparent=!0:(a.transparent=!1,p===R&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&r!==cr&&(c.push(this.assignTexture(a,"normalMap",o.normalTexture.index)),a.normalScale=new x(1,1),void 0!==o.normalTexture.scale&&a.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&r!==cr&&(c.push(this.assignTexture(a,"aoMap",o.occlusionTexture.index)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&r!==cr&&(a.emissive=(new v).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&r!==cr&&c.push(this.assignTexture(a,"emissiveMap",o.emissiveTexture.index)),Promise.all(c).then(function(){var e;return e=r===Xr?i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new r(a),void 0!==o.name&&(e.name=o.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=Qt),e.emissiveMap&&(e.emissiveMap.encoding=Qt),e.specularMap&&(e.specularMap.encoding=Qt),B(e,o),o.extensions&&k(i,e,o),e})},X.prototype.loadGeometries=function(e){var r,n=this,i=this.extensions,o=this.primitiveCache,a=function(e){if(e.length<2)return!1;var t=e[0],r=t.targets||[];if(void 0===t.indices)return!1;for(var n=1,i=e.length;n<i;n++){var o=e[n];if(t.mode!==o.mode)return!1;if(void 0===o.indices)return!1;if(!V(t.attributes,o.attributes))return!1;var a=o.targets||[];if(r.length!==a.length)return!1;for(var s=0,c=r.length;s<c;s++)if(!V(r[s],a[s]))return!1}return!0}(e);return a&&(r=e,e=[e[0]]),this.getDependencies("accessor").then(function(s){for(var c=[],u=0,l=e.length;u<l;u++){var h=e[u],d=W(o,h);if(d)c.push(d);else if(h.extensions&&h.extensions[t.KHR_DRACO_MESH_COMPRESSION]){var f=i[t.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(h,n).then(function(e){return Y(e,h,s),e});o.push({primitive:h,promise:f}),c.push(f)}else{var p=new U;Y(p,h,s);f=Promise.resolve(p);o.push({primitive:h,promise:f}),c.push(f)}}return Promise.all(c).then(function(t){if(a){var i=t[0];if(null!==(g=function(e,t,r){for(var n=0,i=e.length;n<i;n++){var o=e[n];if(t===o.baseGeometry&&G(r,o.primitives))return o.geometry}return null}(v=n.multiPassGeometryCache,i,r)))return[g.geometry];var o=new U;for(var c in o.name=i.name,o.userData=i.userData,i.attributes)o.addAttribute(c,i.attributes[c]);for(var c in i.morphAttributes)o.morphAttributes[c]=i.morphAttributes[c];for(var u=[],l=0,h=0,d=r.length;h<d;h++){for(var f=s[r[h].indices],p=0,m=f.count;p<m;p++)u.push(f.array[p]);o.addGroup(l,f.count,h),l+=f.count}return o.setIndex(u),v.push({geometry:o,baseGeometry:i,primitives:r}),[o]}if(t.length>1&&void 0!==Vo){for(h=1,d=e.length;h<d;h++)if(e[0].mode!==e[h].mode)return t;var v,g;if(g=function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r];if(G(t,i.baseGeometries))return i.geometry}return null}(v=n.multiplePrimitivesCache,t)){if(null!==g.geometry)return[g.geometry]}else{o=Vo.mergeBufferGeometries(t,!0);if(v.push({geometry:o,baseGeometries:t}),null!==o)return[o]}}return t})})},X.prototype.loadMesh=function(e){var r=this,n=this.json,i=this.extensions,o=n.meshes[e];return this.getMultiDependencies(["accessor","material"]).then(function(n){for(var a=o.primitives,s=[],c=0,u=a.length;c<u;c++)s[c]=void 0===a[c].material?new gn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:q}):n.materials[a[c].material];return r.loadGeometries(a).then(function(n){for(var c=1===n.length&&n[0].groups.length>0,u=[],l=0,h=n.length;l<h;l++){var d,f=n[l],p=a[l],v=c?s:s[l];if(p.mode===w||p.mode===_||p.mode===S||void 0===p.mode)d=!0===o.isSkinnedMesh?new lo(f,v):new dr(f,v),p.mode===_?d.drawMode=qt:p.mode===S&&(d.drawMode=Yt);else if(p.mode===g)d=new Eo(f,v);else if(p.mode===b)d=new fr(f,v);else if(p.mode===y)d=new Ro(f,v);else{if(p.mode!==m)throw new Error("GLTFLoader: Primitive mode unsupported: "+p.mode);d=new Gi(f,v)}Object.keys(d.geometry.morphAttributes).length>0&&z(d,o),d.name=o.name||"mesh_"+e,n.length>1&&(d.name+="_"+l),B(d,o),u.push(d);for(var x=c?d.material:[d.material],T=void 0!==f.attributes.color,A=void 0===f.attributes.normal,E=!0===d.isSkinnedMesh,C=Object.keys(f.morphAttributes).length>0,L=C&&void 0!==f.morphAttributes.normal,P=0,O=x.length;P<O;P++){v=x[P];if(d.isPoints){var N="PointsMaterial:"+v.uuid,R=r.cache.get(N);R||(R=new xn,sr.prototype.copy.call(R,v),R.color.copy(v.color),R.map=v.map,R.lights=!1,r.cache.add(N,R)),v=R}else if(d.isLine){N="LineBasicMaterial:"+v.uuid;var I=r.cache.get(N);I||(I=new ur,sr.prototype.copy.call(I,v),I.color.copy(v.color),I.lights=!1,r.cache.add(N,I)),v=I}if(T||A||E||C){N="ClonedMaterial:"+v.uuid+":";v.isGLTFSpecularGlossinessMaterial&&(N+="specular-glossiness:"),E&&(N+="skinning:"),T&&(N+="vertex-colors:"),A&&(N+="flat-shading:"),C&&(N+="morph-targets:"),L&&(N+="morph-normals:");var D=r.cache.get(N);D||(D=v.isGLTFSpecularGlossinessMaterial?i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(v):v.clone(),E&&(D.skinning=!0),T&&(D.vertexColors=K),A&&(D.flatShading=!0),C&&(D.morphTargets=!0),L&&(D.morphNormals=!0),r.cache.add(N,D)),v=D}x[P]=v,v.aoMap&&void 0===f.attributes.uv2&&void 0!==f.attributes.uv&&(console.log("GLTFLoader: Duplicating UVs to support aoMap."),f.addAttribute("uv2",new M(f.attributes.uv.array,2))),v.isGLTFSpecularGlossinessMaterial&&(d.onBeforeRender=i[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}d.material=c?x:x[0]}if(1===u.length)return u[0];var F=new oo;for(l=0,h=u.length;l<h;l++)F.add(u[l]);return F})})},X.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new Wr(o.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new Yr(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),B(t,r),Promise.resolve(t);console.warn("GLTFLoader: Missing camera parameters.")},X.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},X.prototype.loadAnimation=function(e){var t=this.json.animations[e];return this.getMultiDependencies(["accessor","node"]).then(function(r){for(var n=[],i=0,o=t.channels.length;i<o;i++){var a=t.channels[i],s=t.samplers[a.sampler];if(s){var c=a.target,u=void 0!==c.node?c.node:c.id,l=void 0!==t.parameters?t.parameters[s.input]:s.input,h=void 0!==t.parameters?t.parameters[s.output]:s.output,d=r.accessors[l],p=r.accessors[h],m=r.nodes[u];if(m){var v;switch(m.updateMatrix(),m.matrixAutoUpdate=!0,P[c.path]){case P.weights:v=Er;break;case P.rotation:v=Lr;break;case P.position:case P.scale:default:v=Or}var g=m.name?m.name:m.uuid,y=void 0!==s.interpolation?O[s.interpolation]:2301,b=[];P[c.path]===P.weights?m.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&b.push(e.name?e.name:e.uuid)}):b.push(g);for(var x=0,w=b.length;x<w;x++){var _=new v(b[x]+"."+P[c.path],wr.arraySlice(d.array,0),wr.arraySlice(p.array,0),y);"CUBICSPLINE"===s.interpolation&&(_.createInterpolant=function(e){return new f(this.times,this.values,this.getValueSize()/3,e)},_.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),n.push(_)}}}}return new Nr(u=void 0!==t.name?t.name:"animation_"+e,void 0,n)})},X.prototype.loadNode=function(e){var r=this.json,n=this.extensions,i=r.meshReferences,o=r.meshUses,s=r.nodes[e];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(e){var r;if(!0===s.isBone)r=new Dr;else if(void 0!==s.mesh){var c=e.meshes[s.mesh];if(i[s.mesh]>1){var u=o[s.mesh]++;(r=c.clone()).name+="_instance_"+u,r.onBeforeRender=c.onBeforeRender;for(var l=0,h=r.children.length;l<h;l++)r.children[l].name+="_instance_"+u,r.children[l].onBeforeRender=c.children[l].onBeforeRender}else r=c}else if(void 0!==s.camera)r=e.cameras[s.camera];else if(s.extensions&&s.extensions[t.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[t.KHR_LIGHTS_PUNCTUAL].light){r=n[t.KHR_LIGHTS_PUNCTUAL].lights[s.extensions[t.KHR_LIGHTS_PUNCTUAL].light]}else r=new p;if(void 0!==s.name&&(r.name=br.sanitizeNodeName(s.name)),B(r,s),s.extensions&&k(n,r,s),void 0!==s.matrix){var d=new a;d.fromArray(s.matrix),r.applyMatrix(d)}else void 0!==s.translation&&r.position.fromArray(s.translation),void 0!==s.rotation&&r.quaternion.fromArray(s.rotation),void 0!==s.scale&&r.scale.fromArray(s.scale);return r})},X.prototype.loadScene=function(){function e(t,r,n,i,o){var s=i[t],c=n.nodes[t];if(void 0!==c.skin)for(var u=!0===s.isGroup?s.children:[s],l=0,h=u.length;l<h;l++){for(var d=u[l],f=o[c.skin],p=[],m=[],v=0,g=f.joints.length;v<g;v++){var y=f.joints[v],b=i[y];if(b){p.push(b);var x=new a;void 0!==f.inverseBindMatrices&&x.fromArray(f.inverseBindMatrices.array,16*v),m.push(x)}else console.warn('GLTFLoader: Joint "%s" could not be found.',y)}d.bind(new uo(p,m),d.matrixWorld)}if(r.add(s),c.children){var w=c.children;for(l=0,h=w.length;l<h;l++){e(w[l],s,n,i,o)}}}return function(t){var r=this.json,n=this.extensions,i=this.json.scenes[t];return this.getMultiDependencies(["node","skin"]).then(function(t){var o=new qr;void 0!==i.name&&(o.name=i.name),B(o,i),i.extensions&&k(n,o,i);for(var a=i.nodes||[],s=0,c=a.length;s<c;s++)e(a[s],o,r,t.nodes,t.skins);return o})}}(),e}(),Wo=function(e){this.manager=void 0!==e?e:cn};(Wo.prototype=Object.create(ko.prototype))._parser=function(e){var t=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var n=e.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));0>(i=s.indexOf("\n"))&&o<t&&n<e.byteLength;)a+=s,o+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<i&&(!1!==r&&(e.pos+=o+i+1),a+s.slice(0,i))},n=new Uint8Array(e);n.pos=0;var i=function(e){var n,i,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,c=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=r(e)))return t(1,"no header found");if(!(i=n.match(/^#\?(\S+)$/)))return t(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=n+"\n";!1!==(n=r(e));)if(u.string+=n+"\n","#"!==n.charAt(0)){if((i=n.match(o))&&(u.gamma=parseFloat(i[1],10)),(i=n.match(a))&&(u.exposure=parseFloat(i[1],10)),(i=n.match(s))&&(u.valid|=2,u.format=i[1]),(i=n.match(c))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=n+"\n";return 2&u.valid?4&u.valid?u:t(3,"missing image size specifier"):t(3,"missing format specifier")}(n);if(-1!==i){var o=i.width,a=i.height,s=function(e,r,n){var i,o,a,s,c,u,l,h,d,f,p,m,v,g=r,y=n;if(g<8||g>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(i=new Uint8Array(4*r*n))||!i.length)return t(4,"unable to allocate buffer space");for(o=0,a=0,h=4*g,v=new Uint8Array(4),u=new Uint8Array(h);y>0&&a<e.byteLength;){if(a+4>e.byteLength)return t(1);if(v[0]=e[a++],v[1]=e[a++],v[2]=e[a++],v[3]=e[a++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return t(3,"bad rgbe scanline format");for(l=0;l<h&&a<e.byteLength;){if((m=(s=e[a++])>128)&&(s-=128),0===s||l+s>h)return t(3,"bad scanline data");if(m)for(c=e[a++],d=0;d<s;d++)u[l++]=c;else u.set(e.subarray(a,a+s),l),l+=s,a+=s}for(f=g,d=0;d<f;d++)p=0,i[o]=u[d+p],p+=g,i[o+1]=u[d+p],p+=g,i[o+2]=u[d+p],p+=g,i[o+3]=u[d+p],o+=4;y--}return i}(n.subarray(n.pos),o,a);if(-1!==s)return{width:o,height:a,data:s,header:i.string,gamma:i.gamma,exposure:i.exposure,format:gt,type:et}}return null};var Ho=Wo;function Xo(e,t,r,n,i,o,a,s,c,u){e=void 0!==e?e:[],t=void 0!==t?t:ke,Zr.call(this,e,t,r,n,i,o,a,s,c,u),this.flipY=!1}Xo.prototype=Object.create(Zr.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isCubeTexture=!0,Object.defineProperty(Xo.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var qo=function(e){this.manager=void 0!==e?e:cn,this.hdrLoader=new Wo};qo.prototype.load=function(e,t,r,n,i){var o=function(e,t,r,n){var i=e[t+3],o=Math.pow(2,i-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o},a=function(){var e=new Float32Array(1),t=new Int32Array(e.buffer);function r(r){e[0]=r;var n=t[0],i=n>>16&32768,o=n>>12&2047,a=n>>23&255;return a<103?i:a>142?(i|=31744,i|=(255==a?0:1)&&8388607&n):a<113?i|=((o|=2048)>>114-a)+(o>>113-a&1):(i|=a-112<<10|o>>1,i+=1&o)}return function(e,t,n,i){var o=e[t+3],a=Math.pow(2,o-128)/255;n[i+0]=r(e[t+0]*a),n[i+1]=r(e[t+1]*a),n[i+2]=r(e[t+2]*a)}}(),s=new Xo;s.type=e,s.encoding=e===et?Kt:Jt,s.format=e===et?pt:ft,s.minFilter=s.encoding===Kt?Ye:Ze,s.magFilter=s.encoding===Kt?Ye:Ze,s.generateMipmaps=s.encoding!==Kt,s.anisotropy=0;var c=this.hdrLoader,u=0;function l(r,n,i,l){var h=new ln(c.manager);h.setResponseType("arraybuffer"),h.load(t[r],function(t){u++;var i=c._parser(t);if(i){if(e===at){for(var l=i.data.length/4*3,h=new Float32Array(l),d=0;d<l;d++)o(i.data,4*d,h,3*d);i.data=h}else if(e===st){l=i.data.length/4*3;var f=new Uint16Array(l);for(d=0;d<l;d++)a(i.data,4*d,f,3*d);i.data=f}if(void 0!==i.image)s[r].images=i.image;else if(void 0!==i.data){var p=new Vi(i.data,i.width,i.height);p.format=s.format,p.type=s.type,p.encoding=s.encoding,p.minFilter=s.minFilter,p.magFilter=s.magFilter,p.generateMipmaps=s.generateMipmaps,s.images[r]=p}6===u&&(s.needsUpdate=!0,n&&n(s))}},i,l)}for(var h=0;h<t.length;h++)l(h,r,n,i);return s};var Yo=function(e){this.manager=void 0!==e?e:cn};Yo.prototype={constructor:Yo,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){var t=new sn;t.setURLModifier(function(e){var t=function(e){for(var t in r.files)if(t.substr(-e.length)===e)return r.files[t]}(e);if(t){console.log("Loading",e);var n=new Blob([t.asArrayBuffer()],{type:"application/octet-stream"});return URL.createObjectURL(n)}return e});var r=new JSZip(e);if(r.files["doc.kml"]){var n=(new DOMParser).parseFromString(r.files["doc.kml"].asText(),"application/xml").querySelector("Placemark Model Link href");if(n)return new Lo(t).parse(r.files[n.textContent].asText())}else for(var i in console.warn("KMZLoader: Missing doc.kml file."),r.files){if("dae"===i.split(".").pop().toLowerCase())return new Lo(t).parse(r.files[i].asText())}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new oo}}};var Jo=function(e){Oo.call(this,e),this._parser=Jo.parse};Jo.prototype=Object.create(Oo.prototype),Jo.prototype.constructor=Jo,Jo.parse=function(e,t){var r=new Qo(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}};var Qo=function(){function e(t,r,n,i){this.arrayBuffer=t;var o=new Uint8Array(this.arrayBuffer,0,12);if(171===o[0]&&75===o[1]&&84===o[2]&&88===o[3]&&32===o[4]&&49===o[5]&&49===o[6]&&187===o[7]&&13===o[8]&&10===o[9]&&26===o[10]&&10===o[11]){var a=new Int32Array(this.arrayBuffer,12,13),s=16909060===a[0];this.glType=s?this.switchEndainness(a[1]):a[1],this.glTypeSize=s?this.switchEndainness(a[2]):a[2],this.glFormat=s?this.switchEndainness(a[3]):a[3],this.glInternalFormat=s?this.switchEndainness(a[4]):a[4],this.glBaseInternalFormat=s?this.switchEndainness(a[5]):a[5],this.pixelWidth=s?this.switchEndainness(a[6]):a[6],this.pixelHeight=s?this.switchEndainness(a[7]):a[7],this.pixelDepth=s?this.switchEndainness(a[8]):a[8],this.numberOfArrayElements=s?this.switchEndainness(a[9]):a[9],this.numberOfFaces=s?this.switchEndainness(a[10]):a[10],this.numberOfMipmapLevels=s?this.switchEndainness(a[11]):a[11],this.bytesOfKeyValueData=s?this.switchEndainness(a[12]):a[12],0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===r?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.switchEndainness=function(e){return(255&e)<<24|(65280&e)<<8|e>>8&65280|e>>24&255},e.prototype.mipmaps=function(t){for(var r=[],n=e.HEADER_LEN+this.bytesOfKeyValueData,i=this.pixelWidth,o=this.pixelHeight,a=t?this.numberOfMipmapLevels:1,s=0;s<a;s++){for(var c=new Int32Array(this.arrayBuffer,n,1)[0],u=0;u<this.numberOfFaces;u++){var l=new Uint8Array(this.arrayBuffer,n+4,c);r.push({data:l,width:i,height:o}),n+=c+4,n+=3-(c+3)%4}i=Math.max(1,.5*i),o=Math.max(1,.5*o)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}(),Zo={Validator:{isValid:function(e){return null!==e&&void 0!==e},verifyInput:function(e,t){return null===e||void 0===e?t:e}}};Zo.Callbacks=function(){var e=Zo.Validator;function t(){this.onProgress=null,this.onReportError=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null}return t.prototype.setCallbackOnProgress=function(t){this.onProgress=e.verifyInput(t,this.onProgress)},t.prototype.setCallbackOnReportError=function(t){this.onReportError=e.verifyInput(t,this.onReportError)},t.prototype.setCallbackOnMeshAlter=function(t){this.onMeshAlter=e.verifyInput(t,this.onMeshAlter)},t.prototype.setCallbackOnLoad=function(t){this.onLoad=e.verifyInput(t,this.onLoad)},t.prototype.setCallbackOnLoadMaterials=function(t){this.onLoadMaterials=e.verifyInput(t,this.onLoadMaterials)},t}(),Zo.LoadedMeshUserOverride=function(){function e(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]}return e.prototype.addMesh=function(e){this.meshes.push(e),this.alteredMesh=!0},e.prototype.isDisregardMesh=function(){return this.disregardMesh},e.prototype.providesAlteredMeshes=function(){return this.alteredMesh},e}(),Zo.ResourceDescriptor=function(){var e=Zo.Validator;function t(t,r){var n=t.split("/");n.length<2?(this.path=null,this.name=t,this.url=t):(this.path=e.verifyInput(n.slice(0,n.length-1).join("/")+"/",null),this.name=n[n.length-1],this.url=t),this.name=e.verifyInput(this.name,"Unnamed_Resource"),this.extension=e.verifyInput(r,"default"),this.extension=this.extension.trim(),this.content=null}return t.prototype.setContent=function(t){this.content=e.verifyInput(t,null)},t}(),Zo.PrepData=function(){var e=Zo.Validator;function t(t){this.logging={enabled:!0,debug:!1},this.modelName=e.verifyInput(t,""),this.resources=[],this.callbacks=new Zo.Callbacks}return t.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},t.prototype.getCallbacks=function(){return this.callbacks},t.prototype.addResource=function(e){this.resources.push(e)},t.prototype.clone=function(){var e,t,r=new Zo.PrepData(this.modelName);for(e in r.logging.enabled=this.logging.enabled,r.logging.debug=this.logging.debug,r.resources=this.resources,r.callbacks=this.callbacks,this)t=this[e],r.hasOwnProperty(e)||"function"==typeof this[e]||(r[e]=t);return r},t.prototype.checkResourceDescriptorFiles=function(t,r){var n,i,o,a,s={};for(var c in t)if(n=t[c],a=!1,e.isValid(n.name))if(e.isValid(n.content)){for(o=0;o<r.length&&!a;o++)if(i=r[o],n.extension.toLowerCase()===i.ext.toLowerCase())if(i.ignore)a=!0;else if("ArrayBuffer"===i.type){if(!(n.content instanceof ArrayBuffer||n.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";s[i.ext]=n,a=!0}else if("String"===i.type){if(!("string"==typeof n.content||n.content instanceof String))throw"Provided  content is not of type String! Aborting...";s[i.ext]=n,a=!0}if(!a)throw'Unidentified resource "'+n.name+'": '+n.url}else{if(!("string"==typeof n.name||n.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(o=0;o<r.length&&!a;o++)i=r[o],n.extension.toLowerCase()===i.ext.toLowerCase()&&(i.ignore||(s[i.ext]=n),a=!0);if(!a)throw'Unidentified resource "'+n.name+'": '+n.url}return s},t}(),Zo.MeshBuilder=function(){var e="1.2.2",t=Zo.Validator;function r(){console.info("Using LoaderSupport.MeshBuilder version: "+e),this.logging={enabled:!0,debug:!1},this.callbacks=new Zo.Callbacks,this.materials=[]}return r.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},r.prototype.init=function(){var e=new gn({color:14479871});e.name="defaultMaterial";var t=new gn({color:14479871});t.name="defaultVertexColorMaterial",t.vertexColors=K;var r=new ur;r.name="defaultLineMaterial";var n=new xn({size:1});n.name="defaultPointMaterial";var i={};i[e.name]=e,i[t.name]=t,i[r.name]=r,i[n.name]=n,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},r.prototype.setMaterials=function(e){var r={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:t.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(e):e}};this.updateMaterials(r)},r.prototype._setCallbacks=function(e){t.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),t.isValid(e.onReportError)&&this.callbacks.setCallbackOnReportError(e.onReportError),t.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),t.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),t.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials)},r.prototype.processPayload=function(e){return"meshData"===e.cmd?this.buildMeshes(e):"materialData"===e.cmd?(this.updateMaterials(e),null):void 0},r.prototype.buildMeshes=function(e){var r,n,i,o=e.params.meshName,a=new U;a.addAttribute("position",new M(new Float32Array(e.buffers.vertices),3)),t.isValid(e.buffers.indices)&&a.setIndex(new M(new Uint32Array(e.buffers.indices),1)),t.isValid(e.buffers.colors)&&a.addAttribute("color",new M(new Float32Array(e.buffers.colors),3)),t.isValid(e.buffers.normals)?a.addAttribute("normal",new M(new Float32Array(e.buffers.normals),3)):a.computeVertexNormals(),t.isValid(e.buffers.uvs)&&a.addAttribute("uv",new M(new Float32Array(e.buffers.uvs),2));var s=e.materials.materialNames,c=e.materials.multiMaterial,u=[];for(i in s)n=s[i],r=this.materials[n],c&&u.push(r);if(c){r=u;var l,h=e.materials.materialGroups;for(i in h)l=h[i],a.addGroup(l.start,l.count,l.index)}var d,f,p,m=[],v=this.callbacks.onMeshAlter,g=!0,y=t.verifyInput(e.geometryType,0);if(t.isValid(v)&&(f=v({detail:{meshName:o,bufferGeometry:a,material:r,geometryType:y}}),t.isValid(f)))if(f.isDisregardMesh())g=!1;else if(f.providesAlteredMeshes()){for(var b in f.meshes)m.push(f.meshes[b]);g=!1}if(g&&(e.computeBoundingSphere&&a.computeBoundingSphere(),(d=0===y?new dr(a,r):1===y?new Eo(a,r):new Gi(a,r)).name=o,m.push(d)),t.isValid(m)&&m.length>0){var x=[];for(var b in m)d=m[b],x[b]=d.name;p="Adding mesh(es) ("+x.length+": "+x+") from input mesh: "+o,p+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else p="Not adding mesh: "+o,p+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";var w=this.callbacks.onProgress;t.isValid(w)&&w(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:e.params.meshName,text:p,numericalValue:e.progress.numericalValue}}));return m},r.prototype.updateMaterials=function(e){var r,n,i=e.materials.materialCloneInstructions;if(t.isValid(i)){var o=i.materialNameOrg,a=this.materials[o];if(t.isValid(o)){r=a.clone(),n=i.materialName,r.name=n;var s=i.materialProperties;for(var c in s)r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&(r[c]=s[c]);this.materials[n]=r}else console.warn('Requested material "'+o+'" is not available!')}var u=e.materials.serializedMaterials;if(t.isValid(u)&&Object.keys(u).length>0){var l,h=new Mn;for(n in u)l=u[n],t.isValid(l)&&(r=h.parse(l),this.logging.enabled&&console.info('De-serialized material with name "'+n+'" will be added.'),this.materials[n]=r)}if(u=e.materials.runtimeMaterials,t.isValid(u)&&Object.keys(u).length>0)for(n in u)r=u[n],this.logging.enabled&&console.info('Material with name "'+n+'" will be added.'),this.materials[n]=r},r.prototype.getMaterialsJSON=function(){var e,t={};for(var r in this.materials)e=this.materials[r],t[r]=e.toJSON();return t},r.prototype.getMaterials=function(){return this.materials},r}(),Zo.WorkerRunnerRefImpl=function(){function e(){var e=this;self.addEventListener("message",function(t){e.processMessage(t.data)},!1)}return e.prototype.applyProperties=function(e,t){var r,n,i;for(r in t)n="set"+r.substring(0,1).toLocaleUpperCase()+r.substring(1),i=t[r],"function"==typeof e[n]?e[n](i):e.hasOwnProperty(r)&&(e[r]=i)},e.prototype.processMessage=function(e){if("run"===e.cmd){var t={callbackMeshBuilder:function(e){self.postMessage(e)},callbackProgress:function(t){e.logging.enabled&&e.logging.debug&&console.debug("WorkerRunner: progress: "+t)}},r=new Parser;"function"==typeof r.setLogging&&r.setLogging(e.logging.enabled,e.logging.debug),this.applyProperties(r,e.params),this.applyProperties(r,e.materials),this.applyProperties(r,t),r.workerScope=self,r.parse(e.data.input,e.data.options),e.logging.enabled&&console.log("WorkerRunner: Run complete!"),t.callbackMeshBuilder({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)},e}(),Zo.WorkerSupport=function(){var e="2.2.1",t=Zo.Validator,r=function(){function e(){this._reset()}return e.prototype._reset=function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.setForceCopy=function(e){this.forceCopy=!0===e},e.prototype.initWorker=function(e,t){this.runnerImplName=t;var r=new Blob([e],{type:"application/javascript"});this.worker=new Worker(i.URL.createObjectURL(r)),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},e.prototype._receiveWorkerMessage=function(e){var t=e.data;switch(t.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(t);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+t.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+t.cmd)}},e.prototype.setCallbacks=function(e,r){this.callbacks.meshBuilder=t.verifyInput(e,this.callbacks.meshBuilder),this.callbacks.onLoad=t.verifyInput(r,this.callbacks.onLoad)},e.prototype.run=function(e){if(t.isValid(this.queuedMessage))console.warn("Already processing message. Rejecting new run instruction");else{if(this.queuedMessage=e,this.started=!0,!t.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!t.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==e.cmd&&(e.cmd="run"),t.isValid(e.logging)?(e.logging.enabled=!0===e.logging.enabled,e.logging.debug=!0===e.logging.debug):e.logging={enabled:!0,debug:!1},this._postMessage()}},e.prototype._postMessage=function(){var e;t.isValid(this.queuedMessage)&&t.isValid(this.worker)&&(this.queuedMessage.data.input instanceof ArrayBuffer?(e=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[e])):this.worker.postMessage(this.queuedMessage))},e.prototype.setTerminateRequested=function(e){this.terminateRequested=!0===e,this.terminateRequested&&t.isValid(this.worker)&&!t.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},e.prototype._terminate=function(){this.worker.terminate(),this._reset()},e}();function n(){if(console.info("Using LoaderSupport.WorkerSupport version: "+e),this.logging={enabled:!0,debug:!1},void 0===i.Worker)throw"This browser does not support web workers!";if(void 0===i.Blob)throw"This browser does not support Blob!";if("function"!=typeof i.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this.loaderWorker=new r}n.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},n.prototype.setForceWorkerDataCopy=function(e){this.loaderWorker.setForceCopy(e)},n.prototype.validate=function(e,r,n,i,s){if(!t.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),t.isValid(s)?this.logging.enabled&&console.info('WorkerSupport: Using "'+s.name+'" as Runner class for worker.'):(s=Zo.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.'));var c=e(o,a);c+="var Parser = "+r+";\n\n",c+=a(s.name,s),c+="new "+s.name+"();\n\n";var u=this;if(t.isValid(n)&&n.length>0){var l="",h=function(e,t){if(0===t.length)u.loaderWorker.initWorker(l+c,s.name),u.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var r=new ln;r.setPath(e),r.setResponseType("text"),r.load(t[0],function(r){l+=r,h(e,t)}),t.shift()}};h(i,n)}else this.loaderWorker.initWorker(c,s.name),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},n.prototype.setCallbacks=function(e,t){this.loaderWorker.setCallbacks(e,t)},n.prototype.run=function(e){this.loaderWorker.run(e)},n.prototype.setTerminateRequested=function(e){this.loaderWorker.setTerminateRequested(e)};var o=function(e,t){var r,n=e+" = {\n";for(var i in t)"string"==typeof(r=t[i])||r instanceof String?n+="\t"+i+': "'+(r=(r=r.replace("\n","\\n")).replace("\r","\\r"))+'",\n':r instanceof Array?n+="\t"+i+": ["+r+"],\n":Number.isInteger(r)?n+="\t"+i+": "+r+",\n":"function"==typeof r&&(n+="\t"+i+": "+r+",\n");return n+="}\n\n"},a=function(e,r,n,i,o){var a,s,c="",u=t.isValid(n)?n:r.name;for(var l in o=t.verifyInput(o,[]),r.prototype)a=r.prototype[l],"constructor"===l?s="\tfunction "+u+a.toString().replace("function","")+";\n\n":"function"==typeof a&&o.indexOf(l)<0&&(c+="\t"+u+".prototype."+l+" = "+a.toString()+";\n\n");c+="\treturn "+u+";\n",c+="})();\n\n";var h="";return t.isValid(i)&&(h+="\n",h+=u+".prototype = Object.create( "+i+".prototype );\n",h+=u+".constructor = "+u+";\n",h+="\n"),t.isValid(s)?c=e+" = (function () {\n\n"+h+s+c:(s=e+" = (function () {\n\n",c=(s+=h+"\t"+r.prototype.constructor.toString()+"\n\n")+c),c};return n}(),Zo.WorkerDirector=function(){var e="2.2.2",t=Zo.Validator,r=16,n=8192;function i(i){if(console.info("Using LoaderSupport.WorkerDirector version: "+e),this.logging={enabled:!0,debug:!1},this.maxQueueSize=n,this.maxWebWorkers=r,this.crossOrigin=null,!t.isValid(i))throw"Provided invalid classDef: "+i;this.workerDescription={classDef:i,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null}return i.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},i.prototype.getMaxQueueSize=function(){return this.maxQueueSize},i.prototype.getMaxWebWorkers=function(){return this.maxWebWorkers},i.prototype.setCrossOrigin=function(e){this.crossOrigin=e},i.prototype.setForceWorkerDataCopy=function(e){this.workerDescription.forceWorkerDataCopy=!0===e},i.prototype.prepareWorkers=function(e,i,o){t.isValid(e)&&(this.workerDescription.globalCallbacks=e),this.maxQueueSize=Math.min(i,n),this.maxWebWorkers=Math.min(o,r),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0;for(var a=0;a<this.maxWebWorkers;a++){var s=new Zo.WorkerSupport;s.setLogging(this.logging.enabled,this.logging.debug),s.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[a]={instanceNo:a,inUse:!1,terminateRequested:!1,workerSupport:s,loader:null}}},i.prototype.enqueueForRun=function(e){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(e)},i.prototype.isRunning=function(){var e=Object.keys(this.workerDescription.workerSupports);return this.instructionQueue.length>0&&this.instructionQueuePointer<this.instructionQueue.length||e.length>0},i.prototype.processQueue=function(){var e,t;for(var r in this.workerDescription.workerSupports)(t=this.workerDescription.workerSupports[r]).inUse||(this.instructionQueuePointer<this.instructionQueue.length?(e=this.instructionQueue[this.instructionQueuePointer],this._kickWorkerRun(e,t),this.instructionQueuePointer++):this._deregister(t));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},i.prototype._kickWorkerRun=function(e,r){r.inUse=!0,r.workerSupport.setTerminateRequested(r.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var n=this,i=e.getCallbacks(),o=this.workerDescription.globalCallbacks;r.loader=this._buildLoader(r.instanceNo);var a=new Zo.Callbacks;a.setCallbackOnLoad(function(e){t.isValid(o.onLoad)&&o.onLoad(e),t.isValid(i.onLoad)&&i.onLoad(e),n.objectsCompleted++,r.inUse=!1,n.processQueue()}),a.setCallbackOnProgress(function(e){t.isValid(o.onProgress)&&o.onProgress(e),t.isValid(i.onProgress)&&i.onProgress(e)}),a.setCallbackOnReportError(function(e){var a=!0;t.isValid(o.onReportError)&&(a=o.onReportError(r,e)),t.isValid(i.onReportError)&&(a=i.onReportError(r,e)),t.isValid(o.onReportError)||t.isValid(i.onReportError)||(console.error("Loader reported an error: "),console.error(e)),a&&(r.inUse=!1,n.processQueue())}),a.setCallbackOnMeshAlter(function(e,r){return t.isValid(o.onMeshAlter)&&(r=o.onMeshAlter(e,r)),t.isValid(i.onMeshAlter)&&(r=o.onMeshAlter(e,r)),r}),a.setCallbackOnLoadMaterials(function(e){return t.isValid(o.onLoadMaterials)&&(e=o.onLoadMaterials(e)),t.isValid(i.onLoadMaterials)&&(e=i.onLoadMaterials(e)),e}),e.callbacks=a,r.loader.run(e,r.workerSupport)},i.prototype._buildLoader=function(e){var r=this.workerDescription.classDef,n=Object.create(r.prototype);if(r.call(n,cn),!n.hasOwnProperty("instanceNo"))throw r.name+' has no property "instanceNo".';if(n.instanceNo=e,!n.hasOwnProperty("workerSupport"))throw r.name+' has no property "workerSupport".';if("function"!=typeof n.run)throw r.name+' has no function "run".';return n.hasOwnProperty("callbacks")&&t.isValid(n.callbacks)||(console.warn(r.name+' has an invalid property "callbacks". Will change to "LoaderSupport.Callbacks"'),n.callbacks=new Zo.Callbacks),n},i.prototype._deregister=function(e){if(t.isValid(e)){e.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+e.instanceNo+".");var r=e.loader.callbacks;t.isValid(r.onProgress)&&r.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[e.instanceNo]}},i.prototype.tearDown=function(e){for(var r in this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=t.verifyInput(e,null),this.workerDescription.workerSupports)this.workerDescription.workerSupports[r].terminateRequested=!0},i}();var Ko=function(e){this.manager=void 0!==e?e:cn};Ko.prototype={constructor:Ko,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(){var e=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(t){console.time("MD2Loader");for(var r=new DataView(t),n={},i=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],o=0;o<i.length;o++)n[i[o]]=r.getInt32(4*o,!0);if(844121161===n.ident&&8===n.version){if(n.offset_end===r.byteLength){for(var a=new U,c=[],u=n.offset_st,l=(o=0,n.num_st);o<l;o++){var h=r.getInt16(u+0,!0),d=r.getInt16(u+2,!0);c.push(h/n.skinwidth,1-d/n.skinheight),u+=4}u=n.offset_tris;var f=[],p=[];for(o=0,l=n.num_tris;o<l;o++)f.push(r.getUint16(u+0,!0),r.getUint16(u+2,!0),r.getUint16(u+4,!0)),p.push(r.getUint16(u+6,!0),r.getUint16(u+8,!0),r.getUint16(u+10,!0)),u+=12;var m=new s,v=new s,g=[],y=[];u=n.offset_frames;for(o=0,l=n.num_frames;o<l;o++){v.set(r.getFloat32(u+0,!0),r.getFloat32(u+4,!0),r.getFloat32(u+8,!0)),m.set(r.getFloat32(u+12,!0),r.getFloat32(u+16,!0),r.getFloat32(u+20,!0)),u+=24;for(var b=0;b<16;b++){var x=r.getUint8(u+b,!0);if(0===x)break;g[b]=x}var w={name:String.fromCharCode.apply(null,g),vertices:[],normals:[]};u+=16;for(b=0;b<n.num_vertices;b++){var _=r.getUint8(u++,!0),S=r.getUint8(u++,!0),M=r.getUint8(u++,!0),T=e[r.getUint8(u++,!0)];_=_*v.x+m.x,S=S*v.y+m.y,M=M*v.z+m.z,w.vertices.push(_,M,S),w.normals.push(T[0],T[2],T[1])}y.push(w)}var A=[],E=[],C=[],L=y[0].vertices,P=y[0].normals;for(o=0,l=f.length;o<l;o++){_=L[z=3*f[o]],S=L[z+1],M=L[z+2];A.push(_,S,M);var O=P[z],R=P[z+1],I=P[z+2];E.push(O,R,I);h=c[z=2*p[o]],d=c[z+1];C.push(h,d)}a.addAttribute("position",new N(A,3)),a.addAttribute("normal",new N(E,3)),a.addAttribute("uv",new N(C,2));var D=[],F=[];for(o=0,l=y.length;o<l;o++){var k=(w=y[o]).name;if(w.vertices.length>0){A=[],b=0;for(var B=f.length;b<B;b++){var z=3*f[b];_=w.vertices[z],S=w.vertices[z+1],M=w.vertices[z+2];A.push(_,S,M)}var j=new N(A,3);j.name=k,D.push(j)}if(w.normals.length>0){for(E=[],b=0,B=f.length;b<B;b++){z=3*f[b],O=w.normals[z],R=w.normals[z+1],I=w.normals[z+2];E.push(O,R,I)}var V=new N(E,3);V.name=k,F.push(V)}}return a.morphAttributes.position=D,a.morphAttributes.normal=F,a.animations=Nr.CreateClipsFromMorphTargetSequences(y,10),console.timeEnd("MD2Loader"),a}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")}}()};var $o=function(){function e(e){this.manager=void 0!==e?e:cn,this.loader=new ln(this.manager),this.parser=null,this.meshBuilder=new r(this.manager),this.animationBuilder=new o}e.prototype={constructor:e,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},load:function(e,t,r,n){var i=this.meshBuilder.setCrossOrigin(this.crossOrigin),o=Cn.extractUrlBase(e),a=this._extractExtension(e).toLowerCase();"pmd"===a||"pmx"===a?this["pmd"===a?"loadPMD":"loadPMX"](e,function(e){t(i.build(e,o,r,n))},r,n):n&&n(new Error("MMDLoader: Unknown model file extension ."+a+"."))},loadAnimation:function(e,t,r,n,i){var o=this.animationBuilder;this.loadVMD(e,function(e){r(t.isCamera?o.buildCameraAnimation(e):o.build(e,t))},n,i)},loadWithAnimation:function(e,t,r,n,i){var o=this;this.load(e,function(e){o.loadAnimation(t,e,function(t){r({mesh:e,animation:t})},n,i)},n,i)},loadPMD:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmd(e,!0))},r,n)},loadPMX:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmx(e,!0))},r,n)},loadVMD:function(e,t,r,n){var i=Array.isArray(e)?e:[e],o=[],a=i.length,s=this._getParser();this.loader.setMimeType(void 0).setResponseType("arraybuffer");for(var c=0,u=i.length;c<u;c++)this.loader.load(i[c],function(e){o.push(s.parseVmd(e,!0)),o.length===a&&t(s.mergeVmds(o))},r,n)},loadVPD:function(e,t,r,n,i){var o=this._getParser();this.loader.setMimeType(t?void 0:"text/plain; charset=shift_jis").setResponseType("text").load(e,function(e){r(o.parseVpd(e,!0))},n,i)},_extractExtension:function(e){var t=e.lastIndexOf(".");return t<0?"":e.slice(t+1)},_getParser:function(){if(null===this.parser){if("undefined"==typeof MMDParser)throw new Error("MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser");this.parser=new MMDParser.Parser}return this.parser}};var t=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];function r(e){this.geometryBuilder=new n,this.materialBuilder=new i(e)}function n(){}function i(e){this.manager=e,this.textureLoader=new An(this.manager),this.tgaLoader=null}function o(){}function a(e,t,r,n,i){vr.call(this,e,t,r,n),this.interpolationParams=i}return r.prototype={constructor:r,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},build:function(e,t,r,n){var i=this.geometryBuilder.build(e);return new lo(i,this.materialBuilder.setCrossOrigin(this.crossOrigin).setTexturePath(t).build(e,i,r,n))}},n.prototype={constructor:n,build:function(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],c=[],u=[],l=[],h=[],d=[],f=[],p=[],m=[],v=0,g={},y=0;y<e.metadata.vertexCount;y++){for(var b=e.vertices[y],x=0,w=b.position.length;x<w;x++)t.push(b.position[x]);for(x=0,w=b.normal.length;x<w;x++)n.push(b.normal[x]);for(x=0,w=b.uv.length;x<w;x++)r.push(b.uv[x]);for(x=0;x<4;x++)c.push(b.skinIndices.length-1>=x?b.skinIndices[x]:0);for(x=0;x<4;x++)u.push(b.skinWeights.length-1>=x?b.skinWeights[x]:0)}for(y=0;y<e.metadata.faceCount;y++){var _=e.faces[y];for(x=0,w=_.indices.length;x<w;x++)i.push(_.indices[x])}for(y=0;y<e.metadata.materialCount;y++){var S=e.materials[y];o.push({offset:3*v,count:3*S.faceCount}),v+=S.faceCount}for(y=0;y<e.metadata.rigidBodyCount;y++){var M=e.rigidBodies[y],T=g[M.boneIndex];T=void 0===T?M.type:Math.max(M.type,T),g[M.boneIndex]=T}for(y=0;y<e.metadata.boneCount;y++){-1!==(X={parent:(D=e.bones[y]).parentIndex,name:D.name,pos:D.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:void 0!==g[y]?g[y]:-1}).parent&&(X.pos[0]-=e.bones[X.parent].position[0],X.pos[1]-=e.bones[X.parent].position[1],X.pos[2]-=e.bones[X.parent].position[2]),a.push(X)}if("pmd"===e.metadata.format)for(y=0;y<e.metadata.ikCount;y++){var A={target:(E=e.iks[y]).target,effector:E.effector,iteration:E.iteration,maxAngle:4*E.maxAngle,links:[]};for(x=0,w=E.links.length;x<w;x++){(C={}).index=E.links[x].index,C.enabled=!0,e.bones[C.index].name.indexOf("")>=0&&(C.limitation=new s(1,0,0)),A.links.push(C)}d.push(A)}else for(y=0;y<e.metadata.boneCount;y++){var E;if(void 0!==(E=e.bones[y].ik)){for(A={target:y,effector:E.effector,iteration:E.iteration,maxAngle:E.maxAngle,links:[]},x=0,w=E.links.length;x<w;x++){var C;if((C={}).index=E.links[x].index,C.enabled=!0,1===E.links[x].angleLimitation){var P=E.links[x].lowerLimitationAngle,O=E.links[x].upperLimitationAngle,R=-O[0],I=-O[1];O[0]=-P[0],O[1]=-P[1],P[0]=R,P[1]=I,C.rotationMin=(new s).fromArray(P),C.rotationMax=(new s).fromArray(O)}A.links.push(C)}d.push(A)}}if("pmx"===e.metadata.format){for(y=0;y<e.metadata.boneCount;y++){var D,F=(D=e.bones[y]).grant;if(void 0!==F){A={index:y,parentIndex:F.parentIndex,ratio:F.ratio,isLocal:F.isLocal,affectRotation:F.affectRotation,affectPosition:F.affectPosition,transformationClass:D.transformationClass};f.push(A)}}f.sort(function(e,t){return e.transformationClass-t.transformationClass})}function k(t,r,n){for(var i=0;i<r.elementCount;i++){var o,a=r.elements[i];o="pmd"===e.metadata.format?e.morphs[0].elements[a.index].index:a.index,t.array[3*o+0]+=a.position[0]*n,t.array[3*o+1]+=a.position[1]*n,t.array[3*o+2]+=a.position[2]*n}}for(y=0;y<e.metadata.morphCount;y++){var B=e.morphs[y],z={name:B.name},j=new N(3*e.metadata.vertexCount,3);j.name=B.name;for(x=0;x<3*e.metadata.vertexCount;x++)j.array[x]=t[x];if("pmd"===e.metadata.format)0!==y&&k(j,B,1);else if(0===B.type)for(x=0;x<B.elementCount;x++){var V=e.morphs[B.elements[x].index],G=B.elements[x].ratio;1===V.type&&k(j,V,G)}else 1===B.type?k(j,B,1):2===B.type||3===B.type||4===B.type||5===B.type||6===B.type||7===B.type||B.type;l.push(z),h.push(j)}for(y=0;y<e.metadata.rigidBodyCount;y++){var W=e.rigidBodies[y];z={};for(var H in W)z[H]=W[H];if("pmx"===e.metadata.format&&-1!==z.boneIndex){var X=e.bones[z.boneIndex];z.position[0]-=X.position[0],z.position[1]-=X.position[1],z.position[2]-=X.position[2]}p.push(z)}for(y=0;y<e.metadata.constraintCount;y++){var q=e.constraints[y];z={};for(var H in q)z[H]=q[H];var Y=p[z.rigidBodyIndex1],J=p[z.rigidBodyIndex2];0!==Y.type&&2===J.type&&-1!==Y.boneIndex&&-1!==J.boneIndex&&e.bones[J.boneIndex].parentIndex===Y.boneIndex&&(J.type=1),m.push(z)}var Q=new U;Q.addAttribute("position",new N(t,3)),Q.addAttribute("normal",new N(n,3)),Q.addAttribute("uv",new N(r,2)),Q.addAttribute("skinIndex",new L(c,4)),Q.addAttribute("skinWeight",new N(u,4)),Q.setIndex(i);y=0;for(var Z=o.length;y<Z;y++)Q.addGroup(o[y].offset,o[y].count,y);return Q.bones=a,Q.morphTargets=l,Q.morphAttributes.position=h,Q.userData.MMD={bones:a,iks:d,grants:f,rigidBodies:p,constraints:m,format:e.metadata.format},Q.computeBoundingSphere(),Q}},i.prototype={constructor:i,crossOrigin:"anonymous",texturePath:void 0,setCrossOrigin:function(e){return this.crossOrigin=e,this},setTexturePath:function(e){return this.texturePath=e,this},build:function(e,t,r,n){var i=[],o={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(var a=0;a<e.metadata.materialCount;a++){var s=e.materials[a],c={userData:{}};if(void 0!==s.name&&(c.name=s.name),c.color=(new v).fromArray(s.diffuse),c.opacity=s.diffuse[3],c.specular=(new v).fromArray(s.specular),c.emissive=(new v).fromArray(s.ambient),c.shininess=Math.max(s.shininess,1e-4),c.transparent=1!==c.opacity,c.skinning=t.bones.length>0,c.morphTargets=t.morphTargets.length>0,c.lights=!0,c.fog=!0,c.blending=ie,c.blendSrc=pe,c.blendDst=me,c.blendSrcAlpha=pe,c.blendDstAlpha=ve,"pmx"===e.metadata.format&&1==(1&s.flag)?c.side=J:c.side=1===c.opacity?q:J,"pmd"===e.metadata.format){if(s.fileName){var u=s.fileName.split("*");if(c.map=this._loadTexture(u[0],o),u.length>1){var l=u[1].slice(-4).toLowerCase();c.envMap=this._loadTexture(u[1],o,{sphericalReflectionMapping:!0}),c.combine=".sph"===l?Le:Oe}}var h=-1===s.toonIndex?"toon00.bmp":e.toonTextures[s.toonIndex].fileName;c.gradientMap=this._loadTexture(h,o,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(h)}),c.userData.outlineParameters={thickness:1===s.edgeFlag?.003:0,color:[0,0,0],alpha:1,visible:1===s.edgeFlag}}else{var d;-1!==s.textureIndex&&(c.map=this._loadTexture(e.textures[s.textureIndex],o)),-1===s.envTextureIndex||1!==s.envFlag&&2!=s.envFlag||(c.envMap=this._loadTexture(e.textures[s.envTextureIndex],o,{sphericalReflectionMapping:!0}),c.combine=1===s.envFlag?Le:Oe),-1===s.toonIndex||0!==s.toonFlag?(h="toon"+("0"+(s.toonIndex+1)).slice(-2)+".bmp",d=!0):(h=e.textures[s.toonIndex],d=!1),c.gradientMap=this._loadTexture(h,o,{isToonTexture:!0,isDefaultToonTexture:d}),c.userData.outlineParameters={thickness:s.edgeSize/300,color:s.edgeColor.slice(0,3),alpha:s.edgeColor[3],visible:0!=(16&s.flag)&&s.edgeSize>0}}void 0!==c.map&&(c.transparent||this._checkImageTransparency(c.map,t,a),c.emissive.multiplyScalar(.2)),i.push(new bn(c))}if("pmx"===e.metadata.format){function f(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r];if(-1!==i.index){var o=t[i.index];o.opacity!==i.diffuse[3]&&(o.transparent=!0)}}}a=0;for(var p=e.morphs.length;a<p;a++){var m=e.morphs[a],g=m.elements;if(0===m.type)for(var y=0,b=g.length;y<b;y++){var x=e.morphs[g[y].index];8===x.type&&f(x.elements,i)}else 8===m.type&&f(g,i)}}return i},_getTGALoader:function(){if(null===this.tgaLoader){if(void 0===Co)throw new Error("MMDLoader: Import TGALoader");this.tgaLoader=new Co(this.manager)}return this.tgaLoader},_isDefaultToonTexture:function(e){return 10===e.length&&/toon(10|0[0-9])\.bmp/.test(e)},_loadTexture:function(e,r,n,i,o){var a,s=this;if(!0===(n=n||{}).isDefaultToonTexture){var c;try{c=parseInt(e.match("toon([0-9]{2}).bmp$")[1])}catch(t){console.warn("MMDLoader: "+e+" seems like a not right default texture path. Using toon00.bmp instead."),c=0}a=t[c]}else a=this.texturePath+e;if(void 0!==r[a])return r[a];var u=Loader.Handlers.get(a);null===u&&(u=".tga"===e.slice(-4).toLowerCase()?this._getTGALoader():this.textureLoader);var l=u.load(a,function(e){!0===n.isToonTexture&&(e.image=s._getRotatedImage(e.image)),e.flipY=!1,e.wrapS=He,e.wrapT=He;for(var t=0;t<l.readyCallbacks.length;t++)l.readyCallbacks[t](l);delete l.readyCallbacks},i,o);return!0===n.sphericalReflectionMapping&&(l.mapping=Ve),l.readyCallbacks=[],r[a]=l,l},_getRotatedImage:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),n=e.width,i=e.height;return t.width=n,t.height=i,r.clearRect(0,0,n,i),r.translate(n/2,i/2),r.rotate(.5*Math.PI),r.translate(-n/2,-i/2),r.drawImage(e,0,0),r.getImageData(0,0,n,i)},_checkImageTransparency:function(e,t,r){e.readyCallbacks.push(function(n){function i(e,t){var r=e.width,n=e.height,i=Math.round(t.x*r)%r,o=Math.round(t.y*n)%n;i<0&&(i+=r),o<0&&(o+=n);var a=o*r+i;return e.data[4*a+3]}var o=void 0!==n.image.data?n.image:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}(n.image),a=t.groups[r];(function(e,t,r){var n=e.width,o=e.height;if(e.data.length/(n*o)!=4)return!1;for(var a=0;a<r.length;a+=3){for(var s={x:0,y:0},c=0;c<3;c++){var u=r[3*a+c],l={x:t[2*u+0],y:t[2*u+1]};if(i(e,l)<253)return!0;s.x+=l.x,s.y+=l.y}if(s.x/=3,s.y/=3,i(e,s)<253)return!0}return!1})(o,t.attributes.uv.array,t.index.array.slice(a.start,a.start+a.count))&&(e.transparent=!0)})}},o.prototype={constructor:o,build:function(e,t){for(var r=this.buildSkeletalAnimation(e,t).tracks,n=this.buildMorphAnimation(e,t).tracks,i=0,o=n.length;i<o;i++)r.push(n[i]);return new Nr("",-1,r)},buildSkeletalAnimation:function(e,t){function r(e,t,r){e.push(t[r+0]/127),e.push(t[r+8]/127),e.push(t[r+4]/127),e.push(t[r+12]/127)}for(var n=[],i={},o=t.skeleton.bones,a={},s=0,c=o.length;s<c;s++)a[o[s].name]=!0;for(s=0;s<e.metadata.motionCount;s++){var u=e.motions[s],l=u.boneName;void 0!==a[l]&&(i[l]=i[l]||[],i[l].push(u))}for(var h in i){var d=i[h];d.sort(function(e,t){return e.frameNum-t.frameNum});var f=[],p=[],m=[],v=[],g=[],y=t.skeleton.getBoneByName(h).position.toArray();for(s=0,c=d.length;s<c;s++){var b=d[s].frameNum/30,x=d[s].position,w=d[s].rotation,_=d[s].interpolation;f.push(b);for(var S=0;S<3;S++)p.push(y[S]+x[S]);for(S=0;S<4;S++)m.push(w[S]);for(S=0;S<3;S++)r(v,_,S);r(g,_,3)}var M=".bones["+h+"]";n.push(this._createTrack(M+".position",VectorKeyframeTrack,f,p,v)),n.push(this._createTrack(M+".quaternion",QuaternionKeyframeTrack,f,m,g))}return new Nr("",-1,n)},buildMorphAnimation:function(e,t){for(var r=[],n={},i=t.morphTargetDictionary,o=0;o<e.metadata.morphCount;o++){var a=e.morphs[o],s=a.morphName;void 0!==i[s]&&(n[s]=n[s]||[],n[s].push(a))}for(var c in n){var u=n[c];u.sort(function(e,t){return e.frameNum-t.frameNum});for(var l=[],h=[],d=(o=0,u.length);o<d;o++)l.push(u[o].frameNum/30),h.push(u[o].weight);r.push(new Er(".morphTargetInfluences["+i[c]+"]",l,h))}return new Nr("",-1,r)},buildCameraAnimation:function(e){function t(e,t){e.push(t.x),e.push(t.y),e.push(t.z)}function r(e,t){e.push(t.x),e.push(t.y),e.push(t.z),e.push(t.w)}function n(e,t,r){e.push(t[4*r+0]/127),e.push(t[4*r+1]/127),e.push(t[4*r+2]/127),e.push(t[4*r+3]/127)}var i=[],o=void 0===e.cameras?[]:e.cameras.slice();o.sort(function(e,t){return e.frameNum-t.frameNum});for(var a=[],u=[],h=[],d=[],f=[],p=[],m=[],v=[],g=[],y=new c,b=new l,x=new s,w=new s,_=0,S=o.length;_<S;_++){var M=o[_],T=M.frameNum/30,A=M.position,E=M.rotation,C=M.distance,L=M.fov,P=M.interpolation;a.push(T),x.set(0,0,-C),w.set(A[0],A[1],A[2]),b.set(-E[0],-E[1],-E[2]),y.setFromEuler(b),x.add(w),x.applyQuaternion(y),t(u,w),r(h,y),t(d,x),f.push(L);for(var O=0;O<3;O++)n(p,P,O);n(m,P,3);for(O=0;O<3;O++)n(v,P,4);n(g,P,5)}return(i=[]).push(this._createTrack("target.position",VectorKeyframeTrack,a,u,p)),i.push(this._createTrack(".quaternion",QuaternionKeyframeTrack,a,h,m)),i.push(this._createTrack(".position",VectorKeyframeTrack,a,d,v)),i.push(this._createTrack(".fov",Er,a,f,g)),new Nr("",-1,i)},_createTrack:function(e,t,r,n,i){if(r.length>2){r=r.slice(),n=n.slice(),i=i.slice();for(var o=n.length/r.length,s=i.length/r.length,c=1,u=2,l=r.length;u<l;u++){for(var h=0;h<o;h++)if(n[c*o+h]!==n[(c-1)*o+h]||n[c*o+h]!==n[u*o+h]){c++;break}if(u>c){r[c]=r[u];for(h=0;h<o;h++)n[c*o+h]=n[u*o+h];for(h=0;h<s;h++)i[c*s+h]=i[u*s+h]}}r.length=c+1,n.length=(c+1)*o,i.length=(c+1)*s}var d=new t(e,r,n);return d.createInterpolant=function(e){return new a(this.times,this.values,this.getValueSize(),e,new Float32Array(i))},d}},a.prototype=Object.assign(Object.create(vr.prototype),{constructor:a,interpolate_:function(e,t,r,n){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=this.interpolationParams,u=e*a,l=u-a,h=n-t<.05?0:(r-t)/(n-t);if(4===a){var d=s[4*e+0],f=s[4*e+1],p=s[4*e+2],m=s[4*e+3],v=this._calculate(d,f,p,m,h);c.slerpFlat(i,0,o,l,o,u,v)}else if(3===a)for(var g=0;g!==a;++g){d=s[12*e+4*g+0],f=s[12*e+4*g+1],p=s[12*e+4*g+2],m=s[12*e+4*g+3],v=this._calculate(d,f,p,m,h);i[g]=o[l+g]*(1-v)+o[u+g]*v}else{d=s[4*e+0],f=s[4*e+1],p=s[4*e+2],m=s[4*e+3],v=this._calculate(d,f,p,m,h);i[0]=o[l]*(1-v)+o[u]*v}return i},_calculate:function(e,t,r,n,i){for(var o,a,s,c=.5,u=c,l=1-u,h=Math,d=0;d<15;d++){var f=(o=3*l*l*u)*e+(a=3*l*u*u)*t+(s=u*u*u)-i;if(h.abs(f)<1e-5)break;c/=2,l=1-(u+=f<0?c:-c)}return o*r+a*n+s}}),e}(),ea=function(e){this.manager=void 0!==e?e:cn};function ta(e){this.uuid=o.generateUUID(),this.name="",this.type=e,this.userData={}}function ra(e,t){ta.call(this,e),t=t||{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}ea.prototype={constructor:ea,load:function(e,t,r,n){var i=this,o=new ln(this.manager);o.setPath(this.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setTexturePath:function(e){return this.texturePath=e,this},setBaseUrl:function(e){return console.warn("MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e){for(var t=e.split("\n"),r={},n=/\s+/,i={},o=0;o<t.length;o++){var a=t[o];if(0!==(a=a.trim()).length&&"#"!==a.charAt(0)){var s=a.indexOf(" "),c=s>=0?a.substring(0,s):a;c=c.toLowerCase();var u=s>=0?a.substring(s+1):"";if(u=u.trim(),"newmtl"===c)r={name:u},i[u]=r;else if(r)if("ka"===c||"kd"===c||"ks"===c){var l=u.split(n,3);r[c]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else r[c]=u}}var h=new ea.MaterialCreator(this.texturePath||this.path,this.materialOptions);return h.setCrossOrigin(this.crossOrigin),h.setManager(this.manager),h.setMaterials(i),h}},(ea.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:q,this.wrap=this.options&&this.options.wrap?this.options.wrap:He}).prototype={constructor:ea.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};for(var o in t[r]=i,n){var a=!0,s=n[o],c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(i[c]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,r=this.materialsInfo[e],n={name:e,side:this.side};function i(e,r){if(!n[e]){var i=t.getTextureParams(r,n),o=t.loadTexture(function(e,t){return"string"!=typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}(t.baseUrl,i.url));o.repeat.copy(i.scale),o.offset.copy(i.offset),o.wrapS=t.wrap,o.wrapT=t.wrap,n[e]=o}}for(var o in r){var a,s=r[o];if(""!==s)switch(o.toLowerCase()){case"kd":n.color=(new v).fromArray(s);break;case"ks":n.specular=(new v).fromArray(s);break;case"map_kd":i("map",s);break;case"map_ks":i("specularMap",s);break;case"norm":i("normalMap",s);break;case"map_bump":case"bump":i("bumpMap",s);break;case"ns":n.shininess=parseFloat(s);break;case"d":(a=parseFloat(s))<1&&(n.opacity=a,n.transparent=!0);break;case"tr":a=parseFloat(s),this.options&&this.options.invertTrProperty&&(a=1-a),a>0&&(n.opacity=1-a,n.transparent=!0)}}return this.materials[e]=new vn(n),this.materials[e]},getTextureParams:function(e,t){var r,n={scale:new x(1,1),offset:new x(0,0)},i=e.split(/\s+/);return(r=i.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(i[r+1]),i.splice(r,2)),(r=i.indexOf("-s"))>=0&&(n.scale.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),(r=i.indexOf("-o"))>=0&&(n.offset.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),n.url=i.join(" ").trim(),n},loadTexture:function(e,t,r,n,i){var o,a=En.Handlers.get(e),s=void 0!==this.manager?this.manager:cn;return null===a&&(a=new An(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(e,r,n,i),void 0!==t&&(o.mapping=t),o}},ta.prototype={constructor:ta,isNode:!0,parse:function(e,t){t=t||{},e.parsing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.parsing=!1},parseAndBuildCode:function(e,t,r){return r=r||{},this.parse(e,r),this.buildCode(e,t,r)},buildCode:function(e,t,r){r=r||{};var n={result:this.build(e.addFlow(r.slot,r.cache,r.context),t)};return n.code=e.clearNodeCode(),e.removeFlow(),n},build:function(e,t,r){t=t||this.getType(e,t);var n=e.getNodeData(r||this);return e.parsing&&this.appendDepsNode(e,n,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)},appendDepsNode:function(e,t,r){t.deps=(t.deps||0)+1;var n=e.getTypeLength(r);(n>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=n,t.output=r)},setName:function(e){return this.name=e,this},getName:function(e){return this.name},getType:function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type},getJSONNode:function(e){if(!(void 0===e||"string"==typeof e)&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},copy:function(e){void 0!==e.name&&(this.name=e.name),void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData)))},createJSONNode:function(e){var t=void 0===e||"string"==typeof e,r={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return r.uuid=this.uuid,r.nodeType=this.nodeType,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t||(e.nodes[this.uuid]=r),r},toJSON:function(e){return this.getJSONNode(e)||this.createJSONNode(e)}},ra.prototype=Object.create(ta.prototype),ra.prototype.constructor=ra,ra.prototype.build=function(e,t,r,n){if(t=t||this.getType(e),this.isShared(e,t)){var i=this.isUnique(e,t);i&&void 0===this.constructor.uuid&&(this.constructor.uuid=o.generateUUID()),r=e.getUuid(r||this.getUuid(),!i);var a=e.getNodeData(r),s=a.output||this.getType(e);if(e.parsing)return(a.deps||0)>0?(this.appendDepsNode(e,a,t),this.generate(e,t,r)):ta.prototype.build.call(this,e,t,r);if(i)return a.name=a.name||ta.prototype.build.call(this,e,t,r),a.name;if(!this.isShared(e,s)||!e.optimize||1==a.deps)return ta.prototype.build.call(this,e,t,r);r=this.getUuid(!1);var c=this.getTemp(e,r);if(c)return e.format(c,s,t);c=ra.prototype.generate.call(this,e,t,r,a.output,n);var u=this.generate(e,s,r);return e.addNodeCode(c+" = "+u+";"),e.format(c,s,t)}return ta.prototype.build.call(this,e,t,r)},ra.prototype.isShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},ra.prototype.isUnique=function(e,t){return this.unique},ra.prototype.getUuid=function(e){var t=(e||void 0==e)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t},ra.prototype.getTemp=function(e,t){t=t||this.uuid;var r=e.getVars()[t];return r?r.name:void 0},ra.prototype.generate=function(e,t,r,n,i){return this.isShared(e,t)||console.error("TempNode is not shared!"),r=r||this.uuid,e.getTempVar(r,n||this.getType(e),i).name};var na=function(e,t,r,n){e=e||"",this.isMethod="string"!=typeof t,this.useKeywords=!0,ra.call(this,this.isMethod?null:t),this.isMethod?this.eval(e,t,r,n):this.eval(e,r,n)};na.rDeclaration=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\((.*?)\)/i,na.rProperties=/[a-z_0-9]+/gi,na.prototype=Object.create(ra.prototype),na.prototype.constructor=na,na.prototype.nodeType="Function",na.prototype.eval=function(e,t,r,n){if(e=(e||"").trim(),this.includes=t||[],this.extensions=r||{},this.keywords=n||{},this.isMethod){var i=e.match(na.rDeclaration);if(this.inputs=[],i&&4==i.length){this.type=i[1],this.name=i[2];var o=i[3].match(na.rProperties);if(o)for(var a=0;a<o.length;){var s,c,u=o[a++];"in"==u||"out"==u||"inout"==u?s=o[a++]:(s=u,u=""),c=o[a++],this.inputs.push({name:c,type:s,qualifier:u})}}else this.type="",this.name=""}this.value=e};var ia={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,t,r){r=void 0===r||r,this.keywords[e]={callback:t,cache:r}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,t){return this.keywords[e].callback.call(this,t)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return void 0!=this.nodes[e]},containsKeyword:function(e){return void 0!=this.keywords[e]}},oa=["uv","uv2"],aa=["vUv","vUv2"];function sa(e){ra.call(this,"v2",{shared:!1}),this.index=e||0}function ca(e){ra.call(this,"v3"),this.scope=e||ca.LOCAL}function ua(e){ra.call(this,"v3"),this.scope=e||ua.LOCAL}function la(e,t){(t=t||{}).shared=void 0!==t.shared&&t.shared,ra.call(this,e,t),this.readonly=!1}function ha(e){la.call(this,"f"),this.value=e||0}function da(e,t,r){ha.call(this),this.scale=void 0!==e?e:1,this.scope=t||da.GLOBAL,this.timeScale=void 0!==r?r:1!==this.scale}sa.prototype=Object.create(ra.prototype),sa.prototype.constructor=sa,sa.prototype.nodeType="UV",sa.prototype.generate=function(e,t){e.requires.uv[this.index]=!0;var r=e.isShader("vertex")?oa[this.index]:aa[this.index];return e.format(r,this.getType(e),t)},sa.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.index=e.index},sa.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},ia.addKeyword("uv",function(){return new sa}),ia.addKeyword("uv2",function(){return new sa(1)}),ca.LOCAL="local",ca.WORLD="world",ca.VIEW="view",ca.PROJECTION="projection",ca.prototype=Object.create(ra.prototype),ca.prototype.constructor=ca,ca.prototype.nodeType="Position",ca.prototype.getType=function(){switch(this.scope){case ca.PROJECTION:return"v4"}return this.type},ca.prototype.isShared=function(e){switch(this.scope){case ca.LOCAL:case ca.WORLD:return!1}return!0},ca.prototype.generate=function(e,t){var r;switch(this.scope){case ca.LOCAL:e.requires.position=!0,r=e.isShader("vertex")?"transformed":"vPosition";break;case ca.WORLD:e.requires.worldPosition=!0,r="vWPosition";break;case ca.VIEW:r=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case ca.PROJECTION:r=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(r,this.getType(e),t)},ca.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.scope=e.scope},ca.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},ia.addKeyword("position",function(){return new ca}),ia.addKeyword("worldPosition",function(){return new ca(ca.WORLD)}),ia.addKeyword("viewPosition",function(){return new ca(NormalNode.VIEW)}),ua.LOCAL="local",ua.WORLD="world",ua.VIEW="view",ua.prototype=Object.create(ra.prototype),ua.prototype.constructor=ua,ua.prototype.nodeType="Normal",ua.prototype.isShared=function(e){switch(this.scope){case ua.WORLD:return!0}return!1},ua.prototype.generate=function(e,t){var r;switch(this.scope){case ua.LOCAL:e.requires.normal=!0,r="normal";break;case ua.WORLD:e.requires.worldNormal=!0,r=e.isShader("vertex")?"( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz":"vWNormal";break;case ua.VIEW:r="vNormal"}return e.format(r,this.getType(e),t)},ua.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.scope=e.scope},ua.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},ia.addKeyword("normal",function(){return new ua}),ia.addKeyword("worldNormal",function(){return new ua(ua.WORLD)}),ia.addKeyword("viewNormal",function(){return new ua(ua.VIEW)}),la.prototype=Object.create(ra.prototype),la.prototype.constructor=la,la.prototype.isReadonly=function(e){return this.readonly},la.prototype.copy=function(e){ra.prototype.copy.call(this,e),void 0!==e.readonly&&(this.readonly=e.readonly)},la.prototype.createJSONNode=function(e){var t=ra.prototype.createJSONNode.call(this,e);return!0===this.readonly&&(t.readonly=this.readonly),t},la.prototype.generate=function(e,t,r,n,i,o){r=e.getUuid(r||this.getUuid()),n=n||this.getType(e);var a=e.getNodeData(r);return this.isReadonly(e)&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,n,i,o):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(n,this,i,o)),e.format(a.vertex.name,n,t)):(a.fragment||(a.fragment=e.createFragmentUniform(n,this,i,o)),e.format(a.fragment.name,n,t))},ha.prototype=Object.create(la.prototype),ha.prototype.constructor=ha,ha.prototype.nodeType="Float",ha.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format(this.value+(this.value%1?"":".0"),n,t)},ha.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value=e.value},ha.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},da.GLOBAL="global",da.LOCAL="local",da.DELTA="delta",da.prototype=Object.create(ha.prototype),da.prototype.constructor=da,da.prototype.nodeType="Timer",da.prototype.isReadonly=function(){return!1},da.prototype.isUnique=function(){return this.timeScale&&(this.scope===da.GLOBAL||this.scope===da.DELTA)},da.prototype.updateFrame=function(e){var t=this.timeScale?this.scale:1;switch(this.scope){case da.LOCAL:this.value+=e.delta*t;break;case da.DELTA:this.value=e.delta*t;break;default:this.value=e.time*t}},da.prototype.copy=function(e){ha.prototype.copy.call(this,e),this.scope=e.scope,this.scale=e.scale,this.timeScale=e.timeScale},da.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope,t.scale=this.scale,t.timeScale=this.timeScale),t},ia.addKeyword("time",function(){return new da});var fa=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i;function pa(e,t){ra.call(this),this.eval(e||pa.PI,t)}function ma(e,t){ra.call(this,"v3"),this.setScope(e||ma.POSITION),this.setCamera(t)}pa.PI="PI",pa.PI2="PI2",pa.RECIPROCAL_PI="RECIPROCAL_PI",pa.RECIPROCAL_PI2="RECIPROCAL_PI2",pa.LOG2="LOG2",pa.EPSILON="EPSILON",pa.prototype=Object.create(ra.prototype),pa.prototype.constructor=pa,pa.prototype.nodeType="Const",pa.prototype.getType=function(e){return e.getTypeByFormat(this.type)},pa.prototype.eval=function(e,t){this.src=e||"";var r,n,i="",o=this.src.match(fa);this.useDefine=t||"#"===this.src.charAt(0),o&&o.length>1?(n=o[1],r=o[2],i=o[3]):(r=this.src,n="f"),this.name=r,this.type=n,this.value=i},pa.prototype.build=function(e,t){return"source"!==t?(e.include(this),e.format(this.name,this.getType(e),t)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0},pa.prototype.generate=function(e,t){return e.format(this.name,this.getType(e),t)},pa.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.eval(e.src,e.useDefine)},pa.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src,!0===t.useDefine&&(t.useDefine=!0)),t},ia.addKeyword("uv",function(){return new sa}),ia.addKeyword("uv2",function(){return new sa(1)}),ia.addKeyword("position",function(){return new ca}),ia.addKeyword("worldPosition",function(){return new ca(ca.WORLD)}),ia.addKeyword("normal",function(){return new ua}),ia.addKeyword("worldNormal",function(){return new ua(ua.WORLD)}),ia.addKeyword("viewPosition",function(){return new ca(ua.VIEW)}),ia.addKeyword("viewNormal",function(){return new ua(ua.VIEW)}),ia.addKeyword("time",function(){return new da}),ia.add(new pa("vec3 LUMA vec3(0.2125, 0.7154, 0.0721)")),ia.add(new na(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 scale ) {","\tvec3 q0 = dFdx( eye_pos );","\tvec3 q1 = dFdy( eye_pos );","\tvec2 st0 = dFdx( mUv.st );","\tvec2 st1 = dFdy( mUv.st );","\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );","\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );","\tvec3 N = normalize( surf_norm );","\tvec3 mapN = map * 2.0 - 1.0;","\tmapN.xy = scale * mapN.xy;","\tmat3 tsn = mat3( S, T, N );","\treturn normalize( tsn * mapN );","}"].join("\n"),null,{derivatives:!0})),ia.add(new na(["float snoise(vec2 co) {","\treturn fract( sin( dot(co.xy, vec2(12.9898,78.233) ) ) * 43758.5453 );","}"].join("\n"))),ia.add(new na(["vec3 hue_rgb(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n"))),ia.add(new na(["vec3 saturation_rgb(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3(dot(rgb, LUMA));","\treturn mix(intensity, rgb, adjustment);","}"].join("\n"))),ia.add(new na(["float luminance_rgb(vec3 rgb) {","\treturn dot(rgb, LUMA);","}"].join("\n"))),ia.add(new na(["vec3 vibrance_rgb(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))),na.prototype.isShared=function(e,t){return!this.isMethod},na.prototype.getType=function(e){return e.getTypeByFormat(this.type)},na.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},na.prototype.getIncludeByName=function(e){for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]},na.prototype.generate=function(e,t){for(var r,n=0,i=this.value,o=0;o<this.includes.length;o++)e.include(this.includes[o],this);for(var a in this.extensions)e.material.extensions[a]=!0;for(;r=na.rProperties.exec(this.value);){var s=r[0],c=!this.isMethod||!this.getInputByName(s),u=s;if(this.keywords[s]||this.useKeywords&&c&&ia.containsKeyword(s)){var l=this.keywords[s];if(!l){var h=ia.getKeywordData(s);h.cache&&(l=e.keywords[s]),l=l||ia.getKeyword(s,e),h.cache&&(e.keywords[s]=l)}u=l.build(e)}s!=u&&(i=i.substring(0,r.index+n)+u+i.substring(r.index+s.length+n),n+=u.length-s.length),void 0===this.getIncludeByName(u)&&ia.contains(u)&&e.include(ia.get(u))}return"source"===t?i:this.isMethod?(e.include(this,!1,i),this.name):e.format("("+i+")",this.getType(e),t)},ma.Nodes={depthColor:new na(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n"))},ma.POSITION="position",ma.DEPTH="depth",ma.TO_VERTEX="toVertex",ma.prototype=Object.create(ra.prototype),ma.prototype.constructor=ma,ma.prototype.nodeType="Camera",ma.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0!==e?this.onUpdateFrame:void 0},ma.prototype.setScope=function(e){switch(this.scope){case ma.DEPTH:delete this.near,delete this.far}switch(this.scope=e,e){case ma.DEPTH:var t=this.camera;this.near=new ha(t?t.near:1),this.far=new ha(t?t.far:1200)}},ma.prototype.getType=function(e){switch(this.scope){case ma.DEPTH:return"f"}return this.type},ma.prototype.isUnique=function(e){switch(this.scope){case ma.DEPTH:case ma.TO_VERTEX:return!0}return!1},ma.prototype.isShared=function(e){switch(this.scope){case ma.POSITION:return!1}return!0},ma.prototype.generate=function(e,t){var r;switch(this.scope){case ma.POSITION:r="cameraPosition";break;case ma.DEPTH:r=e.include(ma.Nodes.depthColor)+"( "+this.near.build(e,"f")+", "+this.far.build(e,"f")+" )";break;case ma.TO_VERTEX:r="normalize( "+new ca(ca.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(r,this.getType(e),t)},ma.prototype.onUpdateFrame=function(e){switch(this.scope){case ma.DEPTH:var t=this.camera;this.near.value=t.near,this.far.value=t.far}},ma.prototype.copy=function(e){switch(ra.prototype.copy.call(this,e),this.setScope(e.scope),e.camera&&this.setCamera(e.camera),e.scope){case ma.DEPTH:this.near.number=e.near,this.far.number=e.far}},ma.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch((t=this.createJSONNode(e)).scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case ma.DEPTH:t.near=this.near.value,t.far=this.far.value}return t};var va=function(e,t){this.manager=void 0!==e?e:cn,this.nodes={},this.materials={},this.passes={},this.names={},this.library=t||{}};Object.assign(va.prototype,{load:function(e,t,r,n){var i=this;return new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n),this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=this.resolve(e[t]);else for(var r in e)"uuid"!==r&&(e[r]=this.resolve(e[r]))}return e},declare:function(e){var t,n,i;for(t in e.nodes)n=e.nodes[t],i=new r[n.nodeType+"Node"],n.name&&(i.name=n.name,this.names[i.name]=i),this.nodes[t]=i;for(t in e.materials)n=e.materials[t],i=new r[n.type],n.name&&(i.name=n.name,this.names[i.name]=i),this.materials[t]=i;for(t in e.passes)n=e.passes[t],i=new r[n.type],n.name&&(i.name=n.name,this.names[i.name]=i),this.passes[t]=i;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){var t;for(t in(e=this.resolve(this.declare(e))).nodes)this.nodes[t].copy(e.nodes[t]);for(t in e.materials)this.materials[t].copy(e.materials[t]);for(t in e.passes)this.passes[t].copy(e.passes[t]);return this.material||this.pass||this}});var ga=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,r=/^usemtl /;function n(e){this.manager=void 0!==e?e:cn,this.materials=null}return n.prototype={constructor:n,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setPath(this.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(n){console.time("OBJLoader");var i=new function(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors,i=this.object.geometry.colors;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[e+0],n[e+1]),i.push(n[t+0],n[t+1]),i.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,i,o,a,s,c){var u=this.vertices.length,l=this.parseVertexIndex(e,u),h=this.parseVertexIndex(t,u),d=this.parseVertexIndex(r,u);if(this.addVertex(l,h,d),void 0!==n&&""!==n){var f=this.uvs.length;l=this.parseUVIndex(n,f),h=this.parseUVIndex(i,f),d=this.parseUVIndex(o,f),this.addUV(l,h,d)}if(void 0!==a&&""!==a){var p=this.normals.length;l=this.parseNormalIndex(a,p),h=a===s?l:this.parseNormalIndex(s,p),d=a===c?l:this.parseNormalIndex(c,p),this.addNormal(l,h,d)}this.colors.length>0&&this.addColor(l,h,d)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,i=0,o=e.length;i<o;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));var a=0;for(o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],n))}};return e.startObject("",!1),e};-1!==n.indexOf("\r\n")&&(n=n.replace(/\r\n/g,"\n")),-1!==n.indexOf("\\\n")&&(n=n.replace(/\\\n/g,""));for(var o=n.split("\n"),a="",s="",c=[],u="function"==typeof"".trimLeft,l=0,h=o.length;l<h;l++)if(a=o[l],0!==(a=u?a.trimLeft():a.trim()).length&&"#"!==(s=a.charAt(0)))if("v"===s){var d=a.split(/\s+/);switch(d[0]){case"v":i.vertices.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3])),8===d.length&&i.colors.push(parseFloat(d[4]),parseFloat(d[5]),parseFloat(d[6]));break;case"vn":i.normals.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]));break;case"vt":i.uvs.push(parseFloat(d[1]),parseFloat(d[2]))}}else if("f"===s){for(var f=a.substr(1).trim().split(/\s+/),p=[],m=0,v=f.length;m<v;m++){var g=f[m];if(g.length>0){var y=g.split("/");p.push(y)}}var b=p[0];for(m=1,v=p.length-1;m<v;m++){var x=p[m],w=p[m+1];i.addFace(b[0],x[0],w[0],b[1],x[1],w[1],b[2],x[2],w[2])}}else if("l"===s){var _=a.substring(1).trim().split(" "),S=[],M=[];if(-1===a.indexOf("/"))S=_;else for(var T=0,A=_.length;T<A;T++){var E=_[T].split("/");""!==E[0]&&S.push(E[0]),""!==E[1]&&M.push(E[1])}i.addLineGeometry(S,M)}else if("p"===s){var C=a.substr(1).trim().split(" ");i.addPointGeometry(C)}else if(null!==(c=e.exec(a))){var L=(" "+c[0].substr(1).trim()).substr(1);i.startObject(L)}else if(r.test(a))i.object.startMaterial(a.substring(7).trim(),i.materialLibraries);else if(t.test(a))i.materialLibraries.push(a.substring(7).trim());else{if("s"!==s){if("\0"===a)continue;throw new Error('OBJLoader: Unexpected line: "'+a+'"')}if((c=a.split(" ")).length>1){var P=c[1].trim().toLowerCase();i.object.smooth="0"!==P&&"off"!==P}else i.object.smooth=!0;(X=i.object.currentMaterial())&&(X.smooth=i.object.smooth)}i.finalize();var O=new oo;O.materialLibraries=[].concat(i.materialLibraries);for(l=0,h=i.objects.length;l<h;l++){var R=i.objects[l],I=R.geometry,D=R.materials,F="Line"===I.type,k="Points"===I.type,B=!1;if(0!==I.vertices.length){var z=new U;z.addAttribute("position",new N(I.vertices,3)),I.normals.length>0?z.addAttribute("normal",new N(I.normals,3)):z.computeVertexNormals(),I.colors.length>0&&(B=!0,z.addAttribute("color",new N(I.colors,3))),I.uvs.length>0&&z.addAttribute("uv",new N(I.uvs,2));for(var j,V=[],G=0,W=D.length;G<W;G++){var H=D[G],X=void 0;if(null!==this.materials)if(X=this.materials.create(H.name),!F||!X||X instanceof ur){if(k&&X&&!(X instanceof xn)){var q=new xn({size:10,sizeAttenuation:!1});Y.copy(X),X=q}}else{var Y=new ur;Y.copy(X),Y.lights=!1,X=Y}X||((X=F?new ur:k?new xn({size:1,sizeAttenuation:!1}):new vn).name=H.name),X.flatShading=!H.smooth,X.vertexColors=B?K:Q,V.push(X)}if(V.length>1){for(G=0,W=D.length;G<W;G++){H=D[G];z.addGroup(H.groupStart,H.groupCount,G)}j=F?new Eo(z,V):k?new Gi(z,V):new dr(z,V)}else j=F?new Eo(z,V[0]):k?new Gi(z,V[0]):new dr(z,V[0]);j.name=R.name,O.add(j)}}return console.timeEnd("OBJLoader"),O}},n}();void 0===Zo&&console.error('"LoaderSupport" is not available. "OBJLoader2" requires it. Please include "LoaderSupport.js" in your HTML.');var ya=function(){var e="2.4.2",t=Zo.Validator;function r(r){console.info("Using OBJLoader2 version: "+e),this.manager=t.verifyInput(r,cn),this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path="",this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.loaderRootNode=new oo,this.meshBuilder=new Zo.MeshBuilder,this.callbacks=new Zo.Callbacks,this.workerSupport=new Zo.WorkerSupport,this.terminateWorkerOnLoad=!0}r.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.meshBuilder.setLogging(this.logging.enabled,this.logging.debug)},r.prototype.setModelName=function(e){this.modelName=t.verifyInput(e,this.modelName)},r.prototype.setPath=function(e){this.path=t.verifyInput(e,this.path)},r.prototype.setStreamMeshesTo=function(e){this.loaderRootNode=t.verifyInput(e,this.loaderRootNode)},r.prototype.setMaterials=function(e){this.meshBuilder.setMaterials(e)},r.prototype.setUseIndices=function(e){this.useIndices=!0===e},r.prototype.setDisregardNormals=function(e){this.disregardNormals=!0===e},r.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=!0===e},r.prototype.setUseOAsMesh=function(e){this.useOAsMesh=!0===e},r.prototype._setCallbacks=function(e){t.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),t.isValid(e.onReportError)&&this.callbacks.setCallbackOnReportError(e.onReportError),t.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),t.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),t.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials),this.meshBuilder._setCallbacks(this.callbacks)},r.prototype.onProgress=function(e,r,n){var i=t.isValid(r)?r:"",o={detail:{type:e,modelName:this.modelName,instanceNo:this.instanceNo,text:i,numericalValue:n}};t.isValid(this.callbacks.onProgress)&&this.callbacks.onProgress(o),this.logging.enabled&&this.logging.debug&&console.debug(i)},r.prototype._onError=function(e){var t="Error occurred while downloading!";e.currentTarget&&null!==e.currentTarget.statusText&&(t+="\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),this.onProgress("error",t,-1),this._throwError(t)},r.prototype._throwError=function(e){if(!t.isValid(this.callbacks.onReportError))throw e;this.callbacks.onReportError(e)},r.prototype.load=function(e,t,r,n,i,o){var a=new Zo.ResourceDescriptor(e,"OBJ");this._loadObj(a,t,r,n,i,o)},r.prototype._loadObj=function(e,r,n,i,o,a){var s=this;t.isValid(i)||(i=function(e){s._onError(e)}),t.isValid(e)||i("An invalid ResourceDescriptor was provided. Unable to continue!");var c=function(t){if(e.content=t,a)s.parseAsync(t,r);else{var n=new Zo.Callbacks;n.setCallbackOnMeshAlter(o),s._setCallbacks(n),r({detail:{loaderRootNode:s.parse(t),modelName:s.modelName,instanceNo:s.instanceNo}})}};if(!t.isValid(e.url)||t.isValid(e.content))c(t.isValid(e.content)?e.content:null);else{if(!t.isValid(n)){var u=0,l=0;n=function(t){if(t.lengthComputable&&(l=t.loaded/t.total)>u){u=l;var r='Download of "'+e.url+'": '+(100*l).toFixed(2)+"%";s.onProgress("progressLoad",r,l)}}}var h=new ln(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.load(e.url,c,n,i)}},r.prototype.run=function(e,r){this._applyPrepData(e);var n=e.checkResourceDescriptorFiles(e.resources,[{ext:"obj",type:"ArrayBuffer",ignore:!1},{ext:"mtl",type:"String",ignore:!1},{ext:"zip",type:"String",ignore:!0}]);t.isValid(r)&&(this.terminateWorkerOnLoad=!1,this.workerSupport=r,this.logging.enabled=this.workerSupport.logging.enabled,this.logging.debug=this.workerSupport.logging.debug);var i=this;this._loadMtl(n.mtl,function(t){null!==t&&i.meshBuilder.setMaterials(t),i._loadObj(n.obj,i.callbacks.onLoad,null,null,i.callbacks.onMeshAlter,e.useAsync)},null,null,e.crossOrigin,e.materialOptions)},r.prototype._applyPrepData=function(e){t.isValid(e)&&(this.setLogging(e.logging.enabled,e.logging.debug),this.setModelName(e.modelName),this.setStreamMeshesTo(e.streamMeshesTo),this.meshBuilder.setMaterials(e.materials),this.setUseIndices(e.useIndices),this.setDisregardNormals(e.disregardNormals),this.setMaterialPerSmoothingGroup(e.materialPerSmoothingGroup),this.setUseOAsMesh(e.useOAsMesh),this._setCallbacks(e.getCallbacks()))},r.prototype.parse=function(e){if(!t.isValid(e))return console.warn("Provided content is not a valid ArrayBuffer or String."),this.loaderRootNode;this.logging.enabled&&console.time("OBJLoader2 parse: "+this.modelName),this.meshBuilder.init();var r=new n;r.setLogging(this.logging.enabled,this.logging.debug),r.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),r.setUseOAsMesh(this.useOAsMesh),r.setUseIndices(this.useIndices),r.setDisregardNormals(this.disregardNormals),r.setMaterials(this.meshBuilder.getMaterials());var i=this;r.setCallbackMeshBuilder(function(e){var t,r=i.meshBuilder.processPayload(e);for(var n in r)t=r[n],i.loaderRootNode.add(t)});return r.setCallbackProgress(function(e,t){i.onProgress("progressParse",e,t)}),e instanceof ArrayBuffer||e instanceof Uint8Array?(this.logging.enabled&&console.info("Parsing arrayBuffer..."),r.parse(e)):"string"==typeof e||e instanceof String?(this.logging.enabled&&console.info("Parsing text..."),r.parseText(e)):this._throwError("Provided content was neither of type String nor Uint8Array! Aborting..."),this.logging.enabled&&console.timeEnd("OBJLoader2 parse: "+this.modelName),this.loaderRootNode},r.prototype.parseAsync=function(e,r){var i=this,o=!1,a=function(){r({detail:{loaderRootNode:i.loaderRootNode,modelName:i.modelName,instanceNo:i.instanceNo}}),o&&i.logging.enabled&&console.timeEnd("OBJLoader2 parseAsync: "+i.modelName)};t.isValid(e)?o=!0:(console.warn("Provided content is not a valid ArrayBuffer."),a()),o&&this.logging.enabled&&console.time("OBJLoader2 parseAsync: "+this.modelName),this.meshBuilder.init();this.workerSupport.validate(function(e,r){var i="";return i+="\n\n",i+="THREE = { "+Zo.constructor.name+": {} };\n\n",i+=e(Zo.constructor.name+"."+Zo.Validator.constructor.name,t),i+=r("Parser",n)},"Parser"),this.workerSupport.setCallbacks(function(e){var t,r=i.meshBuilder.processPayload(e);for(var n in r)t=r[n],i.loaderRootNode.add(t)},a),i.terminateWorkerOnLoad&&this.workerSupport.setTerminateRequested(!0);var s={},c=this.meshBuilder.getMaterials();for(var u in c)s[u]=u;this.workerSupport.run({params:{useAsync:!0,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useOAsMesh:this.useOAsMesh,useIndices:this.useIndices,disregardNormals:this.disregardNormals},logging:{enabled:this.logging.enabled,debug:this.logging.debug},materials:{materials:s},data:{input:e,options:null}})};var n=function(){function e(){this.callbackProgress=null,this.callbackMeshBuilder=null,this.contentRef=null,this.legacyMode=!1,this.materials={},this.useAsync=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}}return e.prototype.resetRawMesh=function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},e.prototype.setUseAsync=function(e){this.useAsync=e},e.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=e},e.prototype.setUseOAsMesh=function(e){this.useOAsMesh=e},e.prototype.setUseIndices=function(e){this.useIndices=e},e.prototype.setDisregardNormals=function(e){this.disregardNormals=e},e.prototype.setMaterials=function(e){this.materials=Zo.Validator.verifyInput(e,this.materials),this.materials=Zo.Validator.verifyInput(this.materials,{})},e.prototype.setCallbackMeshBuilder=function(e){Zo.Validator.isValid(e)||this._throwError('Unable to run as no "MeshBuilder" callback is set.'),this.callbackMeshBuilder=e},e.prototype.setCallbackProgress=function(e){this.callbackProgress=e},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.configure=function(){if(this.pushSmoothingGroup(1),this.logging.enabled){var e=Object.keys(this.materials),t="OBJLoader2.Parser configuration:"+(e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tuseAsync: "+this.useAsync+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals+"\n\tcallbackMeshBuilderName: "+this.callbackMeshBuilder.name+"\n\tcallbackProgressName: "+this.callbackProgress.name;console.info(t)}},e.prototype.parse=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parse"),this.configure();var t=new Uint8Array(e);this.contentRef=t;var r=t.byteLength;this.globalCounts.totalBytes=r;for(var n,i=new Array(128),o="",a=0,s=0,c=0;c<r;c++)switch(n=t[c]){case 32:o.length>0&&(i[a++]=o),o="";break;case 47:o.length>0&&(i[a++]=o),s++,o="";break;case 10:o.length>0&&(i[a++]=o),o="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=c,this.processLine(i,a,s),a=0,s=0;break;case 13:break;default:o+=String.fromCharCode(n)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parse")},e.prototype.parseText=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=e;var t=e.length;this.globalCounts.totalBytes=t;for(var r,n=new Array(128),i="",o=0,a=0,s=0;s<t;s++)switch(r=e[s]){case" ":i.length>0&&(n[o++]=i),i="";break;case"/":i.length>0&&(n[o++]=i),a++,i="";break;case"\n":i.length>0&&(n[o++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=s,this.processLine(n,o,a),o=0,a=0;break;case"\r":break;default:i+=r}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parseText")},e.prototype.processLine=function(e,t,r){if(!(t<1)){var n,i,o,a,s=function(e,t,r,n){var i="";if(n>r){var o;if(t)for(o=r;o<n;o++)i+=e[o];else for(o=r;o<n;o++)i+=String.fromCharCode(e[o]);i=i.trim()}return i};switch(a=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),t>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(n=t-1,0===r)for(this.checkFaceType(0),o=2,i=n;o<i;o++)this.buildFace(e[1]),this.buildFace(e[o]),this.buildFace(e[o+1]);else if(n===2*r)for(this.checkFaceType(1),o=3,i=n-2;o<i;o+=2)this.buildFace(e[1],e[2]),this.buildFace(e[o],e[o+1]),this.buildFace(e[o+2],e[o+3]);else if(2*n==3*r)for(this.checkFaceType(2),o=4,i=n-3;o<i;o+=3)this.buildFace(e[1],e[2],e[3]),this.buildFace(e[o],e[o+1],e[o+2]),this.buildFace(e[o+3],e[o+4],e[o+5]);else for(this.checkFaceType(3),o=3,i=n-2;o<i;o+=2)this.buildFace(e[1],void 0,e[2]),this.buildFace(e[o],void 0,e[o+1]),this.buildFace(e[o+2],void 0,e[o+3]);break;case"l":case"p":if((n=t-1)===2*r)for(this.checkFaceType(4),o=1,i=n+1;o<i;o+=2)this.buildFace(e[o],e[o+1]);else for(this.checkFaceType("l"===a?5:6),o=1,i=n+1;o<i;o++)this.buildFace(e[o]);break;case"s":this.pushSmoothingGroup(e[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this.processCompletedMesh(),this.rawMesh.objectName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var c=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==c&&this.rawMesh.activeMtlName!==c&&(this.rawMesh.activeMtlName=c,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}}},e.prototype.pushSmoothingGroup=function(e){var t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);var r=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,r!==t&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},e.prototype.checkFaceType=function(e){this.rawMesh.faceType!==e&&(this.processCompletedMesh(),this.rawMesh.faceType=e,this.checkSubGroup())},e.prototype.checkSubGroup=function(){var e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],Zo.Validator.isValid(this.rawMesh.subGroupInUse)||(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},e.prototype.buildFace=function(e,t,r){this.disregardNormals&&(r=void 0);var n=this,i=function(){var i=parseInt(e),o=3*(i>0?i-1:i+n.vertices.length/3),a=n.rawMesh.subGroupInUse.vertices;a.push(n.vertices[o++]),a.push(n.vertices[o++]),a.push(n.vertices[o]);var s=n.colors.length>0?o+1:null;if(null!==s){var c=n.rawMesh.subGroupInUse.colors;c.push(n.colors[s++]),c.push(n.colors[s++]),c.push(n.colors[s])}if(t){var u=parseInt(t),l=2*(u>0?u-1:u+n.uvs.length/2),h=n.rawMesh.subGroupInUse.uvs;h.push(n.uvs[l++]),h.push(n.uvs[l])}if(r){var d=parseInt(r),f=3*(d>0?d-1:d+n.normals.length/3),p=n.rawMesh.subGroupInUse.normals;p.push(n.normals[f++]),p.push(n.normals[f++]),p.push(n.normals[f])}};if(this.useIndices){var o=e+(t?"_"+t:"_n")+(r?"_"+r:"_n"),a=this.rawMesh.subGroupInUse.indexMappings[o];Zo.Validator.isValid(a)?this.rawMesh.counts.doubleIndicesCount++:(a=this.rawMesh.subGroupInUse.vertices.length/3,i(),this.rawMesh.subGroupInUse.indexMappings[o]=a,this.rawMesh.subGroupInUse.indexMappingsCount++),this.rawMesh.subGroupInUse.indices.push(a)}else i();this.rawMesh.counts.faceCount++},e.prototype.createRawMeshReport=function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},e.prototype.finalizeRawMesh=function(){var e,t,r=[],n=0,i=0,o=0,a=0,s=0,c=0;for(var u in this.rawMesh.subGroups)if((e=this.rawMesh.subGroups[u]).vertices.length>0){if((t=e.indices).length>0&&i>0)for(var l in t)t[l]=t[l]+i;r.push(e),n+=e.vertices.length,i+=e.indexMappingsCount,o+=e.indices.length,a+=e.colors.length,c+=e.uvs.length,s+=e.normals.length}var h=null;return r.length>0&&(h={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:r,absoluteVertexCount:n,absoluteIndexCount:o,absoluteColorCount:a,absoluteNormalCount:s,absoluteUvCount:c,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),h},e.prototype.processCompletedMesh=function(){var e=this.finalizeRawMesh();if(Zo.Validator.isValid(e)){this.colors.length>0&&this.colors.length!==this.vertices.length&&this._throwError("Vertex Colors were detected, but vertex count and color count do not match!"),this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(e);var t=this.globalCounts.currentByte/this.globalCounts.totalBytes;return this.callbackProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%",t),this.resetRawMesh(),!0}return!1},e.prototype.buildMesh=function(e){var t=e.subGroups,r=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;var n,i,o,a,s,c,u,l=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,h=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,d=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,f=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,p=Zo.Validator.isValid(h),m=[],v=t.length>1,g=0,y=[],b=[],x=0,w=0,_=0,S=0,M=0,T=0,A=0;for(var E in t)if(t.hasOwnProperty(E)){if(u=(n=t[E]).materialName,c=this.rawMesh.faceType<4?u+(p?"_vertexColor":"")+(0===n.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",a=this.materials[u],s=this.materials[c],!Zo.Validator.isValid(a)&&!Zo.Validator.isValid(s)){var C=p?"defaultVertexColorMaterial":"defaultMaterial";a=this.materials[C],this.logging.enabled&&console.warn('object_group "'+n.objectName+"_"+n.groupName+'" was defined with unresolvable material "'+u+'"! Assigning "'+C+'".'),(u=C)===c&&(s=a,c=C)}if(!Zo.Validator.isValid(s)){var L={materialNameOrg:u,materialName:c,materialProperties:{vertexColors:p?2:0,flatShading:0===n.smoothingGroup}},P={cmd:"materialData",materials:{materialCloneInstructions:L}};this.callbackMeshBuilder(P),this.useAsync&&(this.materials[c]=L)}if(v?((i=y[c])||(i=g,y[c]=g,m.push(c),g++),o={start:T,count:A=this.useIndices?n.indices.length:n.vertices.length/3,index:i},b.push(o),T+=A):m.push(c),r.set(n.vertices,x),x+=n.vertices.length,l&&(l.set(n.indices,w),w+=n.indices.length),h&&(h.set(n.colors,_),_+=n.colors.length),d&&(d.set(n.normals,S),S+=n.normals.length),f&&(f.set(n.uvs,M),M+=n.uvs.length),this.logging.enabled&&this.logging.debug){var O=Zo.Validator.isValid(i)?"\n\t\tmaterialIndex: "+i:"",N="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+n.groupName+"\n\t\tIndex: "+n.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+n.materialName+"\n\t\tsmoothingGroup: "+n.smoothingGroup+O+"\n\t\tobjectName: "+n.objectName+"\n\t\t#vertices: "+n.vertices.length/3+"\n\t\t#indices: "+n.indices.length+"\n\t\t#colors: "+n.colors.length/3+"\n\t\t#uvs: "+n.uvs.length/2+"\n\t\t#normals: "+n.normals.length/3;console.debug(N)}}this.outputObjectCount++,this.callbackMeshBuilder({cmd:"meshData",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:v,materialNames:m,materialGroups:b},buffers:{vertices:r,indices:l,colors:h,normals:d,uvs:f},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[r.buffer],Zo.Validator.isValid(l)?[l.buffer]:null,Zo.Validator.isValid(h)?[h.buffer]:null,Zo.Validator.isValid(d)?[d.buffer]:null,Zo.Validator.isValid(f)?[f.buffer]:null)},e.prototype.finalizeParsing=function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){var e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}},e}();return r.prototype.loadMtl=function(e,t,r,n,i,o,a){var s=new Zo.ResourceDescriptor(e,"MTL");s.setContent(t),this._loadMtl(s,r,n,i,o,a)},r.prototype._loadMtl=function(e,r,n,i,o,a){void 0===ea&&console.error('"MTLLoader" is not available. "OBJLoader2" requires it for loading MTL files.'),t.isValid(e)&&this.logging.enabled&&console.time("Loading MTL: "+e.name);var s=[],c=this,u=function(n){var i=[];if(t.isValid(n))for(var o in n.preload(),i=n.materials)i.hasOwnProperty(o)&&(s[o]=i[o]);t.isValid(e)&&c.logging.enabled&&console.timeEnd("Loading MTL: "+e.name),r(s,n)};if(t.isValid(e)&&(t.isValid(e.content)||t.isValid(e.url))){var l=new ea(this.manager);o=t.verifyInput(o,"anonymous"),l.setCrossOrigin(o),l.setPath(e.path),t.isValid(a)&&l.setMaterialOptions(a);var h=function(e){var t=e;"string"==typeof e||e instanceof String||(e.length>0||e.byteLength>0?t=Cn.decodeText(e):this._throwError("Unable to parse mtl as it it seems to be neither a String, an Array or an ArrayBuffer!")),u(l.parse(t))};if(t.isValid(e.content))h(e.content);else if(t.isValid(e.url)){var d=new ln(this.manager);if(t.isValid(i)||(i=function(e){c._onError(e)}),!t.isValid(n)){var f=0,p=0;n=function(t){if(t.lengthComputable&&(p=t.loaded/t.total)>f){f=p;var r='Download of "'+e.url+'": '+(100*p).toFixed(2)+"%";c.onProgress("progressLoad",r,p)}}}d.load(e.url,h,n,i)}}else u()},r}(),ba=function(e){this.manager=void 0!==e?e:cn,this.littleEndian=!0};ba.prototype={constructor:ba,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(r){try{t(i.parse(r,e))}catch(e){if(!n)throw e;n(e)}},r,n)},parse:function(e,t){var r=Cn.decodeText(e),n=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),n=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=n[1],t.headerLen=n[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map(function(e){return parseInt(e,10)})),null!==t.count)t.count=t.count[1].split(" ").map(function(e){return parseInt(e,10)});else{t.count=[];for(var i=0,o=t.fields.length;i<o;i++)t.count.push(1)}t.offset={};var a=0;for(i=0,o=t.fields.length;i<o;i++)"ascii"===t.data?t.offset[t.fields[i]]=i:(t.offset[t.fields[i]]=a,a+=t.size[i]);return t.rowSize=a,t}(r),i=[],o=[],a=[];if("ascii"===n.data)for(var s=n.offset,c=r.substr(n.headerLen).split("\n"),u=0,l=c.length;u<l;u++)if(""!==c[u]){var h=c[u].split(" ");if(void 0!==s.x&&(i.push(parseFloat(h[s.x])),i.push(parseFloat(h[s.y])),i.push(parseFloat(h[s.z]))),void 0!==s.rgb){var d=new Float32Array([parseFloat(h[s.rgb])]),f=new DataView(d.buffer,0);a.push(f.getUint8(0)/255),a.push(f.getUint8(1)/255),a.push(f.getUint8(2)/255)}void 0!==s.normal_x&&(o.push(parseFloat(h[s.normal_x])),o.push(parseFloat(h[s.normal_y])),o.push(parseFloat(h[s.normal_z])))}if("binary_compressed"!==n.data){if("binary"===n.data){f=new DataView(e,n.headerLen),s=n.offset,u=0;for(var p=0;u<n.points;u++,p+=n.rowSize)void 0!==s.x&&(i.push(f.getFloat32(p+s.x,this.littleEndian)),i.push(f.getFloat32(p+s.y,this.littleEndian)),i.push(f.getFloat32(p+s.z,this.littleEndian))),void 0!==s.rgb&&(a.push(f.getUint8(p+s.rgb+0)/255),a.push(f.getUint8(p+s.rgb+1)/255),a.push(f.getUint8(p+s.rgb+2)/255)),void 0!==s.normal_x&&(o.push(f.getFloat32(p+s.normal_x,this.littleEndian)),o.push(f.getFloat32(p+s.normal_y,this.littleEndian)),o.push(f.getFloat32(p+s.normal_z,this.littleEndian)))}var m=new U;i.length>0&&m.addAttribute("position",new N(i,3)),o.length>0&&m.addAttribute("normal",new N(o,3)),a.length>0&&m.addAttribute("color",new N(a,3)),m.computeBoundingSphere();var v=new xn({size:.005});a.length>0?v.vertexColors=!0:v.color.setHex(16777215*Math.random());var g=new Gi(m,v),y=t.split("").reverse().join("");return y=(y=/([^\/]*)/.exec(y))[1].split("").reverse().join(""),g.name=y,g}console.error("PCDLoader: binary_compressed files are not supported")}};var xa=function(e){this.manager=void 0!==e?e:cn};xa.prototype={constructor:xa,load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var r=parseInt(f[p].substr(e,t));if(r){var n=function(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}(v,r);void 0===d[n]&&(h.push([v-1,r-1,1]),d[n]=h.length-1)}}for(var i,o,a,s,c,u={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},l=[],h=[],d={},f=e.split("\n"),p=0,m=f.length;p<m;p++)if("ATOM"===f[p].substr(0,4)||"HETATM"===f[p].substr(0,6))i=parseFloat(f[p].substr(30,7)),o=parseFloat(f[p].substr(38,7)),a=parseFloat(f[p].substr(46,7)),s=parseInt(f[p].substr(6,5))-1,""===(c=t(f[p].substr(76,2)).toLowerCase())&&(c=t(f[p].substr(12,2)).toLowerCase()),l[s]=[i,o,a,u[c],r(c)];else if("CONECT"===f[p].substr(0,6)){var v=parseInt(f[p].substr(6,5));n(11,5),n(16,5),n(21,5),n(26,5)}return function(){var e,t,r={geometryAtoms:new U,geometryBonds:new U,json:{atoms:l,bonds:h}},n=r.geometryAtoms,i=r.geometryBonds,o=[],a=[],s=[];for(e=0,t=l.length;e<t;e++){var c=l[e],u=c[0],d=c[1],f=c[2];o.push(u,d,f);var p=c[3][0]/255,m=c[3][1]/255,v=c[3][2]/255;a.push(p,m,v)}for(e=0,t=h.length;e<t;e++){var g=h[e],y=g[0],b=g[1];s.push(o[3*y+0]),s.push(o[3*y+1]),s.push(o[3*y+2]),s.push(o[3*b+0]),s.push(o[3*b+1]),s.push(o[3*b+2])}return n.addAttribute("position",new N(o,3)),n.addAttribute("color",new N(a,3)),i.addAttribute("position",new N(s,3)),r}()}};var wa=function(e){this.manager=void 0!==e?e:cn};wa.prototype={constructor:wa,load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){function t(e){var t={};for(var r in e){var n,i=e[r],o=i.type,a=i.components;switch(o){case"float32":n=new N(i.data,a);break;case"uint8":n=new A(i.data,a);break;case"uint16":n=new L(i.data,a);break;default:console.log('PlayCanvasLoader: Array type "%s" not yet supported.',o)}t[r]=n}e._attributes=t}function r(e){var t=new U;t.setIndex(e.indices);var r=o.vertices[e.vertices]._attributes;for(var n in r){var i=r[n];"texCoord0"===n&&(n="uv"),t.addAttribute(n,i)}e._geometry=t}function n(e){var t=o.nodes[e.node],r=o.meshes[e.mesh];void 0===t._geometries&&(t._geometries=[]),t._geometries.push(r._geometry)}function i(e){var t=new oo,r=e._geometries;if(void 0!==r)for(var n=new vn,i=0,o=r.length;i<o;i++){var a=r[i];t.add(new dr(a,n))}for(i=0,o=e.rotation.length;i<o;i++)e.rotation[i]*=Math.PI/180;t.name=e.name,t.position.fromArray(e.position),t.quaternion.setFromEuler((new l).fromArray(e.rotation)),t.scale.fromArray(e.scale),e._object=t}for(var o=e.model,a=0,s=o.vertices.length;a<s;a++)t(o.vertices[a]);for(a=0,s=o.meshes.length;a<s;a++)r(o.meshes[a]);for(a=0,s=o.meshInstances.length;a<s;a++)n(o.meshInstances[a]);for(a=0,s=o.nodes.length;a<s;a++)i(o.nodes[a]);for(a=0,s=o.parents.length;a<s;a++){var c=o.parents[a];-1!==c&&o.nodes[c]._object.add(o.nodes[a]._object)}return o.nodes[0]._object}};var _a=function(e){this.manager=void 0!==e?e:cn,this.propertyNameMapping={}};_a.prototype={constructor:_a,load:function(e,t,r,n){var i=this,o=new ln(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){var t="",r=0,n=/ply([\s\S]*)end_header\s/.exec(e);null!==n&&(t=n[1],r=n[0].length);var i,o,a,s={comments:[],elements:[],headerLength:r},c=t.split("\n");function u(e,t){var r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}for(var h=0;h<c.length;h++){var d=c[h];if(""!==(d=d.trim()))switch(o=(a=d.split(/\s+/)).shift(),d=a.join(" "),o){case"format":s.format=a[0],s.version=a[1];break;case"comment":s.comments.push(d);break;case"element":void 0!==i&&s.elements.push(i),(i={}).name=a[0],i.count=parseInt(a[1]),i.properties=[];break;case"property":i.properties.push(u(a,l.propertyNameMapping));break;default:console.log("unhandled",o,a)}}return void 0!==i&&s.elements.push(i),s}function r(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function n(e,t){for(var n=t.split(/\s+/),i={},o=0;o<e.length;o++)if("list"===e[o].type){for(var a=[],s=r(n.shift(),e[o].countType),c=0;c<s;c++)a.push(r(n.shift(),e[o].itemType));i[e[o].name]=a}else i[e[o].name]=r(n.shift(),e[o].type);return i}function i(e,t){var r,i={indices:[],vertices:[],normals:[],uvs:[],colors:[]},s="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(s=r[1]);for(var c=s.split("\n"),u=0,l=0,h=0;h<c.length;h++){var d=c[h];if(""!==(d=d.trim())){l>=t.elements[u].count&&(u++,l=0);var f=n(t.elements[u].properties,d);a(i,t.elements[u].name,f),l++}}return o(i)}function o(e){var t=new U;return e.indices.length>0&&t.setIndex(e.indices),t.addAttribute("position",new N(e.vertices,3)),e.normals.length>0&&t.addAttribute("normal",new N(e.normals,3)),e.uvs.length>0&&t.addAttribute("uv",new N(e.uvs,2)),e.colors.length>0&&t.addAttribute("color",new N(e.colors,3)),t.computeBoundingSphere(),t}function a(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var n=r.vertex_indices||r.vertex_index;3===n.length?e.indices.push(n[0],n[1],n[2]):4===n.length&&(e.indices.push(n[0],n[1],n[3]),e.indices.push(n[1],n[2],n[3]))}}function s(e,t,r,n){switch(r){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,n),2];case"uint16":case"ushort":return[e.getUint16(t,n),2];case"int32":case"int":return[e.getInt32(t,n),4];case"uint32":case"uint":return[e.getUint32(t,n),4];case"float32":case"float":return[e.getFloat32(t,n),4];case"float64":case"double":return[e.getFloat64(t,n),8]}}function c(e,t,r,n){for(var i,o={},a=0,c=0;c<r.length;c++)if("list"===r[c].type){var u=[],l=(i=s(e,t+a,r[c].countType,n))[0];a+=i[1];for(var h=0;h<l;h++)i=s(e,t+a,r[c].itemType,n),u.push(i[0]),a+=i[1];o[r[c].name]=u}else i=s(e,t+a,r[c].type,n),o[r[c].name]=i[0],a+=i[1];return[o,a]}var u,l=this;if(e instanceof ArrayBuffer){var h=Cn.decodeText(new Uint8Array(e)),d=t(h);u="ascii"===d.format?i(h,d):function(e,t){for(var r,n={indices:[],vertices:[],normals:[],uvs:[],colors:[]},i="binary_little_endian"===t.format,s=new DataView(e,t.headerLength),u=0,l=0;l<t.elements.length;l++)for(var h=0;h<t.elements[l].count;h++){u+=(r=c(s,u,t.elements[l].properties,i))[1];var d=r[0];a(n,t.elements[l].name,d)}return o(n)}(e,d)}else u=i(e,t(e));return u}};var Sa=null;function Ma(){if(null===Sa){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);t[0]=170,t[1]=187,Sa=43707===r[0]}return Sa}var Ta=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],Aa={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function Ea(e,t,r,n,i){var o,a=t.BYTES_PER_ELEMENT;if(i===Ma()||1===a)o=new t(e,r,n);else{var s=new DataView(e,r,n*a),c=Aa[t.name],u=!i,l=0;for(o=new t(n);l<n;l++)o[l]=s[c](l*a,u)}return o}var Ca=function(e){this.manager=void 0!==e?e:cn};Ca.prototype={constructor:Ca,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),e=e.replace(/\*/g,Ma()?"be":"le"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){console.time("PRWMLoader");var t,r,n=function(e){var t=new Uint8Array(e),r=t[0],n=t[1],i=!!(n>>7&1),o=n>>6&1,a=1==(n>>5&1),s=31&n,c=0,u=0;if(a?(c=(t[2]<<16)+(t[3]<<8)+t[4],u=(t[5]<<16)+(t[6]<<8)+t[7]):(c=t[2]+(t[3]<<8)+(t[4]<<16),u=t[5]+(t[6]<<8)+(t[7]<<16)),0===r)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==r)throw new Error("PRWM decoder: Unsupported format version: "+r);if(!i){if(0!==o)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==u)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var l,h,d,f,p,m,v,g,y=8,b={};for(g=0;g<s;g++){for(l="";y<t.length&&(h=t[y],y++,0!==h);)l+=String.fromCharCode(h);d=(n=t[y])>>7&1,f=1+(n>>4&3),y++,m=Ea(e,p=Ta[15&n],y=4*Math.ceil(y/4),f*c,a),y+=p.BYTES_PER_ELEMENT*f*c,b[l]={type:d,cardinality:f,values:m}}return y=4*Math.ceil(y/4),v=null,i&&(v=Ea(e,1===o?Uint32Array:Uint16Array,y,u,a)),{version:r,attributes:b,indices:v}}(e),i=Object.keys(n.attributes),o=new U;for(r=0;r<i.length;r++)t=n.attributes[i[r]],o.addAttribute(i[r],new M(t.values,t.cardinality,t.normalized));return null!==n.indices&&o.setIndex(new M(n.indices,1)),console.timeEnd("PRWMLoader"),o}},Ca.isBigEndianPlatform=function(){return Ma()};var La=function(e){Oo.call(this,e),this._parser=La.parse};La.prototype=Object.create(Oo.prototype),La.prototype.constructor=La,La.parse=function(e,t){var r=new Uint32Array(e,0,13),n={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?La._parseV3(n):559044176===r[11]?La._parseV2(n):void console.error("PVRLoader: Unknown PVR format.")},La._parseV3=function(e){var t,r,n=e.header,i=n[12],o=n[2],a=n[6],s=n[7],c=n[10],u=n[11];switch(o){case 0:t=2,r=Tt;break;case 1:t=2,r=Et;break;case 2:t=4,r=Mt;break;case 3:t=4,r=At;break;default:console.error("PVRLoader: Unsupported PVR format:",o)}return e.dataPtr=52+i,e.bpp=t,e.format=r,e.width=s,e.height=a,e.numSurfaces=c,e.numMipmaps=u,e.isCubemap=6===c,La._extract(e)},La._parseV2=function(e){var t,r,n=e.header,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[10],l=n[12],h=255&c,d=u>0;return 25===h?(r=d?At:Mt,t=4):24===h?(r=d?Et:Tt,t=2):console.error("PVRLoader: Unknown PVR format:",h),e.dataPtr=i,e.bpp=t,e.format=r,e.width=a,e.height=o,e.numSurfaces=l,e.numMipmaps=s+1,e.isCubemap=6===l,La._extract(e)},La._extract=function(e){var t,r={mipmaps:[],width:e.width,height:e.height,format:e.format,mipmapCount:e.numMipmaps,isCubemap:e.isCubemap},n=e.buffer,i=e.dataPtr,o=e.bpp,a=e.numSurfaces,s=0,c=0,u=0,l=0,h=0;2===o?(c=8,u=4):(c=4,u=4),t=c*u*o/8,r.mipmaps.length=e.numMipmaps*a;for(var d=0;d<e.numMipmaps;){var f=e.width>>d,p=e.height>>d;h=p/u,(l=f/c)<2&&(l=2),h<2&&(h=2),s=l*h*t;for(var m=0;m<a;m++){var v={data:new Uint8Array(n,i,s),width:f,height:p};r.mipmaps[m*e.numMipmaps+d]=v,i+=s}d++}return r};var Pa=function(e){this.manager=void 0!==e?e:cn};function Oa(e,t,r,n,i,o,a,s){si.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Na(e,t,r,n,i,o){Oa.call(this,e,t,r,r,n,i,o),this.type="ArcCurve"}function Ra(){var e=0,t=0,r=0,n=0;function i(i,o,a,s){e=i,t=a,r=-3*i+3*o-2*a-s,n=2*i-2*o+a+s}return{initCatmullRom:function(e,t,r,n,o){i(t,r,o*(r-e),o*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,o,a,s){var c=(t-e)/o-(r-e)/(o+a)+(r-t)/a,u=(r-t)/a-(n-t)/(a+s)+(n-r)/s;i(t,r,c*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+r*o+n*(o*i)}}}Pa.prototype={constructor:Pa,load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){try{t(i.parse(e))}catch(e){n&&n(e)}},r,n)},parse:function(e){function t(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var r=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){var r;if(84+50*(r=new DataView(e)).getUint32(80,!0)===r.byteLength)return!0;for(var n=[115,111,108,105,100],i=0;i<5;i++)if(t(n,r,i))return!1;return!0}(r)?function(e){for(var t,r,n,i,o,a,s,c,u=new DataView(e),l=u.getUint32(80,!0),h=!1,d=0;d<70;d++)1129270351==u.getUint32(d,!1)&&82==u.getUint8(d+4)&&61==u.getUint8(d+5)&&(h=!0,i=[],o=u.getUint8(d+6)/255,a=u.getUint8(d+7)/255,s=u.getUint8(d+8)/255,c=u.getUint8(d+9)/255);for(var f=new U,p=[],m=[],v=0;v<l;v++){var g=84+50*v,y=u.getFloat32(g,!0),b=u.getFloat32(g+4,!0),x=u.getFloat32(g+8,!0);if(h){var w=u.getUint16(g+48,!0);0==(32768&w)?(t=(31&w)/31,r=(w>>5&31)/31,n=(w>>10&31)/31):(t=o,r=a,n=s)}for(var _=1;_<=3;_++){var S=g+12*_;p.push(u.getFloat32(S,!0)),p.push(u.getFloat32(S+4,!0)),p.push(u.getFloat32(S+8,!0)),m.push(y,b,x),h&&i.push(t,r,n)}}return f.addAttribute("position",new M(new Float32Array(p),3)),f.addAttribute("normal",new M(new Float32Array(m),3)),h&&(f.addAttribute("color",new M(new Float32Array(i),3)),f.hasColors=!0,f.alpha=c),f}(r):function(e){for(var t,r=new U,n=/facet([\s\S]*?)endfacet/g,i=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,a=new RegExp("vertex"+o+o+o,"g"),c=new RegExp("normal"+o+o+o,"g"),u=[],l=[],h=new s;null!==(t=n.exec(e));){for(var d=0,f=0,p=t[0];null!==(t=c.exec(p));)h.x=parseFloat(t[1]),h.y=parseFloat(t[2]),h.z=parseFloat(t[3]),f++;for(;null!==(t=a.exec(p));)u.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),l.push(h.x,h.y,h.z),d++;1!==f&&console.error("STLLoader: Something isn't right with the normal of face number "+i),3!==d&&console.error("STLLoader: Something isn't right with the vertices of face number "+i),i++}return r.addAttribute("position",new N(u,3)),r.addAttribute("normal",new N(l,3)),r}(function(e){return"string"!=typeof e?Cn.decodeText(new Uint8Array(e)):e}(e))}},Oa.prototype=Object.create(si.prototype),Oa.prototype.constructor=Oa,Oa.prototype.isEllipseCurve=!0,Oa.prototype.getPoint=function(e,t){for(var r=t||new x,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=o?0:n),!0!==this.aClockwise||o||(i===n?i=-n:i-=n);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,d=c-this.aY;s=h*u-d*l+this.aX,c=h*l+d*u+this.aY}return r.set(s,c)},Oa.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Oa.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Oa.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Na.prototype=Object.create(Oa.prototype),Na.prototype.constructor=Na,Na.prototype.isArcCurve=!0;var Ia=new s,Da=new Ra,Fa=new Ra,Ua=new Ra;function ka(e,t,r,n){si.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Ba(e,t,r,n,i){var o=.5*(n-t),a=.5*(i-r),s=e*e;return(2*r-2*n+o+a)*(e*s)+(-3*r+3*n-2*o-a)*s+o*e+r}function za(e,t,r,n){return function(e,t){var r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function ja(e,t,r,n,i){return function(e,t){var r=1-e;return r*r*r*t}(e,t)+function(e,t){var r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}function Va(e,t,r,n){si.call(this),this.type="CubicBezierCurve",this.v0=e||new x,this.v1=t||new x,this.v2=r||new x,this.v3=n||new x}function Ga(e,t,r,n){si.call(this),this.type="CubicBezierCurve3",this.v0=e||new s,this.v1=t||new s,this.v2=r||new s,this.v3=n||new s}function Wa(e,t){si.call(this),this.type="LineCurve",this.v1=e||new x,this.v2=t||new x}function Ha(e,t){si.call(this),this.type="LineCurve3",this.v1=e||new s,this.v2=t||new s}function Xa(e,t,r){si.call(this),this.type="QuadraticBezierCurve",this.v0=e||new x,this.v1=t||new x,this.v2=r||new x}function qa(e,t,r){si.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new s,this.v1=t||new s,this.v2=r||new s}function Ya(e){si.call(this),this.type="SplineCurve",this.points=e||[]}ka.prototype=Object.create(si.prototype),ka.prototype.constructor=ka,ka.prototype.isCatmullRomCurve3=!0,ka.prototype.getPoint=function(e,t){var r,n,i,o,a=t||new s,c=this.points,u=c.length,l=(u-(this.closed?0:1))*e,h=Math.floor(l),d=l-h;if(this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/u)+1)*u:0===d&&h===u-1&&(h=u-2,d=1),this.closed||h>0?r=c[(h-1)%u]:(Ia.subVectors(c[0],c[1]).add(c[0]),r=Ia),n=c[h%u],i=c[(h+1)%u],this.closed||h+2<u?o=c[(h+2)%u]:(Ia.subVectors(c[u-1],c[u-2]).add(c[u-1]),o=Ia),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,p=Math.pow(r.distanceToSquared(n),f),m=Math.pow(n.distanceToSquared(i),f),v=Math.pow(i.distanceToSquared(o),f);m<1e-4&&(m=1),p<1e-4&&(p=m),v<1e-4&&(v=m),Da.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,p,m,v),Fa.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,p,m,v),Ua.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,p,m,v)}else"catmullrom"===this.curveType&&(Da.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),Fa.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),Ua.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return a.set(Da.calc(d),Fa.calc(d),Ua.calc(d)),a},ka.prototype.copy=function(e){si.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ka.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ka.prototype.fromJSON=function(e){si.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new s).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Va.prototype=Object.create(si.prototype),Va.prototype.constructor=Va,Va.prototype.isCubicBezierCurve=!0,Va.prototype.getPoint=function(e,t){var r=t||new x,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(ja(e,n.x,i.x,o.x,a.x),ja(e,n.y,i.y,o.y,a.y)),r},Va.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Va.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Va.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ga.prototype=Object.create(si.prototype),Ga.prototype.constructor=Ga,Ga.prototype.isCubicBezierCurve3=!0,Ga.prototype.getPoint=function(e,t){var r=t||new s,n=this.v0,i=this.v1,o=this.v2,a=this.v3;return r.set(ja(e,n.x,i.x,o.x,a.x),ja(e,n.y,i.y,o.y,a.y),ja(e,n.z,i.z,o.z,a.z)),r},Ga.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ga.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ga.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Wa.prototype=Object.create(si.prototype),Wa.prototype.constructor=Wa,Wa.prototype.isLineCurve=!0,Wa.prototype.getPoint=function(e,t){var r=t||new x;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Wa.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Wa.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Wa.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Wa.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Wa.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ha.prototype=Object.create(si.prototype),Ha.prototype.constructor=Ha,Ha.prototype.isLineCurve3=!0,Ha.prototype.getPoint=function(e,t){var r=t||new s;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Ha.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ha.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ha.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ha.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Xa.prototype=Object.create(si.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isQuadraticBezierCurve=!0,Xa.prototype.getPoint=function(e,t){var r=t||new x,n=this.v0,i=this.v1,o=this.v2;return r.set(za(e,n.x,i.x,o.x),za(e,n.y,i.y,o.y)),r},Xa.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Xa.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Xa.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},qa.prototype=Object.create(si.prototype),qa.prototype.constructor=qa,qa.prototype.isQuadraticBezierCurve3=!0,qa.prototype.getPoint=function(e,t){var r=t||new s,n=this.v0,i=this.v1,o=this.v2;return r.set(za(e,n.x,i.x,o.x),za(e,n.y,i.y,o.y),za(e,n.z,i.z,o.z)),r},qa.prototype.copy=function(e){return si.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},qa.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},qa.prototype.fromJSON=function(e){return si.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ya.prototype=Object.create(si.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isSplineCurve=!0,Ya.prototype.getPoint=function(e,t){var r=t||new x,n=this.points,i=(n.length-1)*e,o=Math.floor(i),a=i-o,s=n[0===o?o:o-1],c=n[o],u=n[o>n.length-2?n.length-1:o+1],l=n[o>n.length-3?n.length-1:o+2];return r.set(Ba(a,s.x,c.x,u.x,l.x),Ba(a,s.y,c.y,u.y,l.y)),r},Ya.prototype.copy=function(e){si.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this},Ya.prototype.toJSON=function(){var e=si.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e},Ya.prototype.fromJSON=function(e){si.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new x).fromArray(n))}return this};var Ja={ArcCurve:Na,CatmullRomCurve3:ka,CubicBezierCurve:Va,CubicBezierCurve3:Ga,EllipseCurve:Oa,LineCurve:Wa,LineCurve3:Ha,QuadraticBezierCurve:Xa,QuadraticBezierCurve3:qa,SplineCurve:Ya};function Qa(){si.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Za(e){Qa.call(this),this.type="Path",this.currentPoint=new x,e&&this.setFromPoints(e)}function Ka(e){Za.call(this,e),this.uuid=o.generateUUID(),this.type="Shape",this.holes=[]}Qa.prototype=Object.assign(Object.create(si.prototype),{constructor:Qa,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ja.LineCurve(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var u=s[c];t&&t.equals(u)||(r.push(u),t=u)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){si.prototype.copy.call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=si.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){si.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push((new Ja[n.type]).fromJSON(n))}return this}}),Za.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Za,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new Wa(this.currentPoint.clone(),new x(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var i=new Xa(this.currentPoint.clone(),new x(e,t),new x(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,i,o){var a=new Va(this.currentPoint.clone(),new x(e,t),new x(r,n),new x(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new Ya([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,r,n,i,o)},absarc:function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},ellipse:function(e,t,r,n,i,o,a,s){var c=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+c,t+u,r,n,i,o,a,s)},absellipse:function(e,t,r,n,i,o,a,s){var c=new Oa(e,t,r,n,i,o,a,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(e){return Qa.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Qa.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Qa.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Ka.prototype=Object.assign(Object.create(Za.prototype),{constructor:Ka,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Za.prototype.copy.call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=Za.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){Za.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push((new Za).fromJSON(n))}return this}});var $a={triangulate:function(e,t,r){r=r||2;var n,i,o,a,s,c,u,l=t&&t.length,h=l?t[0]*r:e.length,d=es(e,0,h,r,!0),f=[];if(!d)return f;if(l&&(d=function(e,t,r,n){var i,o,a,s,c,u=[];for(i=0,o=t.length;i<o;i++)a=t[i]*n,s=i<o-1?t[i+1]*n:e.length,(c=es(e,a,s,n,!1))===c.next&&(c.steiner=!0),u.push(ls(c));for(u.sort(ss),i=0;i<u.length;i++)cs(u[i],r),r=ts(r,r.next);return r}(e,t,d,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var p=r;p<h;p+=r)s=e[p],c=e[p+1],s<n&&(n=s),c<i&&(i=c),s>o&&(o=s),c>a&&(a=c);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return rs(d,f,r,n,i,u),f}};function es(e,t,r,n,i){var o,a;if(i===function(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,r,n)>0)for(o=t;o<r;o+=n)a=ys(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=ys(o,e[o],e[o+1],a);return a&&ps(a,a.next)&&(bs(a),a=a.next),a}function ts(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!ps(n,n.next)&&0!==fs(n.prev,n,n.next))n=n.next;else{if(bs(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function rs(e,t,r,n,i,o,a){if(e){!a&&o&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=us(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,c,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(c=u;s>0||c>0&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,c--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(e,n,i,o);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?is(e,n,i,o):ns(e))t.push(s.i/r),t.push(e.i/r),t.push(c.i/r),bs(e),e=c.next,u=c.next;else if((e=c)===u){a?1===a?rs(e=os(e,t,r),t,r,n,i,o,2):2===a&&as(e,t,r,n,i,o):rs(ts(e),t,r,n,i,o,1);break}}}function ns(e){var t=e.prev,r=e,n=e.next;if(fs(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(hs(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&fs(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function is(e,t,r,n){var i=e.prev,o=e,a=e.next;if(fs(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=us(s,c,t,r,n),d=us(u,l,t,r,n),f=e.nextZ;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&hs(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fs(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&hs(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&fs(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function os(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!ps(i,o)&&ms(i,n,n.next,o)&&vs(i,o)&&vs(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),bs(n),bs(n.next),n=e=o),n=n.next}while(n!==e);return n}function as(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ds(a,s)){var c=gs(a,s);return a=ts(a,a.next),c=ts(c,c.next),rs(a,t,r,n,i,o),void rs(c,t,r,n,i,o)}s=s.next}a=a.next}while(a!==e)}function ss(e,t){return e.x-t.x}function cs(e,t){if(t=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var c,u=r,l=r.x,h=r.y,d=1/0;n=r.next;for(;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&hs(o<h?i:a,o,l,h,o<h?a:i,o,n.x,n.y)&&((c=Math.abs(o-n.y)/(i-n.x))<d||c===d&&n.x>r.x)&&vs(n,e)&&(r=n,d=c),n=n.next;return r}(e,t)){var r=gs(t,e);ts(r,r.next)}}function us(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ls(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function hs(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function ds(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&ms(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&vs(e,t)&&vs(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function fs(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function ps(e,t){return e.x===t.x&&e.y===t.y}function ms(e,t,r,n){return!!(ps(e,t)&&ps(r,n)||ps(e,n)&&ps(r,t))||fs(e,t,r)>0!=fs(e,t,n)>0&&fs(r,n,e)>0!=fs(r,n,t)>0}function vs(e,t){return fs(e.prev,e,e.next)<0?fs(e,t,e.next)>=0&&fs(e,e.prev,t)>=0:fs(e,t,e.prev)<0||fs(e,e.next,t)<0}function gs(e,t){var r=new xs(e.i,e.x,e.y),n=new xs(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function ys(e,t,r,n){var i=new xs(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function bs(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xs(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ws={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},isClockWise:function(e){return ws.area(e)<0},triangulateShape:function(e,t){var r=[],n=[],i=[];_s(e),Ss(r,e);var o=e.length;t.forEach(_s);for(var a=0;a<t.length;a++)n.push(o),o+=t[a].length,Ss(r,t[a]);var s=$a.triangulate(r,n);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function _s(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Ss(e,t){for(var r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function Ms(){this.type="ShapePath",this.color=new v,this.subPaths=[],this.currentPath=null}Object.assign(Ms.prototype,{moveTo:function(e,t){this.currentPath=new Za,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,o){this.currentPath.bezierCurveTo(e,t,r,n,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new Ka;o.curves=i.curves,t.push(o)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],c=-c,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=u*(e.x-a.x)-c*(e.y-a.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var i=ws.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return r(o);var a,s,c,u=[];if(1===o.length)return s=o[0],(c=new Ka).curves=s.curves,u.push(c),u;var l=!i(o[0].getPoints());l=e?!l:l;var h,d,f=[],p=[],m=[],v=0;p[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=i(h=(s=o[g]).getPoints()),(a=e?!a:a)?(!l&&p[v]&&v++,p[v]={s:new Ka,p:h},p[v].s.curves=s.curves,l&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!p[0])return r(o);if(p.length>1){for(var b=!1,x=[],w=0,_=p.length;w<_;w++)f[w]=[];for(w=0,_=p.length;w<_;w++)for(var S=m[w],M=0;M<S.length;M++){for(var T=S[M],A=!0,E=0;E<p.length;E++)n(T.p,p[E].p)&&(w!==E&&x.push({froms:w,tos:E,hole:M}),A?(A=!1,f[E].push(T)):b=!0);A&&f[w].push(T)}x.length>0&&(b||(m=f))}g=0;for(var C=p.length;g<C;g++){c=p[g].s,u.push(c);for(var L=0,P=(d=m[g]).length;L<P;L++)c.holes.push(d[L].h)}return u}});var Ts=function(e){this.manager=void 0!==e?e:cn};Ts.prototype={constructor:Ts,load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e,t,n,i,o,a,s,c){i=i*Math.PI/180,t=Math.abs(t),n=Math.abs(n);var u=(s.x-c.x)/2,l=(s.y-c.y)/2,h=Math.cos(i)*u+Math.sin(i)*l,d=-Math.sin(i)*u+Math.cos(i)*l,f=t*t,p=n*n,m=h*h,v=d*d,g=m/f+v/p;if(g>1){var y=Math.sqrt(g);f=(t*=y)*t,p=(n*=y)*n}var b=f*v+p*m,x=(f*p-b)/b,w=Math.sqrt(Math.max(0,x));o===a&&(w=-w);var _=w*t*d/n,S=-w*n*h/t,M=Math.cos(i)*_-Math.sin(i)*S+(s.x+c.x)/2,T=Math.sin(i)*_+Math.cos(i)*S+(s.y+c.y)/2,A=r(1,0,(h-_)/t,(d-S)/n),E=r((h-_)/t,(d-S)/n,(-h-_)/t,(-d-S)/n)%(2*Math.PI);e.currentPath.absellipse(M,T,t,n,A,A+E,0===a,i)}function r(e,t,r,n){var i=e*r+t*n,o=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n),a=Math.acos(Math.max(-1,Math.min(1,i/o)));return e*n-t*r<0&&(a=-a),a}function n(e,t){return t=Object.assign({},t),e.hasAttribute("fill")&&(t.fill=e.getAttribute("fill")),""!==e.style.fill&&(t.fill=e.style.fill),t}function i(e){return"none"!==e.fill&&"transparent"!==e.fill}function o(e,t){return e-(t-e)}function a(e){for(var t=e.split(/[\s,]+|(?=\s?[+\-])/),r=0;r<t.length;r++){var n=t[r];if(n.indexOf(".")!==n.lastIndexOf("."))for(var i=n.split("."),o=2;o<i.length;o++)t.splice(r+o-1,0,"0."+i[o]);t[r]=parseFloat(n)}return t}function c(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function u(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}console.log("SVGLoader");var l=[],h=[],f=new d,p=new d,m=new d,v=new d;console.time("SVGLoader: DOMParser");var g=(new DOMParser).parseFromString(e,"image/svg+xml");return console.timeEnd("SVGLoader: DOMParser"),console.time("SVGLoader: Parse"),function e(r,g){if(1===r.nodeType){var y=function(e){if(!e.hasAttribute("transform"))return null;var t=function(e){var t=e.getAttribute("transform"),r=null,n=t.indexOf("("),i=t.indexOf(")");if(n>0&&n<i){var o=t.substr(0,n),s=a(t.substr(n+1,i-n-1));switch(o){case"translate":if(s.length>=1){r=new d;var c=s[0],u=c;s.length>=2&&(u=s[1]),r.translate(c,u)}break;case"rotate":if(s.length>=1){var l=0,h=0,v=0;r=new d,l=-s[0]*Math.PI/180,s.length>=3&&(h=s[1],v=s[2]),f.identity().translate(-h,-v),p.identity().rotate(l),m.multiplyMatrices(p,f),f.identity().translate(h,v),r.multiplyMatrices(f,m)}break;case"scale":if(s.length>=1){r=new d;var g=s[0],y=g;s.length>=2&&(y=s[1]),r.scale(g,y)}break;case"skewX":1===s.length&&(r=new d).set(1,Math.tan(s[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===s.length&&(r=new d).set(1,0,0,Math.tan(s[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===s.length&&(r=new d).set(s[0],s[2],s[4],s[1],s[3],s[5],0,0,1)}}return r}(e);return t&&(h.length>0&&t.premultiply(h[h.length-1]),v.copy(t),h.push(t)),t}(r),b=null;switch(r.nodeName){case"svg":break;case"g":g=n(r,g);break;case"path":g=n(r,g),r.hasAttribute("d")&&i(g)&&(b=function(e,r){var n=new Ms;n.color.setStyle(r.fill);for(var i=new x,s=new x,c=new x,u=!0,l=!1,h=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),d=0,f=h.length;d<f;d++){var p=h[d],m=p.charAt(0),v=p.substr(1).trim();switch(u&&(l=!0),u=!1,m){case"M":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x=g[y+0],i.y=g[y+1],s.x=i.x,s.y=i.y,0===y?n.moveTo(i.x,i.y):n.lineTo(i.x,i.y);break;case"H":for(var g=a(v),y=0,b=g.length;y<b;y++)i.x=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"V":for(var g=a(v),y=0,b=g.length;y<b;y++)i.y=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"L":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x=g[y+0],i.y=g[y+1],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"C":for(var g=a(v),y=0,b=g.length;y<b;y+=6)n.bezierCurveTo(g[y+0],g[y+1],g[y+2],g[y+3],g[y+4],g[y+5]),s.x=g[y+2],s.y=g[y+3],i.x=g[y+4],i.y=g[y+5];break;case"S":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.bezierCurveTo(o(i.x,s.x),o(i.y,s.y),g[y+0],g[y+1],g[y+2],g[y+3]),s.x=g[y+0],s.y=g[y+1],i.x=g[y+2],i.y=g[y+3];break;case"Q":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.quadraticCurveTo(g[y+0],g[y+1],g[y+2],g[y+3]),s.x=g[y+0],s.y=g[y+1],i.x=g[y+2],i.y=g[y+3];break;case"T":for(var g=a(v),y=0,b=g.length;y<b;y+=2){var w=o(i.x,s.x),_=o(i.y,s.y);n.quadraticCurveTo(w,_,g[y+0],g[y+1]),s.x=w,s.y=_,i.x=g[y+0],i.y=g[y+1]}break;case"A":for(var g=a(v),y=0,b=g.length;y<b;y+=7){var S=i.clone();i.x=g[y+5],i.y=g[y+6],s.x=i.x,s.y=i.y,t(n,g[y],g[y+1],g[y+2],g[y+3],g[y+4],S,i)}break;case"m":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x+=g[y+0],i.y+=g[y+1],s.x=i.x,s.y=i.y,0===y?n.moveTo(i.x,i.y):n.lineTo(i.x,i.y);break;case"h":for(var g=a(v),y=0,b=g.length;y<b;y++)i.x+=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"v":for(var g=a(v),y=0,b=g.length;y<b;y++)i.y+=g[y],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"l":for(var g=a(v),y=0,b=g.length;y<b;y+=2)i.x+=g[y+0],i.y+=g[y+1],s.x=i.x,s.y=i.y,n.lineTo(i.x,i.y);break;case"c":for(var g=a(v),y=0,b=g.length;y<b;y+=6)n.bezierCurveTo(i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3],i.x+g[y+4],i.y+g[y+5]),s.x=i.x+g[y+2],s.y=i.y+g[y+3],i.x+=g[y+4],i.y+=g[y+5];break;case"s":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.bezierCurveTo(o(i.x,s.x),o(i.y,s.y),i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3]),s.x=i.x+g[y+0],s.y=i.y+g[y+1],i.x+=g[y+2],i.y+=g[y+3];break;case"q":for(var g=a(v),y=0,b=g.length;y<b;y+=4)n.quadraticCurveTo(i.x+g[y+0],i.y+g[y+1],i.x+g[y+2],i.y+g[y+3]),s.x=i.x+g[y+0],s.y=i.y+g[y+1],i.x+=g[y+2],i.y+=g[y+3];break;case"t":for(var g=a(v),y=0,b=g.length;y<b;y+=2){var w=o(i.x,s.x),_=o(i.y,s.y);n.quadraticCurveTo(w,_,i.x+g[y+0],i.y+g[y+1]),s.x=w,s.y=_,i.x=i.x+g[y+0],i.y=i.y+g[y+1]}break;case"a":for(var g=a(v),y=0,b=g.length;y<b;y+=7){var S=i.clone();i.x+=g[y+5],i.y+=g[y+6],s.x=i.x,s.y=i.y,t(n,g[y],g[y+1],g[y+2],g[y+3],g[y+4],S,i)}break;case"Z":case"z":n.currentPath.autoClose=!0,n.currentPath.curves.length>0&&(i.copy(c),n.currentPath.currentPoint.copy(i),u=!0);break;default:console.warn(p)}l&&(c.copy(i),l=!1)}return n}(r,g));break;case"rect":i(g=n(r,g))&&(b=function(e,t){var r=parseFloat(e.getAttribute("x")||0),n=parseFloat(e.getAttribute("y")||0),i=parseFloat(e.getAttribute("rx")||0),o=parseFloat(e.getAttribute("ry")||0),a=parseFloat(e.getAttribute("width")),s=parseFloat(e.getAttribute("height")),c=new Ms;return c.color.setStyle(t.fill),c.moveTo(r+2*i,n),c.lineTo(r+a-2*i,n),(0!==i||0!==o)&&c.bezierCurveTo(r+a,n,r+a,n,r+a,n+2*o),c.lineTo(r+a,n+s-2*o),(0!==i||0!==o)&&c.bezierCurveTo(r+a,n+s,r+a,n+s,r+a-2*i,n+s),c.lineTo(r+2*i,n+s),(0!==i||0!==o)&&c.bezierCurveTo(r,n+s,r,n+s,r,n+s-2*o),c.lineTo(r,n+2*o),(0!==i||0!==o)&&c.bezierCurveTo(r,n,r,n,r+2*i,n),c}(r,g));break;case"polygon":i(g=n(r,g))&&(b=function(e,t){var r=new Ms;r.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,i){var o=parseFloat(t),a=parseFloat(i);0===n?r.moveTo(o,a):r.lineTo(o,a),n++}),r.currentPath.autoClose=!0,r}(r,g));break;case"polyline":i(g=n(r,g))&&(b=function(e,t){var r=new Ms;r.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,i){var o=parseFloat(t),a=parseFloat(i);0===n?r.moveTo(o,a):r.lineTo(o,a),n++}),r.currentPath.autoClose=!1,r}(r,g));break;case"circle":i(g=n(r,g))&&(b=function(e,t){var r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("r")),o=new Za;o.absarc(r,n,i,0,2*Math.PI);var a=new Ms;return a.color.setStyle(t.fill),a.subPaths.push(o),a}(r,g));break;case"ellipse":i(g=n(r,g))&&(b=function(e,t){var r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("rx")),o=parseFloat(e.getAttribute("ry")),a=new Za;a.absellipse(r,n,i,o,0,2*Math.PI);var s=new Ms;return s.color.setStyle(t.fill),s.subPaths.push(a),s}(r,g));break;case"line":i(g=n(r,g))&&(b=function(e,t){var r=parseFloat(e.getAttribute("x1")),n=parseFloat(e.getAttribute("y1")),i=parseFloat(e.getAttribute("x2")),o=parseFloat(e.getAttribute("y2")),a=new Ms;return a.moveTo(r,n),a.lineTo(i,o),a.currentPath.autoClose=!1,a}(r));break;default:console.log(r)}b&&(function(e,t){function r(e){o.set(e.x,e.y,1).applyMatrix3(t),e.set(o.x,o.y)}for(var n=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=new x,o=new s,a=e.subPaths,l=0,h=a.length;l<h;l++)for(var d=a[l],f=d.curves,p=0;p<f.length;p++){var m=f[p];m.isLineCurve?(r(m.v1),r(m.v2)):m.isCubicBezierCurve?(r(m.v0),r(m.v1),r(m.v2),r(m.v3)):m.isQuadraticBezierCurve?(r(m.v0),r(m.v1),r(m.v2)):m.isEllipseCurve&&(n&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),i.set(m.aX,m.aY),r(i),m.aX=i.x,m.aY=i.y,m.xRadius*=c(t),m.yRadius*=u(t))}}(b,v),l.push(b));for(var w=r.childNodes,_=0;_<w.length;_++)e(w[_],g);y&&v.copy(h.pop())}}(g.documentElement,{fill:"#000"}),console.timeEnd("SVGLoader: Parse"),l}};var As=function(e){this.manager=void 0!==e?e:cn,this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};As.prototype={constructor:As,load:function(e,t,r,n){var i=this,o=void 0!==this.path?this.path:Cn.extractUrlBase(e),a=new ln(this.manager);a.setResponseType("arraybuffer"),a.load(e,function(e){t(i.parse(e,o))},r,n)},parse:function(e,t){this.group=new oo,this.position=0,this.materials=[],this.meshes=[],this.readFile(e,t);for(var r=0;r<this.meshes.length;r++)this.group.add(this.meshes[r]);return this.group},readFile:function(e,t){var r=new DataView(e),n=this.readChunk(r);if(n.id===Cs||n.id===Ls||n.id===Es)for(var i=this.nextChunk(r,n);0!==i;){if(i===Ps){var o=this.readDWord(r);this.debugMessage("3DS file version: "+o)}else i===Ds?(this.resetPosition(r),this.readMeshData(r,t)):this.debugMessage("Unknown main chunk: "+i.toString(16));i=this.nextChunk(r,n)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r);0!==n;){if(n===Fs){var i=+this.readDWord(e);this.debugMessage("Mesh Version: "+i)}else if(n===Us){var o=this.readFloat(e);this.debugMessage("Master scale: "+o),this.group.scale.set(o,o,o)}else n===nc?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):n===ks?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,t)):this.debugMessage("Unknown MDATA chunk: "+n.toString(16));n=this.nextChunk(e,r)}},readNamedObject:function(e){var t=this.readChunk(e),r=this.readString(e,64);t.cur=this.position;for(var n=this.nextChunk(e,t);0!==n;){if(n===ic){this.resetPosition(e);var i=this.readMesh(e);i.name=r,this.meshes.push(i)}else this.debugMessage("Unknown named object chunk: "+n.toString(16));n=this.nextChunk(e,t)}this.endChunk(t)},readMaterialEntry:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r),i=new vn;0!==n;){if(n===Bs)i.name=this.readString(e,64),this.debugMessage("   Name: "+i.name);else if(n===Xs)this.debugMessage("   Wireframe"),i.wireframe=!0;else if(n===qs){var o=this.readByte(e);i.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(n===Ws)i.side=J,this.debugMessage("   DoubleSided");else if(n===Hs)this.debugMessage("   Additive Blending"),i.blending=te;else if(n===js)this.debugMessage("   Diffuse Color"),i.color=this.readColor(e);else if(n===Vs)this.debugMessage("   Specular Color"),i.specular=this.readColor(e);else if(n===zs)this.debugMessage("   Ambient color"),i.color=this.readColor(e);else if(n===Gs){var a=this.readWord(e);i.shininess=a,this.debugMessage("   Shininess : "+a)}else n===Ys?(this.debugMessage("   ColorMap"),this.resetPosition(e),i.map=this.readMap(e,t)):n===Qs?(this.debugMessage("   BumpMap"),this.resetPosition(e),i.bumpMap=this.readMap(e,t)):n===Js?(this.debugMessage("   OpacityMap"),this.resetPosition(e),i.alphaMap=this.readMap(e,t)):n===Zs?(this.debugMessage("   SpecularMap"),this.resetPosition(e),i.specularMap=this.readMap(e,t)):this.debugMessage("   Unknown material chunk: "+n.toString(16));n=this.nextChunk(e,r)}this.endChunk(r),this.materials[i.name]=i},readMesh:function(e){var t=this.readChunk(e),r=this.nextChunk(e,t),n=new U,i=[],o=new dr(n,new vn);for(o.name="mesh";0!==r;){if(r===oc){var s=this.readWord(e);this.debugMessage("   Vertex: "+s);for(var c=[],u=0;u<s;u++)c.push(this.readFloat(e)),c.push(this.readFloat(e)),c.push(this.readFloat(e));n.addAttribute("position",new N(c,3))}else if(r===ac)this.resetPosition(e),this.readFaceArray(e,o);else if(r===cc){var l=this.readWord(e);this.debugMessage("   UV: "+l);for(i=[],u=0;u<l;u++)i.push(this.readFloat(e)),i.push(this.readFloat(e));n.addAttribute("uv",new N(i,2))}else if(r===uc){this.debugMessage("   Tranformation Matrix (TODO)");var h=[];for(u=0;u<12;u++)h[u]=this.readFloat(e);var d=new a;d.elements[0]=h[0],d.elements[1]=h[6],d.elements[2]=h[3],d.elements[3]=h[9],d.elements[4]=h[2],d.elements[5]=h[8],d.elements[6]=h[5],d.elements[7]=h[11],d.elements[8]=h[1],d.elements[9]=h[7],d.elements[10]=h[4],d.elements[11]=h[10],d.elements[12]=0,d.elements[13]=0,d.elements[14]=0,d.elements[15]=1,d.transpose();var f=new a;f.getInverse(d,!0),n.applyMatrix(f),d.decompose(o.position,o.quaternion,o.scale)}else this.debugMessage("   Unknown mesh chunk: "+r.toString(16));r=this.nextChunk(e,t)}return this.endChunk(t),n.computeVertexNormals(),o},readFaceArray:function(e,t){var r=this.readChunk(e),n=this.readWord(e);this.debugMessage("   Faces: "+n);for(var i=[],o=0;o<n;++o){i.push(this.readWord(e),this.readWord(e),this.readWord(e));this.readWord(e)}for(t.geometry.setIndex(i);this.position<r.end;){if((r=this.readChunk(e)).id===sc){this.debugMessage("      Material Group"),this.resetPosition(e);var a=this.readMaterialGroup(e),s=this.materials[a.name];void 0!==s&&(t.material=s,""===s.name&&(s.name=t.name))}else this.debugMessage("      Unknown face array chunk: "+r.toString(16));this.endChunk(r)}this.endChunk(r)},readMap:function(e,t){var r=this.readChunk(e),n=this.nextChunk(e,r),i={},o=new An(this.manager);for(o.setPath(t);0!==n;){if(n===Ks){var a=this.readString(e,128);i=o.load(a),this.debugMessage("      File: "+t+a)}else n===tc?(i.offset.x=this.readFloat(e),this.debugMessage("      OffsetX: "+i.offset.x)):n===rc?(i.offset.y=this.readFloat(e),this.debugMessage("      OffsetY: "+i.offset.y)):n===$s?(i.repeat.x=this.readFloat(e),this.debugMessage("      RepeatX: "+i.repeat.x)):n===ec?(i.repeat.y=this.readFloat(e),this.debugMessage("      RepeatY: "+i.repeat.y)):this.debugMessage("      Unknown map chunk: "+n.toString(16));n=this.nextChunk(e,r)}return this.endChunk(r),i},readMaterialGroup:function(e){this.readChunk(e);var t=this.readString(e,64),r=this.readWord(e);this.debugMessage("         Name: "+t),this.debugMessage("         Faces: "+r);for(var n=[],i=0;i<r;++i)n.push(this.readWord(e));return{name:t,index:n}},readColor:function(e){var t=this.readChunk(e),r=new v;if(t.id===Ns||t.id===Rs){var n=this.readByte(e),i=this.readByte(e),o=this.readByte(e);r.setRGB(n/255,i/255,o/255),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else if(t.id===Os||t.id===Is){n=this.readFloat(e),i=this.readFloat(e),o=this.readFloat(e);r.setRGB(n,i,o),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else this.debugMessage("      Unknown color chunk: "+t.toString(16));return this.endChunk(t),r},readChunk:function(e){var t={};return t.cur=this.position,t.id=this.readWord(e),t.size=this.readDWord(e),t.end=t.cur+t.size,t.cur+=6,t},endChunk:function(e){this.position=e.end},nextChunk:function(e,t){if(t.cur>=t.end)return 0;this.position=t.cur;try{var r=this.readChunk(e);return t.cur+=r.size,r.id}catch(e){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var t=e.getUint8(this.position,!0);return this.position+=1,t},readFloat:function(e){try{var t=e.getFloat32(this.position,!0);return this.position+=4,t}catch(t){this.debugMessage(t+" "+this.position+" "+e.byteLength)}},readInt:function(e){var t=e.getInt32(this.position,!0);return this.position+=4,t},readShort:function(e){var t=e.getInt16(this.position,!0);return this.position+=2,t},readDWord:function(e){var t=e.getUint32(this.position,!0);return this.position+=4,t},readWord:function(e){var t=e.getUint16(this.position,!0);return this.position+=2,t},readString:function(e,t){for(var r="",n=0;n<t;n++){var i=this.readByte(e);if(!i)break;r+=String.fromCharCode(i)}return r},setPath:function(e){return this.path=e,this},debugMessage:function(e){this.debug&&console.log(e)}};var Es=19789,Cs=15786,Ls=49725,Ps=2,Os=16,Ns=17,Rs=18,Is=19,Ds=15677,Fs=15678,Us=256,ks=45055,Bs=40960,zs=40976,js=40992,Vs=41008,Gs=41024,Ws=41089,Hs=41091,Xs=41093,qs=41095,Ys=41472,Js=41488,Qs=41520,Zs=41476,Ks=41728,$s=41812,ec=41814,tc=41816,rc=41818,nc=16384,ic=16640,oc=16656,ac=16672,sc=16688,cc=16704,uc=16736,lc=function(e){this.manager=void 0!==e?e:cn,this.reversed=!1};lc.prototype={constructor:lc,load:function(e,t,r,n){var i=this,o=new ln(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e){var t,r=[];e.forEach(function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)});var n=[];return r.forEach(function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};n.push(t);for(var r=e.length-1;r>0;r--){var i=e[r];t={type:i.type};void 0!==i.x2&&void 0!==i.y2?(t.x1=i.x2,t.y1=i.y2,t.x2=i.x1,t.y2=i.y1):void 0!==i.x1&&void 0!==i.y1&&(t.x1=i.x1,t.y1=i.y1),t.x=e[r-1].x,t.y=e[r-1].y,n.push(t)}}),n}return"undefined"==typeof opentype?(console.warn("TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,r){for(var n=Math.round,i={},o=1e5/(72*(e.unitsPerEm||2048)),a=0;a<e.glyphs.length;a++){var s=e.glyphs.glyphs[a];if(void 0!==s.unicode){var c={ha:n(s.advanceWidth*o),x_min:n(s.xMin*o),x_max:n(s.xMax*o),o:""};r&&(s.path.commands=t(s.path.commands)),s.path.commands.forEach(function(e,t){"c"===e.type.toLowerCase()&&(e.type="b"),c.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(c.o+=n(e.x*o)+" "+n(e.y*o)+" "),void 0!==e.x1&&void 0!==e.y1&&(c.o+=n(e.x1*o)+" "+n(e.y1*o)+" "),void 0!==e.x2&&void 0!==e.y2&&(c.o+=n(e.x2*o)+" "+n(e.y2*o)+" ")}),i[String.fromCharCode(s.unicode)]=c}}return{glyphs:i,familyName:e.familyName,ascender:n(e.ascender*o),descender:n(e.descender*o),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(opentype.parse(e),this.reversed)}};var hc=function(e){this.manager=void 0!==e?e:cn};hc.prototype={constructor:hc,isRecordingPoints:!1,isRecordingFaces:!1,points:[],indexes:[],isRecordingAngles:!1,isRecordingColors:!1,angles:[],colors:[],recordingFieldname:null,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this;new ln(this.manager).load(e,function(e){t(i.parse(e))},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e){var t=this,r=this.texturePath||"",n=new An(this.manager);n.setCrossOrigin(this.crossOrigin);for(var i=new qr,o=e.split("\n"),a=o.length-1;a>-1;a--){var c=o[a];if(/{.*[{\[]/.test(c))(u=c.split("{").join("{\n").split("\n")).unshift(1),u.unshift(a),o.splice.apply(o,u);else if(/\].*}/.test(c)){var u;(u=c.split("]").join("]\n").split("\n")).unshift(1),u.unshift(a),o.splice.apply(o,u)}if(/}.*}/.test(c))(u=c.split("}").join("}\n").split("\n")).unshift(1),u.unshift(a),o.splice.apply(o,u);/^\b[^\s]+\b$/.test(c.trim())?(o[a+1]=c+" "+o[a+1].trim(),o.splice(a,1)):c.indexOf("coord")>-1&&c.indexOf("[")<0&&c.indexOf("{")<0&&(o[a]+=" Coordinate {}")}var l=o.shift();return/V1.0/.exec(l)?console.warn("VRMLLoader: V1.0 not supported yet."):/V2.0/.exec(l)&&function(e,i){var o={},a=/(\b|\-|\+)([\d\.e]+)/,c=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,u=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g;function l(e,t,r,n,i){for(var o=!0===i?1:-1,a=[],c={},u={},l=0;l<r.length;l++){var h={x:o*(Math.cos(r[l])*t),y:o*(Math.sin(r[l])*t)};a.push(h)}for(var d=e.index,f=e.attributes.position,p=new M(new Float32Array(3*e.attributes.position.count),3),m=new s,g=new v,y=0;y<d.count;y++){var b=d.getX(y);m.fromBufferAttribute(f,b);for(var x=0;x<n.length;x++)if(0===x?(c.x=0,c.y=!0===i?t:-1*t):(c.x=a[x-1].x,c.y=a[x-1].y),void 0!==(u=a[x]))if(!0==(!0===i?m.y<=c.y&&m.y>u.y:m.y>=c.y&&m.y<u.y)){var w=n[x],_=n[x+1],S=Math.abs(m.y-c.y)/(c.y-u.y);g.copy(w).lerp(_,S),p.setXYZ(b,g.r,g.g,g.b)}else{var T=n[!0===i?n.length-1:0];p.setXYZ(b,T.r,T.g,T.b)}}e.addAttribute("color",p)}var h=[];function d(e,r){for(var n,i,o,s=[],l={},d=/[^\s,\[\]]+/g;null!==(n=d.exec(r));)s.push(n[0]);switch(i=s[0]){case"skyAngle":case"groundAngle":t.recordingFieldname=i,t.isRecordingAngles=!0,t.angles=[];break;case"skyColor":case"groundColor":t.recordingFieldname=i,t.isRecordingColors=!0,t.colors=[];break;case"point":t.recordingFieldname=i,t.isRecordingPoints=!0,t.points=[];break;case"coordIndex":case"texCoordIndex":t.recordingFieldname=i,t.isRecordingFaces=!0,t.indexes=[]}if(t.isRecordingFaces){if(s.length>0)for(var f=0;f<s.length;f++)/(-?\d+)/.test(s[f])&&("-1"===s[f]?(h.length>0&&t.indexes.push(h),h=[]):h.push(parseInt(s[f])));/]/.exec(r)&&(h.length>0&&t.indexes.push(h),h=[],t.isRecordingFaces=!1,e[t.recordingFieldname]=t.indexes)}else if(t.isRecordingPoints){if("Coordinate"==e.nodeType)for(;null!==(s=u.exec(r));)o={x:parseFloat(s[1]),y:parseFloat(s[2]),z:parseFloat(s[3])},t.points.push(o);if("TextureCoordinate"==e.nodeType)for(;null!==(s=c.exec(r));)o={x:parseFloat(s[1]),y:parseFloat(s[2])},t.points.push(o);/]/.exec(r)&&(t.isRecordingPoints=!1,e.points=t.points)}else if(t.isRecordingAngles){if(s.length>0)for(f=0;f<s.length;f++)a.test(s[f])&&t.angles.push(parseFloat(s[f]));/]/.exec(r)&&(t.isRecordingAngles=!1,e[t.recordingFieldname]=t.angles)}else if(t.isRecordingColors){for(;null!==(s=u.exec(r));){var p={r:parseFloat(s[1]),g:parseFloat(s[2]),b:parseFloat(s[3])};t.colors.push(p)}/]/.exec(r)&&(t.isRecordingColors=!1,e[t.recordingFieldname]=t.colors)}else if("NULL"!==s[s.length-1]&&"children"!==i){switch(i){case"diffuseColor":case"emissiveColor":case"specularColor":case"color":if(4!==s.length){console.warn("VRMLLoader: Invalid color format detected for %s.",i);break}l={r:parseFloat(s[1]),g:parseFloat(s[2]),b:parseFloat(s[3])};break;case"location":case"direction":case"translation":case"scale":case"size":if(4!==s.length){console.warn("VRMLLoader: Invalid vector format detected for %s.",i);break}l={x:parseFloat(s[1]),y:parseFloat(s[2]),z:parseFloat(s[3])};break;case"intensity":case"cutOffAngle":case"radius":case"topRadius":case"bottomRadius":case"height":case"transparency":case"shininess":case"ambientIntensity":if(2!==s.length){console.warn("VRMLLoader: Invalid single float value specification detected for %s.",i);break}l=parseFloat(s[1]);break;case"rotation":if(5!==s.length){console.warn("VRMLLoader: Invalid quaternion format detected for %s.",i);break}l={x:parseFloat(s[1]),y:parseFloat(s[2]),z:parseFloat(s[3]),w:parseFloat(s[4])};break;case"on":case"ccw":case"solid":case"colorPerVertex":case"convex":if(2!==s.length){console.warn("VRMLLoader: Invalid format detected for %s.",i);break}l="TRUE"===s[1]}e[i]=l}return l}!function e(t,a){var c;if("string"!=typeof t){c=a,t.string.indexOf("AmbientLight")>-1&&"PointLight"===t.nodeType&&(t.nodeType="AmbientLight");var u=void 0===t.on||t.on,h=void 0!==t.intensity?t.intensity:1,d=new v;if(t.color&&d.copy(t.color),"AmbientLight"===t.nodeType)(c=new Ao(d,h)).visible=u,a.add(c);else if("PointLight"===t.nodeType){var f=0;void 0!==t.radius&&t.radius<1e3&&(f=t.radius),(c=new yo(d,h,f)).visible=u,a.add(c)}else if("SpotLight"===t.nodeType){h=1,f=0;var m=Math.PI/3;u=!0,void 0!==t.radius&&t.radius<1e3&&(f=t.radius),void 0!==t.cutOffAngle&&(m=t.cutOffAngle),(c=new _o(d,h,f,m,0)).visible=u,a.add(c)}else if("Transform"===t.nodeType||"Group"===t.nodeType){if(c=new p,/DEF/.exec(t.string)&&(c.name=/DEF\s+([^\s]+)/.exec(t.string)[1],o[c.name]=c),void 0!==t.translation){var g=t.translation;c.position.set(g.x,g.y,g.z)}if(void 0!==t.rotation){var y=t.rotation;c.quaternion.setFromAxisAngle(new s(y.x,y.y,y.z),y.w)}if(void 0!==t.scale){var b=t.scale;c.scale.set(b.x,b.y,b.z)}a.add(c)}else if("Shape"===t.nodeType)c=new dr,/DEF/.exec(t.string)&&(c.name=/DEF\s+([^\s]+)/.exec(t.string)[1],o[c.name]=c),a.add(c);else if("Background"===t.nodeType){var w=2e4,_=new B(w,20,20),S=new cr({fog:!1,side:Y});if(t.skyColor.length>1)l(_,w,t.skyAngle,t.skyColor,!0),S.vertexColors=K;else{var M=t.skyColor[0];S.color.setRGB(M.r,M.b,M.g)}if(i.add(new dr(_,S)),void 0!==t.groundColor){var T=new B(w=12e3,20,20,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),A=new cr({fog:!1,side:Y,vertexColors:K});l(T,w,t.groundAngle,t.groundColor,!1),i.add(new dr(T,A))}}else{if(/geometry/.exec(t.string)){if("Box"===t.nodeType)b=t.size,a.geometry=new Ur(b.x,b.y,b.z);else if("Cylinder"===t.nodeType)a.geometry=new Br(t.radius,t.radius,t.height);else if("Cone"===t.nodeType)a.geometry=new Br(t.topRadius,t.bottomRadius,t.height);else if("Sphere"===t.nodeType)a.geometry=new B(t.radius);else if("IndexedFaceSet"===t.nodeType){var E,C,L,P,O,R=new U,I=[],D=[];for(X=0,L=t.children.length;X<L;X++){if("TextureCoordinate"===(q=t.children[X]).nodeType&&q.points)for(P=0,O=q.points.length;P<O;P++)C=q.points[P],D.push(C.x,C.y);if("Coordinate"===q.nodeType){if(q.points)for(P=0,O=q.points.length;P<O;P++)E=q.points[P],I.push(E.x,E.y,E.z);if(q.string.indexOf("DEF")>-1){var F=/DEF\s+([^\s]+)/.exec(q.string)[1];o[F]=I.slice(0)}q.string.indexOf("USE")>-1&&(re=/USE\s+([^\s]+)/.exec(q.string)[1],I=o[re])}}var k=0;if(t.coordIndex){var z=[],j=[];for(E=new s,C=new x,X=0,L=t.coordIndex.length;X<L;X++){var V=t.coordIndex[X];for(k=0;V.length>=3&&k<V.length-2;){void 0===t.ccw&&(t.ccw=!0);var G=V[0],W=V[k+(t.ccw?1:2)],H=V[k+(t.ccw?2:1)];E.fromArray(I,3*G),C.fromArray(D,2*G),z.push(E.x,E.y,E.z),j.push(C.x,C.y),E.fromArray(I,3*W),C.fromArray(D,2*W),z.push(E.x,E.y,E.z),j.push(C.x,C.y),E.fromArray(I,3*H),C.fromArray(D,2*H),z.push(E.x,E.y,E.z),j.push(C.x,C.y),k++}}I=z,D=j}else a.parent.remove(a);!1===t.solid&&(a.material.side=J),R.solid=t.solid,R.addAttribute("position",new N(I,3)),D.length>0&&R.addAttribute("uv",new N(D,2)),R.computeVertexNormals(),R.computeBoundingSphere(),/DEF/.exec(t.string)&&(R.name=/DEF ([^\s]+)/.exec(t.string)[1],o[R.name]=R),a.geometry=R}return}if(/appearance/.exec(t.string)){for(var X=0;X<t.children.length;X++){var q;if("Material"===(q=t.children[X]).nodeType){var Q=new vn;if(void 0!==q.diffuseColor){var Z=q.diffuseColor;Q.color.setRGB(Z.r,Z.g,Z.b)}if(void 0!==q.emissiveColor){var $=q.emissiveColor;Q.emissive.setRGB($.r,$.g,$.b)}void 0!==q.specularColor&&(b=q.specularColor,Q.specular.setRGB(b.r,b.g,b.b)),void 0!==q.transparency&&(g=q.transparency,Q.opacity=Math.abs(1-g),Q.transparent=!0),/DEF/.exec(t.string)&&(Q.name=/DEF ([^\s]+)/.exec(t.string)[1],o[Q.name]=Q),a.material=Q}if("ImageTexture"===q.nodeType){var ee=/"([^"]+)"/.exec(q.children[0]);ee&&(a.material.name=ee[1],a.material.map=n.load(r+ee[1]))}}return}}X=0;for(var te=t.children.length;X<te;X++)e(t.children[X],c)}else if(/USE/.exec(t)){var re=/USE\s+?([^\s]+)/.exec(t)[1];void 0==o[re]?console.warn("VRMLLoader: %s is not defined.",re):/appearance/.exec(t)&&re?a.material=o[re].clone():/geometry/.exec(t)&&re?(a.geometry=o[re].clone(),void 0!==o[re].solid&&!1===o[re].solid&&(a.geometry.solid=!1,a.material.side=J)):re&&(c=o[re].clone(),a.add(c))}}(function(e){for(var t,r,n={string:"Scene",children:[]},i=n,o=0;o<e.length;o++){var a="",s=e[o];if(null===/^\s+?$/g.exec(s)&&""!==(s=s.trim())){if(/#/.exec(s)){var c=s.split("#");s=c[0],a=c[1]}if(t=/([^\s]*){1}(?:\s+)?{/.exec(s)){var u={nodeType:t[1],string:s,parent:i,children:[],comment:a};i.children.push(u),i=u,/}/.exec(s)&&(r=/{(.*)}/.exec(s)[1],u.children.push(r),d(i,r),i=i.parent)}else/}/.exec(s)?i=i.parent:""!==s&&(d(i,s),i.children.push(s))}}return n}(e),i)}(o,i),i}};var dc=function(){function e(e){if(void 0===Go)throw new Error("VRMLoader: Import GLTFLoader.");this.manager=void 0!==e?e:cn,this.gltfLoader=new Go(this.manager)}return e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this;this.gltfLoader.load(e,function(e){i.parse(e,t)},r,n)},setCrossOrigin:function(e){return this.glTFLoader.setCrossOrigin(e),this},setPath:function(e){return this.glTFLoader.setPath(e),this},setDRACOLoader:function(e){return this.glTFLoader.setDRACOLoader(e),this},parse:function(e,t){e.parser,(e.userData.gltfExtensions||{}).VRM;t(e)}},e}(),fc=function(e){this.manager=void 0!==e?e:cn};function pc(e){p.call(this),this.material=e,this.render=function(){}}Object.assign(fc.prototype,u.prototype,{load:function(e,t,r,n){var i=this,o=new ln(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},parse:function(e){function t(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}function r(e,t){var r=e.length,n=new Int32Array(r+t.length);return n.set(e),n.set(t,r),n}function n(e){for(var t="",r=new Uint8Array(e),n=0,i=r.length;i--;)t+=String.fromCharCode(r[n++]);return t}var o=Cn.decodeText(new Uint8Array(e,0,250)).split("\n");return-1!==o[0].indexOf("xml")?function(e){function n(e){var t,r,n,i,o,a,s="undefined"!=typeof Uint8Array?Uint8Array:Array,c=[],u=[],l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=l.length;for(t=0;t<h;t++)c[t]=l[t];for(t=0;t<h;++t)u[l.charCodeAt(t)]=t;if(u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63,(h=e.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a=new s(3*h/4-(o="="===e[h-2]?2:"="===e[h-1]?1:0)),n=o>0?h-4:h;var d=0;for(t=0,r=0;t<n;t+=4,r+=3)i=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],a[d++]=(16711680&i)>>16,a[d++]=(65280&i)>>8,a[d++]=255&i;return 2===o?(i=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,a[d++]=255&i):1===o&&(i=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,a[d++]=i>>8&255,a[d++]=255&i),a}function o(e,i){var o=0;if("UInt64"===s.attributes.header_type?o=8:"UInt32"===s.attributes.header_type&&(o=4),"binary"===e.attributes.format&&i){var a,c,u,l,h,d;if("Float32"===e.attributes.type)var f=new Float32Array;else"Int64"===e.attributes.type&&(f=new Int32Array);c=(a=n(e["#text"]))[0];for(var p=1;p<o-1;p++)c|=a[p]<<p*o;for(l=(c+3)*o,d=l+=l%3>0?3-l%3:0,(h=[]).push(d),u=3*o,p=0;p<c;p++){for(var m=a[p*o+u],v=1;v<o-1;v++)m|=a[p*o+u+v]<<8*v;d+=m,h.push(d)}for(p=0;p<h.length-1;p++)g=(g=new Zlib.Inflate(a.slice(h[p],h[p+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===e.attributes.type?f=t(f,g=new Float32Array(g)):"Int64"===e.attributes.type&&(f=r(f,g=new Int32Array(g)));delete e["#text"],"Float32"===e.attributes.type?"binary"===e.attributes.format&&(i||(f=f.filter(function(e,t){if(0!==t)return!0}))):"Int64"===e.attributes.type&&"binary"===e.attributes.format&&(i||(f=f.filter(function(e,t){if(0!==t)return!0})),f=f.filter(function(e,t){if(t%2!=1)return!0}))}else{if("binary"!==e.attributes.format||i)if(e["#text"])var g=e["#text"].split(/\s+/).filter(function(e){if(""!==e)return e});else g=new Int32Array(0).buffer;else g=(g=n(e["#text"])).slice(o).buffer;delete e["#text"],"Float32"===e.attributes.type?f=new Float32Array(g):"Int32"===e.attributes.type?f=new Int32Array(g):"Int64"===e.attributes.type&&(f=new Int32Array(g),"binary"===e.attributes.format&&(f=f.filter(function(e,t){if(t%2!=1)return!0})))}return f}var a=null;if(i.DOMParser)try{a=(new DOMParser).parseFromString(e,"text/xml")}catch(e){a=null}else{if(!i.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((a=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!a.loadXML())throw new Error(a.parseError.reason+a.parseError.srcText)}catch(e){a=null}}var s=function e(t){var r={};if(1===t.nodeType){if(t.attributes&&t.attributes.length>0){r.attributes={};for(var n=0;n<t.attributes.length;n++){var i=t.attributes.item(n);r.attributes[i.nodeName]=i.nodeValue.trim()}}}else 3===t.nodeType&&(r=t.nodeValue.trim());if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes.item(o),s=a.nodeName;if(void 0===r[s])""!==(u=e(a))&&(r[s]=u);else{if(void 0===r[s].push){var c=r[s];r[s]=[c]}var u;""!==(u=e(a))&&r[s].push(u)}}return r}(a.documentElement),c=[],u=[],l=[];if(s.PolyData){for(var h=s.PolyData.Piece,d=s.attributes.hasOwnProperty("compressor"),f=["PointData","Points","Strips","Polys"],p=0,m=f.length;p<m;){var v=h[f[p]];if(v&&v.DataArray){if("[object Array]"===Object.prototype.toString.call(v.DataArray))var g=v.DataArray;else g=[v.DataArray];for(var y=0,b=g.length;y<b;)"#text"in g[y]&&g[y]["#text"].length>0&&(g[y].text=o(g[y],d)),y++;switch(f[p]){case"PointData":var x=parseInt(h.attributes.NumberOfPoints),w=v.attributes.Normals;if(x>0)for(var _=0,S=g.length;_<S;_++)if(w===g[_].attributes.Name){var T=g[_].attributes.NumberOfComponents;(u=new Float32Array(x*T)).set(g[_].text,0)}break;case"Points":(x=parseInt(h.attributes.NumberOfPoints))>0&&(T=v.DataArray.attributes.NumberOfComponents,(c=new Float32Array(x*T)).set(v.DataArray.text,0));break;case"Strips":var A=parseInt(h.attributes.NumberOfStrips);if(A>0){var E=new Int32Array(v.DataArray[0].text.length),C=new Int32Array(v.DataArray[1].text.length);E.set(v.DataArray[0].text,0),C.set(v.DataArray[1].text,0);var L=A+E.length;l=new Uint32Array(3*L-9*A);var P=0;for(_=0,S=A;_<S;_++){for(var O=[],N=0,R=C[_],I=0;N<R-I;N++)O.push(E[N]),_>0&&(I=C[_-1]);var D=0;for(R=C[_],I=0;D<R-I-2;D++)D%2?(l[P++]=O[D],l[P++]=O[D+2],l[P++]=O[D+1]):(l[P++]=O[D],l[P++]=O[D+1],l[P++]=O[D+2]),_>0&&(I=C[_-1])}}break;case"Polys":var F=parseInt(h.attributes.NumberOfPolys);if(F>0){E=new Int32Array(v.DataArray[0].text.length),C=new Int32Array(v.DataArray[1].text.length),E.set(v.DataArray[0].text,0),C.set(v.DataArray[1].text,0),L=F+E.length,l=new Uint32Array(3*L-9*F),P=0;var k=0;for(_=0,S=F,I=0;_<S;){var B=[];for(N=0,R=C[_];N<R-I;)B.push(E[k++]),N++;for(D=1;D<R-I-1;)l[P++]=B[0],l[P++]=B[D],l[P++]=B[D+1],D++;I=C[++_-1]}}}}p++}var z=new U;return z.setIndex(new M(l,1)),z.addAttribute("position",new M(c,3)),u.length===c.length&&z.addAttribute("normal",new M(u,3)),z}}(n(e)):o[2].includes("ASCII")?function(e){var t,r=[],n=[],i=[],o=[],a=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,s=/^(\d+)\s+([\s\d]*)/,c=/^POINTS /,u=/^POLYGONS /,l=/^TRIANGLE_STRIPS /,h=/^POINT_DATA[ ]+(\d+)/,d=/^CELL_DATA[ ]+(\d+)/,f=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,p=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,m=!1,v=!1,g=!1,y=!1,b=!1,x=!1,w=!1,_=e.split("\n");for(var S in _){var M=_[S];if(m)for(;null!==(t=a.exec(M));){var T=parseFloat(t[1]),A=parseFloat(t[2]),E=parseFloat(t[3]);n.push(T,A,E)}else if(v){if(null!==(t=s.exec(M))){var C=parseInt(t[1]),L=t[2].split(/\s+/);if(C>=3)for(var P=parseInt(L[0]),O=1,R=0;R<C-2;++R)I=parseInt(L[O]),D=parseInt(L[O+1]),r.push(P,I,D),O++}}else if(g){if(null!==(t=s.exec(M))){var I,D;if(C=parseInt(t[1]),L=t[2].split(/\s+/),C>=3)for(R=0;R<C-2;R++)R%2==1?(P=parseInt(L[R]),I=parseInt(L[R+2]),D=parseInt(L[R+1]),r.push(P,I,D)):(P=parseInt(L[R]),I=parseInt(L[R+1]),D=parseInt(L[R+2]),r.push(P,I,D))}}else if(y||b)if(x)for(;null!==(t=a.exec(M));){var F=parseFloat(t[1]),k=parseFloat(t[2]),B=parseFloat(t[3]);i.push(F,k,B)}else if(w)for(;null!==(t=a.exec(M));){var z=parseFloat(t[1]),j=parseFloat(t[2]),V=parseFloat(t[3]);o.push(z,j,V)}null!==u.exec(M)?(v=!0,m=!1,g=!1):null!==c.exec(M)?(v=!1,m=!0,g=!1):null!==l.exec(M)?(v=!1,m=!1,g=!0):null!==h.exec(M)?(y=!0,m=!1,v=!1,g=!1):null!==d.exec(M)?(b=!0,m=!1,v=!1,g=!1):null!==f.exec(M)?(x=!0,w=!1,m=!1,v=!1,g=!1):null!==p.exec(M)&&(w=!0,x=!1,m=!1,v=!1,g=!1)}var G=new U;if(G.setIndex(r),G.addAttribute("position",new N(n,3)),o.length===n.length&&G.addAttribute("normal",new N(o,3)),i.length!==r.length)i.length===n.length&&G.addAttribute("color",new N(i,3));else{var W=(G=G.toNonIndexed()).attributes.position.count/3;if(i.length===3*W){var H=[];for(S=0;S<W;S++)F=i[3*S+0],k=i[3*S+1],B=i[3*S+2],H.push(F,k,B),H.push(F,k,B),H.push(F,k,B);G.addAttribute("color",new N(H,3))}}return G}(n(e)):function(e){var t,r,n,i,o,a,s,c=new Uint8Array(e),u=new DataView(e),l=[],h=[],d=[],f=0;function p(e,t){for(var r=t,n=e[r],i=[];10!==n;)i.push(String.fromCharCode(n)),n=e[++r];return{start:t,end:r,next:r+1,parsedString:i.join("")}}for(;;){if(0===(s=(a=p(c,f)).parsedString).indexOf("POINTS")){for(t=4*(i=parseInt(s.split(" ")[1],10))*3,l=new Float32Array(3*i),r=a.next,n=0;n<i;n++)l[3*n]=u.getFloat32(r,!1),l[3*n+1]=u.getFloat32(r+4,!1),l[3*n+2]=u.getFloat32(r+8,!1),r+=12;a.next=a.next+t+1}else if(0===s.indexOf("TRIANGLE_STRIPS")){var m=parseInt(s.split(" ")[1],10);t=4*(x=parseInt(s.split(" ")[2],10)),d=new Uint32Array(3*x-9*m);var v=0;for(r=a.next,n=0;n<m;n++){var g=u.getInt32(r,!1),y=[];for(r+=4,o=0;o<g;o++)y.push(u.getInt32(r,!1)),r+=4;for(var b=0;b<g-2;b++)b%2?(d[v++]=y[b],d[v++]=y[b+2],d[v++]=y[b+1]):(d[v++]=y[b],d[v++]=y[b+1],d[v++]=y[b+2])}a.next=a.next+t+1}else if(0===s.indexOf("POLYGONS")){var x;for(m=parseInt(s.split(" ")[1],10),t=4*(x=parseInt(s.split(" ")[2],10)),d=new Uint32Array(3*x-9*m),v=0,r=a.next,n=0;n<m;n++){for(g=u.getInt32(r,!1),y=[],r+=4,o=0;o<g;o++)y.push(u.getInt32(r,!1)),r+=4;for(b=1;b<g-1;b++)d[v++]=y[0],d[v++]=y[b],d[v++]=y[b+1]}a.next=a.next+t+1}else if(0===s.indexOf("POINT_DATA")){for(i=parseInt(s.split(" ")[1],10),a=p(c,a.next),t=4*i*3,h=new Float32Array(3*i),r=a.next,n=0;n<i;n++)h[3*n]=u.getFloat32(r,!1),h[3*n+1]=u.getFloat32(r+4,!1),h[3*n+2]=u.getFloat32(r+8,!1),r+=12;a.next=a.next+t}if((f=a.next)>=c.byteLength)break}var w=new U;return w.setIndex(new M(d,1)),w.addAttribute("position",new M(l,3)),h.length===l.length&&w.addAttribute("normal",new M(h,3)),w}(e)}}),pc.prototype=Object.create(p.prototype),pc.prototype.constructor=pc,pc.prototype.isImmediateRenderObject=!0;var mc=function(e,t,r,n){pc.call(this,t);var i=this,o=new Float32Array(36),a=new Float32Array(36);function s(e,t,r){return e+(t-e)*r}function c(e,t,r,n,c,u,l,h){var d=(r-l)/(h-l),f=i.normal_cache;o[t+0]=n+d*i.delta,o[t+1]=c,o[t+2]=u,a[t+0]=s(f[e+0],f[e+3],d),a[t+1]=s(f[e+1],f[e+4],d),a[t+2]=s(f[e+2],f[e+5],d)}function u(e,t,r,n,c,u,l,h){var d=(r-l)/(h-l),f=i.normal_cache;o[t+0]=n,o[t+1]=c+d*i.delta,o[t+2]=u;var p=e+3*i.yd;a[t+0]=s(f[e+0],f[p+0],d),a[t+1]=s(f[e+1],f[p+1],d),a[t+2]=s(f[e+2],f[p+2],d)}function l(e,t,r,n,c,u,l,h){var d=(r-l)/(h-l),f=i.normal_cache;o[t+0]=n,o[t+1]=c,o[t+2]=u+d*i.delta;var p=e+3*i.zd;a[t+0]=s(f[e+0],f[p+0],d),a[t+1]=s(f[e+1],f[p+1],d),a[t+2]=s(f[e+2],f[p+2],d)}function h(e){var t=3*e;0===i.normal_cache[t]&&(i.normal_cache[t+0]=i.field[e-1]-i.field[e+1],i.normal_cache[t+1]=i.field[e-i.yd]-i.field[e+i.yd],i.normal_cache[t+2]=i.field[e-i.zd]-i.field[e+i.zd])}function d(e,t,r,n,s,d){var p=n+1,m=n+i.yd,v=n+i.zd,g=p+i.yd,y=p+i.zd,b=n+i.yd+i.zd,x=p+i.yd+i.zd,w=0,_=i.field[n],S=i.field[p],M=i.field[m],T=i.field[g],A=i.field[v],E=i.field[y],C=i.field[b],L=i.field[x];_<s&&(w|=1),S<s&&(w|=2),M<s&&(w|=8),T<s&&(w|=4),A<s&&(w|=16),E<s&&(w|=32),C<s&&(w|=128),L<s&&(w|=64);var P=gc[w];if(0===P)return 0;var O=i.delta,N=e+O,R=t+O,I=r+O;1&P&&(h(n),h(p),c(3*n,0,s,e,t,r,_,S)),2&P&&(h(p),h(g),u(3*p,3,s,N,t,r,S,T)),4&P&&(h(m),h(g),c(3*m,6,s,e,R,r,M,T)),8&P&&(h(n),h(m),u(3*n,9,s,e,t,r,_,M)),16&P&&(h(v),h(y),c(3*v,12,s,e,t,I,A,E)),32&P&&(h(y),h(x),u(3*y,15,s,N,t,I,E,L)),64&P&&(h(b),h(x),c(3*b,18,s,e,R,I,C,L)),128&P&&(h(v),h(b),u(3*v,21,s,e,t,I,A,C)),256&P&&(h(n),h(v),l(3*n,24,s,e,t,r,_,A)),512&P&&(h(p),h(y),l(3*p,27,s,N,t,r,S,E)),1024&P&&(h(g),h(x),l(3*g,30,s,N,R,r,T,L)),2048&P&&(h(m),h(b),l(3*m,33,s,e,R,r,M,C)),w<<=4;for(var D,F,U,k=0,B=0;-1!=yc[w+B];)F=(D=w+B)+1,U=D+2,f(o,a,3*yc[D],3*yc[F],3*yc[U],d),B+=3,k++;return k}function f(e,t,r,n,o,a){var s=3*i.count;if(i.positionArray[s+0]=e[r],i.positionArray[s+1]=e[r+1],i.positionArray[s+2]=e[r+2],i.positionArray[s+3]=e[n],i.positionArray[s+4]=e[n+1],i.positionArray[s+5]=e[n+2],i.positionArray[s+6]=e[o],i.positionArray[s+7]=e[o+1],i.positionArray[s+8]=e[o+2],!0===i.material.flatShading){var c=(t[r+0]+t[n+0]+t[o+0])/3,u=(t[r+1]+t[n+1]+t[o+1])/3,l=(t[r+2]+t[n+2]+t[o+2])/3;i.normalArray[s+0]=c,i.normalArray[s+1]=u,i.normalArray[s+2]=l,i.normalArray[s+3]=c,i.normalArray[s+4]=u,i.normalArray[s+5]=l,i.normalArray[s+6]=c,i.normalArray[s+7]=u,i.normalArray[s+8]=l}else i.normalArray[s+0]=t[r+0],i.normalArray[s+1]=t[r+1],i.normalArray[s+2]=t[r+2],i.normalArray[s+3]=t[n+0],i.normalArray[s+4]=t[n+1],i.normalArray[s+5]=t[n+2],i.normalArray[s+6]=t[o+0],i.normalArray[s+7]=t[o+1],i.normalArray[s+8]=t[o+2];if(i.enableUvs){var h=2*i.count;i.uvArray[h+0]=e[r+0],i.uvArray[h+1]=e[r+2],i.uvArray[h+2]=e[n+0],i.uvArray[h+3]=e[n+2],i.uvArray[h+4]=e[o+0],i.uvArray[h+5]=e[o+2]}i.enableColors&&(i.colorArray[s+0]=e[r+0],i.colorArray[s+1]=e[r+1],i.colorArray[s+2]=e[r+2],i.colorArray[s+3]=e[n+0],i.colorArray[s+4]=e[n+1],i.colorArray[s+5]=e[n+2],i.colorArray[s+6]=e[o+0],i.colorArray[s+7]=e[o+1],i.colorArray[s+8]=e[o+2]),i.count+=3,i.count>=i.maxCount-3&&(i.hasPositions=!0,i.hasNormals=!0,i.enableUvs&&(i.hasUvs=!0),i.enableColors&&(i.hasColors=!0),a(i))}function p(e,t,r){var n=new Float32Array(e.length+r);return n.set(e,0),n.set(t.slice(0,r),e.length),n}this.enableUvs=void 0!==r&&r,this.enableColors=void 0!==n&&n,this.init=function(e){this.resolution=e,this.isolation=80,this.size=e,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.maxCount=4096,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.normalArray=new Float32Array(3*this.maxCount),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(e){if(0!==this.count){for(var t=3*this.count;t<this.positionArray.length;t++)this.positionArray[t]=0;this.hasPositions=!0,this.hasNormals=!0,this.enableUvs&&this.material.map&&(this.hasUvs=!0),this.enableColors&&this.material.vertexColors!==Q&&(this.hasColors=!0),e(this)}},this.addBall=function(e,t,r,n,i){var o=Math.sign(n);n=Math.abs(n);var a=this.size*Math.sqrt(n/i),s=r*this.size,c=t*this.size,u=e*this.size,l=Math.floor(s-a);l<1&&(l=1);var h=Math.floor(s+a);h>this.size-1&&(h=this.size-1);var d=Math.floor(c-a);d<1&&(d=1);var f=Math.floor(c+a);f>this.size-1&&(f=this.size-1);var p=Math.floor(u-a);p<1&&(p=1);var m,v,g,y,b,x,w,_,S,M,T,A=Math.floor(u+a);for(A>this.size-1&&(A=this.size-1),g=l;g<h;g++)for(b=this.size2*g,S=(_=g/this.size-r)*_,v=d;v<f;v++)for(y=b+this.size*v,M=(w=v/this.size-t)*w,m=p;m<A;m++)(T=n/(1e-6+(x=m/this.size-e)*x+M+S)-i)>0&&(this.field[y+m]+=T*o)},this.addPlaneX=function(e,t){var r,n,i,o,a,s,c=this.size,u=this.yd,l=this.zd,h=this.field,d=c*Math.sqrt(e/t);for(d>c&&(d=c),r=0;r<d;r++)if((o=e/(1e-4+(a=r/c)*a)-t)>0)for(n=0;n<c;n++)for(s=r+n*u,i=0;i<c;i++)h[l*i+s]+=o},this.addPlaneY=function(e,t){var r,n,i,o,a,s,c,u=this.size,l=this.yd,h=this.zd,d=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),n=0;n<f;n++)if((o=e/(1e-4+(a=n/u)*a)-t)>0)for(s=n*l,r=0;r<u;r++)for(c=s+r,i=0;i<u;i++)d[h*i+c]+=o},this.addPlaneZ=function(e,t){var r,n,i,o,a,s,c,u=this.size,l=this.yd,h=this.zd,d=this.field,f=u*Math.sqrt(e/t);for(f>u&&(f=u),i=0;i<f;i++)if((o=e/(1e-4+(a=i/u)*a)-t)>0)for(s=h*i,n=0;n<u;n++)for(c=s+n*l,r=0;r<u;r++)d[c+r]+=o},this.reset=function(){var e;for(e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0},this.render=function(e){this.begin();for(var t=this.size-2,r=1;r<t;r++)for(var n=this.size2*r,i=(r-this.halfsize)/this.halfsize,o=1;o<t;o++)for(var a=n+this.size*o,s=(o-this.halfsize)/this.halfsize,c=1;c<t;c++){d((c-this.halfsize)/this.halfsize,s,i,a+c,this.isolation,e)}this.end(e)},this.generateGeometry=function(){return console.warn("MarchingCubes: generateGeometry() now returns BufferGeometry"),this.generateBufferGeometry()},this.generateBufferGeometry=function(){var e=new U,t=new Float32Array,r=new Float32Array,n=new Float32Array,i=new Float32Array,o=this;return this.render(function(e){o.hasPositions&&(t=p(t,e.positionArray,3*e.count)),o.hasNormals&&(r=p(r,e.normalArray,3*e.count)),o.hasColors&&(n=p(n,e.colorArray,3*e.count)),o.hasUvs&&(i=p(i,e.uvArray,2*e.count)),e.count=0}),this.hasPositions&&e.addAttribute("position",new M(t,3)),this.hasNormals&&e.addAttribute("normal",new M(r,3)),this.hasColors&&e.addAttribute("color",new M(n,3)),this.hasUvs&&e.addAttribute("uv",new M(i,2)),e},this.init(e)};(mc.prototype=Object.create(pc.prototype)).constructor=mc;var vc,gc=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),yc=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),bc={setHSV:function(e,t,r,n){return t=o.euclideanModulo(t,1),r=o.clamp(r,0,1),n=o.clamp(n,0,1),e.setHSL(t,r*n/((t=(2-r)*n)<1?t:2-t),.5*t)},getHSV:function(){var e={};return function(t,r){return void 0===r&&(console.warn("ColorConverter: .getHSV() target is now required"),r={h:0,s:0,l:0}),t.getHSL(e),e.s*=e.l<.5?e.l:1-e.l,r.h=e.h,r.s=2*e.s/(e.l+e.s),r.v=e.l+e.s,r}}(),setCMYK:function(e,t,r,n,i){var o=(1-t)*(1-i),a=(1-r)*(1-i),s=(1-n)*(1-i);return e.setRGB(o,a,s)},getCMYK:function(e,t){void 0===t&&(console.warn("ColorConverter: .getCMYK() target is now required"),t={c:0,m:0,y:0,k:0});var r=e.r,n=e.g,i=e.b,o=1-Math.max(r,n,i),a=(1-r-o)/(1-o),s=(1-n-o)/(1-o),c=(1-i-o)/(1-o);return t.c=a,t.m=s,t.y=c,t.k=o,t}};function xc(e,t,r,n,i,o,a,s,c){Zr.call(this,e,t,r,n,i,o,a,s,c),this.needsUpdate=!0}function wc(e){if(p.call(this),this.type="Sprite",void 0===vc){vc=new U;var t=new Yi(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);vc.setIndex([0,1,2,0,2,3]),vc.addAttribute("position",new Qi(t,3,0,!1)),vc.addAttribute("uv",new Qi(t,2,3,!1))}this.geometry=vc,this.material=void 0!==e?e:new Sn,this.center=new x(.5,.5)}xc.prototype=Object.create(Zr.prototype),xc.prototype.constructor=xc,xc.prototype.isCanvasTexture=!0,wc.prototype=Object.assign(Object.create(p.prototype),{constructor:wc,isSprite:!0,raycast:function(){var e=new s,t=new s,r=new s,n=new x,i=new x,o=new a,c=new s,u=new s,l=new s,h=new x,d=new x,f=new x;function p(e,t,r,a,s,c){n.subVectors(e,r).addScalar(.5).multiply(a),void 0!==s?(i.x=c*n.x-s*n.y,i.y=s*n.x+c*n.y):i.copy(n),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(n,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),r.setFromMatrixPosition(this.modelViewMatrix);var a,s,m=this.material.rotation;0!==m&&(s=Math.cos(m),a=Math.sin(m));var v=this.center;p(c.set(-.5,-.5,0),r,v,t,a,s),p(u.set(.5,-.5,0),r,v,t,a,s),p(l.set(.5,.5,0),r,v,t,a,s),h.set(0,0),d.set(1,0),f.set(1,1);var g=n.ray.intersectTriangle(c,u,l,!1,e);if(null!==g||(p(u.set(-.5,.5,0),r,v,t,a,s),d.set(0,1),null!==(g=n.ray.intersectTriangle(c,l,u,!1,e)))){var y=n.ray.origin.distanceTo(e);y<n.near||y>n.far||i.push({distance:y,point:e.clone(),uv:hr.getUV(e,c,u,l,h,d,f,new x),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return p.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var _c=function(e,t){this.lut=[],this.map=Sc[e],this.n=t,this.mapname=e;for(var r=1/this.n,n=0;n<=1;n+=r)for(var i=0;i<this.map.length-1;i++)if(n>=this.map[i][0]&&n<this.map[i+1][0]){var o=this.map[i][0],a=this.map[i+1][0],s=new v(16777215).setHex(this.map[i][1]),c=new v(16777215).setHex(this.map[i+1][1]),u=s.lerp(c,(n-o)/(a-o));this.lut.push(u)}return this.set(this)};_c.prototype={constructor:_c,lut:[],map:[],mapname:"rainbow",n:256,minV:0,maxV:1,legend:null,set:function(e){return e instanceof _c&&this.copy(e),this},setMin:function(e){return this.minV=e,this},setMax:function(e){return this.maxV=e,this},changeNumberOfColors:function(e){return this.n=e,new _c(this.mapname,this.n)},changeColorMap:function(e){return this.mapname=e,new _c(this.mapname,this.n)},copy:function(e){return this.lut=e.lut,this.mapname=e.mapname,this.map=e.map,this.n=e.n,this.minV=e.minV,this.maxV=e.maxV,this},getColor:function(e){e<=this.minV?e=this.minV:e>=this.maxV&&(e=this.maxV),e=(e-this.minV)/(this.maxV-this.minV);var t=Math.round(e*this.n);return t==this.n&&(t-=1),this.lut[t]},addColorMap:function(e,t){Sc[e]=t},setLegendOn:function(e){void 0===e&&(e={}),this.legend={},this.legend.layout=e.hasOwnProperty("layout")?e.layout:"vertical",this.legend.position=e.hasOwnProperty("position")?e.position:{x:4,y:0,z:0},this.legend.dimensions=e.hasOwnProperty("dimensions")?e.dimensions:{width:.5,height:3},this.legend.canvas=document.createElement("canvas"),this.legend.canvas.setAttribute("id","legend"),this.legend.canvas.setAttribute("hidden",!0),document.body.appendChild(this.legend.canvas),this.legend.ctx=this.legend.canvas.getContext("2d"),this.legend.canvas.setAttribute("width",1),this.legend.canvas.setAttribute("height",this.n),this.legend.texture=new Zr(this.legend.canvas);var t=this.legend.ctx.getImageData(0,0,1,this.n),r=t.data;this.map=Sc[this.mapname];for(var n=0,i=1/this.n,o=1;o>=0;o-=i)for(var a=this.map.length-1;a>=0;a--)if(o<this.map[a][0]&&o>=this.map[a-1][0]){var s=this.map[a-1][0],c=this.map[a][0],u=new v(16777215).setHex(this.map[a-1][1]),l=new v(16777215).setHex(this.map[a][1]),h=u.lerp(l,(o-s)/(c-s));r[4*n]=Math.round(255*h.r),r[4*n+1]=Math.round(255*h.g),r[4*n+2]=Math.round(255*h.b),r[4*n+3]=255,n+=1}return this.legend.ctx.putImageData(t,0,0),this.legend.texture.needsUpdate=!0,this.legend.legendGeometry=new en(this.legend.dimensions.width,this.legend.dimensions.height),this.legend.legendMaterial=new cr({map:this.legend.texture,side:J}),this.legend.mesh=new dr(this.legend.legendGeometry,this.legend.legendMaterial),"horizontal"==this.legend.layout&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh.position.copy(this.legend.position),this.legend.mesh},setLegendOff:function(){return this.legend=null,this.legend},setLegendLayout:function(e){return!!this.legend&&(this.legend.layout!=e&&(("horizontal"==e||"vertical"==e)&&(this.layout=e,"horizontal"==e&&(this.legend.mesh.rotation.z=Math.PI/180*90),"vertical"==e&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh)))},setLegendPosition:function(e){return this.legend.position=new s(e.x,e.y,e.z),this.legend},setLegendLabels:function(e,t){if(!this.legend)return!1;"function"==typeof e&&(t=e),void 0===e&&(e={}),this.legend.labels={},this.legend.labels.fontsize=e.hasOwnProperty("fontsize")?e.fontsize:24,this.legend.labels.fontface=e.hasOwnProperty("fontface")?e.fontface:"Arial",this.legend.labels.title=e.hasOwnProperty("title")?e.title:"",this.legend.labels.um=e.hasOwnProperty("um")?" [ "+e.um+" ]":"",this.legend.labels.ticks=e.hasOwnProperty("ticks")?e.ticks:0,this.legend.labels.decimal=e.hasOwnProperty("decimal")?e.decimal:2,this.legend.labels.notation=e.hasOwnProperty("notation")?e.notation:"standard";var r=255,n=100,i=100,o=.8,a=255,c=0,u=0,l=1,h=document.createElement("canvas"),d=h.getContext("2d");d.font="Normal "+1.2*this.legend.labels.fontsize+"px "+this.legend.labels.fontface,d.fillStyle="rgba("+r+","+n+","+i+","+o+")",d.strokeStyle="rgba("+a+","+c+","+u+","+l+")",d.lineWidth=4,d.fillStyle="rgba( 0, 0, 0, 1.0 )",d.fillText(this.legend.labels.title.toString()+this.legend.labels.um.toString(),4,this.legend.labels.fontsize+4);var f=new xc(h);f.minFilter=Ze;var p=new wc(new Sn({map:f}));if(p.scale.set(2,1,1),"vertical"==this.legend.layout&&p.position.set(this.legend.position.x+this.legend.dimensions.width,this.legend.position.y+.45*this.legend.dimensions.height,this.legend.position.z),"horizontal"==this.legend.layout&&p.position.set(1.015*this.legend.position.x,this.legend.position.y+.03*this.legend.dimensions.height,this.legend.position.z),this.legend.labels.ticks>0){var m={},v={};if("vertical"==this.legend.layout)var g=this.legend.position.y+.36*this.legend.dimensions.height,y=this.legend.position.y-.61*this.legend.dimensions.height;if("horizontal"==this.legend.layout)var b=this.legend.position.x+.75*this.legend.dimensions.height,x=this.legend.position.x-1.2*this.legend.dimensions.width;for(var w=0;w<this.legend.labels.ticks;w++){var _=(this.maxV-this.minV)/(this.legend.labels.ticks-1)*w+this.minV;_=t?t(_):"scientific"==this.legend.labels.notation?_.toExponential(this.legend.labels.decimal):_.toFixed(this.legend.labels.decimal);var S=document.createElement("canvas"),M=S.getContext("2d");M.font="Normal "+this.legend.labels.fontsize+"px "+this.legend.labels.fontface,M.fillStyle="rgba("+r+","+n+","+i+","+o+")",M.strokeStyle="rgba("+a+","+c+","+u+","+l+")",M.lineWidth=4,M.fillStyle="rgba( 0, 0, 0, 1.0 )",M.fillText(_.toString(),4,this.legend.labels.fontsize+4);var T=new xc(S);T.minFilter=Ze;var A=new wc(new Sn({map:T}));if(A.scale.set(2,1,1),"vertical"==this.legend.layout){var E=y+(g-y)*((_-this.minV)/(this.maxV-this.minV));A.position.set(this.legend.position.x+2.7*this.legend.dimensions.width,E,this.legend.position.z)}if("horizontal"==this.legend.layout){E=x+(b-x)*((_-this.minV)/(this.maxV-this.minV));if(this.legend.labels.ticks>5)if(w%2==0)var C=1.7;else C=2.1;else C=1.7;A.position.set(E,this.legend.position.y-this.legend.dimensions.width*C,this.legend.position.z)}var L=new ur({color:0,linewidth:2}),P=[];if("vertical"==this.legend.layout){var O=this.legend.position.y-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((_-this.minV)/(this.maxV-this.minV)*.99);P.push(new s(this.legend.position.x+.55*this.legend.dimensions.width,O,this.legend.position.z)),P.push(new s(this.legend.position.x+.7*this.legend.dimensions.width,O,this.legend.position.z))}if("horizontal"==this.legend.layout){O=this.legend.position.x-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((_-this.minV)/(this.maxV-this.minV)*.99);P.push(new s(O,this.legend.position.y-.55*this.legend.dimensions.width,this.legend.position.z)),P.push(new s(O,this.legend.position.y-.7*this.legend.dimensions.width,this.legend.position.z))}var N=new fr((new U).setFromPoints(P),L);v[w]=N,m[w]=A}}return{title:p,ticks:m,lines:v}}};var Sc={rainbow:[[0,"0x0000FF"],[.2,"0x00FFFF"],[.5,"0x00FF00"],[.8,"0xFFFF00"],[1,"0xFF0000"]],cooltowarm:[[0,"0x3C4EC2"],[.2,"0x9BBCFF"],[.5,"0xDCDCDC"],[.8,"0xF6A385"],[1,"0xB40426"]],blackbody:[[0,"0x000000"],[.2,"0x780000"],[.5,"0xE63200"],[.8,"0xFFFF00"],[1,"0xFFFFFF"]],grayscale:[[0,"0x000000"],[.2,"0x404040"],[.5,"0x7F7F80"],[.8,"0xBFBFBF"],[1,"0xFFFFFF"]]},Mc=function(e,t){dr.call(this,e,t),this.animationsMap={},this.animationsList=[];var r=Object.keys(this.morphTargetDictionary).length,n=r-1,i=r/1;this.createAnimation("__default",0,n,i),this.setAnimationWeight("__default",1)};Mc.prototype=Object.assign(Object.create(dr.prototype),{constructor:Mc,createAnimation:function(e,t,r,n){var i={start:t,end:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},autoCreateAnimations:function(e){var t,r=/([a-z]+)_?(\d+)/i,n={},i=0;for(var o in this.morphTargetDictionary){var a=o.match(r);if(a&&a.length>1)n[s=a[1]]||(n[s]={start:1/0,end:-1/0}),i<(c=n[s]).start&&(c.start=i),i>c.end&&(c.end=i),t||(t=s);i++}for(var s in n){var c=n[s];this.createAnimation(s,c.start,c.end,e)}this.firstAnimation=t},setAnimationDirectionForward:function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},setAnimationDirectionBackward:function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},setAnimationFPS:function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},setAnimationDuration:function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},setAnimationWeight:function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},setAnimationTime:function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},getAnimationTime:function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},getAnimationDuration:function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},playAnimation:function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},stopAnimation:function(e){var t=this.animationsMap[e];t&&(t.active=!1)},update:function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(n.active){var i=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var a=n.start+o.clamp(Math.floor(n.time/i),0,n.length-1),s=n.weight;a!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*s,this.morphTargetInfluences[a]=0,n.lastFrame=n.currentFrame,n.currentFrame=a);var c=n.time%i/i;n.directionBackwards&&(c=1-c),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=c*s,this.morphTargetInfluences[n.lastFrame]=(1-c)*s):this.morphTargetInfluences[n.currentFrame]=s}}}});var Tc=function(){};Tc.prototype.modify=function(e){for(var t=[],r=0,n=e.faces.length;r<n;r++){var i=t.length,o=e.faces[r],a=o.a,s=o.b,c=o.c,u=e.vertices[a],l=e.vertices[s],h=e.vertices[c];t.push(u.clone()),t.push(l.clone()),t.push(h.clone()),o.a=i,o.b=i+1,o.c=i+2}e.vertices=t};var Ac=function(){};!function(){var e=new s,t=new s;function r(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function n(e,t){var r,n,i,o=t.position.distanceTo(e.position),a=0,s=[],c=e.faces.length;for(r=0;r<c;r++)(n=e.faces[r]).hasVertex(t)&&s.push(n);for(r=0;r<c;r++){var u=1;n=e.faces[r];for(var l=0;l<s.length;l++){i=s[l];var h=n.normal.dot(i.normal);u=Math.min(u,(1.001-h)/2)}a=Math.max(a,u)}return s.length<2&&(a=1),o*a+0}function i(e){if(0===e.neighbors.length)return e.collapseNeighbor=null,void(e.collapseCost=-.01);e.collapseCost=1e5,e.collapseNeighbor=null;for(var t=0;t<e.neighbors.length;t++){var r=n(e,e.neighbors[t]);e.collapseNeighbor||(e.collapseNeighbor=e.neighbors[t],e.collapseCost=r,e.minCost=r,e.totalCost=0,e.costCount=0),e.costCount++,e.totalCost+=r,r<e.minCost&&(e.collapseNeighbor=e.neighbors[t],e.minCost=r)}e.collapseCost=e.totalCost/e.costCount}function o(e,t){for(console.assert(0===e.faces.length);e.neighbors.length;){r(e.neighbors.pop().neighbors,e)}r(t,e)}function a(e,t){r(t,e),e.v1&&r(e.v1.faces,e),e.v2&&r(e.v2.faces,e),e.v3&&r(e.v3.faces,e);for(var n,i,o=[e.v1,e.v2,e.v3],a=0;a<3;a++)i=o[(a+1)%3],(n=o[a])&&i&&(n.removeIfNonNeighbor(i),i.removeIfNonNeighbor(n))}function c(e,t,r,n){if(n){var s,c=[];for(s=0;s<r.neighbors.length;s++)c.push(r.neighbors[s]);for(s=r.faces.length-1;s>=0;s--)r.faces[s].hasVertex(n)&&a(r.faces[s],t);for(s=r.faces.length-1;s>=0;s--)r.faces[s].replaceVertex(r,n);for(o(r,e),s=0;s<c.length;s++)i(c[s])}else o(r,e)}function u(e){for(var t=e[0],r=0;r<e.length;r++)e[r].collapseCost<t.collapseCost&&(t=e[r]);return t}function l(e,t,r,n,i,o){this.a=n,this.b=i,this.c=o,this.v1=e,this.v2=t,this.v3=r,this.normal=new s,this.computeNormal(),e.faces.push(this),e.addUniqueNeighbor(t),e.addUniqueNeighbor(r),t.faces.push(this),t.addUniqueNeighbor(e),t.addUniqueNeighbor(r),r.faces.push(this),r.addUniqueNeighbor(e),r.addUniqueNeighbor(t)}function h(e,t){this.position=e,this.id=t,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}l.prototype.computeNormal=function(){var r=this.v1.position,n=this.v2.position,i=this.v3.position;e.subVectors(i,n),t.subVectors(r,n),e.cross(t).normalize(),this.normal.copy(e)},l.prototype.hasVertex=function(e){return e===this.v1||e===this.v2||e===this.v3},l.prototype.replaceVertex=function(e,t){e===this.v1?this.v1=t:e===this.v2?this.v2=t:e===this.v3&&(this.v3=t),r(e.faces,this),t.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},h.prototype.addUniqueNeighbor=function(e){!function(e,t){-1===e.indexOf(t)&&e.push(t)}(this.neighbors,e)},h.prototype.removeIfNonNeighbor=function(e){var t=this.neighbors,r=this.faces,n=t.indexOf(e);if(-1!==n){for(var i=0;i<r.length;i++)if(r[i].hasVertex(e))return;t.splice(n,1)}},Ac.prototype.modify=function(e,t){e.isBufferGeometry&&(e=(new _).fromBufferGeometry(e)),e.mergeVertices();var r,n,o,a=e.vertices,s=e.faces,d=[],f=[];for(r=0,n=a.length;r<n;r++){var p=new h(a[r],r);d.push(p)}for(r=0,n=s.length;r<n;r++){var m=(M=s[r]).a,v=M.b,g=M.c,y=new l(d[m],d[v],d[g],m,v,g);f.push(y)}for(r=0,n=d.length;r<n;r++)i(d[r]);for(var b=t;b--;){if(!(o=u(d))){console.log("SimplifyModifier: No next vertex");break}c(d,f,o,o.collapseNeighbor)}var x=new U,w=[],S=[];for(r=0;r<d.length;r++){p=d[r].position;w.push(p.x,p.y,p.z)}for(r=0;r<f.length;r++){var M=f[r];m=d.indexOf(M.v1),v=d.indexOf(M.v2),g=d.indexOf(M.v3);S.push(m,v,g)}return x.addAttribute("position",new N(w,3)),x.setIndex(S),x}}();var Ec=function(e){this.subdivisions=void 0===e?1:e};Ec.prototype.modify=function(e){(e=e.isBufferGeometry?(new _).fromBufferGeometry(e):e.clone()).mergeVertices();for(var t=this.subdivisions;t-- >0;)this.smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e},function(){var e=["a","b","c"];function t(e,t,r){return r[Math.min(e,t)+"_"+Math.max(e,t)]}function r(e,t,r,n,i,o){var a,s=Math.min(e,t),c=Math.max(e,t),u=s+"_"+c;u in n?a=n[u]:(a={a:r[s],b:r[c],newEdge:null,faces:[]},n[u]=a);a.faces.push(i),o[e].edges.push(a),o[t].edges.push(a)}function n(e,t,r,n,i){e.push(new g(t,r,n,void 0,void 0,i))}function i(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function o(e,t,r,n){e.push([t.clone(),r.clone(),n.clone()])}Ec.prototype.smooth=function(a){var c,u,l,h,d,f,p,m,v,g,y,b,w,_,S=new s,M=[];c=a.vertices,u=a.faces;var T,A,E,C,L,P,O,N,R,I,D,F,U,k,B=void 0!==(l=a.faceVertexUvs[0])&&l.length>0;for(p in function(e,t,n,i){var o,a,s;for(o=0,a=e.length;o<a;o++)n[o]={edges:[]};for(o=0,a=t.length;o<a;o++)r((s=t[o]).a,s.b,e,i,s,n),r(s.b,s.c,e,i,s,n),r(s.c,s.a,e,i,s,n)}(c,u,y=new Array(c.length),b={}),w=[],b){for(A=b[p],E=new s,L=3/8,P=1/8,2!=(O=A.faces.length)&&(L=.5,P=0),E.addVectors(A.a,A.b).multiplyScalar(L),S.set(0,0,0),v=0;v<O;v++){for(C=A.faces[v],g=0;g<3&&((T=c[C[e[g]]])===A.a||T===A.b);g++);S.add(T)}S.multiplyScalar(P),E.add(S),A.newEdge=w.length,w.push(E)}for(_=[],p=0,m=c.length;p<m;p++){for(U=c[p],3==(f=(F=y[p].edges).length)?N=3/16:f>3&&(N=3/(8*f)),R=1-f*N,I=N,f<=2&&2==f&&(R=.75,I=1/8),k=U.clone().multiplyScalar(R),S.set(0,0,0),v=0;v<f;v++)T=(D=F[v]).a!==U?D.a:D.b,S.add(T);S.multiplyScalar(I),k.add(S),_.push(k)}h=_.concat(w);var z,j,V,G,W,H,X,q=_.length;d=[];var Y=new x,J=new x,Q=new x;for(p=0,m=u.length;p<m;p++)n(d,z=t((C=u[p]).a,C.b,b).newEdge+q,j=t(C.b,C.c,b).newEdge+q,V=t(C.c,C.a,b).newEdge+q,C.materialIndex),n(d,C.a,z,V,C.materialIndex),n(d,C.b,j,z,C.materialIndex),n(d,C.c,V,j,C.materialIndex),B&&(W=(G=l[p])[0],H=G[1],X=G[2],Y.set(i(W.x,H.x),i(W.y,H.y)),J.set(i(H.x,X.x),i(H.y,X.y)),Q.set(i(W.x,X.x),i(W.y,X.y)),o(M,Y,J,Q),o(M,W,Y,Q),o(M,H,J,Y),o(M,X,Q,J));a.vertices=h,a.faces=d,B&&(a.faceVertexUvs[0]=M)}}();var Cc=function(e){this.maxEdgeLength=e};Cc.prototype.modify=function(e){for(var t,r=[],n=[],i=this.maxEdgeLength*this.maxEdgeLength,o=0,a=e.faceVertexUvs.length;o<a;o++)n[o]=[];for(o=0,a=e.faces.length;o<a;o++){var s=e.faces[o];if(s instanceof g){var c=s.a,u=s.b,l=s.c,h=e.vertices[c],d=e.vertices[u],f=e.vertices[l],p=h.distanceToSquared(d),m=d.distanceToSquared(f),v=h.distanceToSquared(f);if(p>i||m>i||v>i){var y=e.vertices.length,b=s.clone(),x=s.clone();if(p>=m&&p>=v){if((w=h.clone()).lerp(d,.5),b.a=c,b.b=y,b.c=l,x.a=y,x.b=u,x.c=l,3===s.vertexNormals.length)(_=s.vertexNormals[0].clone()).lerp(s.vertexNormals[1],.5),b.vertexNormals[1].copy(_),x.vertexNormals[0].copy(_);if(3===s.vertexColors.length)(S=s.vertexColors[0].clone()).lerp(s.vertexColors[1],.5),b.vertexColors[1].copy(S),x.vertexColors[0].copy(S);t=0}else if(m>=p&&m>=v){if((w=d.clone()).lerp(f,.5),b.a=c,b.b=u,b.c=y,x.a=y,x.b=l,x.c=c,3===s.vertexNormals.length)(_=s.vertexNormals[1].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(_),x.vertexNormals[0].copy(_),x.vertexNormals[1].copy(s.vertexNormals[2]),x.vertexNormals[2].copy(s.vertexNormals[0]);if(3===s.vertexColors.length)(S=s.vertexColors[1].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(S),x.vertexColors[0].copy(S),x.vertexColors[1].copy(s.vertexColors[2]),x.vertexColors[2].copy(s.vertexColors[0]);t=1}else{var w,_,S;if((w=h.clone()).lerp(f,.5),b.a=c,b.b=u,b.c=y,x.a=y,x.b=u,x.c=l,3===s.vertexNormals.length)(_=s.vertexNormals[0].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(_),x.vertexNormals[0].copy(_);if(3===s.vertexColors.length)(S=s.vertexColors[0].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(S),x.vertexColors[0].copy(S);t=2}r.push(b,x),e.vertices.push(w);for(var M=0,T=e.faceVertexUvs.length;M<T;M++)if(e.faceVertexUvs[M].length){var A=e.faceVertexUvs[M][o],E=A[0],C=A[1],L=A[2];if(0===t){(N=E.clone()).lerp(C,.5);var P=[E.clone(),N.clone(),L.clone()],O=[N.clone(),C.clone(),L.clone()]}else if(1===t){(N=C.clone()).lerp(L,.5);P=[E.clone(),C.clone(),N.clone()],O=[N.clone(),L.clone(),E.clone()]}else{var N;(N=E.clone()).lerp(L,.5);P=[E.clone(),C.clone(),N.clone()],O=[N.clone(),C.clone(),L.clone()]}n[M].push(P,O)}}else{r.push(s);for(M=0,T=e.faceVertexUvs.length;M<T;M++)n[M].push(e.faceVertexUvs[M][o])}}}e.faces=r,e.faceVertexUvs=n};var Lc=function(e,t){dr.call(this,e,t),this.type="MorphAnimMesh",this.mixer=new Ir(this),this.activeAction=null};(Lc.prototype=Object.create(dr.prototype)).constructor=Lc,Lc.prototype.setDirectionForward=function(){this.mixer.timeScale=1},Lc.prototype.setDirectionBackward=function(){this.mixer.timeScale=-1},Lc.prototype.playAnimation=function(e,t){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);var r=Nr.findByName(this,e);if(!r)throw new Error("MorphAnimMesh: animations["+e+"] undefined in .playAnimation()");var n=this.mixer.clipAction(r);n.timeScale=r.tracks.length*t/r.duration,this.activeAction=n.play()},Lc.prototype.updateAnimation=function(e){this.mixer.update(e)},Lc.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.mixer=new Ir(this),this};var Pc=["color","color2"],Oc=["vColor","vColor2"];function Nc(e){ra.call(this,"v4",{shared:!1}),this.index=e||0}function Rc(e){ra.call(this,"v3",{shared:!1}),this.scope=e||Rc.TOTAL}function Ic(e){ra.call(this,"v3",{unique:!0}),this.scope=e||Ic.CUBE}Nc.prototype=Object.create(ra.prototype),Nc.prototype.constructor=Nc,Nc.prototype.generate=function(e,t){e.requires.color[this.index]=!0;var r=e.isShader("vertex")?Pc[this.index]:Oc[this.index];return e.format(r,this.getType(e),t)},Nc.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.index=e.index},Nc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},Rc.TOTAL="total",Rc.prototype=Object.create(ra.prototype),Rc.prototype.constructor=Rc,Rc.prototype.nodeType="Light",Rc.prototype.generate=function(e,t){return e.isCache("light")?e.format("reflectedLight.directDiffuse",this.type,t):(console.warn('LightNode is only compatible in "light" channel.'),e.format("vec3( 0.0 )",this.type,t))},Rc.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.scope=e.scope},Rc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},Ic.CUBE="cube",Ic.SPHERE="sphere",Ic.VECTOR="vector",Ic.prototype=Object.create(ra.prototype),Ic.prototype.constructor=Ic,Ic.prototype.nodeType="Reflect",Ic.prototype.getType=function(e){switch(this.scope){case Ic.SPHERE:return"v2"}return this.type},Ic.prototype.generate=function(e,t){if(e.isShader("fragment")){var r;switch(this.scope){case Ic.VECTOR:e.addNodeCode("vec3 reflectVec = inverseTransformDirection( reflect( -normalize( vViewPosition ), normal ), viewMatrix );"),r="reflectVec";break;case Ic.CUBE:var n=new Ic(Ic.VECTOR).build(e,"v3");e.addNodeCode("vec3 reflectCubeVec = vec3( -1.0 * "+n+".x, "+n+".yz );"),r="reflectCubeVec";break;case Ic.SPHERE:n=new Ic(Ic.VECTOR).build(e,"v3");e.addNodeCode("vec2 reflectSphereVec = normalize( ( viewMatrix * vec4( "+n+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5;"),r="reflectSphereVec"}return e.format(r,this.getType(e),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)},Ic.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t};var Dc={elements:["x","y","z","w"],addShortcuts:function(){function e(e,t,r){return r?{get:function(){return this[e][t][r]},set:function(n){this[e][t][r]=n}}:{get:function(){return this[e][t]},set:function(r){this[e][t]=r}}}return function(t,r,n){for(var i={},o=0;o<n.length;++o){var a=n[o].split("."),s=a[0],c=a[1];i[s]=e(r,s,c)}Object.defineProperties(t,i)}}()};function Fc(e){e=e||{},this.name=e.name,this.type=e.type,this.node=e.node,this.needsUpdate=e.needsUpdate}Object.defineProperties(Fc.prototype,{value:{get:function(){return this.node.value},set:function(e){this.node.value=e}}});var Uc=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,kc=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim;function Bc(e){ra.call(this),this.eval(e)}function zc(e,t,r){la.call(this,"v3"),this.value=e instanceof s?e:new s(e,t,r)}function jc(e,t,r,n){la.call(this,"v4"),this.value=e instanceof S?e:new S(e,t,r,n)}function Vc(e,t){ra.call(this,"v4"),this.input=e,this.method=t||Vc.LINEAR}function Gc(e,t,r,n){la.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new sa,this.bias=r,this.project=void 0!==n&&n}function Wc(e,t,r){la.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new Ic,this.bias=r}function Hc(){ra.call(this,"f")}function Xc(e){ra.call(this,"f"),this.blinnExponent=e||new Hc}function qc(e,t,r){ra.call(this,"TextureCubeUVData"),this.uv=e||new Ic(Ic.VECTOR),this.textureSize=t||new ha(1024),this.blinnExponentToRoughness=r||new Xc}function Yc(e,t){ra.call(this,"v4"),this.value=e,this.uv=t||new qc}Bc.prototype=Object.create(ra.prototype),Bc.prototype.constructor=Bc,Bc.prototype.nodeType="Struct",Bc.prototype.getType=function(e){return e.getTypeByFormat(this.name)},Bc.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},Bc.prototype.generate=function(e,t){return"source"===t?this.src+";":e.format("( "+src+" )",this.getType(e),t)},Bc.prototype.eval=function(e){this.src=e||"",this.inputs=[];var t=Uc.exec(this.src);if(t){for(var r,n=t[2];r=kc.exec(n);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name},Bc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src),t},zc.prototype=Object.create(la.prototype),zc.prototype.constructor=zc,zc.prototype.nodeType="Vector3",Dc.addShortcuts(zc.prototype,"value",["x","y","z"]),zc.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",n,t)},zc.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value.copy(e)},zc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,!0===this.readonly&&(t.readonly=!0)),t},jc.prototype=Object.create(la.prototype),jc.prototype.constructor=jc,jc.prototype.nodeType="Vector4",Dc.addShortcuts(jc.prototype,"value",["x","y","z","w"]),jc.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",n,t)},jc.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value.copy(e)},jc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,!0===this.readonly&&(t.readonly=!0)),t},Vc.Nodes=function(){var e=new na(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),t=new na(["vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );","}"].join("\n")),r=new na(["vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );","}"].join("\n")),n=new na(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),i=new na(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n")),o=new na(["vec4 RGBEToLinear( in vec4 value ) {","\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );","}"].join("\n")),a=new na(["vec4 LinearToRGBE( in vec4 value ) {","\tfloat maxComponent = max( max( value.r, value.g ), value.b );","\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );","\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );","}"].join("\n")),s=new na(["vec3 RGBMToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.xyz * value.w * maxRange, 1.0 );","}"].join("\n")),c=new na(["vec3 LinearToRGBM( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );","\tM            = ceil( M * 255.0 ) / 255.0;","\treturn vec4( value.rgb / ( M * maxRange ), M );","}"].join("\n")),u=new na(["vec3 RGBDToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );","}"].join("\n")),l=new na(["vec3 LinearToRGBD( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat D      = max( maxRange / maxRGB, 1.0 );","\tD            = min( floor( D ) / 255.0, 1.0 );","\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );","}"].join("\n")),h=new pa("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),d=new na(["vec4 LinearToLogLuv( in vec4 value ) {","\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;","\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));","\tvec4 vResult;","\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;","\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;","\tvResult.w = fract(Le);","\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;","\treturn vResult;","}"].join("\n"),[h]),f=new pa("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );");return{LinearToLinear:e,GammaToLinear:t,LinearToGamma:r,sRGBToLinear:n,LinearTosRGB:i,RGBEToLinear:o,LinearToRGBE:a,RGBMToLinear:s,LinearToRGBM:c,RGBDToLinear:u,LinearToRGBD:l,cLogLuvM:h,LinearToLogLuv:d,cLogLuvInverseM:f,LogLuvToLinear:new na(["vec4 LogLuvToLinear( in vec4 value ) {","\tfloat Le = value.z * 255.0 + value.w;","\tvec3 Xp_Y_XYZp;","\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);","\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;","\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;","\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;","\treturn vec4( max(vRGB, 0.0), 1.0 );","}"].join("\n"),[f])}}(),Vc.LINEAR_TO_LINEAR="LinearToLinear",Vc.GAMMA_TO_LINEAR="GammaToLinear",Vc.LINEAR_TO_GAMMA="LinearToGamma",Vc.SRGB_TO_LINEAR="sRGBToLinear",Vc.LINEAR_TO_SRGB="LinearTosRGB",Vc.RGBE_TO_LINEAR="RGBEToLinear",Vc.LINEAR_TO_RGBE="LinearToRGBE",Vc.RGBM_TO_LINEAR="RGBMToLinear",Vc.LINEAR_TO_RGBM="LinearToRGBM",Vc.RGBD_TO_LINEAR="RGBDToLinear",Vc.LINEAR_TO_RGBD="LinearToRGBD",Vc.LINEAR_TO_LOG_LUV="LinearToLogLuv",Vc.LOG_LUV_TO_LINEAR="LogLuvToLinear",Vc.prototype=Object.create(ra.prototype),Vc.prototype.constructor=Vc,Vc.prototype.nodeType="ColorAdjustment",Vc.prototype.generate=function(e,t){var r=e.context.input||this.input.build(e,"v4"),n=void 0!==e.context.encoding?this.getEncodingMethod(e.context.encoding):[this.method],i=this.factor?this.factor.build(e,"f"):n[1],o=e.include(Vc.Nodes[n[0]]);return i?e.format(o+"( "+r+", "+i+" )",this.getType(e),t):e.format(o+"( "+r+" )",this.getType(e),t)},Vc.prototype.getDecodingMethod=function(e){var t=this.getEncodingComponents(e);return t[0]+="ToLinear",t},Vc.prototype.getEncodingMethod=function(e){var t=this.getEncodingComponents(e);return t[0]="LinearTo"+t[0],t},Vc.prototype.getEncodingComponents=function(e){switch(e){case Jt:return["Linear"];case Qt:return["sRGB"];case Kt:return["RGBE"];case $t:return["RGBM","7.0"];case er:return["RGBM","16.0"];case tr:return["RGBD","256.0"];case Zt:return["Gamma","float( GAMMA_FACTOR )"]}},Vc.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.input=e.input,this.method=e.method},Vc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).input=this.input.toJSON(e).uuid,t.method=this.method),t},Gc.prototype=Object.create(la.prototype),Gc.prototype.constructor=Gc,Gc.prototype.nodeType="Texture",Gc.prototype.getTexture=function(e,t){return la.prototype.generate.call(this,e,t,this.value.uuid,"t")},Gc.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var r,n,i=this.getTexture(e,t),o=this.uv.build(e,this.project?"v4":"v2"),a=this.bias?this.bias.build(e,"f"):void 0;return void 0==a&&e.context.bias&&(a=new e.context.bias(this).build(e,"f")),r=this.project?"texture2DProj":a?"tex2DBias":"tex2D",n=a?r+"( "+i+", "+o+", "+a+" )":r+"( "+i+", "+o+" )",e.addContext({input:n,encoding:e.getTextureEncodingFromMap(this.value),include:e.isShader("vertex")}),this.colorSpace=this.colorSpace||new Vc(this),n=this.colorSpace.build(e,this.type),e.removeContext(),e.format(n,this.type,t)},Gc.prototype.copy=function(e){la.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),void 0!==e.project&&(this.project=e.project)},Gc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},Wc.prototype=Object.create(la.prototype),Wc.prototype.constructor=Wc,Wc.prototype.nodeType="CubeTexture",Wc.prototype.getTexture=function(e,t){return la.prototype.generate.call(this,e,t,this.value.uuid,"tc")},Wc.prototype.generate=function(e,t){if("samplerCube"===t)return this.getTexture(e,t);var r,n=this.getTexture(e,t),i=this.uv.build(e,"v3"),o=this.bias?this.bias.build(e,"f"):void 0;return void 0===o&&e.context.bias&&(o=new e.context.bias(this).build(e,"f")),r=o?"texCubeBias( "+n+", "+i+", "+o+" )":"texCube( "+n+", "+i+" )",e.addContext({input:r,encoding:e.getTextureEncodingFromMap(this.value),include:e.isShader("vertex")}),this.colorSpace=this.colorSpace||new Vc(this),r=this.colorSpace.build(e,this.type),e.removeContext(),e.format(r,this.type,t)},Wc.prototype.copy=function(e){la.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias)},Wc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.uuid,t.uv=this.uv.toJSON(e).uuid,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},Hc.prototype=Object.create(ra.prototype),Hc.prototype.constructor=Hc,Hc.prototype.nodeType="BlinnShininessExponent",Hc.prototype.generate=function(e,t){return e.isCache("clearCoat")?e.format("Material_ClearCoat_BlinnShininessExponent( material )",this.type,t):e.format("Material_BlinnShininessExponent( material )",this.type,t)},Xc.prototype=Object.create(ra.prototype),Xc.prototype.constructor=Xc,Xc.prototype.nodeType="BlinnExponentToRoughness",Xc.prototype.generate=function(e,t){return e.format("BlinnExponentToGGXRoughness( "+this.blinnExponent.build(e,"f")+" )",this.type,t)},Xc.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.blinnExponent=e.blinnExponent},Xc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).blinnExponent=this.blinnExponent),t},qc.Nodes=function(){var e=new Bc(["struct TextureCubeUVData {","\tvec2 uv_10;","\tvec2 uv_20;","\tfloat t;","}"].join("\n")),t=new na(["int getFaceFromDirection(vec3 direction) {","\tvec3 absDirection = abs(direction);","\tint face = -1;","\tif( absDirection.x > absDirection.z ) {","\t\tif(absDirection.x > absDirection.y )","\t\t\tface = direction.x > 0.0 ? 0 : 3;","\t\telse","\t\t\tface = direction.y > 0.0 ? 1 : 4;","\t}","\telse {","\t\tif(absDirection.z > absDirection.y )","\t\t\tface = direction.z > 0.0 ? 2 : 5;","\t\telse","\t\t\tface = direction.y > 0.0 ? 1 : 4;","\t}","\treturn face;","}"].join("\n")),r=new pa("#define cubeUV_maxLods1 ( log2( cubeUV_textureSize * 0.25 ) - 1.0 )"),n=new pa("#define cubeUV_rangeClamp ( exp2( ( 6.0 - 1.0 ) * 2.0 ) )"),i=new na(["vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness, in float cubeUV_textureSize ) {","\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);","\tfloat dxRoughness = dFdx(roughness);","\tfloat dyRoughness = dFdy(roughness);","\tvec3 dx = dFdx( vec * scale * dxRoughness );","\tvec3 dy = dFdy( vec * scale * dyRoughness );","\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );","\td = clamp(d, 1.0, cubeUV_rangeClamp);","\tfloat mipLevel = 0.5 * log2(d);","\treturn vec2(floor(mipLevel), fract(mipLevel));","}"].join("\n"),[r,n],{derivatives:!0}),o=new pa("#define cubeUV_maxLods2 ( log2( cubeUV_textureSize * 0.25 ) - 2.0 )"),a=new pa("#define cubeUV_rcpTextureSize ( 1.0 / cubeUV_textureSize )"),s=new na(["vec2 getCubeUV( vec3 direction, float roughnessLevel, float mipLevel, in float cubeUV_textureSize ) {","\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;","\tfloat a = 16.0 * cubeUV_rcpTextureSize;","","\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );","\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;","\tfloat powScale = exp2_packed.x * exp2_packed.y;","\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;","\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;","","\tbool bRes = mipLevel == 0.0;","\tscale =  bRes && (scale < a) ? a : scale;","","\tvec3 r;","\tvec2 offset;","\tint face = getFaceFromDirection(direction);","","\tfloat rcpPowScale = 1.0 / powScale;","","\tif( face == 0) {","\t\tr = vec3(direction.x, -direction.z, direction.y);","\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 1) {","\t\tr = vec3(direction.y, direction.x, direction.z);","\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 2) {","\t\tr = vec3(direction.z, direction.x, direction.y);","\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;","\t}","\telse if( face == 3) {","\t\tr = vec3(direction.x, direction.z, direction.y);","\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\telse if( face == 4) {","\t\tr = vec3(direction.y, direction.x, -direction.z);","\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\telse {","\t\tr = vec3(direction.z, -direction.x, direction.y);","\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);","\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;","\t}","\tr = normalize(r);","\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;","\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;","\tvec2 base = offset + vec2( texelOffset );","\treturn base + s * ( scale - 2.0 * texelOffset );","}"].join("\n"),[o,a,t]),c=new pa("#define cubeUV_maxLods3 ( log2( cubeUV_textureSize * 0.25 ) - 3.0 )");return{TextureCubeUVData:e,textureCubeUV:new na(["TextureCubeUVData textureCubeUV( vec3 reflectedDirection, float roughness, in float cubeUV_textureSize ) {","\tfloat roughnessVal = roughness * cubeUV_maxLods3;","\tfloat r1 = floor(roughnessVal);","\tfloat r2 = r1 + 1.0;","\tfloat t = fract(roughnessVal);","\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness, cubeUV_textureSize);","\tfloat s = mipInfo.y;","\tfloat level0 = mipInfo.x;","\tfloat level1 = level0 + 1.0;","\tlevel1 = level1 > 5.0 ? 5.0 : level1;","","\tlevel0 += min( floor( s + 0.5 ), 5.0 );","","\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0, cubeUV_textureSize);","\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0, cubeUV_textureSize);","","\treturn TextureCubeUVData(uv_10, uv_20, t);","}"].join("\n"),[e,c,i,s])}}(),qc.prototype=Object.create(ra.prototype),qc.prototype.constructor=qc,qc.prototype.nodeType="TextureCubeUV",qc.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(qc.Nodes.textureCubeUV);return e.format(r+"( "+this.uv.build(e,"v3")+", "+this.blinnExponentToRoughness.build(e,"f")+", "+this.textureSize.build(e,"f")+" )",this.getType(e),t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},qc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.textureSize=this.textureSize.toJSON(e).uuid,t.blinnExponentToRoughness=this.blinnExponentToRoughness.toJSON(e).uuid),t},Yc.prototype=Object.create(ra.prototype),Yc.prototype.constructor=Yc,Yc.prototype.nodeType="TextureCube",Yc.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=this.uv.build(e)+".uv_10",n=this.uv.build(e)+".uv_20",i=this.uv.build(e)+".t",o=e.getTexelDecodingFunctionFromTexture("texture2D( "+this.value.build(e,"sampler2D")+", "+r+" )",this.value.value),a=e.getTexelDecodingFunctionFromTexture("texture2D( "+this.value.build(e,"sampler2D")+", "+n+" )",this.value.value);return e.format("vec4( mix( "+o+", "+a+", "+i+" ).rgb, 1.0 )",this.getType(e),t)}return console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},Yc.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.textureSize=this.textureSize.toJSON(e).uuid,t.blinnExponentToRoughness=this.blinnExponentToRoughness.toJSON(e).uuid,this.roughness&&(t.roughness=this.roughness.toJSON(e).uuid)),t};var Jc=Dc.elements,Qc=["float","vec2","vec3","vec4"],Zc={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i"},Kc={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"};function $c(){this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.parsing=!1,this.optimize=!0}function eu(e,t,r){la.call(this,"c"),this.value=e instanceof v?e:new v(e||0,t,r)}function tu(e){ta.call(this,"v4"),this.value=e}function ru(e,t){Xr.call(this),this.vertex=e||new tu(new ca(ca.PROJECTION)),this.fragment=t||new tu(new eu(16711680)),this.updaters=[]}function nu(e,t){la.call(this,"v2"),this.value=e instanceof x?e:new x(e,t)}function iu(){nu.call(this)}function ou(e){ra.call(this,"v2"),this.resolution=e||new iu}function au(e){ha.call(this),this.texture=e,this.maxMIPLevel=0}function su(e){ra.call(this,"f"),this.texture=e,this.maxMIPLevel=new au(e),this.blinnShininessExponent=new Hc}function cu(e,t){ta.call(this,t),this.name=e}function uu(e,t,r,n,i){na.call(this,e,i,n,r,t)}function lu(e,t){ra.call(this),this.setFunction(e,t)}function hu(e){this.time=void 0!==e?e:0,this.id=0}function du(e,t){ta.call(this,e),this.value=t}function fu(e,t,r,n){ra.call(this,"v4"),this.value=e,this.uv=t||new sa,this.radius=new nu(1,1),this.size=n,this.blurX=!0,this.blurY=!0,this.horizontal=new ha(1/64),this.vertical=new ha(1/64)}function pu(e){ra.call(this,"f"),this.rgb=e}function mu(e,t,r){ra.call(this,"v3"),this.rgb=e,this.adjustment=t,this.method=r||mu.SATURATION}function vu(e){la.call(this,"i"),this.value=Math.floor(e||0)}function gu(e){la.call(this,"m3"),this.value=e||new d}function yu(e){la.call(this,"m4"),this.value=e||new a}function bu(e,t,r){la.call(this,r),this.object=e,this.property=t}function xu(e,t,r){ra.call(this),this.a=e,this.b=t,this.op=r}function wu(e){ra.call(this,"v4"),e&&this.setMirror(e)}function _u(e,t,r,n){n=n||{},this.input=r,this.clear=void 0===n.clear||n.clear,this.renderTarget=new Kr(e,t,n),this.material=new ru,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.render=!0,Gc.call(this,this.renderTarget.texture)}function Su(e){Gc.call(this,void 0,e)}function Mu(){ta.call(this),this.color=new eu(15658734),this.roughness=new ha(.5),this.metalness=new ha(.5)}function Tu(e,t){ta.call(this),this.node=e,this.components=t||"x"}function Au(e,t){ra.call(this,"v3"),this.value=e,this.scale=t||new nu(1,1)}function Eu(){Mu.call(this),this.properties={color:new v(16777215),roughness:.5,metalness:.5,normalScale:new x(1,1)},this.inputs={color:new bu(this.properties,"color","c"),roughness:new bu(this.properties,"roughness","f"),metalness:new bu(this.properties,"metalness","f"),normalScale:new bu(this.properties,"normalScale","v2")}}function Cu(){var e=new Eu;ru.call(this,e,e),this.type="MeshStandardNodeMaterial"}function Lu(){ta.call(this),this.color=new eu(15658734),this.specular=new eu(1118481),this.shininess=new ha(30)}function Pu(){ta.call(this),this.color=new eu(15658734),this.spherical=!0}function Ou(){var e=new Lu;ru.call(this,e,e),this.type="PhongNodeMaterial"}function Nu(){var e=new Pu;ru.call(this,e,e),this.type="SpriteNodeMaterial"}function Ru(){var e=new Mu;ru.call(this,e,e),this.type="StandardNodeMaterial"}function Iu(e,t,r,n,i){ra.call(this),this.a=e,this.b=t,this.ifNode=r,this.elseNode=n,this.op=i}function Du(e,t){ra.call(this),this.a=e,this.method=t}function Fu(e,t,r){ra.call(this),this.a=e,this.b=t,this.method=r}function Uu(e,t,r,n){ra.call(this),this.a=e,this.b=t,this.c=r,this.method=n}function ku(e,t){ra.call(this,"v3"),this.value=e,this.scale=t||new ha(1),this.toNormalMap=!1}$c.prototype={constructor:$c,build:function(e,t){return this.buildShader("vertex",e),this.buildShader("fragment",t),this.requires.uv[0]&&(this.addVaryCode("varying vec2 vUv;"),this.addVertexFinalCode("vUv = uv;")),this.requires.uv[1]&&(this.addVaryCode("varying vec2 vUv2;"),this.addVertexParsCode("attribute vec2 uv2;"),this.addVertexFinalCode("vUv2 = uv2;")),this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")),this},buildShader:function(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")},setMaterial:function(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this},addFlow:function(e,t,r){return this.addSlot(e).addCache(t).addContext(r)},removeFlow:function(){return this.removeSlot().removeCache().removeContext()},addCache:function(e){return this.cache=e||"",this.caches.push(this.cache),this},removeCache:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this},addContext:function(e){return this.context=Object.assign({},this.context,e),this.contexts.push(this.context),this},removeContext:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this},addSlot:function(e){return this.slot=e||"",this.slots.push(this.slot),this},removeSlot:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this},addVertexCode:function(e){this.addCode(e,"vertex")},addFragmentCode:function(e){this.addCode(e,"fragment")},addCode:function(e,t){this.code[t||this.shader]+=e+"\n"},addVertexNodeCode:function(e){this.addNodeCode(e,"vertex")},addFragmentNodeCode:function(e){this.addNodeCode(e,"fragment")},addNodeCode:function(e,t){this.nodeCode[t||this.shader]+=e+"\n"},clearNodeCode:function(e){e=e||this.shader;var t=this.nodeCode[e];return this.nodeCode[e]="",t},clearVertexNodeCode:function(){return this.clearNodeCode("vertex")},clearFragmentNodeCode:function(){return this.clearNodeCode("fragment")},addVertexFinalCode:function(e){this.addFinalCode(e,"vertex")},addFragmentFinalCode:function(e){this.addFinalCode(e,"fragment")},addFinalCode:function(e,t){this.finalCode[t||this.shader]+=e+"\n"},addVertexParsCode:function(e){this.addParsCode(e,"vertex")},addFragmentParsCode:function(e){this.addParsCode(e,"fragment")},addParsCode:function(e,t){this.parsCode[t||this.shader]+=e+"\n"},addVaryCode:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)},isCache:function(e){return-1!==this.caches.indexOf(e)},isSlot:function(e){return-1!==this.slots.indexOf(e)},define:function(e,t){this.defines[e]=void 0===t?1:t},isDefined:function(e){return void 0!==this.defines[e]},getVar:function(e,t,r,n){n=n||"varying";var i=this.getVars(n),o=i[e];if(!o){var a=i.length;o={name:r||"nVv"+a,type:t},i.push(o),i[e]=o}return o},getTempVar:function(e,t,r){return this.getVar(e,t,r,this.shader)},getAttribute:function(e,t){if(!this.attributes[e]){var r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]},getCode:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")},getVarListCode:function(e,t){t=t||"";for(var r="",n=0,i=e.length;n<i;++n){var o=e[n],a=o.type,s=o.name,c=this.getFormatByType(a);if(void 0===c)throw new Error("Node pars "+c+" not found.");r+=t+" "+c+" "+s+";\n"}return r},getVars:function(e){return this.inputs.vars[e||this.shader]},getNodeData:function(e){var t=e.isNode?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}},createUniform:function(e,t,r,n,i){var o=this.inputs.uniforms,a=o.list.length,s=new Fc({type:t,name:n||"nVu"+a,node:r,needsUpdate:i});return o.list.push(s),o[e].push(s),o[e][s.name]=s,this.uniforms[s.name]=s,s},createVertexUniform:function(e,t,r,n){return this.createUniform("vertex",e,t,r,n)},createFragmentUniform:function(e,t,r,n){return this.createUniform("fragment",e,t,r,n)},include:function(e,t,r){var n;if(e="string"==typeof e?ia.get(e):e,!1===this.context.include)return e.name;e instanceof na?n=this.includes.functions:e instanceof pa?n=this.includes.consts:e instanceof Bc&&(n=this.includes.structs);var i=n[this.shader]=n[this.shader]||[];if(e){var o=i[e.name];if(o||(o=i[e.name]={node:e,deps:[]},i.push(o),o.src=e.build(this,"source")),e instanceof na&&t&&i[t.name]&&-1==i[t.name].deps.indexOf(e)&&(i[t.name].deps.push(e),e.includes&&e.includes.length)){var a=0;do{this.include(e.includes[a++],t)}while(a<e.includes.length)}return r&&(o.src=r),e.name}throw new Error("Include not found.")},colorToVectorProperties:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},colorToVector:function(e){return e.replace(/c/g,"v3")},getIncludes:function(e,t){return this.includes[e][t||this.shader]},getIncludesCode:function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){if(!(i=this.getIncludes(t,r)))return"";for(var n="",i=i.sort(e),o=0;o<i.length;o++)i[o].src&&(n+=i[o].src+"\n");return n}}(),getConstructorFromLength:function(e){return Qc[e-1]},isTypeMatrix:function(e){return/^m/.test(e)},getTypeLength:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))},getTypeFromLength:function(e){return 1===e?"f":"v"+e},findNode:function(){for(var e=arguments,t=0;t<arguments.length;t++){var r=e[t];if(void 0!==r&&r.isNode)return r}},resolve:function(){for(var e=arguments,t=0;t<arguments.length;t++){var r=e[t];if(void 0!==r){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case ke:case Be:return new Wc(r);case Ge:case We:return new Yc(new Gc(r));default:return new Gc(r)}else{if(r.isVector2)return new nu(r);if(r.isVector3)return new zc(r);if(r.isVector4)return new jc(r)}}}},format:function(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":return"vec4( float( "+e+" ) )";case"i <- f":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )"}return e},getTypeByFormat:function(e){return Zc[e]||e},getFormatByType:function(e){return Kc[e]||e},getUuid:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return Jc[e]},getIndexByElement:function(e){return Jc.indexOf(e)},isShader:function(e){return this.shader===e},setShader:function(e){return this.shader=e,this},mergeDefines:function(e){for(var t in e)this.defines[t]=e[t];return this.defines},mergeUniform:function(e){for(var t in e)this.uniforms[t]=e[t];return this.uniforms},getTextureEncodingFromMap:function(e,t){var r;return t=void 0!==t?t:this.context.gamma&&!!this.renderer&&this.renderer.gammaInput,e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=Jt,r===Jt&&t&&(r=Zt),r}},eu.prototype=Object.create(la.prototype),eu.prototype.constructor=eu,eu.prototype.nodeType="Color",Dc.addShortcuts(eu.prototype,"value",["r","g","b"]),eu.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",n,t)},eu.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value.copy(e)},eu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).r=this.r,t.g=this.g,t.b=this.b,!0===this.readonly&&(t.readonly=!0)),t},tu.prototype=Object.create(ta.prototype),tu.prototype.constructor=tu,tu.prototype.nodeType="Raw",tu.prototype.generate=function(e){var t=this.value.parseAndBuildCode(e,this.type),r=t.code+"\n";return e.isShader("vertex")?r+="gl_Position = "+t.result+";":r+="gl_FragColor = "+t.result+";",r},tu.prototype.copy=function(e){ta.prototype.copy.call(this,e),this.value=e.value},tu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t},ru.prototype=Object.create(Xr.prototype),ru.prototype.constructor=ru,ru.prototype.type="NodeMaterial",ru.prototype.isNodeMaterial=!0,Object.defineProperties(ru.prototype,{properties:{get:function(){return this.fragment.properties}}}),ru.prototype.updateFrame=function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])},ru.prototype.onBeforeCompile=function(e,t){this.needsUpdate&&(this.build({renderer:t}),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader)},ru.prototype.build=function(e){var t=(e=e||{}).builder||new $c;return t.setMaterial(this,e.renderer),t.build(this.vertex,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters,this.fog=t.requires.fog,this.lights=t.requires.lights,this.transparent=t.requires.transparent||this.blending>ee,this.needsUpdate=!1,this},ru.prototype.copy=function(e){var t=this.uuid;for(var r in e)this[r]=e[r];this.uuid=t,void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData)))},ru.prototype.toJSON=function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.materials&&(e.materials={}),!e.materials[this.uuid]){var t={};t.uuid=this.uuid,t.type=this.type,e.materials[t.uuid]=t,""!==this.name&&(t.name=this.name),void 0!==this.size&&(t.size=this.size),void 0!==this.sizeAttenuation&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==ee&&(t.blending=this.blending),!0===this.flatShading&&(t.flatShading=this.flatShading),this.side!==q&&(t.side=this.side),this.vertexColors!==Q&&(t.vertexColors=this.vertexColors),this.depthFunc!==Me&&(t.depthFunc=this.depthFunc),!1===this.depthTest&&(t.depthTest=this.depthTest),!1===this.depthWrite&&(t.depthWrite=this.depthWrite),1!==this.linewidth&&(t.linewidth=this.linewidth),void 0!==this.dashSize&&(t.dashSize=this.dashSize),void 0!==this.gapSize&&(t.gapSize=this.gapSize),void 0!==this.scale&&(t.scale=this.scale),!0===this.dithering&&(t.dithering=!0),!0===this.wireframe&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(t.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(t.wireframeLinejoin=this.wireframeLinejoin),this.alphaTest>0&&(t.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(t.premultipliedAlpha=this.premultipliedAlpha),!0===this.morphTargets&&(t.morphTargets=!0),!0===this.skinning&&(t.skinning=!0),!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.fog=this.fog,t.lights=this.lights,t.vertex=this.vertex.toJSON(e).uuid,t.fragment=this.fragment.toJSON(e).uuid}return e.material=this.uuid,e},nu.prototype=Object.create(la.prototype),nu.prototype.constructor=nu,nu.prototype.nodeType="Vector2",Dc.addShortcuts(nu.prototype,"value",["x","y"]),nu.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("vec2( "+this.x+", "+this.y+" )",n,t)},nu.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value.copy(e)},nu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,!0===this.readonly&&(t.readonly=!0)),t},iu.prototype=Object.create(nu.prototype),iu.prototype.constructor=iu,iu.prototype.nodeType="Resolution",iu.prototype.updateFrame=function(e){if(e.renderer){var t=e.renderer.getSize(),r=e.renderer.getPixelRatio();this.x=t.width*r,this.y=t.height*r}else console.warn("ResolutionNode need a renderer in NodeFrame")},iu.prototype.copy=function(e){nu.prototype.copy.call(this,e),this.renderer=e.renderer},iu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).renderer=this.renderer.uuid),t},ou.prototype=Object.create(ra.prototype),ou.prototype.constructor=ou,ou.prototype.nodeType="ScreenUV",ou.prototype.generate=function(e,t){var r;return e.isShader("fragment")?r="( gl_FragCoord.xy / "+this.resolution.build(e,"v2")+")":(console.warn("ScreenUVNode is not compatible with "+e.shader+" shader."),r="vec2( 0.0 )"),e.format(r,this.getType(e),t)},ou.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.resolution=e.resolution},ou.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).resolution=this.resolution.toJSON(e).uuid),t},au.prototype=Object.create(ha.prototype),au.prototype.constructor=au,au.prototype.nodeType="MaxMIPLevel",Object.defineProperties(au.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image?this.texture.value.image[0]:void 0;this.maxMIPLevel=void 0!==e?Math.log(Math.max(e.width,e.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(){}}}),au.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.uuid),t},su.Nodes={getSpecularMIPLevel:new na(["float getSpecularMIPLevel( const in float blinnShininessExponent, const in float maxMIPLevelScalar ) {","\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n"))},su.prototype=Object.create(ra.prototype),su.prototype.constructor=su,su.prototype.nodeType="RoughnessToBlinnExponent",su.prototype.generate=function(e,t){if(e.isShader("fragment")){this.maxMIPLevel.texture=this.texture;var r=e.include(su.Nodes.getSpecularMIPLevel);return e.format(r+"( "+this.blinnShininessExponent.build(e,"f")+", "+this.maxMIPLevel.build(e,"f")+" )",this.type,t)}return console.warn("RoughnessToBlinnExponentNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t)},su.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.texture=e.texture},su.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture),t},cu.prototype=Object.create(ta.prototype),cu.prototype.constructor=cu,cu.prototype.nodeType="Attribute",cu.prototype.getAttributeType=function(e){return"number"==typeof this.type?e.getConstructorFromLength(this.type):this.type},cu.prototype.getType=function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)},cu.prototype.generate=function(e,t){var r=this.getAttributeType(e),n=e.getAttribute(this.name,r),i=e.isShader("vertex")?this.name:n.varying.name;return console.log(n),e.format(i,this.getType(e),t)},cu.prototype.copy=function(e){ta.prototype.copy.call(this,e),this.type=e.type},cu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type),t},uu.prototype=Object.create(na.prototype),uu.prototype.constructor=uu,uu.prototype.nodeType="Expression",lu.prototype=Object.create(ra.prototype),lu.prototype.constructor=lu,lu.prototype.nodeType="FunctionCall",lu.prototype.setFunction=function(e,t){this.value=e,this.inputs=t||[]},lu.prototype.getFunction=function(){return this.value},lu.prototype.getType=function(e){return this.value.getType(e)},lu.prototype.generate=function(e,t){for(var r=this.getType(e),n=this.value,i=n.build(e,t)+"( ",o=[],a=0;a<n.inputs.length;a++){var s=n.inputs[a],c=this.inputs[a]||this.inputs[s.name];o.push(c.build(e,e.getTypeByFormat(s.type)))}return i+=o.join(", ")+" )",e.format(i,r,t)},lu.prototype.copy=function(e){for(var t in ra.prototype.copy.call(this,e),e.inputs)this.inputs[t]=e.inputs[t];this.value=e.value},lu.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){var r=this.value;if((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,r.inputs.length){t.inputs={};for(var n=0;n<r.inputs.length;n++){var i=r.inputs[n],o=this.inputs[n]||this.inputs[i.name];t.inputs[i.name]=o.toJSON(e).uuid}}}return t},hu.prototype={constructor:hu,update:function(e){return++this.id,this.time+=e,this.delta=e,this},setRenderer:function(e){return this.renderer=e,this},setRenderTexture:function(e){return this.renderTexture=e,this},updateNode:function(e){return e.frameId===this.id?this:(e.updateFrame(this),e.frameId=this.id,this)}},du.prototype=Object.create(ta.prototype),du.prototype.constructor=du,du.prototype.nodeType="Var",du.prototype.getType=function(e){return e.getTypeByFormat(this.type)},du.prototype.generate=function(e,t){var r=e.getVar(this.uuid,this.type);return this.value&&e.isShader("vertex")&&e.addNodeCode(r.name+" = "+this.value.build(e,this.getType(e))+";"),e.format(r.name,this.getType(e),t)},du.prototype.copy=function(e){ta.prototype.copy.call(this,e),this.type=e.type,this.value=e.value},du.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type,this.value&&(t.value=this.value.toJSON(e).uuid)),t},fu.Nodes={blurX:new na(["vec4 blurX( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum * .667;","}"].join("\n")),blurY:new na(["vec4 blurY( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum * .667;","}"].join("\n"))},fu.prototype=Object.create(ra.prototype),fu.prototype.constructor=fu,fu.prototype.nodeType="Blur",fu.prototype.updateFrame=function(e){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var t=this.value.value.image;this.horizontal.value=this.radius.x/t.width,this.vertical.value=this.radius.y/t.height}},fu.prototype.generate=function(e,t){if(e.isShader("fragment")){var r,n=[],i=e.include(fu.Nodes.blurX),o=e.include(fu.Nodes.blurY);return this.blurX&&n.push(i+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.horizontal.build(e,"f")+" )"),this.blurY&&n.push(o+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.vertical.build(e,"f")+" )"),r=2==n.length?"( "+n.join(" + ")+" / 2.0 )":n.length?"( "+n[0]+" )":"vec4( 0.0 )",e.format(r,this.getType(e),t)}return console.warn("BlurNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},fu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.value=e.value,this.uv=e.uv,this.radius=e.radius,void 0!==e.size&&(this.size=new x(e.size.x,e.size.y)),this.blurX=e.blurX,this.blurY=e.blurY},fu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.radius=this.radius.toJSON(e).uuid,this.size&&(t.size={x:this.size.x,y:this.size.y}),t.blurX=this.blurX,t.blurY=this.blurY),t},pu.Nodes=function(){var e=new pa("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )");return{LUMA:e,luminance:new na(["float luminance( vec3 rgb ) {","\treturn dot( rgb, LUMA );","}"].join("\n"),[e])}}(),pu.prototype=Object.create(ra.prototype),pu.prototype.constructor=pu,pu.prototype.nodeType="Luminance",pu.prototype.generate=function(e,t){var r=e.include(pu.Nodes.luminance);return e.format(r+"( "+this.rgb.build(e,"v3")+" )",this.getType(e),t)},pu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.rgb=e.rgb},pu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid),t},mu.Nodes={hue:new na(["vec3 hue(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n")),saturation:new na(["vec3 saturation(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3( luminance( rgb ) );","\treturn mix( intensity, rgb, adjustment );","}"].join("\n"),[pu.Nodes.luminance]),vibrance:new na(["vec3 vibrance(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))},mu.SATURATION="saturation",mu.HUE="hue",mu.VIBRANCE="vibrance",mu.BRIGHTNESS="brightness",mu.CONTRAST="contrast",mu.prototype=Object.create(ra.prototype),mu.prototype.constructor=mu,mu.prototype.nodeType="ColorAdjustment",mu.prototype.generate=function(e,t){var r=this.rgb.build(e,"v3"),n=this.adjustment.build(e,"f");switch(this.method){case mu.BRIGHTNESS:return e.format("( "+r+" + "+n+" )",this.getType(e),t);case mu.CONTRAST:return e.format("( "+r+" * "+n+" )",this.getType(e),t)}var i=e.include(mu.Nodes[this.method]);return e.format(i+"( "+r+", "+n+" )",this.getType(e),t)},mu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.rgb=e.rgb,this.adjustment=e.adjustment,this.method=e.method},mu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid,t.adjustment=this.adjustment.toJSON(e).uuid,t.method=this.method),t},vu.prototype=Object.create(la.prototype),vu.prototype.constructor=vu,vu.prototype.nodeType="Int",vu.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format(this.value,n,t)},vu.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value=e.value},vu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},gu.prototype=Object.create(la.prototype),gu.prototype.constructor=gu,gu.prototype.nodeType="Matrix3",Object.defineProperties(gu.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),gu.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("mat3( "+this.value.elements.join(", ")+" )",n,t)},gu.prototype.copy=function(e){la.prototype.copy.call(this,e),this.value.fromArray(e.elements)},gu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},yu.prototype=Object.create(la.prototype),yu.prototype.constructor=yu,yu.prototype.nodeType="Matrix4",Object.defineProperties(yu.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),yu.prototype.generateReadonly=function(e,t,r,n,i,o){return e.format("mat4( "+this.value.elements.join(", ")+" )",n,t)},yu.prototype.copy=function(e){la.prototype.copy.call(this,e),this.scope.value.fromArray(e.elements)},yu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},bu.prototype=Object.create(la.prototype),bu.prototype.constructor=bu,bu.prototype.nodeType="Property",Object.defineProperties(bu.prototype,{value:{get:function(){return this.object[this.property]},set:function(e){this.object[this.property]=e}}}),bu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,t.property=this.property),t},xu.ADD="+",xu.SUB="-",xu.MUL="*",xu.DIV="/",xu.prototype=Object.create(ra.prototype),xu.prototype.constructor=xu,xu.prototype.nodeType="Operator",xu.prototype.getType=function(e){var t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t},xu.prototype.generate=function(e,t){e.getNodeData(this);var r=this.getType(e),n=this.a.build(e,r),i=this.b.build(e,r);return e.format("( "+n+" "+this.op+" "+i+" )",r,t)},xu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op},xu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t},wu.prototype=Object.create(ra.prototype),wu.prototype.constructor=wu,wu.prototype.nodeType="Reflector",wu.prototype.setMirror=function(e){this.mirror=e,this.textureMatrix=new yu(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new ca(ca.LOCAL),this.uv=new xu(this.textureMatrix,this.localPosition,xu.MUL),this.uvResult=new xu(null,this.uv,xu.ADD),this.texture=new Gc(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},wu.prototype.generate=function(e,t){return e.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===t?this.texture.build(e,t):e.format(this.texture.build(e,this.type),this.type,t)):(console.warn("ReflectorNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.type,t))},wu.prototype.copy=function(e){InputNode.prototype.copy.call(this,e),this.scope.mirror=e.mirror},wu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).mirror=this.mirror.uuid,this.offset&&(t.offset=this.offset.toJSON(e).uuid)),t},_u.prototype=Object.create(Gc.prototype),_u.prototype.constructor=_u,_u.prototype.nodeType="RTT",_u.prototype.build=function(e,t,r){var n=new $c;return n.nodes=e.nodes,n.updaters=e.updaters,this.material.fragment.value=this.input,this.material.build({builder:n}),Gc.prototype.build.call(this,e,t,r)},_u.prototype.updateFramesaveTo=function(e){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var t=new ru;t.fragment.value=this,t.build();var r=new qr,n=new dr(new en(2,2),t);n.frustumCulled=!1,r.add(n),this.saveToScene=r,this.saveToMaterial=t}this.saveToCurrent=this.saveTo,e.renderer.render(this.saveToScene,this.camera,this.saveTo.renderTarget,this.saveTo.clear)},_u.prototype.updateFrame=function(e){e.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(e),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=e.renderTexture),e.renderer.render(this.scene,this.camera,this.renderTarget,this.clear)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(e)):console.warn("RTTNode need a renderer in NodeFrame")},_u.prototype.copy=function(e){Gc.prototype.copy.call(this,e),this.saveTo=e.saveTo},_u.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=Gc.prototype.toJSON.call(this,e),this.saveTo&&(t.saveTo=this.saveTo.toJSON(e).uuid)),t},Su.prototype=Object.create(Gc.prototype),Su.prototype.constructor=Su,Su.prototype.nodeType="Screen",Su.prototype.isUnique=function(){return!0},Su.prototype.getTexture=function(e,t){return la.prototype.generate.call(this,e,t,this.getUuid(),"t","renderTexture")},Mu.prototype=Object.create(ta.prototype),Mu.prototype.constructor=Mu,Mu.prototype.nodeType="Standard",Mu.prototype.build=function(e){var t;if(e.define(this.clearCoat||this.clearCoatRoughness?"PHYSICAL":"STANDARD"),e.requires.lights=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var r=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Hr.merge([Ci.fog,Ci.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),t=n.join("\n")}else{var i={bias:su,gamma:!0},o={gamma:!0},a=!e.isDefined("STANDARD");this.color.parse(e,{slot:"color",context:o}),this.roughness.parse(e),this.metalness.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.clearCoat&&this.clearCoat.parse(e),this.clearCoatRoughness&&this.clearCoatRoughness.parse(e),this.reflectivity&&this.reflectivity.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{cache:"env",context:i,slot:"environment"});var s=this.color.buildCode(e,"c",{slot:"color",context:o}),c=this.roughness.buildCode(e,"f"),u=this.metalness.buildCode(e,"f"),l=this.alpha?this.alpha.buildCode(e,"f"):void 0,h=this.normal?this.normal.buildCode(e,"v3"):void 0,d=this.clearCoat?this.clearCoat.buildCode(e,"f"):void 0,f=this.clearCoatRoughness?this.clearCoatRoughness.buildCode(e,"f"):void 0,p=this.reflectivity?this.reflectivity.buildCode(e,"f"):void 0,m=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,v=this.ao?this.ao.buildCode(e,"f"):void 0,g=this.ambient?this.ambient.buildCode(e,"c"):void 0,y=this.shadow?this.shadow.buildCode(e,"c"):void 0,b=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,x=this.environment?this.environment.buildCode(e,"c",{cache:"env",context:i,slot:"environment"}):void 0,w=a&&x?this.environment.buildCode(e,"c",{cache:"clearCoat",context:i,slot:"environment"}):void 0;e.requires.transparent=void 0!==l,e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <logdepthbuf_vertex>"].join("\n"));n=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );",s.code,"\tvec3 diffuseColor = "+s.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",c.code,"\tfloat roughnessFactor = "+c.result+";",u.code,"\tfloat metalnessFactor = "+u.result+";"];l&&n.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h&&n.push(h.code,"normal = "+h.result+";"),n.push("material.diffuseColor = "+(m?"vec3( 1.0 )":"diffuseColor * (1.0 - metalnessFactor)")+";","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?n.push(d.code,"material.clearCoat = saturate( "+d.result+" );"):a&&n.push("material.clearCoat = 0.0;"),f?n.push(f.code,"material.clearCoatRoughness = clamp( "+f.result+", 0.04, 1.0 );"):a&&n.push("material.clearCoatRoughness = 0.0;"),p?n.push(p.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+p.result+" ) ), diffuseColor, metalnessFactor );"):n.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),n.push("#include <lights_fragment_begin>"),m&&(n.push(m.code,"reflectedLight.directDiffuse = "+m.result+";"),n.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),v&&n.push(v.code,"reflectedLight.indirectDiffuse *= "+v.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+v.result+", material.specularRoughness );"),g&&n.push(g.code,"reflectedLight.indirectDiffuse += "+g.result+";"),y&&n.push(y.code,"reflectedLight.directDiffuse *= "+y.result+";","reflectedLight.directSpecular *= "+y.result+";"),b&&n.push(b.code,"reflectedLight.directDiffuse += "+b.result+";"),x&&(n.push(x.code),w&&n.push(w.code,"clearCoatRadiance += "+w.result+";"),n.push("radiance += "+x.result+";")),n.push("#include <lights_fragment_end>"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),l?n.push("gl_FragColor = vec4( outgoingLight, "+l.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),t=n.join("\n")}return t},Mu.prototype.copy=function(e){ta.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.roughness=e.roughness,this.metalness=e.metalness,e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.clearCoat&&(this.clearCoat=e.clearCoat),e.clearCoatRoughness&&(this.clearCoatRoughness=e.clearCoatRoughness),e.reflectivity&&(this.reflectivity=e.reflectivity),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment)},Mu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.clearCoat&&(t.clearCoat=this.clearCoat.toJSON(e).uuid),this.clearCoatRoughness&&(t.clearCoatRoughness=this.clearCoatRoughness.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid)),t},Tu.prototype=Object.create(ta.prototype),Tu.prototype.constructor=Tu,Tu.prototype.nodeType="Switch",Tu.prototype.getType=function(e){return e.getTypeFromLength(this.components.length)},Tu.prototype.generate=function(e,t){var r=this.node.getType(e),n=this.node.build(e,r),i=e.getTypeLength(r)-1;if(i>0){var o,a=0,s=e.colorToVectorProperties(this.components),c=s.length;for(o=0;o<c;o++)a=Math.max(a,e.getIndexByElement(s.charAt(o)));for(a>i&&(a=i),n+=".",o=0;o<c;o++){s.charAt(o);var u=e.getIndexByElement(s.charAt(o));u>a&&(u=a),n+=e.getElementByIndex(u)}return e.format(n,this.getType(e),t)}return e.format(n,r,t)},Tu.prototype.copy=function(e){ta.prototype.copy.call(this,e),this.node=e.node,this.components=e.components},Tu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).node=this.node.toJSON(e).uuid,t.components=this.components),t},Au.Nodes={perturbNormal2Arb:new na(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 normalScale ) {","\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );","\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );","\tvec2 st0 = dFdx( mUv.st );","\tvec2 st1 = dFdy( mUv.st );","\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );","\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );","\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );","\tvec3 N = normalize( surf_norm );","\tmat3 tsn = mat3( S, T, N );","\tvec3 mapN = map * 2.0 - 1.0;","\tmapN.xy *= normalScale;","\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\treturn normalize( tsn * mapN );","}"].join("\n"),null,{derivatives:!0})},Au.prototype=Object.create(ra.prototype),Au.prototype.constructor=Au,Au.prototype.nodeType="NormalMap",Au.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(Au.Nodes.perturbNormal2Arb);return this.normal=this.normal||new ua,this.position=this.position||new ca(ca.VIEW),this.uv=this.uv||new sa,e.format(r+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+this.value.build(e,"v3")+", "+this.uv.build(e,"v2")+", "+this.scale.build(e,"v2")+" )",this.getType(e),t)}return console.warn("NormalMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},Au.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale},Au.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},Eu.prototype=Object.create(Mu.prototype),Eu.prototype.constructor=Eu,Eu.prototype.nodeType="MeshStandard",Eu.prototype.build=function(e){var t=this.properties,r=this.inputs;if(e.isShader("fragment")){var n=e.findNode(t.color,r.color),i=e.resolve(t.map);this.color=i?new xu(n,i,xu.MUL):n;var o=e.findNode(t.roughness,r.roughness),a=e.resolve(t.roughnessMap);this.roughness=a?new xu(o,new Tu(a,"g"),xu.MUL):o;var s=e.findNode(t.metalness,r.metalness),c=e.resolve(t.metalnessMap);this.metalness=c?new xu(s,new Tu(c,"b"),xu.MUL):s,t.normalMap?(this.normal=new Au(e.resolve(t.normalMap)),this.normal.scale=e.findNode(t.normalScale,r.normalScale)):this.normal=void 0,this.environment=e.resolve(t.envMap)}return Mu.prototype.build.call(this,e)},Eu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),console.warn(".toJSON not implemented in",this)),t},Cu.prototype=Object.create(ru.prototype),Cu.prototype.constructor=Cu,Dc.addShortcuts(Cu.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]),Lu.prototype=Object.create(ta.prototype),Lu.prototype.constructor=Lu,Lu.prototype.nodeType="Phong",Lu.prototype.build=function(e){var t;if(e.define("PHONG"),e.requires.lights=!0,e.isShader("vertex")){var r=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Hr.merge([Ci.fog,Ci.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=n.join("\n")}else{this.color.parse(e,{slot:"color"}),this.specular.parse(e),this.shininess.parse(e),this.alpha&&this.alpha.parse(e),this.normal&&this.normal.parse(e),this.light&&this.light.parse(e,{cache:"light"}),this.ao&&this.ao.parse(e),this.ambient&&this.ambient.parse(e),this.shadow&&this.shadow.parse(e),this.emissive&&this.emissive.parse(e,{slot:"emissive"}),this.environment&&this.environment.parse(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.parse(e);var i=this.color.buildCode(e,"c",{slot:"color"}),o=this.specular.buildCode(e,"c"),a=this.shininess.buildCode(e,"f"),s=this.alpha?this.alpha.buildCode(e,"f"):void 0,c=this.normal?this.normal.buildCode(e,"v3"):void 0,u=this.light?this.light.buildCode(e,"v3",{cache:"light"}):void 0,l=this.ao?this.ao.buildCode(e,"f"):void 0,h=this.ambient?this.ambient.buildCode(e,"c"):void 0,d=this.shadow?this.shadow.buildCode(e,"c"):void 0,f=this.emissive?this.emissive.buildCode(e,"c",{slot:"emissive"}):void 0,p=this.environment?this.environment.buildCode(e,"c",{slot:"environment"}):void 0,m=this.environmentAlpha&&this.environment?this.environmentAlpha.buildCode(e,"f"):void 0;e.requires.transparent=void 0!=s,e.addParsCode(["#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));n=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;",i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",o.code,"\tvec3 specular = "+o.result+";",a.code,"\tfloat shininess = max( 0.0001, "+a.result+" );","\tfloat specularStrength = 1.0;"];s&&n.push(s.code,"#ifdef ALPHATEST","if ( "+s.result+" <= ALPHATEST ) discard;","#endif"),c&&n.push(c.code,"normal = "+c.result+";"),n.push("material.diffuseColor = "+(u?"vec3( 1.0 )":"diffuseColor")+";"),n.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u&&(n.push(u.code,"reflectedLight.directDiffuse = "+u.result+";"),n.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),l&&n.push(l.code,"reflectedLight.indirectDiffuse *= "+l.result+";"),h&&n.push(h.code,"reflectedLight.indirectDiffuse += "+h.result+";"),d&&n.push(d.code,"reflectedLight.directDiffuse *= "+d.result+";","reflectedLight.directSpecular *= "+d.result+";"),f&&n.push(f.code,"reflectedLight.directDiffuse += "+f.result+";"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),p&&(n.push(p.code),m?n.push(m.code,"outgoingLight = mix( outgoingLight, "+p.result+", "+m.result+" );"):n.push("outgoingLight = "+p.result+";")),s?n.push("gl_FragColor = vec4( outgoingLight, "+s.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),t=n.join("\n")}return t},Lu.prototype.copy=function(e){ta.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.specular=e.specular,this.shininess=e.shininess,e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha)},Lu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t},Pu.prototype=Object.create(ta.prototype),Pu.prototype.constructor=Pu,Pu.prototype.nodeType="Sprite",Pu.prototype.build=function(e){var t;if(e.define("SPRITE"),e.requires.lights=!1,e.requires.transparent=void 0!==this.alpha,e.isShader("vertex")){var r=this.position?this.position.parseAndBuildCode(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Hr.merge([Ci.fog])),e.addParsCode(["#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n")),t=["#include <clipping_planes_fragment>","#include <begin_vertex>"],r&&t.push(r.code,r.result?"transformed = "+r.result+";":""),t.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||t.push("modelMtx[1][1] = 1.0;"),t.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&t.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),t.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{e.addParsCode(["#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>"].join("\n")),e.addCode(["#include <clipping_planes_fragment>","#include <logdepthbuf_fragment>"].join("\n")),this.alpha&&this.alpha.parse(e),this.color.parse(e,{slot:"color"});var n=this.alpha?this.alpha.buildCode(e,"f"):void 0,i=this.color.buildCode(e,"c",{slot:"color"});(t=n?[n.code,"#ifdef ALPHATEST","if ( "+n.result+" <= ALPHATEST ) discard;","#endif",i.code,"gl_FragColor = vec4( "+i.result+", "+n.result+" );"]:[i.code,"gl_FragColor = vec4( "+i.result+", 1.0 );"]).push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return t.join("\n")},Pu.prototype.copy=function(e){ta.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,void 0!==e.spherical&&(this.spherical=e.spherical),e.alpha&&(this.alpha=e.alpha)},Pu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,!1===this.spherical&&(t.spherical=!1),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid)),t},Ou.prototype=Object.create(ru.prototype),Ou.prototype.constructor=Ou,Dc.addShortcuts(Ou.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","position"]),Nu.prototype=Object.create(ru.prototype),Nu.prototype.constructor=Nu,Dc.addShortcuts(Nu.prototype,"fragment",["color","alpha","position","spherical"]),Ru.prototype=Object.create(ru.prototype),Ru.prototype.constructor=Ru,Dc.addShortcuts(Ru.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearCoat","clearCoatRoughness","normal","emissive","ambient","light","shadow","ao","environment","position"]),Iu.EQUAL="==",Iu.NOT_EQUAL="!=",Iu.GREATER=">",Iu.GREATER_EQUAL=">=",Iu.LESS="<",Iu.LESS_EQUAL="<=",Iu.prototype=Object.create(ra.prototype),Iu.prototype.constructor=Iu,Iu.prototype.nodeType="Cond",Iu.prototype.getType=function(e){return e.getTypeLength(this.elseNode.getType(e))>e.getTypeLength(this.ifNode.getType(e))?this.elseNode.getType(e):this.ifNode.getType(e)},Iu.prototype.getCondType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},Iu.prototype.generate=function(e,t){var r=this.getType(e),n=this.getCondType(e),i=this.a.build(e,n),o=this.b.build(e,n),a=this.ifNode.build(e,r),s=this.elseNode.build(e,r),c="( "+[i,this.op,o,"?",a,":",s].join(" ")+" )";return e.format(c,this.getType(e),t)},Iu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.ifNode=e.ifNode,this.elseNode=e.elseNode,this.op=e.op},Iu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.ifNode=this.ifNode.toJSON(e).uuid,t.elseNode=this.elseNode.toJSON(e).uuid,t.op=this.op),t},Du.RAD="radians",Du.DEG="degrees",Du.EXP="exp",Du.EXP2="exp2",Du.LOG="log",Du.LOG2="log2",Du.SQRT="sqrt",Du.INV_SQRT="inversesqrt",Du.FLOOR="floor",Du.CEIL="ceil",Du.NORMALIZE="normalize",Du.FRACT="fract",Du.SAT="saturate",Du.SIN="sin",Du.COS="cos",Du.TAN="tan",Du.ASIN="asin",Du.ACOS="acos",Du.ARCTAN="atan",Du.ABS="abs",Du.SIGN="sign",Du.LENGTH="length",Du.NEGATE="negate",Du.INVERT="invert",Du.prototype=Object.create(ra.prototype),Du.prototype.constructor=Du,Du.prototype.nodeType="Math1",Du.prototype.getType=function(e){switch(this.method){case Du.LENGTH:return"f"}return this.a.getType(e)},Du.prototype.generate=function(e,t){var r=this.getType(e),n=this.a.build(e,r);switch(this.method){case Du.NEGATE:n="( -"+n+" )";break;case Du.INVERT:n="( 1.0 - "+n+" )";break;default:n=this.method+"( "+n+" )"}return e.format(n,r,t)},Du.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.a=e.a,this.method=e.method},Du.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.method=this.method),t},Fu.MIN="min",Fu.MAX="max",Fu.MOD="mod",Fu.STEP="step",Fu.REFLECT="reflect",Fu.DISTANCE="distance",Fu.DOT="dot",Fu.CROSS="cross",Fu.POW="pow",Fu.prototype=Object.create(ra.prototype),Fu.prototype.constructor=Fu,Fu.prototype.nodeType="Math2",Fu.prototype.getInputType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},Fu.prototype.getType=function(e){switch(this.method){case Fu.DISTANCE:case Fu.DOT:return"f";case Fu.CROSS:return"v3"}return this.getInputType(e)},Fu.prototype.generate=function(e,t){var r,n,i=this.getInputType(e),o=e.getTypeLength(this.a.getType(e)),a=e.getTypeLength(this.b.getType(e));switch(this.method){case Fu.CROSS:r=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case Fu.STEP:r=this.a.build(e,1===o?"f":i),n=this.b.build(e,i);break;case Fu.MIN:case Fu.MAX:case Fu.MOD:r=this.a.build(e,i),n=this.b.build(e,1===a?"f":i);break;default:r=this.a.build(e,i),n=this.b.build(e,i)}return e.format(this.method+"( "+r+", "+n+" )",this.getType(e),t)},Fu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.method=e.method},Fu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.method=this.method),t},Uu.MIX="mix",Uu.REFRACT="refract",Uu.SMOOTHSTEP="smoothstep",Uu.FACEFORWARD="faceforward",Uu.prototype=Object.create(ra.prototype),Uu.prototype.constructor=Uu,Uu.prototype.nodeType="Math3",Uu.prototype.getType=function(e){var t=e.getTypeLength(this.a.getType(e)),r=e.getTypeLength(this.b.getType(e)),n=e.getTypeLength(this.c.getType(e));return t>r&&t>n?this.a.getType(e):r>n?this.b.getType(e):this.c.getType(e)},Uu.prototype.generate=function(e,t){e.getTypeLength(this.a.getType(e)),e.getTypeLength(this.b.getType(e));var r,n,i,o=e.getTypeLength(this.c.getType(e)),a=this.getType(e);switch(this.method){case Uu.REFRACT:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,"f");break;case Uu.MIX:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,1===o?"f":a);break;default:r=this.a.build(e,a),n=this.b.build(e,a),i=this.c.build(e,a)}return e.format(this.method+"( "+r+", "+n+", "+i+" )",a,t)},Uu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.c=e.c,this.method=e.method},Uu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.c=this.c.toJSON(e).uuid,t.method=this.method),t},ku.Nodes=function(){var e=new na(["vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {","\tvec2 dSTdx = dFdx( vUv );","\tvec2 dSTdy = dFdy( vUv );","\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;","\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","\treturn vec2( dBx, dBy );","}"].join("\n"),null,{derivatives:!0});return{dHdxy_fwd:e,perturbNormalArb:new na(["vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );","\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );","\tvec3 vN = surf_norm;","\tvec3 R1 = cross( vSigmaY, vN );","\tvec3 R2 = cross( vN, vSigmaX );","\tfloat fDet = dot( vSigmaX, R1 );","\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","\treturn normalize( abs( fDet ) * surf_norm - vGrad );","}"].join("\n"),[e],{derivatives:!0}),bumpToNormal:new na(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );","}"].join("\n"),null,{derivatives:!0})}}(),ku.prototype=Object.create(ra.prototype),ku.prototype.constructor=ku,ku.prototype.nodeType="BumpMap",ku.prototype.generate=function(e,t){if(e.isShader("fragment")){if(this.toNormalMap){var r=e.include(ku.Nodes.bumpToNormal);return e.format(r+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )",this.getType(e),t)}var n=e.include(ku.Nodes.dHdxy_fwd),i=e.include(ku.Nodes.perturbNormalArb);this.normal=this.normal||new ua,this.position=this.position||new ca(ca.VIEW);var o=n+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )";return e.format(i+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+o+" )",this.getType(e),t)}return console.warn("BumpMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},ku.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale},ku.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t};var Bu=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(Bu.prototype,{setSize:function(e,t){},render:function(e,t,r,n,i){console.error("Pass: .render() must be implemented in derived pass.")}});var zu=function(e,t){Bu.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Xr?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Hr.clone(e.uniforms),this.material=new Xr({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};function ju(){zu.call(this),this.name="",this.uuid=o.generateUUID(),this.userData={},this.textureID="renderTexture",this.input=new Su,this.material=new ru,this.needsUpdate=!0}function Vu(e,t){if(void 0===t){var r={minFilter:Ze,magFilter:Ze,format:pt,stencilBuffer:!1},n=e.getDrawingBufferSize();t=new Kr(n.width,n.height,r)}this.renderer=e,this.renderTarget=t,this.output=new Su,this.material=new ru,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.needsUpdate=!0}function Gu(e){ra.call(this,"f"),this.uv=e||new sa}function Wu(e){ra.call(this,"f"),this.uv=e||new sa}function Hu(e,t){ta.call(this),this.code=e,this.value=t}zu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:zu,render:function(e,t,r,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}),ju.prototype=Object.create(zu.prototype),ju.prototype.constructor=ju,ju.prototype.render=function(){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.input,this.needsUpdate=!1),this.uniforms=this.material.uniforms,zu.prototype.render.apply(this,arguments)},ju.prototype.copy=function(e){this.input=e.input},ju.prototype.toJSON=function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.passes&&(e.passes={}),!e.passes[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePass",e.passes[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.input=this.input.toJSON(e).uuid}return e.pass=this.uuid,e},Vu.prototype={constructor:Vu,render:function(e,t,r){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.output,this.material.build(),this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=this.renderTarget.texture),this.needsUpdate=!1),r.setRenderer(this.renderer).setRenderTexture(this.renderTarget.texture),this.renderer.render(e,t,this.renderTarget),r.updateNode(this.material),this.renderer.render(this.scene,this.camera)},setSize:function(e,t){this.renderTarget.setSize(e,t),this.renderer.setSize(e,t)},copy:function(e){this.output=e.output},toJSON:function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.post&&(e.post={}),!e.post[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePostProcessing",e.post[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.output=this.output.toJSON(e).uuid}return e.post=this.uuid,e}},Gu.prototype=Object.create(ra.prototype),Gu.prototype.constructor=Gu,Gu.prototype.nodeType="Noise",Gu.Nodes={checker:new na(["float checker( vec2 uv ) {","\tfloat cx = floor( uv.x );","\tfloat cy = floor( uv.y ); ","\tfloat result = mod( cx + cy, 2.0 );","\treturn sign( result );","}"].join("\n"))},Gu.prototype.generate=function(e,t){var r=e.include(Gu.Nodes.checker);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},Gu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.uv=e.uv},Gu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},Wu.prototype=Object.create(ra.prototype),Wu.prototype.constructor=Wu,Wu.prototype.nodeType="Noise",Wu.Nodes={snoise:new na(["float snoise(vec2 co) {","\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}"].join("\n"))},Wu.prototype.generate=function(e,t){var r=e.include(Wu.Nodes.snoise);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},Wu.prototype.copy=function(e){ra.prototype.copy.call(this,e),this.uv=e.uv},Wu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},Hu.prototype=Object.create(ta.prototype),Hu.prototype.constructor=Hu,Hu.prototype.nodeType="Bypass",Hu.prototype.getType=function(e){return this.value?this.value.getType(e):e.isShader("fragment")?"f":"void"},Hu.prototype.generate=function(e,t){var r=this.code.build(e,t)+";";return e.addNodeCode(r),e.isShader("vertex")?this.value?this.value.build(e,t):void 0:this.value?this.value.build(e,t):e.format("0.0","f",t)},Hu.prototype.copy=function(e){ta.prototype.copy.call(this,e),this.code=e.code,this.value=e.value},Hu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).code=this.code.toJSON(e).uuid,this.value&&(t.value=this.value.toJSON(e).uuid)),t};var Xu=Dc.elements;function qu(e,t,r,n){ra.call(this,"f"),this.x=e,this.y=t,this.z=r,this.w=n}function Yu(e,t){uu.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=e||new sa,this.position=t||new gu}function Ju(e,t){zc.call(this),this.params={},this.velocity=new s,this.setTarget(e),this.setParams(t)}function Qu(e,t){this.min=void 0!==e?e:new x(1/0,1/0),this.max=void 0!==t?t:new x(-1/0,-1/0)}qu.prototype=Object.create(ra.prototype),qu.prototype.constructor=qu,qu.prototype.nodeType="Join",qu.prototype.getNumElements=function(){for(var e=Xu.length;e--;)if(void 0!==this[Xu[e]]){++e;break}return Math.max(e,2)},qu.prototype.getType=function(e){return e.getTypeFromLength(this.getNumElements())},qu.prototype.generate=function(e,t){for(var r=this.getType(e),n=this.getNumElements(),i=[],o=0;o<n;o++){var a=this[Xu[o]];i.push(a?a.build(e,"f"):"0.0")}var s=(n>1?e.getConstructorFromLength(n):"")+"( "+i.join(", ")+" )";return e.format(s,r,t)},qu.prototype.copy=function(e){for(var t in ra.prototype.copy.call(this,e),e.inputs)this[t]=e.inputs[t]},qu.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){(t=this.createJSONNode(e)).inputs={};for(var r=this.getNumElements(),n=0;n<r;n++){var i=this[Xu[n]];i&&(t.inputs[Xu[n]]=i.toJSON(e).uuid)}}return t},Yu.prototype=Object.create(uu.prototype),Yu.prototype.constructor=Yu,Yu.prototype.nodeType="UVTransform",Yu.prototype.generate=function(e,t){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,uu.prototype.generate.call(this,e,t)},Yu.prototype.setUvTransform=function(e,t,r,n,i,o,a){o=void 0!==o?o:.5,a=void 0!==a?a:.5,this.position.value.setUvTransform(e,t,r,n,i,o,a)},Yu.prototype.copy=function(e){uu.prototype.copy.call(this,e),this.uv=e.uv,this.position=e.position},Yu.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.position=this.position.toJSON(e).uuid),t},Ju.prototype=Object.create(zc.prototype),Ju.prototype.constructor=Ju,Ju.prototype.nodeType="Velocity",Ju.prototype.isReadonly=function(e){return!1},Ju.prototype.setParams=function(e){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=e||{},this.params.type){case"elastic":this.moment=new s,this.speed=new s,this.springVelocity=new s,this.lastVelocity=new s}},Ju.prototype.setTarget=function(e){this.target&&(delete this.position,delete this.oldPosition),this.target=e,e&&(this.position=e.getWorldPosition(this.position||new s),this.oldPosition=this.position.clone())},Ju.prototype.updateFrameVelocity=function(e){this.target&&(this.position=this.target.getWorldPosition(this.position||new s),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},Ju.prototype.updateFrame=function(e){switch(this.updateFrameVelocity(e),this.params.type){case"elastic":var t=e.delta*(this.params.fps||60),r=Math.pow(this.params.spring,t),n=Math.pow(this.params.damping,t);this.velocity.multiplyScalar(Math.exp(-this.params.damping*t)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(n).multiplyScalar(1-r)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(r),this.moment.add(this.springVelocity),this.moment.multiplyScalar(n),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},Ju.prototype.copy=function(e){zc.prototype.copy.call(this,e),e.target&&object.setTarget(e.target),object.setParams(e.params)},Ju.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.target&&(t.target=this.target.uuid),t.params=JSON.parse(JSON.stringify(this.params))),t},Object.assign(Qu.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new x;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("Box2: .getCenter() target is now required"),e=new x),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box2: .getSize() target is now required"),e=new x),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("Box2: .getParameter() target is now required"),t=new x),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("Box2: .clampPoint() target is now required"),t=new x),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new x;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Zu=function(){dr.call(this,Zu.Geometry,new cr({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var e=new s,t=new Vi(new Uint8Array(768),16,16,ft);t.minFilter=Ye,t.magFilter=Ye,t.wrapS=Xe,t.wrapT=Xe,t.needsUpdate=!0;var r=new Vi(new Uint8Array(768),16,16,ft);r.minFilter=Ye,r.magFilter=Ye,r.wrapS=Xe,r.wrapT=Xe,r.needsUpdate=!0;var n=Zu.Geometry,i=new wn({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),o=new wn({uniforms:{map:{value:t},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),a=new dr(n,i),c=[],u=Ku.Shader,l=new wn({uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new v(16777215)},scale:{value:new x},screenPosition:{value:new s}},vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:te,transparent:!0,depthWrite:!1}),h=new dr(n,l);this.addElement=function(e){c.push(e)};var d=new x,f=new x,p=new Qu,m=new S;this.onBeforeRender=function(s,u,v){m.copy(s.getCurrentViewport());var g=m.w/m.z,y=m.z/2,b=m.w/2,x=16/m.w;if(d.set(x*g,x),p.min.set(m.x,m.y),p.max.set(m.x+(m.z-16),m.y+(m.w-16)),e.setFromMatrixPosition(this.matrixWorld),e.applyMatrix4(v.matrixWorldInverse),e.applyMatrix4(v.projectionMatrix),f.x=m.x+e.x*y+y-8,f.y=m.y+e.y*b+b-8,p.containsPoint(f)){s.copyFramebufferToTexture(f,t),(T=i.uniforms).scale.value=d,T.screenPosition.value=e,s.renderBufferDirect(v,null,n,i,a,null),s.copyFramebufferToTexture(f,r),(T=o.uniforms).scale.value=d,T.screenPosition.value=e,s.renderBufferDirect(v,null,n,o,a,null);for(var w=2*-e.x,_=2*-e.y,S=0,M=c.length;S<M;S++){var T,A=c[S];(T=l.uniforms).color.value.copy(A.color),T.map.value=A.texture,T.screenPosition.value.x=e.x+w*A.distance,T.screenPosition.value.y=e.y+_*A.distance;x=A.size/m.w,g=m.w/m.z;T.scale.value.set(x*g,x),l.uniformsNeedUpdate=!0,s.renderBufferDirect(v,null,n,l,h,null)}}},this.dispose=function(){i.dispose(),o.dispose(),l.dispose(),t.dispose(),r.dispose();for(var e=0,n=c.length;e<n;e++)c[e].texture.dispose()}};Zu.prototype=Object.create(dr.prototype),Zu.prototype.constructor=Zu,Zu.prototype.isLensflare=!0;var Ku=function(e,t,r,n){this.texture=e,this.size=t||1,this.distance=r||0,this.color=n||new v(16777215)};Ku.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Zu.Geometry=function(){var e=new U,t=new Yi(new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),5);return e.setIndex([0,1,2,0,2,3]),e.addAttribute("position",new Qi(t,3,0,!1)),e.addAttribute("uv",new Qi(t,2,3,!1)),e}();var $u=function(e,t){dr.call(this,e),this.type="Reflector";var r=this,n=void 0!==(t=t||{}).color?new v(t.color):new v(8355711),i=t.textureWidth||512,c=t.textureHeight||512,u=t.clipBias||0,l=t.shader||$u.ReflectorShader,h=void 0!==t.recursion?t.recursion:0,d=new On,f=new s,p=new s,m=new s,g=new a,y=new s(0,0,-1),b=new S,x=new S,w=new s,_=new s,M=new S,T=new a,A=new Wr,E=new Kr(i,c,{minFilter:Ze,magFilter:Ze,format:ft,stencilBuffer:!1});o.isPowerOfTwo(i)&&o.isPowerOfTwo(c)||(E.texture.generateMipmaps=!1);var C=new Xr({uniforms:Hr.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});C.uniforms.tDiffuse.value=E.texture,C.uniforms.color.value=n,C.uniforms.textureMatrix.value=T,this.material=C,this.renderOrder=-1/0,this.onBeforeRender=function(e,t,n){if("recursion"in n.userData){if(n.userData.recursion===h)return;n.userData.recursion++}if(p.setFromMatrixPosition(r.matrixWorld),m.setFromMatrixPosition(n.matrixWorld),g.extractRotation(r.matrixWorld),f.set(0,0,1),f.applyMatrix4(g),w.subVectors(p,m),!(w.dot(f)>0)){w.reflect(f).negate(),w.add(p),g.extractRotation(n.matrixWorld),y.set(0,0,-1),y.applyMatrix4(g),y.add(m),_.subVectors(p,y),_.reflect(f).negate(),_.add(p),A.position.copy(w),A.up.set(0,1,0),A.up.applyMatrix4(g),A.up.reflect(f),A.lookAt(_),A.far=n.far,A.updateMatrixWorld(),A.projectionMatrix.copy(n.projectionMatrix),A.userData.recursion=0,T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(A.projectionMatrix),T.multiply(A.matrixWorldInverse),T.multiply(r.matrixWorld),d.setFromNormalAndCoplanarPoint(f,p),d.applyMatrix4(A.matrixWorldInverse),b.set(d.normal.x,d.normal.y,d.normal.z,d.constant);var i=A.projectionMatrix;M.x=(Math.sign(b.x)+i.elements[8])/i.elements[0],M.y=(Math.sign(b.y)+i.elements[9])/i.elements[5],M.z=-1,M.w=(1+i.elements[10])/i.elements[14],b.multiplyScalar(2/b.dot(M)),i.elements[2]=b.x,i.elements[6]=b.y,i.elements[10]=b.z+1-u,i.elements[14]=b.w,r.visible=!1;var o=e.getRenderTarget(),a=e.vr.enabled,s=e.shadowMap.autoUpdate;e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.render(t,A,E,!0),e.vr.enabled=a,e.shadowMap.autoUpdate=s,e.setRenderTarget(o);var c=n.bounds;if(void 0!==c){var l=e.getSize(),v=e.getPixelRatio();x.x=c.x*l.width*v,x.y=c.y*l.height*v,x.z=c.z*l.width*v,x.w=c.w*l.height*v,e.state.viewport(x)}r.visible=!0}},this.getRenderTarget=function(){return E}};$u.prototype=Object.create(dr.prototype),$u.prototype.constructor=$u,$u.ReflectorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var el=function(e,t){$u.call(this,e,t),this.geometry.setDrawRange(0,0)};el.prototype=Object.create($u.prototype);var tl=function(e,t){dr.call(this,e),this.type="Refractor";var r=this,n=void 0!==(t=t||{}).color?new v(t.color):new v(8355711),i=t.textureWidth||512,u=t.textureHeight||512,l=t.clipBias||0,h=t.shader||tl.RefractorShader,d=new Wr;d.matrixAutoUpdate=!1,d.userData.refractor=!0;var f=new On,p=new a,m=new Kr(i,u,{minFilter:Ze,magFilter:Ze,format:ft,stencilBuffer:!1});o.isPowerOfTwo(i)&&o.isPowerOfTwo(u)||(m.texture.generateMipmaps=!1),this.material=new Xr({uniforms:Hr.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,transparent:!0}),this.material.uniforms.color.value=n,this.material.uniforms.tDiffuse.value=m.texture,this.material.uniforms.textureMatrix.value=p;var g=function(){var e=new s,t=new s,n=new a,i=new s,o=new s;return function(a){return e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(a.matrixWorld),i.subVectors(e,t),n.extractRotation(r.matrixWorld),o.set(0,0,1),o.applyMatrix4(n),i.dot(o)<0}}(),y=function(){var e=new s,t=new s,n=new c,i=new s;return function(){r.matrixWorld.decompose(t,n,i),e.set(0,0,1).applyQuaternion(n).normalize(),e.negate(),f.setFromNormalAndCoplanarPoint(e,t)}}(),b=function(){var e=new On,t=new S,r=new S;return function(n){d.matrixWorld.copy(n.matrixWorld),d.matrixWorldInverse.getInverse(d.matrixWorld),d.projectionMatrix.copy(n.projectionMatrix),d.far=n.far,e.copy(f),e.applyMatrix4(d.matrixWorldInverse),t.set(e.normal.x,e.normal.y,e.normal.z,e.constant);var i=d.projectionMatrix;r.x=(Math.sign(t.x)+i.elements[8])/i.elements[0],r.y=(Math.sign(t.y)+i.elements[9])/i.elements[5],r.z=-1,r.w=(1+i.elements[10])/i.elements[14],t.multiplyScalar(2/t.dot(r)),i.elements[2]=t.x,i.elements[6]=t.y,i.elements[10]=t.z+1-l,i.elements[14]=t.w}}();var x=function(){var e=new S;return function(t,n,i){r.visible=!1;var o=t.getRenderTarget(),a=t.vr.enabled,s=t.shadowMap.autoUpdate;t.vr.enabled=!1,t.shadowMap.autoUpdate=!1,t.render(n,d,m,!0),t.vr.enabled=a,t.shadowMap.autoUpdate=s,t.setRenderTarget(o);var c=i.bounds;if(void 0!==c){var u=t.getSize(),l=t.getPixelRatio();e.x=c.x*u.width*l,e.y=c.y*u.height*l,e.z=c.z*u.width*l,e.w=c.w*u.height*l,t.state.viewport(e)}r.visible=!0}}();this.onBeforeRender=function(e,t,n){!0!==n.userData.refractor&&!0!=!g(n)&&(y(),function(e){p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(e.projectionMatrix),p.multiply(e.matrixWorldInverse),p.multiply(r.matrixWorld)}(n),b(n),x(e,t,n))},this.getRenderTarget=function(){return m}};tl.prototype=Object.create(dr.prototype),tl.prototype.constructor=tl,tl.RefractorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var rl=function(e){var t=new cr({color:0,transparent:!0,opacity:.6,depthWrite:!1});dr.call(this,e.geometry,t),this.meshMatrix=e.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1};(rl.prototype=Object.create(dr.prototype)).constructor=rl,rl.prototype.update=function(){var e=new a;return function(t,r){var n=t.normal.x*r.x+t.normal.y*r.y+t.normal.z*r.z+-t.constant*r.w,i=e.elements;i[0]=n-r.x*t.normal.x,i[4]=-r.x*t.normal.y,i[8]=-r.x*t.normal.z,i[12]=-r.x*-t.constant,i[1]=-r.y*t.normal.x,i[5]=n-r.y*t.normal.y,i[9]=-r.y*t.normal.z,i[13]=-r.y*-t.constant,i[2]=-r.z*t.normal.x,i[6]=-r.z*t.normal.y,i[10]=n-r.z*t.normal.z,i[14]=-r.z*-t.constant,i[3]=-r.w*t.normal.x,i[7]=-r.w*t.normal.y,i[11]=-r.w*t.normal.z,i[15]=n-r.w*-t.constant,this.matrix.multiplyMatrices(e,this.meshMatrix)}}();var nl=function(){var e=nl.SkyShader,t=new Xr({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:Hr.clone(e.uniforms),side:Y});dr.call(this,new Ur(1,1,1),t)};nl.prototype=Object.create(dr.prototype),nl.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new s}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};var il=function(e,t){dr.call(this,e);var r=this,n=void 0!==(t=t||{}).textureWidth?t.textureWidth:512,i=void 0!==t.textureHeight?t.textureHeight:512,c=void 0!==t.clipBias?t.clipBias:0,u=void 0!==t.alpha?t.alpha:1,l=void 0!==t.time?t.time:0,h=void 0!==t.waterNormals?t.waterNormals:null,d=void 0!==t.sunDirection?t.sunDirection:new s(.70707,.70707,0),f=new v(void 0!==t.sunColor?t.sunColor:16777215),p=new v(void 0!==t.waterColor?t.waterColor:8355711),m=void 0!==t.eye?t.eye:new s(0,0,0),g=void 0!==t.distortionScale?t.distortionScale:20,y=void 0!==t.side?t.side:q,b=void 0!==t.fog&&t.fog,x=new On,w=new s,_=new s,M=new s,T=new a,A=new s(0,0,-1),E=new S,C=new s,L=new s,P=new S,O=new a,N=new Wr,R=new Kr(n,i,{minFilter:Ze,magFilter:Ze,format:ft,stencilBuffer:!1});o.isPowerOfTwo(n)&&o.isPowerOfTwo(i)||(R.texture.generateMipmaps=!1);var I={uniforms:Hr.merge([Ci.fog,Ci.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new a},sunColor:{value:new v(8355711)},sunDirection:{value:new s(.70707,.70707,0)},eye:{value:new s},waterColor:{value:new v(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",Ei.fog_pars_vertex,Ei.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",Ei.fog_vertex,Ei.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",Ei.common,Ei.packing,Ei.bsdfs,Ei.fog_pars_fragment,Ei.lights_pars_begin,Ei.shadowmap_pars_fragment,Ei.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.z + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",Ei.tonemapping_fragment,Ei.fog_fragment,"}"].join("\n")},D=new Xr({fragmentShader:I.fragmentShader,vertexShader:I.vertexShader,uniforms:Hr.clone(I.uniforms),transparent:!0,lights:!0,side:y,fog:b});D.uniforms.mirrorSampler.value=R.texture,D.uniforms.textureMatrix.value=O,D.uniforms.alpha.value=u,D.uniforms.time.value=l,D.uniforms.normalSampler.value=h,D.uniforms.sunColor.value=f,D.uniforms.waterColor.value=p,D.uniforms.sunDirection.value=d,D.uniforms.distortionScale.value=g,D.uniforms.eye.value=m,r.material=D,r.onBeforeRender=function(e,t,n){if(_.setFromMatrixPosition(r.matrixWorld),M.setFromMatrixPosition(n.matrixWorld),T.extractRotation(r.matrixWorld),w.set(0,0,1),w.applyMatrix4(T),C.subVectors(_,M),!(C.dot(w)>0)){C.reflect(w).negate(),C.add(_),T.extractRotation(n.matrixWorld),A.set(0,0,-1),A.applyMatrix4(T),A.add(M),L.subVectors(_,A),L.reflect(w).negate(),L.add(_),N.position.copy(C),N.up.set(0,1,0),N.up.applyMatrix4(T),N.up.reflect(w),N.lookAt(L),N.far=n.far,N.updateMatrixWorld(),N.projectionMatrix.copy(n.projectionMatrix),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(N.projectionMatrix),O.multiply(N.matrixWorldInverse),x.setFromNormalAndCoplanarPoint(w,_),x.applyMatrix4(N.matrixWorldInverse),E.set(x.normal.x,x.normal.y,x.normal.z,x.constant);var i=N.projectionMatrix;P.x=(Math.sign(E.x)+i.elements[8])/i.elements[0],P.y=(Math.sign(E.y)+i.elements[9])/i.elements[5],P.z=-1,P.w=(1+i.elements[10])/i.elements[14],E.multiplyScalar(2/E.dot(P)),i.elements[2]=E.x,i.elements[6]=E.y,i.elements[10]=E.z+1-c,i.elements[14]=E.w,m.setFromMatrixPosition(n.matrixWorld);var o=e.getRenderTarget(),a=e.vr.enabled,s=e.shadowMap.autoUpdate;r.visible=!1,e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.render(t,N,R,!0),r.visible=!0,e.vr.enabled=a,e.shadowMap.autoUpdate=s,e.setRenderTarget(o)}}};function ol(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function al(e,t){dr.call(this,e),this.type="Water2";var r=this,n=void 0!==(t=t||{}).color?new v(t.color):new v(16777215),i=t.textureWidth||512,o=t.textureHeight||512,s=t.clipBias||0,c=t.flowDirection||new x(1,0),u=t.flowSpeed||.03,l=t.reflectivity||.02,h=t.scale||1,d=t.shader||al.Water2Shader,f=new An,p=t.flowMap||void 0,m=t.normalMap0||f.load("textures/water/Water2_1_M_Normal.jpg"),g=t.normalMap1||f.load("textures/water/Water2_2_M_Normal.jpg"),y=.15,b=.5*y,w=new a,_=new ol;if(void 0!==$u)if(void 0!==tl){var S=new $u(e,{textureWidth:i,textureHeight:o,clipBias:s}),M=new tl(e,{textureWidth:i,textureHeight:o,clipBias:s});S.matrixAutoUpdate=!1,M.matrixAutoUpdate=!1,this.material=new Xr({uniforms:Hr.merge([Ci.fog,d.uniforms]),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,transparent:!0,fog:!0}),void 0!==p?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:p}):this.material.uniforms.flowDirection={type:"v2",value:c},m.wrapS=m.wrapT=He,g.wrapS=g.wrapT=He,this.material.uniforms.tReflectionMap.value=S.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=M.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=m,this.material.uniforms.tNormalMap1.value=g,this.material.uniforms.color.value=n,this.material.uniforms.reflectivity.value=l,this.material.uniforms.textureMatrix.value=w,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=b,this.material.uniforms.config.value.z=b,this.material.uniforms.config.value.w=h,this.onBeforeRender=function(e,t,n){!function(e){w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(e.projectionMatrix),w.multiply(e.matrixWorldInverse),w.multiply(r.matrixWorld)}(n),function(){var e=_.getDelta(),t=r.material.uniforms.config;t.value.x+=u*e,t.value.y=t.value.x+b,t.value.x>=y?(t.value.x=0,t.value.y=b):t.value.y>=y&&(t.value.y=t.value.y-y)}(),r.visible=!1,S.matrixWorld.copy(r.matrixWorld),M.matrixWorld.copy(r.matrixWorld),S.onBeforeRender(e,t,n),M.onBeforeRender(e,t,n),r.visible=!0}}else console.error("Water2: Required component Refractor not found.");else console.error("Water2: Required component Reflector not found.")}(il.prototype=Object.create(dr.prototype)).constructor=il,Object.assign(ol.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),al.prototype=Object.create(dr.prototype),al.prototype.constructor=al,al.Water2Shader={uniforms:{color:{type:"c",value:null},reflectivity:{type:"f",value:0},tReflectionMap:{type:"t",value:null},tRefractionMap:{type:"t",value:null},tNormalMap0:{type:"t",value:null},tNormalMap1:{type:"t",value:null},textureMatrix:{type:"m4",value:null},config:{type:"v4",value:new S}},vertexShader:["#include <fog_pars_vertex>","uniform mat4 textureMatrix;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tvUv = uv;","\tvCoord = textureMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvToEye = cameraPosition - worldPosition.xyz;","\tvec4 mvPosition =  viewMatrix * worldPosition;","\tgl_Position = projectionMatrix * mvPosition;","\t#include <fog_vertex>","}"].join("\n"),fragmentShader:["#include <common>","#include <fog_pars_fragment>","uniform sampler2D tReflectionMap;","uniform sampler2D tRefractionMap;","uniform sampler2D tNormalMap0;","uniform sampler2D tNormalMap1;","#ifdef USE_FLOWMAP","\tuniform sampler2D tFlowMap;","#else","\tuniform vec2 flowDirection;","#endif","uniform vec3 color;","uniform float reflectivity;","uniform vec4 config;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tfloat flowMapOffset0 = config.x;","\tfloat flowMapOffset1 = config.y;","\tfloat halfCycle = config.z;","\tfloat scale = config.w;","\tvec3 toEye = normalize( vToEye );","\tvec2 flow;","\t#ifdef USE_FLOWMAP","\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;","\t#else","\t\tflow = flowDirection;","\t#endif","\tflow.x *= - 1.0;","\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );","\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );","\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;","\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );","\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );","\tfloat theta = max( dot( toEye, normal ), 0.0 );","\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 coord = vCoord.xyz / vCoord.w;","\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;","\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );","\tvec4 refractColor = texture2D( tRefractionMap, uv );","\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","}"].join("\n")};var sl=function(e,t,r,n){function i(e,t){return void 0!==e?e:t}this.changed=!0,this.initial=!0,this.oceanCamera=new Yr,this.oceanCamera.position.z=1,this.renderer=e,this.renderer.clearColor(16777215),this.scene=new qr,n=n||{},this.clearColor=i(n.CLEAR_COLOR,[1,1,1,0]),this.geometryOrigin=i(n.GEOMETRY_ORIGIN,[-1e3,-1e3]),this.sunDirectionX=i(n.SUN_DIRECTION[0],-1),this.sunDirectionY=i(n.SUN_DIRECTION[1],1),this.sunDirectionZ=i(n.SUN_DIRECTION[2],1),this.oceanColor=i(n.OCEAN_COLOR,new s(.004,.016,.047)),this.skyColor=i(n.SKY_COLOR,new s(3.2,9.6,12.8)),this.exposure=i(n.EXPOSURE,.35),this.geometryResolution=i(n.GEOMETRY_RESOLUTION,32),this.geometrySize=i(n.GEOMETRY_SIZE,2e3),this.resolution=i(n.RESOLUTION,64),this.floatSize=i(n.SIZE_OF_FLOAT,4),this.windX=i(n.INITIAL_WIND[0],10),this.windY=i(n.INITIAL_WIND[1],10),this.size=i(n.INITIAL_SIZE,250),this.choppiness=i(n.INITIAL_CHOPPINESS,1.5),this.matrixNeedsUpdate=!1;var o=i(n.USE_HALF_FLOAT,!1)?st:at,a={minFilter:Ze,magFilter:Ze,wrapS:Xe,wrapT:Xe,format:pt,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o},c={minFilter:Ye,magFilter:Ye,wrapS:Xe,wrapT:Xe,format:pt,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o},u={minFilter:Ye,magFilter:Ye,wrapS:He,wrapT:He,format:pt,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:o};this.initialSpectrumFramebuffer=new Kr(this.resolution,this.resolution,u),this.spectrumFramebuffer=new Kr(this.resolution,this.resolution,c),this.pingPhaseFramebuffer=new Kr(this.resolution,this.resolution,c),this.pongPhaseFramebuffer=new Kr(this.resolution,this.resolution,c),this.pingTransformFramebuffer=new Kr(this.resolution,this.resolution,c),this.pongTransformFramebuffer=new Kr(this.resolution,this.resolution,c),this.displacementMapFramebuffer=new Kr(this.resolution,this.resolution,a),this.normalMapFramebuffer=new Kr(this.resolution,this.resolution,a);var l=Li.ocean_sim_vertex,h=Li.ocean_subtransform,d=Hr.clone(h.uniforms);this.materialOceanHorizontal=new Xr({uniforms:d,vertexShader:l.vertexShader,fragmentShader:"#define HORIZONTAL \n"+h.fragmentShader}),this.materialOceanHorizontal.uniforms.u_transformSize={value:this.resolution},this.materialOceanHorizontal.uniforms.u_subtransformSize={value:null},this.materialOceanHorizontal.uniforms.u_input={value:null},this.materialOceanHorizontal.depthTest=!1;var f=Li.ocean_subtransform,p=Hr.clone(f.uniforms);this.materialOceanVertical=new Xr({uniforms:p,vertexShader:l.vertexShader,fragmentShader:f.fragmentShader}),this.materialOceanVertical.uniforms.u_transformSize={value:this.resolution},this.materialOceanVertical.uniforms.u_subtransformSize={value:null},this.materialOceanVertical.uniforms.u_input={value:null},this.materialOceanVertical.depthTest=!1;var m=Li.ocean_initial_spectrum,v=Hr.clone(m.uniforms);this.materialInitialSpectrum=new Xr({uniforms:v,vertexShader:l.vertexShader,fragmentShader:m.fragmentShader}),this.materialInitialSpectrum.uniforms.u_wind={value:new x},this.materialInitialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialInitialSpectrum.depthTest=!1;var g=Li.ocean_phase,y=Hr.clone(g.uniforms);this.materialPhase=new Xr({uniforms:y,vertexShader:l.vertexShader,fragmentShader:g.fragmentShader}),this.materialPhase.uniforms.u_resolution={value:this.resolution},this.materialPhase.depthTest=!1;var b=Li.ocean_spectrum,w=Hr.clone(b.uniforms);this.materialSpectrum=new Xr({uniforms:w,vertexShader:l.vertexShader,fragmentShader:b.fragmentShader}),this.materialSpectrum.uniforms.u_initialSpectrum={value:null},this.materialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialSpectrum.depthTest=!1;var _=Li.ocean_normals,S=Hr.clone(_.uniforms);this.materialNormal=new Xr({uniforms:S,vertexShader:l.vertexShader,fragmentShader:_.fragmentShader}),this.materialNormal.uniforms.u_displacementMap={value:null},this.materialNormal.uniforms.u_resolution={value:this.resolution},this.materialNormal.depthTest=!1;var M=Li.ocean_main,T=Hr.clone(M.uniforms);this.materialOcean=new Xr({uniforms:T,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader}),this.materialOcean.uniforms.u_geometrySize={value:this.resolution},this.materialOcean.uniforms.u_displacementMap={value:this.displacementMapFramebuffer.texture},this.materialOcean.uniforms.u_normalMap={value:this.normalMapFramebuffer.texture},this.materialOcean.uniforms.u_oceanColor={value:this.oceanColor},this.materialOcean.uniforms.u_skyColor={value:this.skyColor},this.materialOcean.uniforms.u_sunDirection={value:new s(this.sunDirectionX,this.sunDirectionY,this.sunDirectionZ)},this.materialOcean.uniforms.u_exposure={value:this.exposure},this.materialOceanHorizontal.blending=0,this.materialOceanVertical.blending=0,this.materialInitialSpectrum.blending=0,this.materialPhase.blending=0,this.materialSpectrum.blending=0,this.materialNormal.blending=0,this.materialOcean.blending=0,this.screenQuad=new dr(new en(2,2)),this.scene.add(this.screenQuad),this.generateSeedPhaseTexture(),this.generateMesh()};function cl(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new U;i.setIndex(new M(r,1)),i.addAttribute("position",new M(n,3)),Eo.call(this,i,new ur({color:t})),this.matrixAutoUpdate=!1,this.update()}function ul(e){return!isNaN(e)&&isFinite(e)}function ll(e){return e?!0!==function(e){return"[object Array]"===Object.prototype.toString.call(e)}(e)?[e]:e:[]}function hl(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}sl.prototype.generateMesh=function(){var e=new en(this.geometrySize,this.geometrySize,this.geometryResolution,this.geometryResolution);e.rotateX(-Math.PI/2),this.oceanMesh=new dr(e,this.materialOcean)},sl.prototype.render=function(){this.scene.overrideMaterial=null,this.changed&&this.renderInitialSpectrum(),this.renderWavePhase(),this.renderSpectrum(),this.renderSpectrumFFT(),this.renderNormalMap(),this.scene.overrideMaterial=null},sl.prototype.generateSeedPhaseTexture=function(){this.pingPhase=!0;for(var e=new i.Float32Array(this.resolution*this.resolution*4),t=0;t<this.resolution;t++)for(var r=0;r<this.resolution;r++)e[t*this.resolution*4+4*r]=2*Math.random()*Math.PI,e[t*this.resolution*4+4*r+1]=0,e[t*this.resolution*4+4*r+2]=0,e[t*this.resolution*4+4*r+3]=0;this.pingPhaseTexture=new Vi(e,this.resolution,this.resolution,pt),this.pingPhaseTexture.wrapS=Xe,this.pingPhaseTexture.wrapT=Xe,this.pingPhaseTexture.type=at,this.pingPhaseTexture.needsUpdate=!0},sl.prototype.renderInitialSpectrum=function(){this.scene.overrideMaterial=this.materialInitialSpectrum,this.materialInitialSpectrum.uniforms.u_wind.value.set(this.windX,this.windY),this.materialInitialSpectrum.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.initialSpectrumFramebuffer,!0)},sl.prototype.renderWavePhase=function(){this.scene.overrideMaterial=this.materialPhase,this.screenQuad.material=this.materialPhase,this.initial?(this.materialPhase.uniforms.u_phases.value=this.pingPhaseTexture,this.initial=!1):this.materialPhase.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialPhase.uniforms.u_deltaTime.value=this.deltaTime,this.materialPhase.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.pingPhase?this.pongPhaseFramebuffer:this.pingPhaseFramebuffer),this.pingPhase=!this.pingPhase},sl.prototype.renderSpectrum=function(){this.scene.overrideMaterial=this.materialSpectrum,this.materialSpectrum.uniforms.u_initialSpectrum.value=this.initialSpectrumFramebuffer.texture,this.materialSpectrum.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialSpectrum.uniforms.u_choppiness.value=this.choppiness,this.materialSpectrum.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.spectrumFramebuffer)},sl.prototype.renderSpectrumFFT=function(){var e=Math.log(this.resolution)/Math.log(2);this.scene.overrideMaterial=this.materialOceanHorizontal;for(var t=0;t<e;t++)0===t?(this.materialOceanHorizontal.uniforms.u_input.value=this.spectrumFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer)):t%2==1?(this.materialOceanHorizontal.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.pongTransformFramebuffer)):(this.materialOceanHorizontal.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer));this.scene.overrideMaterial=this.materialOceanVertical;for(t=e;t<2*e;t++)t===2*e-1?(this.materialOceanVertical.uniforms.u_input.value=e%2==0?this.pingTransformFramebuffer.texture:this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.displacementMapFramebuffer)):t%2==1?(this.materialOceanVertical.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.pongTransformFramebuffer)):(this.materialOceanVertical.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,t%e+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer))},sl.prototype.renderNormalMap=function(){this.scene.overrideMaterial=this.materialNormal,this.changed&&(this.materialNormal.uniforms.u_size.value=this.size),this.materialNormal.uniforms.u_displacementMap.value=this.displacementMapFramebuffer.texture,this.renderer.render(this.scene,this.oceanCamera,this.normalMapFramebuffer,!0)},cl.prototype=Object.create(Eo.prototype),cl.prototype.constructor=cl,cl.prototype.update=function(){var e=new y;return function(t){if(void 0!==t&&console.warn("BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),cl.prototype.setFromObject=function(e){return this.object=e,this.update(),this};var dl=function(e){if((e=e||{}).tree=this,this.nodeCount=0,this.INDEX_INSIDE_CROSS=-1,this.INDEX_OUTSIDE_OFFSET=2,this.INDEX_OUTSIDE_POS_X=ul(e.INDEX_OUTSIDE_POS_X)?e.INDEX_OUTSIDE_POS_X:0,this.INDEX_OUTSIDE_NEG_X=ul(e.INDEX_OUTSIDE_NEG_X)?e.INDEX_OUTSIDE_NEG_X:1,this.INDEX_OUTSIDE_POS_Y=ul(e.INDEX_OUTSIDE_POS_Y)?e.INDEX_OUTSIDE_POS_Y:2,this.INDEX_OUTSIDE_NEG_Y=ul(e.INDEX_OUTSIDE_NEG_Y)?e.INDEX_OUTSIDE_NEG_Y:3,this.INDEX_OUTSIDE_POS_Z=ul(e.INDEX_OUTSIDE_POS_Z)?e.INDEX_OUTSIDE_POS_Z:4,this.INDEX_OUTSIDE_NEG_Z=ul(e.INDEX_OUTSIDE_NEG_Z)?e.INDEX_OUTSIDE_NEG_Z:5,this.INDEX_OUTSIDE_MAP=[],this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X]={index:this.INDEX_OUTSIDE_POS_X,count:0,x:1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X]={index:this.INDEX_OUTSIDE_NEG_X,count:0,x:-1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y]={index:this.INDEX_OUTSIDE_POS_Y,count:0,x:0,y:1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y]={index:this.INDEX_OUTSIDE_NEG_Y,count:0,x:0,y:-1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z]={index:this.INDEX_OUTSIDE_POS_Z,count:0,x:0,y:0,z:1},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z]={index:this.INDEX_OUTSIDE_NEG_Z,count:0,x:0,y:0,z:-1},this.FLAG_POS_X=1<<this.INDEX_OUTSIDE_POS_X+1,this.FLAG_NEG_X=1<<this.INDEX_OUTSIDE_NEG_X+1,this.FLAG_POS_Y=1<<this.INDEX_OUTSIDE_POS_Y+1,this.FLAG_NEG_Y=1<<this.INDEX_OUTSIDE_NEG_Y+1,this.FLAG_POS_Z=1<<this.INDEX_OUTSIDE_POS_Z+1,this.FLAG_NEG_Z=1<<this.INDEX_OUTSIDE_NEG_Z+1,this.utilVec31Search=new s,this.utilVec32Search=new s,this.scene=e.scene,this.scene){var t=new cl(new dr(new Ur(1,1,1)),16711782);this.visualGeometry=t.geometry,this.visualMaterial=t.material}this.objects=[],this.objectsMap={},this.objectsData=[],this.objectsDeferred=[],this.depthMax=ul(e.depthMax)?e.depthMax:1/0,this.objectsThreshold=ul(e.objectsThreshold)?e.objectsThreshold:8,this.overlapPct=ul(e.overlapPct)?e.overlapPct:.15,this.undeferred=e.undeferred||!1,this.root=e.root instanceof pl?e.root:new pl(e)};dl.prototype={update:function(){if(this.objectsDeferred.length>0){for(var e=0,t=this.objectsDeferred.length;e<t;e++){var r=this.objectsDeferred[e];this.addDeferred(r.object,r.options)}this.objectsDeferred.length=0}},add:function(e,t){this.undeferred?(this.updateObject(e),this.addDeferred(e,t)):this.objectsDeferred.push({object:e,options:t})},addDeferred:function(e,t){var r,n,i,a,s,c;if(e instanceof fl&&(e=e.object),e.uuid||(e.uuid=o.generateUUID()),!this.objectsMap[e.uuid])if(this.objects.push(e),this.objectsMap[e.uuid]=e,t&&(a=t.useFaces,c=t.useVertices),!0===c)for(r=0,n=(s=e.geometry.vertices).length;r<n;r++)this.addObjectData(e,s[r]);else if(!0===a)for(r=0,n=(i=e.geometry.faces).length;r<n;r++)this.addObjectData(e,i[r]);else this.addObjectData(e)},addObjectData:function(e,t){var r=new fl(e,t);this.objectsData.push(r),this.root.addObject(r)},remove:function(e){var t,r,n,i,o=e;if(e instanceof fl&&(e=e.object),this.objectsMap[e.uuid]){if(this.objectsMap[e.uuid]=void 0,-1!==(n=hl(this.objects,e)))for(this.objects.splice(n,1),t=0,r=(i=this.root.removeObject(o)).length;t<r;t++)o=i[t],-1!==(n=hl(this.objectsData,o))&&this.objectsData.splice(n,1)}else this.objectsDeferred.length>0&&-1!==(n=function(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n][t]===r)return n;return-1}(this.objectsDeferred,"object",e))&&this.objectsDeferred.splice(n,1)},extend:function(e){var t,r,n,i;if(e instanceof dl)for(t=0,r=(n=e.objectsData).length;t<r;t++)i=n[t],this.add(i,{useFaces:i.faces,useVertices:i.vertices})},rebuild:function(){var e,t,r,n,i,o=[];for(e=0,t=this.objectsData.length;e<t;e++)r=(n=this.objectsData[e]).node,n.update(),r instanceof pl&&!n.positionLast.equals(n.position)&&(i=n.indexOctant,r.getOctantIndex(n)!==i&&o.push(n));for(e=0,t=o.length;e<t;e++)(n=o[e]).node.removeObject(n),this.root.addObject(n)},updateObject:function(e){var t,r,n,i,o=[e];for(n=e.parent;n;)o.push(n),n=n.parent;for(t=0,r=o.length;t<r;t++)!0===(n=o[t]).matrixWorldNeedsUpdate&&(i=n);void 0!==i&&i.updateMatrixWorld()},search:function(e,t,r,n){var i,o,a,c,u,l,h,d,f,p;for(a=[].concat(this.root.objects),t>0||(t=Number.MAX_VALUE),n instanceof s&&(n=this.utilVec31Search.copy(n).normalize(),p=this.utilVec32Search.set(1,1,1).divide(n)),i=0,o=this.root.nodesIndices.length;i<o;i++)a=this.root.nodesByIndex[this.root.nodesIndices[i]].search(e,t,a,n,p);if(!0===r)for(l=[],d=[],i=0,o=a.length;i<o;i++)-1===(f=hl(d,u=(c=a[i]).object))?(h={object:u,faces:[],vertices:[]},l.push(h),d.push(u)):h=l[f],c.faces?h.faces.push(c.faces):c.vertices&&h.vertices.push(c.vertices);else l=a;return l},setRoot:function(e){e instanceof pl&&(this.root=e,this.root.updateProperties())},getDepthEnd:function(){return this.root.getDepthEnd()},getNodeCountEnd:function(){return this.root.getNodeCountEnd()},getObjectCountEnd:function(){return this.root.getObjectCountEnd()},toConsole:function(){this.root.toConsole()}};var fl=function(e,t){this.object=e,t instanceof g?(this.faces=t,this.face3=!0,this.utilVec31FaceBounds=new s):t instanceof s&&(this.vertices=t),this.radius=0,this.position=new s,this.object instanceof p&&this.update(),this.positionLast=this.position.clone()};fl.prototype={update:function(){this.face3?(this.radius=this.getFace3BoundingRadius(this.object,this.faces),this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)):this.vertices?(this.radius=this.object.material.size||1,this.position.copy(this.vertices).applyMatrix4(this.object.matrixWorld)):this.object.geometry?(null===this.object.geometry.boundingSphere&&this.object.geometry.computeBoundingSphere(),this.radius=this.object.geometry.boundingSphere.radius,this.position.copy(this.object.geometry.boundingSphere.center).applyMatrix4(this.object.matrixWorld)):(this.radius=this.object.boundRadius,this.position.setFromMatrixPosition(this.object.matrixWorld)),this.radius=this.radius*Math.max(this.object.scale.x,this.object.scale.y,this.object.scale.z)},getFace3BoundingRadius:function(e,t){void 0===t.centroid&&(t.centroid=new s);var r=(e.geometry||e).vertices,n=t.centroid,i=r[t.a],o=r[t.b],a=r[t.c],c=this.utilVec31FaceBounds;return n.addVectors(i,o).add(a).divideScalar(3),Math.max(c.subVectors(n,i).length(),c.subVectors(n,o).length(),c.subVectors(n,a).length())}};var pl=function(e){this.utilVec31Branch=new s,this.utilVec31Expand=new s,this.utilVec31Ray=new s,(e=e||{}).tree instanceof dl?this.tree=e.tree:e.parent instanceof pl!=!0&&(e.root=this,this.tree=new dl(e)),this.id=this.tree.nodeCount++,this.position=e.position instanceof s?e.position:new s,this.radius=e.radius>0?e.radius:1,this.indexOctant=e.indexOctant,this.depth=0,this.reset(),this.setParent(e.parent),this.overlap=this.radius*this.tree.overlapPct,this.radiusOverlap=this.radius+this.overlap,this.left=this.position.x-this.radiusOverlap,this.right=this.position.x+this.radiusOverlap,this.bottom=this.position.y-this.radiusOverlap,this.top=this.position.y+this.radiusOverlap,this.back=this.position.z-this.radiusOverlap,this.front=this.position.z+this.radiusOverlap,this.tree.scene&&(this.visual=new Eo(this.tree.visualGeometry,this.tree.visualMaterial),this.visual.scale.set(2*this.radiusOverlap,2*this.radiusOverlap,2*this.radiusOverlap),this.visual.position.copy(this.position),this.tree.scene.add(this.visual))};pl.prototype={setParent:function(e){e!==this&&this.parent!==e&&(this.parent=e,this.updateProperties())},updateProperties:function(){var e,t;for(this.parent instanceof pl?(this.tree=this.parent.tree,this.depth=this.parent.depth+1):this.depth=0,e=0,t=this.nodesIndices.length;e<t;e++)this.nodesByIndex[this.nodesIndices[e]].updateProperties()},reset:function(e,t){var r,n,i,o=this.nodesIndices||[],a=this.nodesByIndex;for(this.objects=[],this.nodesIndices=[],this.nodesByIndex={},r=0,n=o.length;r<n;r++)(i=a[o[r]]).setParent(void 0),!0===e&&i.reset(e,t);!0===t&&this.visual&&this.visual.parent&&this.visual.parent.remove(this.visual)},addNode:function(e,t){e.indexOctant=t,-1===hl(this.nodesIndices,t)&&this.nodesIndices.push(t),this.nodesByIndex[t]=e,e.parent!==this&&e.setParent(this)},removeNode:function(e){var t,r;t=hl(this.nodesIndices,e),this.nodesIndices.splice(t,1),r=r||this.nodesByIndex[e],delete this.nodesByIndex[e],r.parent===this&&r.setParent(void 0)},addObject:function(e){var t;(t=this.getOctantIndex(e))>-1&&this.nodesIndices.length>0?this.branch(t).addObject(e):t<-1&&this.parent instanceof pl?this.parent.addObject(e):(-1===hl(this.objects,e)&&this.objects.push(e),e.node=this,this.checkGrow())},addObjectWithoutCheck:function(e){var t,r,n;for(t=0,r=e.length;t<r;t++)n=e[t],this.objects.push(n),n.node=this},removeObject:function(e){var t,r,n,i;if((n=(i=this.removeObjectRecursive(e,{searchComplete:!1,nodesRemovedFrom:[],objectsDataRemoved:[]})).nodesRemovedFrom).length>0)for(t=0,r=n.length;t<r;t++)n[t].shrink();return i.objectsDataRemoved},removeObjectRecursive:function(e,t){var r,n,i,o,a=-1;if(e instanceof fl)-1!==(a=hl(this.objects,e))&&(this.objects.splice(a,1),e.node=void 0,t.objectsDataRemoved.push(e),t.searchComplete=o=!0);else for(r=this.objects.length-1;r>=0;r--)if((i=this.objects[r]).object===e&&(this.objects.splice(r,1),i.node=void 0,t.objectsDataRemoved.push(i),o=!0,!i.faces&&!i.vertices)){t.searchComplete=!0;break}if(!0===o&&t.nodesRemovedFrom.push(this),!0!==t.searchComplete)for(r=0,n=this.nodesIndices.length;r<n&&!0!==(t=this.nodesByIndex[this.nodesIndices[r]].removeObjectRecursive(e,t)).searchComplete;r++);return t},checkGrow:function(){this.objects.length>this.tree.objectsThreshold&&this.tree.objectsThreshold>0&&this.grow()},grow:function(){var e,t,r,n,i=[],o=[],a=[],s=[],c=[];for(r=0,n=this.objects.length;r<n;r++)t=this.objects[r],(e=this.getOctantIndex(t))>-1?(a.push(t),s.push(e)):e<-1?(i.push(t),o.push(e)):c.push(t);a.length>0&&(c=c.concat(this.split(a,s))),i.length>0&&(c=c.concat(this.expand(i,o))),this.objects=c,this.checkMerge()},split:function(e,t){var r,n,i,o,a;if(this.depth<this.tree.depthMax){for(e=e||this.objects,t=t||[],a=[],r=0,n=e.length;r<n;r++)o=e[r],(i=t[r])>-1?this.branch(i).addObject(o):a.push(o);e===this.objects&&(this.objects=a)}else a=this.objects;return a},branch:function(e){var t,r,n,i,o;return this.nodesByIndex[e]instanceof pl?t=this.nodesByIndex[e]:(n=(r=.5*this.radiusOverlap)-r*this.tree.overlapPct,i=this.utilVec31Branch.set(1&e?n:-n,2&e?n:-n,4&e?n:-n),o=(new s).addVectors(this.position,i),t=new pl({tree:this.tree,parent:this,position:o,radius:r,indexOctant:e}),this.addNode(t,e)),t},expand:function(e,t){var r,n,i,o,a,c,u,l,h,d,f,p,m,v,g,y,b,x,w,_,S,M,T,A,E,C,L,P,O=this.tree.INDEX_OUTSIDE_MAP,N=this.utilVec31Expand;if(this.tree.root.getDepthEnd()<this.tree.depthMax){for(e=e||this.objects,t=t||[],o=[],a=[],r=0,n=O.length;r<n;r++)O[r].count=0;for(r=0,n=e.length;r<n;r++)i=e[r],(c=t[r])<-1?((u=-c-this.tree.INDEX_OUTSIDE_OFFSET)&this.tree.FLAG_POS_X?O[this.tree.INDEX_OUTSIDE_POS_X].count++:u&this.tree.FLAG_NEG_X&&O[this.tree.INDEX_OUTSIDE_NEG_X].count++,u&this.tree.FLAG_POS_Y?O[this.tree.INDEX_OUTSIDE_POS_Y].count++:u&this.tree.FLAG_NEG_Y&&O[this.tree.INDEX_OUTSIDE_NEG_Y].count++,u&this.tree.FLAG_POS_Z?O[this.tree.INDEX_OUTSIDE_POS_Z].count++:u&this.tree.FLAG_NEG_Z&&O[this.tree.INDEX_OUTSIDE_NEG_Z].count++,a.push(i)):o.push(i);if(a.length>0)for((h=O.slice(0)).sort(function(e,t){return t.count-e.count}),m=1|(d=h[0]).index,g=h[1],y=h[2],v=1|(f=(1|g.index)!==m?g:y).index,g=h[2],y=h[3],b=h[4],x=1|g.index,w=1|y.index,p=x!==m&&x!==v?g:w!==m&&w!==v?y:b,_=d.x+f.x+p.x,S=d.y+f.y+p.y,M=d.z+f.z+p.z,c=this.getOctantIndexFromPosition(_,S,M),l=this.getOctantIndexFromPosition(-_,-S,-M),T=this.overlap,A=this.radius,E=(C=this.tree.overlapPct>0?T/(.5*this.tree.overlapPct*(1+this.tree.overlapPct)):2*A)+C*this.tree.overlapPct-(A+T),N.set(1&c?E:-E,2&c?E:-E,4&c?E:-E),L=(new s).addVectors(this.position,N),(P=new pl({tree:this.tree,position:L,radius:C})).addNode(this,l),this.tree.setRoot(P),r=0,n=a.length;r<n;r++)this.tree.root.addObject(a[r]);e===this.objects&&(this.objects=o)}else o=e;return o},shrink:function(){this.checkMerge(),this.tree.root.checkContract()},checkMerge:function(){for(var e,t=this;t.parent instanceof pl&&t.getObjectCountEnd()<this.tree.objectsThreshold;)e=t,t=t.parent;t!==this&&t.merge(e)},merge:function(e){var t,r,n;for(t=0,r=(e=ll(e)).length;t<r;t++)n=e[t],this.addObjectWithoutCheck(n.getObjectsEnd()),n.reset(!0,!0),this.removeNode(n.indexOctant,n);this.checkMerge()},checkContract:function(){var e,t,r,n,i,o,a;if(this.nodesIndices.length>0){for(o=0,a=this.objects.length,e=0,t=this.nodesIndices.length;e<t;e++)a+=n=(r=this.nodesByIndex[this.nodesIndices[e]]).getObjectCountEnd(),(i instanceof pl==!1||n>o)&&(i=r,o=n);(a-=o)<this.tree.objectsThreshold&&i instanceof pl&&this.contract(i)}},contract:function(e){var t,r,n;for(t=0,r=this.nodesIndices.length;t<r;t++)(n=this.nodesByIndex[this.nodesIndices[t]])!==e&&(e.addObjectWithoutCheck(n.getObjectsEnd()),n.reset(!0,!0));e.addObjectWithoutCheck(this.objects),this.reset(!1,!0),this.tree.setRoot(e),e.checkContract()},getOctantIndex:function(e){var t,r,n,i,o,a,s,c,u=this.position,l=this.radiusOverlap,h=this.overlap,d=0;if(e instanceof fl?(r=e.radius,t=e.position,e.positionLast.copy(t)):e instanceof pl&&(t=e.position,r=0),n=t.x-u.x,i=t.y-u.y,o=t.z-u.z,a=Math.abs(n),s=Math.abs(i),c=Math.abs(o),Math.max(a,s,c)+r>l)return a+r>l&&(d^=n>0?this.tree.FLAG_POS_X:this.tree.FLAG_NEG_X),s+r>l&&(d^=i>0?this.tree.FLAG_POS_Y:this.tree.FLAG_NEG_Y),c+r>l&&(d^=o>0?this.tree.FLAG_POS_Z:this.tree.FLAG_NEG_Z),e.indexOctant=-d-this.tree.INDEX_OUTSIDE_OFFSET,e.indexOctant;if(n-r>-h)d|=1;else if(!(n+r<h))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;if(i-r>-h)d|=2;else if(!(i+r<h))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;if(o-r>-h)d|=4;else if(!(o+r<h))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;return e.indexOctant=d,e.indexOctant},getOctantIndexFromPosition:function(e,t,r){var n=0;return e>0&&(n|=1),t>0&&(n|=2),r>0&&(n|=4),n},search:function(e,t,r,n,i){var o,a;if(!0===(n?this.intersectRay(e,n,t,i):this.intersectSphere(e,t)))for(r=r.concat(this.objects),o=0,a=this.nodesIndices.length;o<a;o++)r=this.nodesByIndex[this.nodesIndices[o]].search(e,t,r,n);return r},intersectSphere:function(e,t){var r=t*t,n=e.x,i=e.y,o=e.z;return n<this.left?r-=Math.pow(n-this.left,2):n>this.right&&(r-=Math.pow(n-this.right,2)),i<this.bottom?r-=Math.pow(i-this.bottom,2):i>this.top&&(r-=Math.pow(i-this.top,2)),o<this.back?r-=Math.pow(o-this.back,2):o>this.front&&(r-=Math.pow(o-this.front,2)),r>=0},intersectRay:function(e,t,r,n){void 0===n&&(n=this.utilVec31Ray.set(1,1,1).divide(t));var i,o=(this.left-e.x)*n.x,a=(this.right-e.x)*n.x,s=(this.bottom-e.y)*n.y,c=(this.top-e.y)*n.y,u=(this.back-e.z)*n.z,l=(this.front-e.z)*n.z,h=Math.min(Math.min(Math.max(o,a),Math.max(s,c)),Math.max(u,l));return!(h<0)&&!((i=Math.max(Math.max(Math.min(o,a),Math.min(s,c)),Math.min(u,l)))>h||i>r)},getDepthEnd:function(e){var t,r;if(this.nodesIndices.length>0)for(t=0,r=this.nodesIndices.length;t<r;t++)e=this.nodesByIndex[this.nodesIndices[t]].getDepthEnd(e);else e=!e||this.depth>e?this.depth:e;return e},getNodeCountEnd:function(){return this.tree.root.getNodeCountRecursive()+1},getNodeCountRecursive:function(){var e,t,r=this.nodesIndices.length;for(e=0,t=this.nodesIndices.length;e<t;e++)r+=this.nodesByIndex[this.nodesIndices[e]].getNodeCountRecursive();return r},getObjectsEnd:function(e){var t,r;for(e=(e||[]).concat(this.objects),t=0,r=this.nodesIndices.length;t<r;t++)e=this.nodesByIndex[this.nodesIndices[t]].getObjectsEnd(e);return e},getObjectCountEnd:function(){var e,t,r=this.objects.length;for(e=0,t=this.nodesIndices.length;e<t;e++)r+=this.nodesByIndex[this.nodesIndices[e]].getObjectCountEnd();return r},getObjectCountStart:function(){for(var e=this.objects.length,t=this.parent;t instanceof pl;)e+=t.objects.length,t=t.parent;return e},toConsole:function(e){var t,r;for(e="string"==typeof e?e:"   ",console.log(this.parent?e+" octree NODE > ":" octree ROOT > ",this," // id: ",this.id," // indexOctant: ",this.indexOctant," // position: ",this.position.x,this.position.y,this.position.z," // radius: ",this.radius," // depth: ",this.depth),console.log(this.parent?e+" ":" ","+ objects ( ",this.objects.length," ) ",this.objects),console.log(this.parent?e+" ":" ","+ children ( ",this.nodesIndices.length," )",this.nodesIndices,this.nodesByIndex),t=0,r=this.nodesIndices.length;t<r;t++)this.nodesByIndex[this.nodesIndices[t]].toConsole(e+"   ")}},Nn.prototype.intersectOctreeObject=function(e,t){var r,n,i,o;return e.object instanceof p?(e=(n=e).object,o=n.faces,i=e.geometry.faces,o.length>0&&(e.geometry.faces=o),r=this.intersectObject(e,t),o.length>0&&(e.geometry.faces=i)):r=this.intersectObject(e,t),r},Nn.prototype.intersectOctreeObjects=function(e,t){var r,n,i=[];for(r=0,n=e.length;r<n;r++)i=i.concat(this.intersectOctreeObject(e[r],t));return i};var ml=function(e){this.cubeLods=e;var t=4*e[0].width,r=e[0].texture,n={format:r.format,magFilter:r.magFilter,minFilter:r.minFilter,type:r.type,generateMipmaps:r.generateMipmaps,anisotropy:r.anisotropy,encoding:r.encoding===Kt?er:r.encoding};n.encoding===er&&(n.magFilter=Ze,n.minFilter=Ze),this.CubeUVRenderTarget=new Kr(t,t,n),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=Ge,this.camera=new Yr(.5*-t,.5*t,.5*-t,.5*t,0,1),this.scene=new qr,this.objects=[];var i=new en(1,1),o=[];o.push(new x(0,0)),o.push(new x(1,0)),o.push(new x(2,0)),o.push(new x(0,1)),o.push(new x(1,1)),o.push(new x(2,1));var a=t;t=e[0].width;var s=0,c=4;this.numLods=Math.log(e[0].width)/Math.log(2)-2;for(var u=0;u<this.numLods;u++){var l=.5*(a-a/c);t>16&&(c*=2);for(var h=t>16?6:1,d=0,f=0,p=t,m=0;m<h;m++){for(var v=0;v<6;v++){var g=this.getShader();g.uniforms.envMap.value=this.cubeLods[u].texture,g.envMap=this.cubeLods[u].texture,g.uniforms.faceIndex.value=v,g.uniforms.mapSize.value=p;var y=new dr(i,g);y.position.x=o[v].x*p-l+d,y.position.y=o[v].y*p-l+s+f,y.material.side=Y,y.scale.setScalar(p),this.scene.add(y),this.objects.push(y)}f+=1.75*p,d+=1.25*p,p/=2}s+=2*t,t>16&&(t/=2)}};ml.prototype={constructor:ml,update:function(e){var t=e.gammaInput,r=e.gammaOutput,n=e.toneMapping,i=e.toneMappingExposure,o=e.getRenderTarget();e.gammaInput=!1,e.gammaOutput=!1,e.toneMapping=Re,e.toneMappingExposure=1,e.render(this.scene,this.camera,this.CubeUVRenderTarget,!1),e.setRenderTarget(o),e.toneMapping=n,e.toneMappingExposure=i,e.gammaInput=t,e.gammaOutput=r},getShader:function(){var e=new Xr({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new s(1,1,1)}},vertexShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tvoid main() {\t\t\t\t\tvUv = uv;\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\t\t\t\t}",fragmentShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform samplerCube envMap;\t\t\t\tuniform float mapSize;\t\t\t\tuniform vec3 testColor;\t\t\t\tuniform int faceIndex;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec3 sampleDirection;\t\t\t\t\tvec2 uv = vUv;\t\t\t\t\tuv = uv * 2.0 - 1.0;\t\t\t\t\tuv.y *= -1.0;\t\t\t\t\tif(faceIndex == 0) {\t\t\t\t\t\tsampleDirection = normalize(vec3(1.0, uv.y, -uv.x));\t\t\t\t\t} else if(faceIndex == 1) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, 1.0, uv.y));\t\t\t\t\t} else if(faceIndex == 2) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, uv.y, 1.0));\t\t\t\t\t} else if(faceIndex == 3) {\t\t\t\t\t\tsampleDirection = normalize(vec3(-1.0, uv.y, uv.x));\t\t\t\t\t} else if(faceIndex == 4) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));\t\t\t\t\t} else {\t\t\t\t\t\tsampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));\t\t\t\t\t}\t\t\t\t\tvec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );\t\t\t\t\tgl_FragColor = linearToOutputTexel( color );\t\t\t\t}",blending:$});return e.type="PMREMCubeUVPacker",e},dispose:function(){for(var e=0,t=this.objects.length;e<t;e++)this.objects[e].material.dispose();this.objects[0].geometry.dispose()}};var vl=function(e,t,r){this.sourceTexture=e,this.resolution=void 0!==r?r:256,this.samplesPerLevel=void 0!==t?t:16;var n=e.encoding===Jt||e.encoding===Zt||e.encoding===Qt;this.sourceTexture.minFilter=n?Ze:Ye,this.sourceTexture.magFilter=n?Ze:Ye,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&n,this.cubeLods=[];var i=this.resolution,o={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(i)/Math.log(2)-2;for(var a=0;a<this.numLods;a++){var s=new Fo(i,i,o);s.texture.name="PMREMGenerator.cube"+a,this.cubeLods.push(s),i=Math.max(16,i/2)}this.camera=new Yr(-1,1,1,-1,0,1e3),this.shader=this.getShader(),this.shader.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,this.planeMesh=new dr(new en(2,2,0),this.shader),this.planeMesh.material.side=J,this.scene=new qr,this.scene.add(this.planeMesh),this.scene.add(this.camera),this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture};vl.prototype={constructor:vl,update:function(e){this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture;var t=e.gammaInput,r=e.gammaOutput,n=e.toneMapping,i=e.toneMappingExposure,o=e.getRenderTarget();e.toneMapping=Re,e.toneMappingExposure=1,e.gammaInput=!1,e.gammaOutput=!1;for(var a=0;a<this.numLods;a++){var s=a/(this.numLods-1);this.shader.uniforms.roughness.value=.9*s,this.shader.uniforms.queryScale.value.x=0==a?-1:1;var c=this.cubeLods[a].width;this.shader.uniforms.mapSize.value=c,this.renderToCubeMapTarget(e,this.cubeLods[a]),a<5&&(this.shader.uniforms.envMap.value=this.cubeLods[a].texture)}e.setRenderTarget(o),e.toneMapping=n,e.toneMappingExposure=i,e.gammaInput=t,e.gammaOutput=r},renderToCubeMapTarget:function(e,t){for(var r=0;r<6;r++)this.renderToCubeMapTargetFace(e,t,r)},renderToCubeMapTargetFace:function(e,t,r){t.activeCubeFace=r,this.shader.uniforms.faceIndex.value=r,e.render(this.scene,this.camera,t,!0)},getShader:function(){var e=new Xr({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},queryScale:{value:new s(1,1,1)},testColor:{value:new s(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform vec3 testColor;\n\t\t\t\tuniform vec3 queryScale;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tmat3 vecSpace = matrixFromVector(normalize(sampleDirection * queryScale));\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap,vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:$});return e.type="PMREMGenerator",e},dispose:function(){for(var e=0,t=this.cubeLods.length;e<t;e++)this.cubeLods[e].dispose();this.planeMesh.geometry.dispose(),this.planeMesh.material.dispose()}};var gl={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},yl={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","float l = linearToRelativeLuminance( texel.rgb );","gl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},bl={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","uniform sampler2D luminanceMap;","#else","uniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","#ifdef ADAPTED_LUMINANCE","float fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","#else","float fLumAvg = averageLuminance;","#endif","float fLumPixel = linearToRelativeLuminance( vColor );","float fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","return fLumCompressed * vColor;","}","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")},xl=function(e,t){Bu.call(this),this.resolution=void 0!==t?t:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===gl&&console.error("AdaptiveToneMappingPass relies on CopyShader");var r=gl;this.copyUniforms=Hr.clone(r.uniforms),this.materialCopy=new Xr({uniforms:this.copyUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,blending:$,depthTest:!1}),void 0===yl&&console.error("AdaptiveToneMappingPass relies on LuminosityShader"),this.materialLuminance=new Xr({uniforms:Hr.clone(yl.uniforms),vertexShader:yl.vertexShader,fragmentShader:yl.fragmentShader,blending:$}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","vec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","vec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","float fLastLum = max( minLuminance, lastLum.r );","float fCurrentLum = max( minLuminance, currentLum.r );","fCurrentLum *= fCurrentLum;","float fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","gl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new Xr({uniforms:Hr.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:$}),void 0===bl&&console.error("AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new Xr({uniforms:Hr.clone(bl.uniforms),vertexShader:bl.vertexShader,fragmentShader:bl.fragmentShader,blending:$}),this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};xl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:xl,render:function(e,t,r,n,i){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=r.texture.type,this.previousLuminanceRT.texture.type=r.texture.type,this.currentLuminanceRT.texture.type=r.texture.type,this.needsInit=!1),this.adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera,this.currentLuminanceRT),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=n,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.render(this.scene,this.camera,this.luminanceRT),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.render(this.scene,this.camera,this.previousLuminanceRT)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=r.texture,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},reset:function(e){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var t={minFilter:Ze,magFilter:Ze,format:pt};this.luminanceRT=new Kr(this.resolution,this.resolution,t),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new Kr(this.resolution,this.resolution,t),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,t.minFilter=$e,this.currentLuminanceRT=new Kr(this.resolution,this.resolution,t),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new cr({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))},setMinLuminance:function(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)},setMaxLuminance:function(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)},setAverageLuminance:function(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)},setMiddleGrey:function(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}});var wl={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","return max( sign( x - y ), 0.0 );","}","void main() {","vec4 texelOld = texture2D( tOld, vUv );","vec4 texelNew = texture2D( tNew, vUv );","texelOld *= damp * when_gt( texelOld, 0.1 );","gl_FragColor = max(texelNew, texelOld);","}"].join("\n")},_l=function(e){Bu.call(this),void 0===wl&&console.error("AfterimagePass relies on AfterimageShader"),this.shader=wl,this.uniforms=Hr.clone(this.shader.uniforms),this.uniforms.damp.value=void 0!==e?e:.96,this.textureComp=new Kr(i.innerWidth,i.innerHeight,{minFilter:Ze,magFilter:Ye,format:pt}),this.textureOld=new Kr(i.innerWidth,i.innerHeight,{minFilter:Ze,magFilter:Ye,format:pt}),this.shaderMaterial=new Xr({uniforms:this.uniforms,vertexShader:this.shader.vertexShader,fragmentShader:this.shader.fragmentShader}),this.sceneComp=new qr,this.scene=new qr,this.camera=new Yr(-1,1,1,-1,0,1),this.camera.position.z=1;var t=new en(2,2);this.quadComp=new dr(t,this.shaderMaterial),this.sceneComp.add(this.quadComp);var r=new dr(t,new cr({map:this.textureComp.texture}));this.scene.add(r)};_l.prototype=Object.assign(Object.create(Bu.prototype),{constructor:_l,render:function(e,t,r){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=r.texture,this.quadComp.material=this.shaderMaterial,e.render(this.sceneComp,this.camera,this.textureComp),e.render(this.scene,this.camera,this.textureOld),this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}});var Sl={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new x(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){function t(e,t){return Math.exp(-e*e/(2*t*t))}var r,n,i,o,a=2*Math.ceil(3*e)+1;for(a>25&&(a=25),o=.5*(a-1),n=new Array(a),i=0,r=0;r<a;++r)n[r]=t(r-o,e),i+=n[r];for(r=0;r<a;++r)n[r]/=i;return n}},Ml=function(e,t,r,n){Bu.call(this),e=void 0!==e?e:1,t=void 0!==t?t:25,r=void 0!==r?r:4,n=void 0!==n?n:256;var i={minFilter:Ze,magFilter:Ze,format:pt};this.renderTargetX=new Kr(n,n,i),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Kr(n,n,i),this.renderTargetY.texture.name="BloomPass.y",void 0===gl&&console.error("BloomPass relies on CopyShader");var o=gl;this.copyUniforms=Hr.clone(o.uniforms),this.copyUniforms.opacity.value=e,this.materialCopy=new Xr({uniforms:this.copyUniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,blending:te,transparent:!0}),void 0===Sl&&console.error("BloomPass relies on ConvolutionShader");var a=Sl;this.convolutionUniforms=Hr.clone(a.uniforms),this.convolutionUniforms.uImageIncrement.value=Ml.blurX,this.convolutionUniforms.cKernel.value=Sl.buildKernel(r),this.materialConvolution=new Xr({uniforms:this.convolutionUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Ml.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Ml,render:function(e,t,r,n,i){i&&e.context.disable(e.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=Ml.blurX,e.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Ml.blurY,e.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,i&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,r,this.clear)}}),Ml.blurX=new x(.001953125,0),Ml.blurY=new x(0,.001953125);var Tl=function(e,t,r){Bu.call(this),this.scene=e,this.camera=t;var n=void 0!==r.focus?r.focus:1,o=void 0!==r.aspect?r.aspect:t.aspect,a=void 0!==r.aperture?r.aperture:.025,s=void 0!==r.maxblur?r.maxblur:1,c=r.width||i.innerWidth||1,u=r.height||i.innerHeight||1;this.renderTargetColor=new Kr(c,u,{minFilter:Ze,magFilter:Ze,format:ft}),this.renderTargetColor.texture.name="BokehPass.color",this.renderTargetDepth=this.renderTargetColor.clone(),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new dn,this.materialDepth.depthPacking=nr,this.materialDepth.blending=$,void 0===tn&&console.error("BokehPass relies on BokehShader");var l=tn,h=Hr.clone(l.uniforms);h.tDepth.value=this.renderTargetDepth.texture,h.focus.value=n,h.aspect.value=o,h.aperture.value=a,h.maxblur.value=s,h.nearClip.value=t.near,h.farClip.value=t.far,this.materialBokeh=new Xr({defines:Object.assign({},l.defines),uniforms:h,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.uniforms=h,this.needsSwap=!1,this.camera2=new Yr(-1,1,1,-1,0,1),this.scene2=new qr,this.quad2=new dr(new en(2,2),null),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2),this.oldClearColor=new v,this.oldClearAlpha=1};Tl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Tl,render:function(e,t,r,n,i){this.quad2.material=this.materialBokeh,this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.render(this.scene,this.camera,this.renderTargetDepth,!0),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?e.render(this.scene2,this.camera2):e.render(this.scene2,this.camera2,t,this.clear),this.scene.overrideMaterial=null,e.setClearColor(this.oldClearColor),e.setClearAlpha(this.oldClearAlpha),e.autoClear=this.oldAutoClear}});var Al=function(e,t){Bu.call(this),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==t?t:0};Al.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Al,render:function(e,t,r,n,i){var o,a;this.clearColor&&(o=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:r),e.clear(),this.clearColor&&e.setClearColor(o,a)}});var El=function(e,t,r){Bu.call(this),this.camera=e,this.needsSwap=!1,this.cubeShader=Li.cube,this.cubeMesh=new dr(new Ur(10,10,10),new Xr({uniforms:this.cubeShader.uniforms,vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:Y})),this.envMap=t,this.opacity=void 0!==r?r:1,this.cubeScene=new qr,this.cubeCamera=new Wr,this.cubeScene.add(this.cubeMesh)};El.prototype=Object.assign(Object.create(Bu.prototype),{constructor:El,render:function(e,t,r,n,i){var o=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.envMap,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.render(this.cubeScene,this.cubeCamera,this.renderToScreen?null:r,this.clear),e.autoClear=o}});var Cl={uniforms:{tDiffuse:{value:null},tSize:{value:new x(256,256)},center:{value:new x(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")},Ll=function(e,t,r){Bu.call(this),void 0===Cl&&console.error("DotScreenPass relies on DotScreenShader");var n=Cl;this.uniforms=Hr.clone(n.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==t&&(this.uniforms.angle.value=t),void 0!==r&&(this.uniforms.scale.value=r),this.material=new Xr({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Ll.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Ll,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.tSize.value.set(r.width,r.height),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}});var Pl=function(e,t){Bu.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Pl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Pl,render:function(e,t,r,n,i){var o,a,s=e.context,c=e.state;c.buffers.color.setMask(!1),c.buffers.depth.setMask(!1),c.buffers.color.setLocked(!0),c.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),c.buffers.stencil.setTest(!0),c.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),c.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),c.buffers.stencil.setClear(a),e.render(this.scene,this.camera,r,this.clear),e.render(this.scene,this.camera,t,this.clear),c.buffers.color.setLocked(!1),c.buffers.depth.setLocked(!1),c.buffers.stencil.setFunc(s.EQUAL,1,4294967295),c.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP)}});var Ol=function(){Bu.call(this),this.needsSwap=!1};Ol.prototype=Object.create(Bu.prototype),Object.assign(Ol.prototype,{render:function(e,t,r,n,i){e.state.buffers.stencil.setTest(!1)}});var Nl=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:Ze,magFilter:Ze,format:pt,stencilBuffer:!1},n=e.getDrawingBufferSize();(t=new Kr(n.width,n.height,r)).texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===gl&&console.error("EffectComposer relies on CopyShader"),void 0===zu&&console.error("EffectComposer relies on ShaderPass"),this.copyPass=new zu(gl)};Object.assign(Nl.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize();e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){var t,r,n=!1,i=this.passes.length;for(r=0;r<i;r++)if(!1!==(t=this.passes[r]).enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Pl&&(t instanceof Pl?n=!0:t instanceof Ol&&(n=!1))}},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize();(e=this.renderTarget1.clone()).setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(e,t)}});var Rl={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float dx = rand( vUv + time );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")},Il=function(e,t,r,n){Bu.call(this),void 0===Rl&&console.error("FilmPass relies on FilmShader");var i=Rl;this.uniforms=Hr.clone(i.uniforms),this.material=new Xr({uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),void 0!==n&&(this.uniforms.grayscale.value=n),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==r&&(this.uniforms.sCount.value=r),this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Il.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Il,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=n,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}});var Dl={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")},Fl=function(e){Bu.call(this),void 0===Dl&&console.error("GlitchPass relies on DigitalGlitch");var t=Dl;this.uniforms=Hr.clone(t.uniforms),void 0==e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new Xr({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.goWild=!1,this.curF=0,this.generateTrigger()};Fl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Fl,render:function(e,t,r,n,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=o.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=o.randFloat(-1,1),this.uniforms.seed_y.value=o.randFloat(-1,1),this.uniforms.distortion_x.value=o.randFloat(0,1),this.uniforms.distortion_y.value=o.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=o.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=o.randFloat(0,1),this.uniforms.distortion_y.value=o.randFloat(0,1),this.uniforms.seed_x.value=o.randFloat(-.3,.3),this.uniforms.seed_y.value=o.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},generateTrigger:function(){this.randX=o.randInt(120,240)},generateHeightmap:function(e){for(var t=new Float32Array(e*e*3),r=e*e,n=0;n<r;n++){var i=o.randFloat(0,1);t[3*n+0]=i,t[3*n+1]=i,t[3*n+2]=i}var a=new Vi(t,e,e,ft,at);return a.needsUpdate=!0,a}});var Ul={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:["varying vec2 vUV;","void main() {","vUV = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define SQRT2_MINUS_ONE 0.41421356","#define SQRT2_HALF_MINUS_ONE 0.20710678","#define PI2 6.28318531","#define SHAPE_DOT 1","#define SHAPE_ELLIPSE 2","#define SHAPE_LINE 3","#define SHAPE_SQUARE 4","#define BLENDING_LINEAR 1","#define BLENDING_MULTIPLY 2","#define BLENDING_ADD 3","#define BLENDING_LIGHTER 4","#define BLENDING_DARKER 5","uniform sampler2D tDiffuse;","uniform float radius;","uniform float rotateR;","uniform float rotateG;","uniform float rotateB;","uniform float scatter;","uniform float width;","uniform float height;","uniform int shape;","uniform bool disable;","uniform float blending;","uniform int blendingMode;","varying vec2 vUV;","uniform bool greyscale;","const int samples = 8;","float blend( float a, float b, float t ) {","return a * ( 1.0 - t ) + b * t;","}","float hypot( float x, float y ) {","return sqrt( x * x + y * y );","}","float rand( vec2 seed ){","return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}","float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {","float dist = hypot( coord.x - p.x, coord.y - p.y );","float rad = channel;","if ( shape == SHAPE_DOT ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","} else if ( shape == SHAPE_ELLIPSE ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","if ( dist != 0.0 ) {","float dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );","dist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;","}","} else if ( shape == SHAPE_LINE ) {","rad = pow( abs( rad ), 1.5) * rad_max;","float dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;","dist = hypot( normal.x * dot_p, normal.y * dot_p );","} else if ( shape == SHAPE_SQUARE ) {","float theta = atan( p.y - coord.y, p.x - coord.x ) - angle;","float sin_t = abs( sin( theta ) );","float cos_t = abs( cos( theta ) );","rad = pow( abs( rad ), 1.4 );","rad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );","}","return rad - dist;","}","struct Cell {","vec2 normal;","vec2 p1;","vec2 p2;","vec2 p3;","vec2 p4;","float samp2;","float samp1;","float samp3;","float samp4;","};","vec4 getSample( vec2 point ) {","vec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );","float base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;","float step = PI2 / float( samples );","float dist = radius * 0.66;","for ( int i = 0; i < samples; ++i ) {","float r = base + step * float( i );","vec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );","tex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );","}","tex /= float( samples ) + 1.0;","return tex;","}","float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {","float dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;","if ( channel == 0 ) {","c.samp1 = getSample( c.p1 ).r;","c.samp2 = getSample( c.p2 ).r;","c.samp3 = getSample( c.p3 ).r;","c.samp4 = getSample( c.p4 ).r;","} else if (channel == 1) {","c.samp1 = getSample( c.p1 ).g;","c.samp2 = getSample( c.p2 ).g;","c.samp3 = getSample( c.p3 ).g;","c.samp4 = getSample( c.p4 ).g;","} else {","c.samp1 = getSample( c.p1 ).b;","c.samp3 = getSample( c.p3 ).b;","c.samp2 = getSample( c.p2 ).b;","c.samp4 = getSample( c.p4 ).b;","}","dist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );","dist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );","dist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );","dist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );","res = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;","res = clamp( res, 0.0, 1.0 );","return res;","}","Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {","Cell c;","vec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );","float threshold = step * 0.5;","float dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );","float dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );","vec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );","float offset_normal = mod( hypot( offset.x, offset.y ), step );","float normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;","float normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;","float offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );","float line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;","float line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;","c.normal = n;","c.p1.x = p.x - n.x * normal_scale + n.y * line_scale;","c.p1.y = p.y - n.y * normal_scale - n.x * line_scale;","if ( scatter != 0.0 ) {","float off_mag = scatter * threshold * 0.5;","float off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;","c.p1.x += cos( off_angle ) * off_mag;","c.p1.y += sin( off_angle ) * off_mag;","}","float normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );","float line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );","c.p2.x = c.p1.x - n.x * normal_step;","c.p2.y = c.p1.y - n.y * normal_step;","c.p3.x = c.p1.x + n.y * line_step;","c.p3.y = c.p1.y - n.x * line_step;","c.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;","c.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;","return c;","}","float blendColour( float a, float b, float t ) {","if ( blendingMode == BLENDING_LINEAR ) {","return blend( a, b, 1.0 - t );","} else if ( blendingMode == BLENDING_ADD ) {","return blend( a, min( 1.0, a + b ), t );","} else if ( blendingMode == BLENDING_MULTIPLY ) {","return blend( a, max( 0.0, a * b ), t );","} else if ( blendingMode == BLENDING_LIGHTER ) {","return blend( a, max( a, b ), t );","} else if ( blendingMode == BLENDING_DARKER ) {","return blend( a, min( a, b ), t );","} else {","return blend( a, b, 1.0 - t );","}","}","void main() {","if ( ! disable ) {","vec2 p = vec2( vUV.x * width, vUV.y * height );","vec2 origin = vec2( 0, 0 );","float aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;","Cell cell_r = getReferenceCell( p, origin, rotateR, radius );","Cell cell_g = getReferenceCell( p, origin, rotateG, radius );","Cell cell_b = getReferenceCell( p, origin, rotateB, radius );","float r = getDotColour( cell_r, p, 0, rotateR, aa );","float g = getDotColour( cell_g, p, 1, rotateG, aa );","float b = getDotColour( cell_b, p, 2, rotateB, aa );","vec4 colour = texture2D( tDiffuse, vUV );","r = blendColour( r, colour.r, blending );","g = blendColour( g, colour.g, blending );","b = blendColour( b, colour.b, blending );","if ( greyscale ) {","r = g = b = (r + b + g) / 3.0;","}","gl_FragColor = vec4( r, g, b, 1.0 );","} else {","gl_FragColor = texture2D( tDiffuse, vUV );","}","}"].join("\n")},kl=function(e,t,r){for(var n in Bu.call(this),void 0===Ul&&console.error("HalftonePass requires HalftoneShader"),this.uniforms=Hr.clone(Ul.uniforms),this.material=new Xr({uniforms:this.uniforms,fragmentShader:Ul.fragmentShader,vertexShader:Ul.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t,r)r.hasOwnProperty(n)&&this.uniforms.hasOwnProperty(n)&&(this.uniforms[n].value=r[n]);this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};kl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:kl,render:function(e,t,r,n,i){this.material.uniforms.tDiffuse.value=r.texture,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},setSize:function(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}});var Bl=function(e,t,r,n){this.renderScene=t,this.renderCamera=r,this.selectedObjects=void 0!==n?n:[],this.visibleEdgeColor=new v(1,1,1),this.hiddenEdgeColor=new v(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,Bu.call(this),this.resolution=void 0!==e?new x(e.x,e.y):new x(256,256);var i={minFilter:Ze,magFilter:Ze,format:pt},o=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new cr({color:16777215}),this.maskBufferMaterial.side=J,this.renderTargetMaskBuffer=new Kr(this.resolution.x,this.resolution.y,i),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new dn,this.depthMaterial.side=J,this.depthMaterial.depthPacking=nr,this.depthMaterial.blending=$,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=J,this.prepareMaskMaterial.fragmentShader=function(e,t){var r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Kr(this.resolution.x,this.resolution.y,i),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Kr(o,s,i),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Kr(o,s,i),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Kr(Math.round(o/2),Math.round(s/2),i),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Kr(o,s,i),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Kr(Math.round(o/2),Math.round(s/2),i),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new x(o,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new x(Math.round(o/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===gl&&console.error("OutlinePass relies on CopyShader");var c=gl;this.copyUniforms=Hr.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Xr({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:$,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new v,this.oldClearAlpha=1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.tempPulseColor1=new v,this.tempPulseColor2=new v,this.textureMatrix=new a};Bl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Bl,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var r=Math.round(e/this.downSampleRatio),n=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,n),this.renderTargetBlurBuffer1.setSize(r,n),this.renderTargetEdgeBuffer1.setSize(r,n),this.separableBlurMaterial1.uniforms.texSize.value=new x(r,n),r=Math.round(r/2),n=Math.round(n/2),this.renderTargetBlurBuffer2.setSize(r,n),this.renderTargetEdgeBuffer2.setSize(r,n),this.separableBlurMaterial2.uniforms.texSize.value=new x(r,n)},changeVisibilityOfSelectedObjects:function(e){function t(t){t.isMesh&&(e?(t.visible=t.userData.oldVisible,delete t.userData.oldVisible):(t.userData.oldVisible=t.visible,t.visible=e))}for(var r=0;r<this.selectedObjects.length;r++){this.selectedObjects[r].traverse(t)}},changeVisibilityOfNonSelectedObjects:function(e){var t=[];function r(e){e.isMesh&&t.push(e)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(r)}this.renderScene.traverse(function(r){if(r.isMesh||r.isLine||r.isSprite){for(var n=!1,i=0;i<t.length;i++)if(t[i].id===r.id){n=!0;break}if(!n){var o=r.visible;e&&!r.bVisible||(r.visible=e),r.bVisible=o}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,r,n,i){if(this.selectedObjects.length>0){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,i&&e.context.disable(e.context.STENCIL_TEST),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.render(this.renderScene,this.renderCamera,this.renderTargetDepthBuffer,!0),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new x(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.render(this.renderScene,this.renderCamera,this.renderTargetMaskBuffer,!0),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=a,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.render(this.scene,this.camera,this.renderTargetMaskDownSampleBuffer,!0),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new x(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Bl.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.render(this.scene,this.camera,this.renderTargetBlurBuffer1,!0),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Bl.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Bl.BlurDirectionX,e.render(this.scene,this.camera,this.renderTargetBlurBuffer2,!0),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Bl.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer2,!0),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,i&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,r,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera))},getPrepareMaskMaterial:function(){return new Xr({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new x(.5,.5)},textureMatrix:{value:new a}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new Xr({uniforms:{maskTexture:{value:null},texSize:{value:new x(.5,.5)},visibleEdgeColor:{value:new s(1,1,1)},hiddenEdgeColor:{value:new s(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new Xr({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new x(.5,.5)},direction:{value:new x(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new Xr({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:te,depthTest:!1,depthWrite:!1,transparent:!0})}}),Bl.BlurDirectionX=new x(1,0),Bl.BlurDirectionY=new x(0,1);var zl=function(e,t,r,n,i){Bu.call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};function jl(e,t,r,n,i,o,a,s,c,u){if((u=void 0!==u?u:yt)!==yt&&u!==bt)throw new Error("DepthTexture format must be either DepthFormat or DepthStencilFormat");void 0===r&&u===yt&&(r=nt),void 0===r&&u===bt&&(r=ht),Zr.call(this,null,n,i,o,a,s,u,r,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Ye,this.minFilter=void 0!==s?s:Ye,this.flipY=!1,this.generateMipmaps=!1}zl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:zl,render:function(e,t,r,n,i){var o,a,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(o=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.render(this.scene,this.camera,this.renderToScreen?null:r,this.clear),this.clearColor&&e.setClearColor(o,a),this.scene.overrideMaterial=null,e.autoClear=s}}),jl.prototype=Object.create(Zr.prototype),jl.prototype.constructor=jl,jl.prototype.isDepthTexture=!0;var Vl={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{type:"t",value:null},tDiffuse:{type:"t",value:null},tNormal:{type:"t",value:null},size:{type:"v2",value:new x(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new a},cameraInverseProjectionMatrix:{type:"m4",value:new a},scale:{type:"f",value:1},intensity:{type:"f",value:.1},bias:{type:"f",value:.5},minResolution:{type:"f",value:0},kernelRadius:{type:"f",value:100},randomSeed:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},Gl={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new x(512,512)},sampleUvOffsets:{type:"v2v",value:[new x(0,0)]},sampleWeights:{type:"1fv",value:[1]},tDepth:{type:"t",value:null},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1e3},depthCutoff:{type:"f",value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},Wl={createSampleWeights:function(e,t){for(var r=function(e,t){return Math.exp(-e*e/(t*t*2))/(Math.sqrt(2*Math.PI)*t)},n=[],i=0;i<=e;i++)n.push(r(i,t));return n},createSampleOffsets:function(e,t){for(var r=[],n=0;n<=e;n++)r.push(t.clone().multiplyScalar(n));return r},configure:function(e,t,r,n){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=Wl.createSampleOffsets(t,n),e.uniforms.sampleWeights.value=Wl.createSampleWeights(t,r),e.needsUpdate=!0}},Hl={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","gl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},Xl=function(e,t,r,n,i){(Bu.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==r&&r,this.supportsNormalTexture=void 0!==n&&n,this.oldClearColor=new v,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==i?new x(i.x,i.y):new x(256,256),this.saoRenderTarget=new Kr(this.resolution.x,this.resolution.y,{minFilter:Ze,magFilter:Ze,format:pt}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Kr(this.resolution.x,this.resolution.y,{minFilter:Ye,magFilter:Ye,format:pt}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension)&&((r=new jl).type=nt,r.minFilter=Ye,r.maxFilter=Ye,this.beautyRenderTarget.depthTexture=r,this.beautyRenderTarget.depthBuffer=!0);this.depthMaterial=new dn,this.depthMaterial.depthPacking=nr,this.depthMaterial.blending=$,this.normalMaterial=new mn,this.normalMaterial.blending=$,void 0===Vl&&console.error("SAOPass relies on SAOShader"),this.saoMaterial=new Xr({defines:Object.assign({},Vl.defines),fragmentShader:Vl.fragmentShader,vertexShader:Vl.vertexShader,uniforms:Hr.clone(Vl.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=$,void 0===Gl&&console.error("SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new Xr({uniforms:Hr.clone(Gl.uniforms),defines:Object.assign({},Gl.defines),vertexShader:Gl.vertexShader,fragmentShader:Gl.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=$,this.hBlurMaterial=new Xr({uniforms:Hr.clone(Gl.uniforms),defines:Object.assign({},Gl.defines),vertexShader:Gl.vertexShader,fragmentShader:Gl.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=$,void 0===gl&&console.error("SAOPass relies on CopyShader"),this.materialCopy=new Xr({uniforms:Hr.clone(gl.uniforms),vertexShader:gl.vertexShader,fragmentShader:gl.fragmentShader,blending:$}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=ie,this.materialCopy.blendSrc=ye,this.materialCopy.blendDst=le,this.materialCopy.blendEquation=oe,this.materialCopy.blendSrcAlpha=ve,this.materialCopy.blendDstAlpha=le,this.materialCopy.blendEquationAlpha=oe,void 0===gl&&console.error("SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new Xr({uniforms:Hr.clone(Hl.uniforms),vertexShader:Hl.vertexShader,fragmentShader:Hl.fragmentShader,blending:$}),this.quadCamera=new Yr(-1,1,1,-1,0,1),this.quadScene=new qr,this.quad=new dr(new en(2,2),null),this.quadScene.add(this.quad)};Xl.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},Xl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Xl,render:function(e,t,r,n,i){if(this.renderToScreen&&(this.materialCopy.blending=$,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1!==this.params.output){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.clearTarget(this.depthRenderTarget),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var a=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=a,this.hBlurMaterial.uniforms.depthCutoff.value=a,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(Wl.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new x(0,1)),Wl.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new x(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.render(this.scene,this.camera,this.beautyRenderTarget,!0),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var s=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,s=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?s.blending=ie:s.blending=$,this.renderPass(e,s,this.renderToScreen?null:r),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}},renderPass:function(e,t,r,n,i){var o=e.getClearColor(),a=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1;var c=void 0!==n&&null!==n;c&&(e.setClearColor(n),e.setClearAlpha(i||0)),this.quad.material=t,e.render(this.quadScene,this.quadCamera,r,c),e.autoClear=s,e.setClearColor(o),e.setClearAlpha(a)},renderOverride:function(e,t,r,n,i){var o=e.getClearColor(),a=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,n=t.clearColor||n,i=t.clearAlpha||i;var c=void 0!==n&&null!==n;c&&(e.setClearColor(n),e.setClearAlpha(i||0)),this.scene.overrideMaterial=t,e.render(this.scene,this.camera,r,c),this.scene.overrideMaterial=null,e.autoClear=s,e.setClearColor(o),e.setClearAlpha(a)},setSize:function(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}});var ql=function(e){Bu.call(this),void 0===gl&&console.error("SavePass relies on CopyShader");var t=gl;this.textureID="tDiffuse",this.uniforms=Hr.clone(t.uniforms),this.material=new Xr({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new Kr(i.innerWidth,i.innerHeight,{minFilter:Ze,magFilter:Ze,format:ft,stencilBuffer:!1}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};ql.prototype=Object.assign(Object.create(Bu.prototype),{constructor:ql,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,e.render(this.scene,this.camera,this.renderTarget,this.clear)}});var Yl=[{defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new x(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","vUv = uv;","SMAAEdgeDetectionVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","vec4 delta;","vec3 C = texture2D( colorTex, texcoord ).rgb;","vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","vec3 t = abs( C - Cleft );","delta.x = max( max( t.r, t.g ), t.b );","vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","t = abs( C - Ctop );","delta.y = max( max( t.r, t.g ), t.b );","vec2 edges = step( threshold, delta.xy );","if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","discard;","vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","t = abs( C - Cright );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","t = abs( C - Cbottom );","delta.w = max( max( t.r, t.g ), t.b );","float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","t = abs( C - Cleftleft );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","t = abs( C - Ctoptop );","delta.w = max( max( t.r, t.g ), t.b );","maxDelta = max( max( maxDelta, delta.z ), delta.w );","edges.xy *= step( 0.5 * maxDelta, delta.xy );","return vec4( edges, 0.0, 0.0 );","}","void main() {","gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},{defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new x(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","vPixcoord = texcoord / resolution;","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","vUv = uv;","SMAABlendingWeightCalculationVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","vec2 round( vec2 x ) {","return sign( x ) * floor( abs( x ) + 0.5 );","}","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","e.r = bias + e.r * scale;","return 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x += 0.25 * resolution.x;","texcoord.x += resolution.x;","texcoord.x += 2.0 * resolution.x;","texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","return texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x -= 0.25 * resolution.x;","texcoord.x -= resolution.x;","texcoord.x -= 2.0 * resolution.x;","texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","return texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y -= 0.25 * resolution.y;","texcoord.y -= resolution.y;","texcoord.y -= 2.0 * resolution.y;","texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","return texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y += 0.25 * resolution.y;","texcoord.y += resolution.y;","texcoord.y += 2.0 * resolution.y;","texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","return texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","return texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","vec2 e = texture2D( edgesTex, texcoord ).rg;","if ( e.g > 0.0 ) {","vec2 d;","vec2 coords;","coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","coords.y = offset[ 1 ].y;","d.x = coords.x;","float e1 = texture2D( edgesTex, coords, 0.0 ).r;","coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","d.y = coords.x;","d = d / resolution.x - pixcoord.x;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","}","if ( e.r > 0.0 ) {","vec2 d;","vec2 coords;","coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","coords.x = offset[ 0 ].x;","d.x = coords.y;","float e1 = texture2D( edgesTex, coords, 0.0 ).g;","coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","d.y = coords.y;","d = d / resolution.y - pixcoord.y;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","}","return weights;","}","void main() {","gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},{uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new x(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","vUv = uv;","SMAANeighborhoodBlendingVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","vec4 a;","a.xz = texture2D( blendTex, texcoord ).xz;","a.y = texture2D( blendTex, offset[ 1 ].zw ).g;","a.w = texture2D( blendTex, offset[ 1 ].xy ).a;","if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","return texture2D( colorTex, texcoord, 0.0 );","} else {","vec2 offset;","offset.x = a.a > a.b ? a.a : -a.b;","offset.y = a.g > a.r ? -a.g : a.r;","if ( abs( offset.x ) > abs( offset.y )) {","offset.y = 0.0;","} else {","offset.x = 0.0;","}","vec4 C = texture2D( colorTex, texcoord, 0.0 );","texcoord += sign( offset ) * resolution;","vec4 Cop = texture2D( colorTex, texcoord, 0.0 );","float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","C.xyz = pow(C.xyz, vec3(2.2));","Cop.xyz = pow(Cop.xyz, vec3(2.2));","vec4 mixed = mix(C, Cop, s);","mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","return mixed;","}","}","void main() {","gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")}],Jl=function(e,t){Bu.call(this),this.edgesRT=new Kr(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:Ze,format:ft}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Kr(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:Ze,format:pt}),this.weightsRT.texture.name="SMAAPass.weights";var r=new Image;r.src=this.getAreaTexture(),this.areaTexture=new Zr,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.format=ft,this.areaTexture.minFilter=Ze,this.areaTexture.generateMipmaps=!1,this.areaTexture.needsUpdate=!0,this.areaTexture.flipY=!1;var n=new Image;n.src=this.getSearchTexture(),this.searchTexture=new Zr,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=n,this.searchTexture.magFilter=Ye,this.searchTexture.minFilter=Ye,this.searchTexture.generateMipmaps=!1,this.searchTexture.needsUpdate=!0,this.searchTexture.flipY=!1,void 0===Yl&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=Hr.clone(Yl[0].uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Xr({defines:Object.assign({},Yl[0].defines),uniforms:this.uniformsEdges,vertexShader:Yl[0].vertexShader,fragmentShader:Yl[0].fragmentShader}),this.uniformsWeights=Hr.clone(Yl[1].uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Xr({defines:Object.assign({},Yl[1].defines),uniforms:this.uniformsWeights,vertexShader:Yl[1].vertexShader,fragmentShader:Yl[1].fragmentShader}),this.uniformsBlend=Hr.clone(Yl[2].uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Xr({uniforms:this.uniformsBlend,vertexShader:Yl[2].vertexShader,fragmentShader:Yl[2].fragmentShader}),this.needsSwap=!1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Jl.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Jl,render:function(e,t,r,n,i){this.uniformsEdges.tDiffuse.value=r.texture,this.quad.material=this.materialEdges,e.render(this.scene,this.camera,this.edgesRT,this.clear),this.quad.material=this.materialWeights,e.render(this.scene,this.camera,this.weightsRT,this.clear),this.uniformsBlend.tColor.value=r.texture,this.quad.material=this.materialBlend,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},setSize:function(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var Ql=function(e,t,r,n){Bu.call(this),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==r?r:0,this.clearAlpha=void 0!==n?n:0,void 0===gl&&console.error("SSAARenderPass relies on CopyShader");var i=gl;this.copyUniforms=Hr.clone(i.uniforms),this.copyMaterial=new Xr({uniforms:this.copyUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:te,depthTest:!1,depthWrite:!1}),this.camera2=new Yr(-1,1,1,-1,0,1),this.scene2=new qr,this.quad2=new dr(new en(2,2),this.copyMaterial),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2)};Ql.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Ql,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)},render:function(e,t,r){this.sampleRenderTarget||(this.sampleRenderTarget=new Kr(r.width,r.height,{minFilter:Ze,magFilter:Ze,format:pt}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var n=Ql.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],i=e.autoClear;e.autoClear=!1;var o=e.getClearColor().getHex(),a=e.getClearAlpha(),s=1/n.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var c=r.width,u=r.height,l=0;l<n.length;l++){var h=n[l];this.camera.setViewOffset&&this.camera.setViewOffset(c,u,.0625*h[0],.0625*h[1],c,u);var d=s;if(this.unbiased)d+=1/32*((l+.5)/n.length-.5);this.copyUniforms.opacity.value=d,e.setClearColor(this.clearColor,this.clearAlpha),e.render(this.scene,this.camera,this.sampleRenderTarget,!0),0===l&&e.setClearColor(0,0),e.render(this.scene2,this.camera2,this.renderToScreen?null:t,0===l)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=i,e.setClearColor(o,a)}}),Ql.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];var Zl={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new x(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cameraNear;","uniform float cameraFar;","#ifdef USE_LOGDEPTHBUF","uniform float logDepthBufFC;","#endif","uniform float radius;","uniform bool onlyAO;","uniform vec2 size;","uniform float aoClamp;","uniform float lumInfluence;","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","varying vec2 vUv;","#define DL 2.399963229728653","#define EULER 2.718281828459045","const int samples = 64;","const bool useNoise = true;","const float noiseAmount = 0.0004;","const float diffArea = 0.4;","const float gDisplace = 0.4;","#include <packing>","vec2 rand( const vec2 coord ) {","vec2 noise;","if ( useNoise ) {","float nx = dot ( coord, vec2( 12.9898, 78.233 ) );","float ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );","noise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );","} else {","float ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );","float gg = fract( coord.t * ( size.y / 2.0 ) );","noise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;","}","return ( noise * 2.0  - 1.0 ) * noiseAmount;","}","float readDepth( const in vec2 coord ) {","float cameraFarPlusNear = cameraFar + cameraNear;","float cameraFarMinusNear = cameraFar - cameraNear;","float cameraCoef = 2.0 * cameraNear;","#ifdef USE_LOGDEPTHBUF","float logz = unpackRGBAToDepth( texture2D( tDepth, coord ) );","float w = pow(2.0, (logz / logDepthBufFC)) - 1.0;","float z = (logz / w) + 1.0;","#else","float z = unpackRGBAToDepth( texture2D( tDepth, coord ) );","#endif","return cameraCoef / ( cameraFarPlusNear - z * cameraFarMinusNear );","}","float compareDepths( const in float depth1, const in float depth2, inout int far ) {","float garea = 8.0;","float diff = ( depth1 - depth2 ) * 100.0;","if ( diff < gDisplace ) {","garea = diffArea;","} else {","far = 1;","}","float dd = diff - gDisplace;","float gauss = pow( EULER, -2.0 * ( dd * dd ) / ( garea * garea ) );","return gauss;","}","float calcAO( float depth, float dw, float dh ) {","vec2 vv = vec2( dw, dh );","vec2 coord1 = vUv + radius * vv;","vec2 coord2 = vUv - radius * vv;","float temp1 = 0.0;","float temp2 = 0.0;","int far = 0;","temp1 = compareDepths( depth, readDepth( coord1 ), far );","if ( far > 0 ) {","temp2 = compareDepths( readDepth( coord2 ), depth, far );","temp1 += ( 1.0 - temp1 ) * temp2;","}","return temp1;","}","void main() {","vec2 noise = rand( vUv );","float depth = readDepth( vUv );","float tt = clamp( depth, aoClamp, 1.0 );","float w = ( 1.0 / size.x ) / tt + ( noise.x * ( 1.0 - noise.x ) );","float h = ( 1.0 / size.y ) / tt + ( noise.y * ( 1.0 - noise.y ) );","float ao = 0.0;","float dz = 1.0 / float( samples );","float l = 0.0;","float z = 1.0 - dz / 2.0;","for ( int i = 0; i <= samples; i ++ ) {","float r = sqrt( 1.0 - z );","float pw = cos( l ) * r;","float ph = sin( l ) * r;","ao += calcAO( depth, pw * w, ph * h );","z = z - dz;","l = l + DL;","}","ao /= float( samples );","ao = 1.0 - ao;","vec3 color = texture2D( tDiffuse, vUv ).rgb;","vec3 lumcoeff = vec3( 0.299, 0.587, 0.114 );","float lum = dot( color.rgb, lumcoeff );","vec3 luminance = vec3( lum );","vec3 final = vec3( color * mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","if ( onlyAO ) {","final = vec3( mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","}","gl_FragColor = vec4( final, 1.0 );","}"].join("\n")},Kl=function(e,t,r,n){if(void 0===Zl)return console.warn("SSAOPass depends on SSAOShader"),new zu;zu.call(this,Zl),this.width=void 0!==r?r:512,this.height=void 0!==n?n:256,this.renderToScreen=!1,this.camera2=t,this.scene2=e,this.depthMaterial=new dn,this.depthMaterial.depthPacking=nr,this.depthMaterial.blending=$,this.depthRenderTarget=new Kr(this.width,this.height,{minFilter:Ze,magFilter:Ze}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(this.width,this.height),this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far,this.uniforms.radius.value=4,this.uniforms.onlyAO.value=!1,this.uniforms.aoClamp.value=.25,this.uniforms.lumInfluence.value=.7,Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(e){this.uniforms.radius.value=e}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(e){this.uniforms.onlyAO.value=e}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(e){this.uniforms.aoClamp.value=e}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(e){this.uniforms.lumInfluence.value=e}}})};(Kl.prototype=Object.create(zu.prototype)).render=function(e,t,r,n,i){this.scene2.overrideMaterial=this.depthMaterial,e.render(this.scene2,this.camera2,this.depthRenderTarget,!0),this.scene2.overrideMaterial=null,zu.prototype.render.call(this,e,t,r,n,i)},Kl.prototype.setScene=function(e){this.scene2=e},Kl.prototype.setCamera=function(e){this.camera2=e,this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far},Kl.prototype.setSize=function(e,t){this.width=e,this.height=t,this.uniforms.size.value.set(this.width,this.height),this.depthRenderTarget.setSize(this.width,this.height)};var $l=function(e,t,r){void 0===Ql&&console.error("TAARenderPass relies on SSAARenderPass"),Ql.call(this,e,t,r),this.sampleLevel=0,this.accumulate=!1};$l.JitterVectors=Ql.JitterVectors,$l.prototype=Object.assign(Object.create(Ql.prototype),{constructor:$l,render:function(e,t,r,n){if(!this.accumulate)return Ql.prototype.render.call(this,e,t,r,n),void(this.accumulateIndex=-1);var i=$l.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new Kr(r.width,r.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new Kr(r.width,r.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(Ql.prototype.render.call(this,e,this.holdRenderTarget,r,n),this.accumulateIndex=0);var o=e.autoClear;e.autoClear=!1;var a=1/i.length;if(this.accumulateIndex>=0&&this.accumulateIndex<i.length){this.copyUniforms.opacity.value=a,this.copyUniforms.tDiffuse.value=t.texture;for(var s=Math.pow(2,this.sampleLevel),c=0;c<s;c++){var u=i[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(r.width,r.height,.0625*u[0],.0625*u[1],r.width,r.height),e.render(this.scene,this.camera,t,!0),e.render(this.scene2,this.camera2,this.sampleRenderTarget,0===this.accumulateIndex),this.accumulateIndex++,this.accumulateIndex>=i.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var l=this.accumulateIndex*a;l>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.render(this.scene2,this.camera2,t,!0)),l<1&&(this.copyUniforms.opacity.value=1-l,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.render(this.scene2,this.camera2,t,0===l)),e.autoClear=o}});var eh=function(e,t){Bu.call(this),void 0===gl&&console.error("TexturePass relies on CopyShader");var r=gl;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=Hr.clone(r.uniforms),this.material=new Xr({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};eh.prototype=Object.assign(Object.create(Bu.prototype),{constructor:eh,render:function(e,t,r,n,i){var o=e.autoClear;e.autoClear=!1,this.quad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.render(this.scene,this.camera,this.renderToScreen?null:r,this.clear),e.autoClear=o}});var th={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:1},smoothWidth:{type:"f",value:1},defaultColor:{type:"c",value:new v(0)},defaultOpacity:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},rh=function(e,t,r,n){Bu.call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new x(e.x,e.y):new x(256,256),this.clearColor=new v(0,0,0);var i={minFilter:Ze,magFilter:Ze,format:pt};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new Kr(o,a,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var u;(u=new Kr(o,a,i)).texture.name="UnrealBloomPass.h"+c,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u),(u=new Kr(o,a,i)).texture.name="UnrealBloomPass.v"+c,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),o=Math.round(o/2),a=Math.round(a/2)}void 0===th&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var l=th;this.highPassUniforms=Hr.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Xr({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var h=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[c])),this.separableBlurMaterials[c].uniforms.texSize.value=new x(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new s(1,1,1),new s(1,1,1),new s(1,1,1),new s(1,1,1),new s(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===gl&&console.error("BloomPass relies on CopyShader");var d=gl;this.copyUniforms=Hr.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Xr({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:te,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new v,this.oldClearAlpha=1,this.camera=new Yr(-1,1,1,-1,0,1),this.scene=new qr,this.basic=new cr,this.quad=new dr(new en(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};rh.prototype=Object.assign(Object.create(Bu.prototype),{constructor:rh,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),n=Math.round(t/2);this.renderTargetBright.setSize(r,n);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,n),this.renderTargetsVertical[i].setSize(r,n),this.separableBlurMaterials[i].uniforms.texSize.value=new x(r,n),r=Math.round(r/2),n=Math.round(n/2)},render:function(e,t,r,n,i){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.context.disable(e.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=r.texture,e.render(this.scene,this.camera,void 0,!0)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.quad.material=this.materialHighPassFilter,e.render(this.scene,this.camera,this.renderTargetBright,!0);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.quad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=rh.BlurDirectionX,e.render(this.scene,this.camera,this.renderTargetsHorizontal[s],!0),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=rh.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetsVertical[s],!0),a=this.renderTargetsVertical[s];this.quad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.render(this.scene,this.camera,this.renderTargetsHorizontal[0],!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.context.enable(e.context.STENCIL_TEST),this.renderToScreen?e.render(this.scene,this.camera,void 0,!1):e.render(this.scene,this.camera,r,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o},getSeperableBlurMaterial:function(e){return new Xr({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new x(.5,.5)},direction:{value:new x(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new Xr({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),rh.BlurDirectionX=new x(1,0),rh.BlurDirectionY=new x(0,1);function nh(e,t,r,n,i,o){this.planes=[void 0!==e?e:new On,void 0!==t?t:new On,void 0!==r?r:new On,void 0!==n?n:new On,void 0!==i?i:new On,void 0!==o?o:new On]}Object.assign(nh.prototype,{set:function(e,t,r,n,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],c=r[5],u=r[6],l=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],v=r[13],g=r[14],y=r[15];return t[0].setComponents(a-n,l-s,p-h,y-m).normalize(),t[1].setComponents(a+n,l+s,p+h,y+m).normalize(),t[2].setComponents(a+i,l+c,p+d,y+v).normalize(),t[3].setComponents(a-i,l-c,p-d,y-v).normalize(),t[4].setComponents(a-o,l-u,p-f,y-g).normalize(),t[5].setComponents(a+o,l+u,p+f,y+g).normalize(),this},intersectsObject:function(){var e=new b;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new b;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:function(){var e=new s;return function(t){for(var r=this.planes,n=0;n<6;n++){var i=r[n];if(e.x=i.normal.x>0?t.max.x:t.min.x,e.y=i.normal.y>0?t.max.y:t.min.y,e.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(e)<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}});var ih=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},oh=function(){this.id=0,this.v1=new ah,this.v2=new ah,this.v3=new ah,this.normalModel=new s,this.vertexNormalsModel=[new s,new s,new s],this.vertexNormalsLength=0,this.color=new v,this.material=null,this.uvs=[new x,new x,new x],this.z=0,this.renderOrder=0},ah=function(){this.position=new s,this.positionWorld=new s,this.positionScreen=new S,this.visible=!0};ah.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)};var sh=function(){this.id=0,this.v1=new ah,this.v2=new ah,this.vertexColors=[new v,new v],this.material=null,this.z=0,this.renderOrder=0},ch=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new x,this.material=null,this.renderOrder=0},uh=function(){var e,t,r,n,i,o,c,u,l,h,f,p=[],m=0,v=[],g=0,b=[],x=0,w=[],M=0,T=[],A=0,E={objects:[],lights:[],elements:[]},C=new s,L=new S,P=new y(new s(-1,-1,-1),new s(1,1,1)),O=new y,N=new Array(3),R=new a,I=new a,D=new a,F=new d,k=new nh,B=new S,z=new S;this.projectVector=function(e,t){console.warn("Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("Projector: .pickingRay() is now raycaster.setFromCamera().")};var j=new function(){var e=[],t=[],n=[],o=null,a=new d;function s(e){var t=e.position,r=e.positionWorld,n=e.positionScreen;r.copy(t).applyMatrix4(f),n.copy(r).applyMatrix4(I);var i=1/n.w;n.x*=i,n.y*=i,n.z*=i,e.visible=n.x>=-1&&n.x<=1&&n.y>=-1&&n.y<=1&&n.z>=-1&&n.z<=1}function u(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(N[0]=e.positionScreen,N[1]=t.positionScreen,N[2]=r.positionScreen,P.intersectsBox(O.setFromPoints(N)))}function l(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(r){(o=r).material,a.getNormalMatrix(o.matrixWorld),e.length=0,t.length=0,n.length=0},projectVertex:s,checkTriangleVisibility:u,checkBackfaceCulling:l,pushVertex:function(e,t,n){(r=W()).position.set(e,t,n),s(r)},pushNormal:function(t,r,n){e.push(t,r,n)},pushColor:function(e,r,n){t.push(e,r,n)},pushUv:function(e,t){n.push(e,t)},pushLine:function(e,r){var n=v[e],i=v[r];n.positionScreen.copy(n.position).applyMatrix4(D),i.positionScreen.copy(i.position).applyMatrix4(D),!0===$(n.positionScreen,i.positionScreen)&&(n.positionScreen.multiplyScalar(1/n.positionScreen.w),i.positionScreen.multiplyScalar(1/i.positionScreen.w),(c=X()).id=o.id,c.v1.copy(n),c.v2.copy(i),c.z=Math.max(n.positionScreen.z,i.positionScreen.z),c.renderOrder=o.renderOrder,c.material=o.material,o.material.vertexColors===K&&(c.vertexColors[0].fromArray(t,3*e),c.vertexColors[1].fromArray(t,3*r)),E.elements.push(c))},pushTriangle:function(r,s,c,h){var d=arguments,f=v[r],p=v[s],m=v[c];if(!1!==u(f,p,m)&&(h.side===J||!0===l(f,p,m))){(i=H()).id=o.id,i.v1.copy(f),i.v2.copy(p),i.v3.copy(m),i.z=(f.positionScreen.z+p.positionScreen.z+m.positionScreen.z)/3,i.renderOrder=o.renderOrder,C.subVectors(m.position,p.position),L.subVectors(f.position,p.position),C.cross(L),i.normalModel.copy(C),i.normalModel.applyMatrix3(a).normalize();for(var g=0;g<3;g++){var y=i.vertexNormalsModel[g];y.fromArray(e,3*d[g]),y.applyMatrix3(a).normalize(),i.uvs[g].fromArray(n,2*d[g])}i.vertexNormalsLength=3,i.material=h,h.vertexColors===Z&&i.color.fromArray(t,3*r),E.elements.push(i)}}}};function V(r){(e=function(){if(t===m){var e=new ih;return p.push(e),m++,t++,e}return p[t++]}()).id=r.id,e.object=r,C.setFromMatrixPosition(r.matrixWorld),C.applyMatrix4(I),e.z=C.z,e.renderOrder=r.renderOrder,E.objects.push(e)}function G(e,t,r){var n=1/e.w;e.z*=n,e.z>=-1&&e.z<=1&&((l=function(){if(h===A){var e=new ch;return T.push(e),A++,h++,e}return T[h++]}()).id=t.id,l.x=e.x*n,l.y=e.y*n,l.z=e.z,l.renderOrder=t.renderOrder,l.object=t,l.rotation=t.rotation,l.scale.x=t.scale.x*Math.abs(l.x-(e.x+r.projectionMatrix.elements[0])/(e.w+r.projectionMatrix.elements[12])),l.scale.y=t.scale.y*Math.abs(l.y-(e.y+r.projectionMatrix.elements[5])/(e.w+r.projectionMatrix.elements[13])),l.material=t.material,E.elements.push(l))}function W(){if(n===g){var e=new ah;return v.push(e),g++,n++,e}return v[n++]}function H(){if(o===x){var e=new oh;return b.push(e),x++,o++,e}return b[o++]}function X(){if(u===M){var e=new sh;return w.push(e),M++,u++,e}return w[u++]}function Q(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function $(e,t){var r=0,n=1,i=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return i>=0&&o>=0&&a>=0&&s>=0||!(i<0&&o<0||a<0&&s<0)&&(i<0?r=Math.max(r,i/(i-o)):o<0&&(n=Math.min(n,i/(i-o))),a<0?r=Math.max(r,a/(a-s)):s<0&&(n=Math.min(n,a/(a-s))),!(n<r)&&(e.lerp(t,r),t.lerp(e,1-n),!0))}this.projectScene=function(e,r,a,s){o=0,u=0,h=0,E.elements.length=0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),R.copy(r.matrixWorldInverse),I.multiplyMatrices(r.projectionMatrix,R),k.setFromMatrix(I),t=0,E.objects.length=0,E.lights.length=0,function e(t){if(!1!==t.visible){if(t instanceof vo)E.lights.push(t);else if(t instanceof dr||t instanceof fr||t instanceof Gi){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===k.intersectsObject(t))return;V(t)}else if(t instanceof wc){if(!1===t.material.visible)return;if(!0===t.frustumCulled&&!1===k.intersectsSprite(t))return;V(t)}for(var r=t.children,n=0,i=r.length;n<i;n++)e(r[n])}}(e),!0===a&&E.objects.sort(Q);for(var l=E.objects,d=0,p=l.length;d<p;d++){var m=l[d].object,g=m.geometry;if(j.setObject(m),f=m.matrixWorld,n=0,m instanceof dr){if(g instanceof U){var y=m.material,b=Array.isArray(y),x=g.attributes,w=g.groups;if(void 0===x.position)continue;for(var S=0,M=(Oe=x.position.array).length;S<M;S+=3){var T=Oe[S],A=Oe[S+1],P=Oe[S+2];if(!0===y.morphTargets)for(var O=g.morphAttributes.position,N=m.morphTargetInfluences,Z=0,ee=O.length;Z<ee;Z++){if(0!==(de=N[Z]))T+=((fe=O[Z]).getX(S/3)-Oe[S])*de,A+=(fe.getY(S/3)-Oe[S+1])*de,P+=(fe.getZ(S/3)-Oe[S+2])*de}j.pushVertex(T,A,P)}if(void 0!==x.normal){var te=x.normal.array;for(S=0,M=te.length;S<M;S+=3)j.pushNormal(te[S],te[S+1],te[S+2])}if(void 0!==x.color)for(S=0,M=(Le=x.color.array).length;S<M;S+=3)j.pushColor(Le[S],Le[S+1],Le[S+2]);if(void 0!==x.uv){var re=x.uv.array;for(S=0,M=re.length;S<M;S+=2)j.pushUv(re[S],re[S+1])}if(null!==g.index){var ne=g.index.array;if(w.length>0)for(var ie=0;ie<w.length;ie++){var oe=w[ie];if(void 0!==(y=!0===b?m.material[oe.materialIndex]:m.material))for(S=oe.start,M=oe.start+oe.count;S<M;S+=3)j.pushTriangle(ne[S],ne[S+1],ne[S+2],y)}else for(S=0,M=ne.length;S<M;S+=3)j.pushTriangle(ne[S],ne[S+1],ne[S+2],y)}else if(w.length>0)for(ie=0;ie<w.length;ie++){oe=w[ie];if(void 0!==(y=!0===b?m.material[oe.materialIndex]:m.material))for(S=oe.start,M=oe.start+oe.count;S<M;S+=3)j.pushTriangle(S,S+1,S+2,y)}else for(S=0,M=Oe.length/3;S<M;S+=3)j.pushTriangle(S,S+1,S+2,y)}else if(g instanceof _){var ae=g.vertices,se=g.faces,ce=g.faceVertexUvs[0];F.getNormalMatrix(f);y=m.material,b=Array.isArray(y);for(var ue=0,le=ae.length;ue<le;ue++){var he=ae[ue];if(C.copy(he),!0===y.morphTargets)for(O=g.morphTargets,N=m.morphTargetInfluences,Z=0,ee=O.length;Z<ee;Z++){var de;if(0!==(de=N[Z])){var fe,pe=(fe=O[Z]).vertices[ue];C.x+=(pe.x-he.x)*de,C.y+=(pe.y-he.y)*de,C.z+=(pe.z-he.z)*de}}j.pushVertex(C.x,C.y,C.z)}for(var me=0,ve=se.length;me<ve;me++){var ge=se[me];if(void 0!==(y=!0===b?m.material[ge.materialIndex]:m.material)){var ye=y.side,be=v[ge.a],xe=v[ge.b],we=v[ge.c];if(!1!==j.checkTriangleVisibility(be,xe,we)){var _e=j.checkBackfaceCulling(be,xe,we);if(ye!==J){if(ye===q&&!1===_e)continue;if(ye===Y&&!0===_e)continue}(i=H()).id=m.id,i.v1.copy(be),i.v2.copy(xe),i.v3.copy(we),i.normalModel.copy(ge.normal),!1!==_e||ye!==Y&&ye!==J||i.normalModel.negate(),i.normalModel.applyMatrix3(F).normalize();for(var Se=ge.vertexNormals,Me=0,Te=Math.min(Se.length,3);Me<Te;Me++){var Ae=i.vertexNormalsModel[Me];Ae.copy(Se[Me]),!1!==_e||ye!==Y&&ye!==J||Ae.negate(),Ae.applyMatrix3(F).normalize()}i.vertexNormalsLength=Se.length;var Ee=ce[me];if(void 0!==Ee)for(var Ce=0;Ce<3;Ce++)i.uvs[Ce].copy(Ee[Ce]);i.color=ge.color,i.material=y,i.z=(be.positionScreen.z+xe.positionScreen.z+we.positionScreen.z)/3,i.renderOrder=m.renderOrder,E.elements.push(i)}}}}}else if(m instanceof fr){if(D.multiplyMatrices(I,f),g instanceof U){if(void 0!==(x=g.attributes).position){for(S=0,M=(Oe=x.position.array).length;S<M;S+=3)j.pushVertex(Oe[S],Oe[S+1],Oe[S+2]);if(void 0!==x.color){var Le;for(S=0,M=(Le=x.color.array).length;S<M;S+=3)j.pushColor(Le[S],Le[S+1],Le[S+2])}if(null!==g.index)for(S=0,M=(ne=g.index.array).length;S<M;S+=2)j.pushLine(ne[S],ne[S+1]);else{var Pe=m instanceof Eo?2:1;for(S=0,M=Oe.length/3-1;S<M;S+=Pe)j.pushLine(S,S+1)}}}else if(g instanceof _){if(0===(ae=m.geometry.vertices).length)continue;(be=W()).positionScreen.copy(ae[0]).applyMatrix4(D);for(Pe=m instanceof Eo?2:1,ue=1,le=ae.length;ue<le;ue++)(be=W()).positionScreen.copy(ae[ue]).applyMatrix4(D),(ue+1)%Pe>0||(xe=v[n-2],B.copy(be.positionScreen),z.copy(xe.positionScreen),!0===$(B,z)&&(B.multiplyScalar(1/B.w),z.multiplyScalar(1/z.w),(c=X()).id=m.id,c.v1.positionScreen.copy(B),c.v2.positionScreen.copy(z),c.z=Math.max(B.z,z.z),c.renderOrder=m.renderOrder,c.material=m.material,m.material.vertexColors===K&&(c.vertexColors[0].copy(m.geometry.colors[ue]),c.vertexColors[1].copy(m.geometry.colors[ue-1])),E.elements.push(c)))}}else if(m instanceof Gi){if(D.multiplyMatrices(I,f),g instanceof _)for(ue=0,le=(ae=m.geometry.vertices).length;ue<le;ue++){he=ae[ue];L.set(he.x,he.y,he.z,1),L.applyMatrix4(D),G(L,m,r)}else if(g instanceof U){if(void 0!==(x=g.attributes).position){var Oe;for(S=0,M=(Oe=x.position.array).length;S<M;S+=3)L.set(Oe[S],Oe[S+1],Oe[S+2],1),L.applyMatrix4(D),G(L,m,r)}}}else m instanceof wc&&(L.set(f.elements[12],f.elements[13],f.elements[14],1),L.applyMatrix4(I),G(L,m,r))}return!0===s&&E.elements.sort(Q),E}},lh=function(e){sr.call(this),this.type="SpriteCanvasMaterial",this.color=new v(16777215),this.program=function(){},this.setValues(e)};(lh.prototype=Object.create(sr.prototype)).constructor=lh,lh.prototype.isSpriteCanvasMaterial=!0,lh.prototype.clone=function(){var e=new lh;return e.copy(this),e.color.copy(this.color),e.program=this.program,e};var hh=function(e){p.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(e){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};(hh.prototype=Object.create(p.prototype)).constructor=hh;var dh=function(e){p.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};dh.prototype=Object.create(p.prototype),dh.prototype.constructor=dh;var fh=function(e){dh.call(this,e)};fh.prototype=Object.create(dh.prototype),fh.prototype.constructor=fh;var ph=function(e){console.log("RaytracingRenderer",z),e=e||{};var t,r,n=this,i=[],o=!1,a=document.createElement("canvas"),s=a.getContext("2d",{alpha:!0===e.alpha}),c=new v(0);this.domElement=a,this.autoClear=!0;var u=e.workers,l=e.blockSize||64;this.randomize=e.randomize;var h,d,f,p=[],m=0,g=0;function y(e){e.postMessage({init:[t,r],worker:e.id,blockSize:l})}function b(e){if(!p.length)return o=!1,n.dispatchEvent({type:"complete"});var t=p.pop(),r=t%d*l,i=(t/d|0)*l;e.postMessage({render:!0,x:r,y:i,sceneId:g}),s.fillStyle="#"+e.color,s.fillRect(r,i,l,l)}console.log("%cSpinning off "+u+" Workers ","font-size: 20px; background: black; color: white; font-family: monospace;"),this.setWorkers=function(t){for(u=t||navigator.hardwareConcurrency||4;i.length<u;){var r=new Worker(e.workerPath);r.id=m++,r.onmessage=function(e){var t=e.data;if(t&&t.blockSize&&g==t.sceneId){var r=new ImageData(new Uint8ClampedArray(t.data),t.blockSize,t.blockSize);if(s.putImageData(r,t.blockX,t.blockY),console.log("Worker "+this.id,t.time/1e3,(Date.now()-_)/1e3+" s"),i.length>u)return i.splice(i.indexOf(this),1),this.terminate();b(this)}},r.color=(new v).setHSL(Math.random(),.8,.8).getHexString(),i.push(r),y(r),o&&(r.postMessage({scene:x,camera:w,annex:S,sceneId:g}),b(r))}if(!o)for(;i.length>u;)i.pop().terminate()},this.setWorkers(u),this.setClearColor=function(e){c.set(e)},this.setPixelRatio=function(){},this.setSize=function(e,n){a.width=e,a.height=n,t=a.width,r=a.height,s.fillStyle="white",i.forEach(y)},this.setSize(a.width,a.height),this.clear=function(){};var x,w,_,S={},M={mirror:1,reflectivity:1,refractionRatio:1,glass:1};function T(e){var t=e.material;if(t&&!(t.uuid in S)){var r={};for(var n in M)void 0!==t[n]&&(r[n]=t[n]);S[t.uuid]=r}}this.render=function(e,a){o=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),x=e.toJSON(),w=a.toJSON(),++g,e.traverse(T),i.forEach(function(e){e.postMessage({scene:x,camera:w,annex:S,sceneId:g})}),s.clearRect(0,0,t,r),_=Date.now(),d=Math.ceil(t/l),f=Math.ceil(r/l),h=d*f,p=[];for(var c=0;c<h;c++)p.push(c);if(n.randomize)for(c=0;c<h;c++){var u=Math.random()*h|0,m=p[u];p[u]=p[c],p[c]=m}i.forEach(b)}};Object.assign(ph.prototype,u.prototype);var mh=function(e){console.log("SoftwareRenderer",z);var t,r,n,i,o,a,c,u,l,h,d,f,p,m,g,y,b=void 0!==(e=e||{}).canvas?e.canvas:document.createElement("canvas"),w=b.getContext("2d",{alpha:!0===e.alpha}),_={},M={},T=new v(0),A=!0===e.alpha?0:1,E=1,C=2,L=4,P=(1<<L)-1,O=3,N=1<<O,R=1<<24,I=!1,D=new s(0,0,1),F=new s,U=1/0,k=1/0,B=0,j=0,V=1/0,G=1/0,W=0,H=0,X=new uh,q=new S,Y=new S,J=new S,Q=new x,K=new x,$=new x,ee=[],te=0,re=[],ne=0,ie=[],oe=0,ae=this;function se(){return!0===e.alpha?A:1}function ce(e){for(var n=t*r*4,i=0;i<n;i+=4)f[i]=255*e.r|0,f[i+1]=255*e.g|0,f[i+2]=255*e.b|0,f[i+3]=255*se()|0;w.fillStyle="rgba("+(255*T.r|0)+","+(255*T.g|0)+","+(255*T.b|0)+","+se()+")",w.fillRect(0,0,t,r)}function ue(e,t){var r=0,n=0,i=255*e.color.r,o=255*e.color.g,a=255*e.color.b,s=new Uint8Array(768);if(t){for(;r<204;)s[n++]=Math.min(r*i/204,255),s[n++]=Math.min(r*o/204,255),s[n++]=Math.min(r*a/204,255),++r;for(;r<256;)s[n++]=Math.min(i+(r-204)*(255-i)/82,255),s[n++]=Math.min(o+(r-204)*(255-o)/82,255),s[n++]=Math.min(a+(r-204)*(255-a)/82,255),++r}else for(;r<256;)s[n++]=Math.min(r*i/255,255),s[n++]=Math.min(r*o/255,255),s[n++]=Math.min(r*a/255,255),++r;return s}function le(e,t,r,n,i,o,a,s,c){var u=4*r,l=M[c.map.id];if(l.data){var h=l.width,d=c.transparent,f=h-1,p=l.data,m=4*((o*h&f)*h+(i*h&f));if(d){var v=p[m],g=p[m+1],y=p[m+2],b=p[m+3]*c.opacity/255,x=e[u],w=e[u+1],_=e[u+2];e[u]=v*b+x*(1-b),e[u+1]=g*b+w*(1-b),e[u+2]=y*b+_*(1-b),e[u+3]=(c.opacity<<8)-1,255==e[u+3]&&(t[r]=n)}else e[u]=p[m],e[u+1]=p[m+1],e[u+2]=p[m+2],e[u+3]=(c.opacity<<8)-1,t[r]=n}}function he(e,t,r,n,i,o,a,s,c){var u=4*r,l=M[c.map.id];if(l.data){var h=l.width,d=c.transparent,f=3*(a>0?~~a:0),p=h-1,m=l.data,v=4*((o*h&p)*h+(i*h&p));if(d){var g=c.palette[f]*m[v],y=c.palette[f+1]*m[v+1],b=c.palette[f+2]*m[v+2],x=m[v+3]*c.opacity/256,w=e[u],_=e[u+1],S=e[u+2];e[u]=g*x+w*(1-x),e[u+1]=y*x+_*(1-x),e[u+2]=b*x+S*(1-x),e[u+3]=(c.opacity<<8)-1,255==e[u+3]&&(t[r]=n)}else e[u]=c.palette[f]*m[v]>>8,e[u+1]=c.palette[f+1]*m[v+1]>>8,e[u+2]=c.palette[f+2]*m[v+2]>>8,e[u+3]=(c.opacity<<8)-1,t[r]=n}}function de(e){var t=e.id,r=_[t];if(r&&e.map&&!M[e.map.id]&&delete _[t],void 0===_[t]||!0===e.needsUpdate){if(e instanceof cr||e instanceof pn||e instanceof vn||e instanceof Sn)if(e instanceof pn?e.palette||(e.palette=ue(e,!1)):e instanceof vn&&(e.palette||(e.palette=ue(e,!0))),e.map){var n=new mh.Texture;if(n.fromImage(e.map.image),!n.data)return;M[e.map.id]=n,r=e instanceof cr||e instanceof Sn?le:he}else i=e.vertexColors===Z?["var colorOffset = offset * 4;","buffer[ colorOffset ] = face.color.r * 255;","buffer[ colorOffset + 1 ] = face.color.g * 255;","buffer[ colorOffset + 2 ] = face.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"):["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * 255;","buffer[ colorOffset + 1 ] = material.color.g * 255;","buffer[ colorOffset + 2 ] = material.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"),r=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",i);else if(e instanceof ur){var i=["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * (color1.r+color2.r) * 0.5 * 255;","buffer[ colorOffset + 1 ] = material.color.g * (color1.g+color2.g) * 0.5 * 255;","buffer[ colorOffset + 2 ] = material.color.b * (color1.b+color2.b) * 0.5 * 255;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");r=new Function("buffer, depthBuf, offset, depth, color1, color2, material",i)}else{i=["var colorOffset = offset * 4;","buffer[ colorOffset ] = u * 255;","buffer[ colorOffset + 1 ] = v * 255;","buffer[ colorOffset + 2 ] = 0;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");r=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",i)}_[t]=r,e.needsUpdate=!1}return r}function fe(e,i,d,m,v,b,w,_,M){if(!(e.z<-1||e.z>1||i.z<-1||i.z>1||d.z<-1||d.z>1)){var T=1<<L,A=e.x*o+u|0,R=i.x*o+u|0,I=d.x*o+u|0,D=e.y*a+l|0,F=i.y*a+l|0,z=d.y*a+l|0,V=_.vertexNormalsModel&&_.vertexNormalsModel.length,G=m&&v&&b,W=Math.max(Math.sqrt((A-R)*(A-R)+(D-F)*(D-F)),Math.sqrt((R-I)*(R-I)+(F-z)*(F-z)),Math.sqrt((I-A)*(I-A)+(z-D)*(z-D)));if(!(_ instanceof ch)&&W>100*T){var H,X,q,Y,J,Q,Z,K,$,ae,se={vertexNormalsModel:[],color:_.color};if(G)oe===ie.length?(H=new x,ie.push(H),++oe,X=new x,ie.push(X),++oe,q=new x,ie.push(q),++oe):(H=ie[oe],X=ie[++oe],q=ie[++oe],++oe),Y=(1+i.z)*(i.w/e.w)/(1+e.z),H.copy(m).multiplyScalar(Y).add(v).multiplyScalar(1/(Y+1)),Y=(1+d.z)*(d.w/i.w)/(1+i.z),X.copy(v).multiplyScalar(Y).add(b).multiplyScalar(1/(Y+1)),Y=(1+e.z)*(e.w/d.w)/(1+d.z),q.copy(b).multiplyScalar(Y).add(m).multiplyScalar(1/(Y+1));return te===ee.length?(J=new S,ee.push(J),++te,Q=new S,ee.push(Q),++te,Z=new S,ee.push(Z),++te):(J=ee[te],Q=ee[++te],Z=ee[++te],++te),J.copy(e).add(i).multiplyScalar(.5),Q.copy(i).add(d).multiplyScalar(.5),Z.copy(d).add(e).multiplyScalar(.5),V&&(ne===re.length?(K=new s,re.push(K),++ne,$=new s,re.push($),++ne,ae=new s,re.push(ae),++ne):(K=re[ne],$=re[++ne],ae=re[++ne],++ne),K.copy(_.vertexNormalsModel[0]).add(_.vertexNormalsModel[1]).normalize(),$.copy(_.vertexNormalsModel[1]).add(_.vertexNormalsModel[2]).normalize(),ae.copy(_.vertexNormalsModel[2]).add(_.vertexNormalsModel[0]).normalize()),V&&(se.vertexNormalsModel[0]=_.vertexNormalsModel[0],se.vertexNormalsModel[1]=K,se.vertexNormalsModel[2]=ae),fe(e,J,Z,m,H,q,w,se,M),V&&(se.vertexNormalsModel[0]=_.vertexNormalsModel[1],se.vertexNormalsModel[1]=$,se.vertexNormalsModel[2]=K),fe(i,Q,J,v,X,H,w,se,M),V&&(se.vertexNormalsModel[0]=K,se.vertexNormalsModel[1]=$,se.vertexNormalsModel[2]=ae),fe(J,Q,Z,H,X,q,w,se,M),V&&(se.vertexNormalsModel[0]=_.vertexNormalsModel[2],se.vertexNormalsModel[1]=ae,se.vertexNormalsModel[2]=$),void fe(d,Z,Q,b,q,X,w,se,M)}var ce,ue,le,he,de,pe,ve,ge,ye,be,xe,we,_e=e.z*c+h|0,Se=i.z*c+h|0,Me=d.z*c+h|0;G=!1;m&&v&&b&&(G=!0,ce=m.x,ue=1-m.y,le=v.x,he=1-v.y,de=b.x,pe=1-b.y),V&&(ve=_.vertexNormalsModel[0],ge=_.vertexNormalsModel[1],ye=_.vertexNormalsModel[2],be=255*ve.z,xe=255*ge.z,we=255*ye.z);var Te=A-R,Ae=F-D,Ee=R-I,Ce=z-F,Le=I-A,Pe=D-z,Oe=Math.max(Math.min(A,R,I)+P>>L,0),Ne=Math.min(Math.max(A,R,I)+P>>L,t),Re=Math.max(Math.min(D,F,z)+P>>L,0),Ie=Math.min(Math.max(D,F,z)+P>>L,r);U=Math.min(Oe,U),B=Math.max(Ne,B),k=Math.min(Re,k),j=Math.max(Ie,j);var De=N,Fe=(Oe&=~(De-1))<<L,Ue=(Re&=~(De-1))<<L,ke=Ae*(Fe-A)+Te*(Ue-D),Be=Ce*(Fe-R)+Ee*(Ue-F),ze=Pe*(Fe-I)+Le*(Ue-z);(Ae>0||0==Ae&&Te>0)&&ke++,(Ce>0||0==Ce&&Ee>0)&&Be++,(Pe>0||0==Pe&&Le>0)&&ze++,ke=ke-1>>L,Be=Be-1>>L,ze=ze-1>>L;var je,Ve,Ge,We,He,Xe=_e-Se,qe=Me-_e,Ye=1/(Te*Pe-Le*Ae),Je=Ye*(Xe*Pe-qe*Ae),Qe=Ye*(Xe*Le-Te*qe),Ze=_e+(Fe-A)*Je+(Ue-D)*Qe|0;if(Je=Je*T|0,Qe=Qe*T|0,G){var Ke=ce-le,$e=de-ce,et=Ye*(Ke*Pe-$e*Ae),tt=Ye*(Ke*Le-Te*$e),rt=ue-he,nt=pe-ue;Ge=ce+(Fe-A)*et+(Ue-D)*tt,We=ue+(Fe-A)*(je=Ye*(rt*Pe-nt*Ae))+(Ue-D)*(Ve=Ye*(rt*Le-Te*nt)),et*=T,tt*=T,je*=T,Ve*=T}if(V){var it,ot=be-xe,at=we-be,st=Ye*(ot*Pe-at*Ae);He=be+(Fe-A)*st+(Ue-D)*(it=Ye*(ot*Le-Te*at)),st*=T,it*=T}var ct=De-1,ut=0,lt=0,ht=0,dt=0,ft=0,pt=0,mt=0,vt=0;Te>=0?lt-=ct*Te:ut-=ct*Te,Ae>=0?lt-=ct*Ae:ut-=ct*Ae,Ee>=0?dt-=ct*Ee:ht-=ct*Ee,Ce>=0?dt-=ct*Ce:ht-=ct*Ce,Le>=0?pt-=ct*Le:ft-=ct*Le,Pe>=0?pt-=ct*Pe:ft-=ct*Pe,Je>=0?vt+=ct*Je:mt+=ct*Je,Qe>=0?vt+=ct*Qe:mt+=ct*Qe;var gt,yt,bt,xt=t-De,wt=ke,_t=Be,St=ze,Mt=Ze,Tt=-De,At=Tt*Ae,Et=Tt*Ce,Ct=Tt*Pe,Lt=Tt*Je;G&&(gt=Tt*et,yt=Tt*je),V&&(bt=Tt*st);for(var Pt=Oe,Ot=Re;Ot<Ie;Ot+=De){for(;Pt>=Oe&&Pt<Ne&&wt>=lt&&_t>=dt&&St>=pt;)Pt+=Tt,wt+=At,_t+=Et,St+=Ct,Mt+=Lt,G&&(Ge+=gt,We+=yt),V&&(He+=bt);for(Tt=-Tt,At=-At,Et=-Et,Ct=-Ct,Lt=-Lt,G&&(gt=-gt,yt=-yt),V&&(bt=-bt);Pt+=Tt,wt+=At,_t+=Et,St+=Ct,Mt+=Lt,G&&(Ge+=gt,We+=yt),V&&(He+=bt),!(Pt<Oe||Pt>=Ne);)if(wt<lt){if(At<0)break}else if(_t<dt){if(Et<0)break}else if(St<pt){if(Ct<0)break}else{var Nt=Pt>>O,Rt=Ot>>O,It=Nt+Rt*n,Dt=Mt+mt;if(!(g[It]<Dt)){var Ft=y[It];Ft&C&&me(Nt,Rt),y[It]=Ft&~(E|C);var Ut=Pt+Ot*t;if(wt>=ut&&_t>=ht&&St>=ft){var kt=Mt+vt;g[It]=Math.min(g[It],kt);var Bt=wt,zt=_t,jt=Mt;G&&(qt=Ge,Yt=We),V&&(Jt=He);for(var Vt=0;Vt<De;Vt++){var Gt=Bt,Wt=zt,Ht=jt;G&&(Zt=qt,Kt=Yt),V&&($t=Jt);for(var Xt=0;Xt<De;Xt++){(tr=Ht)<p[Ut]&&w(f,p,Ut,tr,Zt,Kt,$t,_,M),Gt+=Ae,Wt+=Ce,Ht+=Je,G&&(Zt+=et,Kt+=je),V&&($t+=st),Ut++}Bt+=Te,zt+=Ee,jt+=Qe,G&&(qt+=tt,Yt+=Ve),V&&(Jt+=it),Ut+=xt}}else{Bt=wt,zt=_t;var qt,Yt,Jt,Qt=St;jt=Mt;G&&(qt=Ge,Yt=We),V&&(Jt=He);for(Vt=0;Vt<De;Vt++){Gt=Bt,Wt=zt;var Zt,Kt,$t,er=Qt;Ht=jt;G&&(Zt=qt,Kt=Yt),V&&($t=Jt);for(Xt=0;Xt<De;Xt++){var tr;if((Gt|Wt|er)>=0)(tr=Ht)<p[Ut]&&w(f,p,Ut,tr,Zt,Kt,$t,_,M);Gt+=Ae,Wt+=Ce,er+=Pe,Ht+=Je,G&&(Zt+=et,Kt+=je),V&&($t+=st),Ut++}Bt+=Te,zt+=Ee,Qt+=Le,jt+=Qe,G&&(qt+=tt,Yt+=Ve),V&&(Jt+=it),Ut+=xt}}}}wt+=De*Te,_t+=De*Ee,St+=De*Le,Mt+=De*Qe,G&&(Ge+=De*tt,We+=De*Ve),V&&(He+=De*it)}}}function pe(e,i,s,d,m,v){if(I||(I=!0,N=1<<(O=0),ae.setSize(b.width,b.height)),!(e.z<-1||e.z>1||i.z<-1||i.z>1)){var x=Math.floor(.5*(v.linewidth-1)),w=e.x*o+u|0,_=i.x*o+u|0,S=e.y*a+l|0,M=i.y*a+l|0,T=e.z*c+h|0,A=i.z*c+h|0,R=w-_,z=S-M,V=T-A,G=Math.max(Math.min(w,_)+P>>L,0),W=Math.min(Math.max(w,_)+P>>L,t),H=Math.max(Math.min(S,M)+P>>L,0),X=Math.min(Math.max(S,M)+P>>L,r),q=Math.max(Math.min(T,A)+P>>L,0),Y=Math.max(T,A)+P>>L;U=Math.min(G,U),B=Math.max(W,B),k=Math.min(H,k),j=Math.max(X,j);var J,Q,Z,K,$,ee=Math.sqrt(z*z+R*R),te=R/ee,re=z/ee,ne=V/ee;for(F.set(te,re,ne),F.cross(D),F.normalize();ee>0;){J=(J=_+ee*te)+P>>L,Q=(Q=M+ee*re)+P>>L,$=A+ee*ne+P>>L;for(var ie=-x;ie<=x;++ie)if(Z=Math.floor(J+F.x*ie),K=Math.floor(Q+F.y*ie),!(U>=Z||B<=Z||k>=K||j<=K)){var oe=Z>>O,se=K>>O,ce=oe+se*n;if(!(g[ce]<q)){g[ce]=Math.min(g[ce],Y);var ue=y[ce];ue&C&&me(oe,se),y[ce]=ue&~(E|C);var le=Z+K*t;$<p[le]&&m(f,p,le,$,s,d,v)}}--ee}}}function me(e,r){for(var n=e*N+r*N*t,i=4*n,o=t-N,a=4*o,s=0;s<N;s++){for(var c=0;c<N;c++)p[n++]=R,f[i++]=255*T.r|0,f[i++]=255*T.g|0,f[i++]=255*T.b|0,f[i++]=255*se()|0;n+=o,i+=a}}this.domElement=b,this.autoClear=!0,this.setClearColor=function(e,t){T.set(e),A=t,ce(T)},this.setPixelRatio=function(){},this.setSize=function(e,s){n=Math.floor(e/N),i=Math.floor(s/N);var v=1<<L;o=v*(t=n*N)/2,a=-v*(r=i*N)/2,c=R/2,u=v*t/2+.5,l=v*r/2+.5,h=R/2+.5,b.width=t,b.height=r,d=w.getImageData(0,0,t,r),f=d.data,p=new Int32Array(f.length/4),m=n*i,g=new Int32Array(m),y=new Uint8Array(m);for(var x=0,_=p.length;x<_;x++)p[x]=R;for(x=0;x<m;x++)y[x]=E;ce(T)},this.clear=function(){U=1/0,k=1/0,B=0,j=0,te=0,ne=0,oe=0;for(var e=0;e<m;e++)g[e]=R,y[e]=y[e]&E?E:C},this.render=function(e,t){this.clear();var r=e.background;r&&r.isColor&&ce(r);for(var o=X.projectScene(e,t,!1,!1).elements,a=0,s=o.length;a<s;a++){var c=o[a],u=c.material;if(f=de(u))if(c instanceof oh)c.uvs?fe(c.v1.positionScreen,c.v2.positionScreen,c.v3.positionScreen,c.uvs[0],c.uvs[1],c.uvs[2],f,c,u):fe(c.v1.positionScreen,c.v2.positionScreen,c.v3.positionScreen,null,null,null,f,c,u);else if(c instanceof ch){var l=.5*c.scale.x,h=.5*c.scale.y;q.copy(c),q.x-=l,q.y+=h,Y.copy(c),Y.x-=l,Y.y-=h,J.copy(c),J.x+=l,J.y+=h,u.map?(Q.set(0,1),K.set(0,0),$.set(1,1),fe(q,Y,J,Q,K,$,f,c,u)):fe(q,Y,J,null,null,null,f,c,u),q.copy(c),q.x+=l,q.y+=h,Y.copy(c),Y.x-=l,Y.y-=h,J.copy(c),J.x+=l,J.y-=h,u.map?(Q.set(1,1),K.set(0,0),$.set(1,0),fe(q,Y,J,Q,K,$,f,c,u)):fe(q,Y,J,null,null,null,f,c,u)}else if(c instanceof sh){var f=de(u);pe(c.v1.positionScreen,c.v2.positionScreen,c.vertexColors[0],c.vertexColors[1],f,u)}}!function(){for(var e=0,t=0;t<i;t++)for(var r=0;r<n;r++)y[e]&C&&(me(r,t),y[e]=E),e++}();var p=Math.min(U,V),m=Math.min(k,G),v=Math.max(B,W)-p,g=Math.max(j,H)-m;p!==1/0&&w.putImageData(d,0,0,p,m,v,g),V=U,G=k,W=B,H=j}};mh.Texture=function(){var e;this.fromImage=function(t){if(!(!t||t.width<=0||t.height<=0)){void 0===e&&(e=document.createElement("canvas"));var r=t.width>t.height?t.width:t.height;r=o.ceilPowerOfTwo(r),e.width==r&&e.height==r||(e.width=r,e.height=r);var n=e.getContext("2d");n.clearRect(0,0,r,r),n.drawImage(t,0,0,r,r);var i=n.getImageData(0,0,r,r);this.data=i.data,this.width=r,this.height=r,this.srcUrl=t.src}}};var vh=function(e){p.call(this),this.node=e};(vh.prototype=Object.create(p.prototype)).constructor=vh;function gh(){var e=null,t=!1,r=null;function n(i,o){!1!==t&&(r(i,o),e.requestAnimationFrame(n))}return{start:function(){!0!==t&&null!==r&&(e.requestAnimationFrame(n),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function yh(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=t.get(r);n&&(e.deleteBuffer(n.buffer),t.delete(r))},update:function(r,n){r.isInterleavedBufferAttribute&&(r=r.data);var i=t.get(r);void 0===i?t.set(r,function(t,r){var n=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,n,i),t.onUploadCallback();var a=e.FLOAT;return n instanceof Float32Array?a=e.FLOAT:n instanceof Float64Array?console.warn("WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=e.UNSIGNED_SHORT:n instanceof Int16Array?a=e.SHORT:n instanceof Uint32Array?a=e.UNSIGNED_INT:n instanceof Int32Array?a=e.INT:n instanceof Int8Array?a=e.BYTE:n instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(r,n)):i.version<r.version&&(function(t,r,n){var i=r.array,o=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(n,0,i):0===o.count?console.error("WebGLObjects.updateBuffer: dynamic BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,r,n),i.version=r.version)}}}function bh(e,t,r,n){var i,o,a,s=new v(0),c=0;function u(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),u(s,c=void 0!==t?t:1)},getClearAlpha:function(){return c},setClearAlpha:function(e){u(s,c=e)},render:function(t,n,l,h){var d=n.background;null===d?u(s,c):d&&d.isColor&&(u(d,1),h=!0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&d.isCubeTexture?(void 0===a&&((a=new dr(new Ur(1,1,1),new Xr({uniforms:Li.cube.uniforms,vertexShader:Li.cube.vertexShader,fragmentShader:Li.cube.fragmentShader,side:Y,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},r.update(a)),a.material.uniforms.tCube.value=d,t.push(a,a.geometry,a.material,0,null)):d&&d.isTexture&&(void 0===i&&(i=new Yr(-1,1,1,-1,0,1),o=new dr(new en(2,2),new cr({depthTest:!1,depthWrite:!1,fog:!1})),r.update(o)),o.material.map=d,e.renderBufferDirect(i,null,o.geometry,o.material,o,null))}}}function xh(e,t,r,n){var i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i)},this.renderInstances=function(o,a,s){var c;if(n.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[n.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),r.update(s,i,o.maxInstancedCount)}}function wh(e,t,r){var n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==r.precision?r.precision:"highp",s=i(a);s!==a&&(console.warn("WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===r.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==n)return n;var r=t.get("EXT_texture_filter_anisotropic");return n=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y}}function _h(){var e=this,t=null,r=0,n=!1,i=!1,o=new On,a=new d,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,r,n,i){var c=null!==t?t.length:0,u=null;if(0!==c){if(u=s.value,!0!==i||null===u){var l=n+4*c,h=r.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<l)&&(u=new Float32Array(l));for(var d=0,f=n;d!==c;++d,f+=4)o.copy(t[d]).applyMatrix4(h,a),o.normal.toArray(u,f),u[f+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=c,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==r||n;return n=i,t=u(e,o,0),r=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,o,a,l,h,d){if(!n||null===e||0===e.length||i&&!a)i?u(null):c();else{var f=i?0:r,p=4*f,m=h.clippingState||null;s.value=m,m=u(e,l,p,d);for(var v=0;v!==p;++v)m[v]=t[v];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}}function Sh(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return null===n&&console.warn("WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}function Mh(e,t,r){var n={},i={};function o(e){var a=e.target,s=n[a.id];for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);a.removeEventListener("dispose",o),delete n[a.id];var u=i[s.id];u&&(t.remove(u),delete i[s.id]),r.memory.geometries--}return{get:function(e,t){var i=n[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new U).setFromObject(e)),i=t._bufferGeometry),n[t.id]=i,r.memory.geometries++,i)},update:function(r){var n=r.index,i=r.attributes;for(var o in null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=r.morphAttributes;for(var o in a)for(var s=a[o],c=0,u=s.length;c<u;c++)t.update(s[c],e.ARRAY_BUFFER)},getWireframeAttribute:function(r){var n=i[r.id];if(n)return n;var o,a=[],s=r.index,c=r.attributes;if(null!==s)for(var u=0,l=(o=s.array).length;u<l;u+=3){var h=o[u+0],d=o[u+1],f=o[u+2];a.push(h,d,d,f,f,h)}else for(u=0,l=(o=c.position.array).length/3-1;u<l;u+=3)h=u+0,d=u+1,f=u+2,a.push(h,d,d,f,f,h);return n=new(D(a)>65535?O:L)(a,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}}}function Th(e,t,r,n){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,o,t*a),r.update(n,i)},this.renderInstances=function(s,c,u){var l;if(n.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLIndexedBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[n.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,o,c*a,s.maxInstancedCount),r.update(u,i,s.maxInstancedCount)}}function Ah(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,n,i){switch(i=i||1,t.calls++,n){case e.TRIANGLES:t.triangles+=i*(r/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:t.triangles+=i*(r-2);break;case e.LINES:t.lines+=i*(r/2);break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r;break;default:console.error("WebGLInfo: Unknown draw mode:",n)}}}}function Eh(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ch(e){var t={},r=new Float32Array(8);return{update:function(n,i,o,a){var s=n.morphTargetInfluences,c=s.length,u=t[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];t[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++)0!==(f=u[l])[1]&&(h&&i.removeAttribute("morphTarget"+l),d&&i.removeAttribute("morphNormal"+l));for(l=0;l<c;l++)(f=u[l])[0]=l,f[1]=s[l];for(u.sort(Eh),l=0;l<8;l++){var f;if(f=u[l]){var p=f[0],m=f[1];if(m){h&&i.addAttribute("morphTarget"+l,h[p]),d&&i.addAttribute("morphNormal"+l,d[p]),r[l]=m;continue}}r[l]=0}a.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function Lh(e,t){var r={};return{update:function(n){var i=t.render.frame,o=n.geometry,a=e.get(n,o);return r[a.id]!==i&&(o.isGeometry&&a.updateFromObject(n),e.update(a),r[a.id]=i),a},dispose:function(){r={}}}}var Ph=new Zr,Oh=new Xo;function Nh(){this.seq=[],this.map={}}var Rh=[],Ih=[],Dh=new Float32Array(16),Fh=new Float32Array(9),Uh=new Float32Array(4);function kh(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,o=Rh[i];if(void 0===o&&(o=new Float32Array(i),Rh[i]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=r,e[a].toArray(o,s)}return o}function Bh(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function zh(e,t){for(var r=0,n=t.length;r<n;r++)e[r]=t[r]}function jh(e,t){var r=Ih[t];void 0===r&&(r=new Int32Array(t),Ih[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocTextureUnit();return r}function Vh(e,t){var r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function Gh(e,t){var r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Wh(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Bh(r,t))return;e.uniform2fv(this.addr,t),zh(r,t)}}function Hh(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Bh(r,t))return;e.uniform3fv(this.addr,t),zh(r,t)}}function Xh(e,t){var r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Bh(r,t))return;e.uniform4fv(this.addr,t),zh(r,t)}}function qh(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(Bh(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),zh(r,t)}else{if(Bh(r,n))return;Uh.set(n),e.uniformMatrix2fv(this.addr,!1,Uh),zh(r,n)}}function Yh(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(Bh(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),zh(r,t)}else{if(Bh(r,n))return;Fh.set(n),e.uniformMatrix3fv(this.addr,!1,Fh),zh(r,n)}}function Jh(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(Bh(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),zh(r,t)}else{if(Bh(r,n))return;Dh.set(n),e.uniformMatrix4fv(this.addr,!1,Dh),zh(r,n)}}function Qh(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2D(t||Ph,i)}function Zh(e,t,r){var n=this.cache,i=r.allocTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||Oh,i)}function Kh(e,t){var r=this.cache;Bh(r,t)||(e.uniform2iv(this.addr,t),zh(r,t))}function $h(e,t){var r=this.cache;Bh(r,t)||(e.uniform3iv(this.addr,t),zh(r,t))}function ed(e,t){var r=this.cache;Bh(r,t)||(e.uniform4iv(this.addr,t),zh(r,t))}function td(e,t){var r=this.cache;Bh(r,t)||(e.uniform1fv(this.addr,t),zh(r,t))}function rd(e,t){var r=this.cache;Bh(r,t)||(e.uniform1iv(this.addr,t),zh(r,t))}function nd(e,t){var r=this.cache,n=kh(t,this.size,2);Bh(r,n)||(e.uniform2fv(this.addr,n),this.updateCache(n))}function id(e,t){var r=this.cache,n=kh(t,this.size,3);Bh(r,n)||(e.uniform3fv(this.addr,n),this.updateCache(n))}function od(e,t){var r=this.cache,n=kh(t,this.size,4);Bh(r,n)||(e.uniform4fv(this.addr,n),this.updateCache(n))}function ad(e,t){var r=this.cache,n=kh(t,this.size,4);Bh(r,n)||(e.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function sd(e,t){var r=this.cache,n=kh(t,this.size,9);Bh(r,n)||(e.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function cd(e,t){var r=this.cache,n=kh(t,this.size,16);Bh(r,n)||(e.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function ud(e,t,r){var n=this.cache,i=t.length,o=jh(r,i);!1===Bh(n,o)&&(e.uniform1iv(this.addr,o),zh(n,o));for(var a=0;a!==i;++a)r.setTexture2D(t[a]||Ph,o[a])}function ld(e,t,r){var n=this.cache,i=t.length,o=jh(r,i);!1===Bh(n,o)&&(e.uniform1iv(this.addr,o),zh(n,o));for(var a=0;a!==i;++a)r.setTextureCube(t[a]||Oh,o[a])}function hd(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Vh;case 35664:return Wh;case 35665:return Hh;case 35666:return Xh;case 35674:return qh;case 35675:return Yh;case 35676:return Jh;case 35678:case 36198:return Qh;case 35680:return Zh;case 5124:case 35670:return Gh;case 35667:case 35671:return Kh;case 35668:case 35672:return $h;case 35669:case 35673:return ed}}(t.type)}function dd(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return td;case 35664:return nd;case 35665:return id;case 35666:return od;case 35674:return ad;case 35675:return sd;case 35676:return cd;case 35678:return ud;case 35680:return ld;case 5124:case 35670:return rd;case 35667:case 35671:return Kh;case 35668:case 35672:return $h;case 35669:case 35673:return ed}}(t.type)}function fd(e){this.id=e,Nh.call(this)}dd.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),zh(t,e)},fd.prototype.setValue=function(e,t,r){for(var n=this.seq,i=0,o=n.length;i!==o;++i){var a=n[i];a.setValue(e,t[a.id],r)}};var pd=/([\w\d_]+)(\])?(\[|\.)?/g;function md(e,t){e.seq.push(t),e.map[t.id]=t}function vd(e,t,r){var n=e.name,i=n.length;for(pd.lastIndex=0;;){var o=pd.exec(n),a=pd.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){md(r,void 0===u?new hd(s,e,t):new dd(s,e,t));break}var l=r.map[s];void 0===l&&md(r,l=new fd(s)),r=l}}function gd(e,t,r){Nh.call(this),this.renderer=r;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=e.getActiveUniform(t,i);vd(o,e.getUniformLocation(t,o.name),this)}}function yd(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(r)),n}gd.prototype.setValue=function(e,t,r){var n=this.map[t];void 0!==n&&n.setValue(e,r,this.renderer)},gd.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},gd.upload=function(e,t,r,n){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},gd.seqWithValue=function(e,t){for(var r=[],n=0,i=e.length;n!==i;++n){var o=e[n];o.id in t&&r.push(o)}return r};var bd=0;function xd(e){switch(e){case Jt:return["Linear","( value )"];case Qt:return["sRGB","( value )"];case Kt:return["RGBE","( value )"];case $t:return["RGBM","( value, 7.0 )"];case er:return["RGBM","( value, 16.0 )"];case tr:return["RGBD","( value, 256.0 )"];case Zt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function wd(e,t){var r=xd(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function _d(e){return""!==e}function Sd(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Md(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Td(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){var r=Ei[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Td(r)})}function Ad(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){for(var i="",o=parseInt(t);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Ed(e,t,r,n,i,o,a){var s=e.context,c=n.defines,u=i.vertexShader,l=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===H?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===X&&(h="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case ke:case Be:d="ENVMAP_TYPE_CUBE";break;case Ge:case We:d="ENVMAP_TYPE_CUBE_UV";break;case ze:case je:d="ENVMAP_TYPE_EQUIREC";break;case Ve:d="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case Be:case je:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case Le:p="ENVMAP_BLENDING_MULTIPLY";break;case Pe:p="ENVMAP_BLENDING_MIX";break;case Oe:p="ENVMAP_BLENDING_ADD"}}var m,v,g=e.gammaFactor>0?e.gammaFactor:1,y=a.isWebGL2?"":function(e,t,r){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_d).join("\n")}(n.extensions,o,t),b=function(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(c),x=s.createProgram();if(n.isRawShaderMaterial?((m=[b].filter(_d).join("\n")).length>0&&(m+="\n"),(v=[y,b].filter(_d).join("\n")).length>0&&(v+="\n")):(m=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(_d).join("\n"),v=[y,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.envMap?"#define "+f:"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==Ne?"#define TONE_MAPPING":"",o.toneMapping!==Ne?Ei.tonemapping_pars_fragment:"",o.toneMapping!==Ne?function(e,t){var r;switch(t){case Re:r="Linear";break;case Ie:r="Reinhard";break;case De:r="Uncharted2";break;case Fe:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Ei.encodings_pars_fragment:"",o.mapEncoding?wd("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?wd("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?wd("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(e,t){var r=xd(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(_d).join("\n")),u=Md(u=Sd(u=Td(u),o),o),l=Md(l=Sd(l=Td(l),o),o),u=Ad(u),l=Ad(l),a.isWebGL2&&!n.isRawShaderMaterial){var w=!1,_=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(_)&&null!==l.match(_)&&(w=!0,u=u.replace(_,""),l=l.replace(_,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#version 300 es\n","#define varying in",w?"":"out highp vec4 pc_fragColor;",w?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v}var S=m+u,M=v+l,T=yd(s,s.VERTEX_SHADER,S),A=yd(s,s.FRAGMENT_SHADER,M);s.attachShader(x,T),s.attachShader(x,A),void 0!==n.index0AttributeName?s.bindAttribLocation(x,0,n.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);var E,C,L=s.getProgramInfoLog(x).trim(),P=s.getShaderInfoLog(T).trim(),O=s.getShaderInfoLog(A).trim(),N=!0,R=!0;return!1===s.getProgramParameter(x,s.LINK_STATUS)?(N=!1,console.error("WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(x,s.VALIDATE_STATUS),"gl.getProgramInfoLog",L,P,O)):""!==L?console.warn("WebGLProgram: gl.getProgramInfoLog()",L):""!==P&&""!==O||(R=!1),R&&(this.diagnostics={runnable:N,material:n,programLog:L,vertexShader:{log:P,prefix:m},fragmentShader:{log:O,prefix:v}}),s.deleteShader(T),s.deleteShader(A),this.getUniforms=function(){return void 0===E&&(E=new gd(s,x,e)),E},this.getAttributes=function(){return void 0===C&&(C=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=e.getActiveAttrib(t,i).name;r[o]=e.getAttribLocation(t,o)}return r}(s,x)),C},this.destroy=function(){s.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=bd++,this.code=r,this.usedTimes=1,this.program=x,this.vertexShader=T,this.fragmentShader=A,this}function Cd(e,t,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=Jt,r===Jt&&t&&(r=Zt),r}this.getParameters=function(t,n,o,s,c,u,l){var h=i[t.type],d=l.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(l):0,f=r.precision;null!==t.precision&&(f=r.getMaxPrecision(t.precision))!==t.precision&&console.warn("WebGLProgram.getParameters:",t.precision,"not supported, using",f,"instead.");var p=e.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:r.vertexTextures,outputEncoding:a(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===Ge||t.envMap.mapping===We),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===or,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&d>0,maxBones:d,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:c,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===J,flipSided:t.side===Y,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var a=0;a<o.length;a++)n.push(r[o[a]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.join()},this.acquireProgram=function(i,o,a,s){for(var c,u=0,l=n.length;u<l;u++){var h=n[u];if(h.code===s){++(c=h).usedTimes;break}}return void 0===c&&(c=new Ed(e,t,s,i,o,a,r),n.push(c)),c},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},this.programs=n}function Ld(){var e=new WeakMap;return{get:function(t){var r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function Pd(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Od(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Nd(){var e={};return{get:function(t,r){var n=t.id+","+r.id,i=e[n];return void 0===i&&(i=new function(){var e=[],t=0,r=[],n=[];return{opaque:r,transparent:n,init:function(){t=0,r.length=0,n.length=0},push:function(i,o,a,s,c){var u=e[t];void 0===u?(u={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:c},e[t]=u):(u.id=i.id,u.object=i,u.geometry=o,u.material=a,u.program=a.program,u.renderOrder=i.renderOrder,u.z=s,u.group=c),(!0===a.transparent?n:r).push(u),t++},sort:function(){r.length>1&&r.sort(Pd),n.length>1&&n.sort(Od)}}},e[n]=i),i},dispose:function(){e={}}}}var Rd=0;function Id(){var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new s,color:new v,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new x};break;case"SpotLight":r={position:new s,direction:new s,color:new v,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new x};break;case"PointLight":r={position:new s,color:new v,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new x,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new s,skyColor:new v,groundColor:new v};break;case"RectAreaLight":r={color:new v,position:new s,halfWidth:new s,halfHeight:new s}}return e[t.id]=r,r}}},t={id:Rd++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new s,n=new a,i=new a;return{setup:function(o,a,s){for(var c=0,u=0,l=0,h=0,d=0,f=0,p=0,m=0,v=s.matrixWorldInverse,g=0,y=o.length;g<y;g++){var b=o[g],x=b.color,w=b.intensity,_=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)c+=x.r*w,u+=x.g*w,l+=x.b*w;else if(b.isDirectionalLight){if((T=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.shadow=b.castShadow,b.castShadow){var M=b.shadow;T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize}t.directionalShadowMap[h]=S,t.directionalShadowMatrix[h]=b.shadow.matrix,t.directional[h]=T,h++}else if(b.isSpotLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(x).multiplyScalar(w),T.distance=_,T.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(v),T.coneCos=Math.cos(b.angle),T.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),T.decay=0===b.distance?0:b.decay,T.shadow=b.castShadow,b.castShadow&&(M=b.shadow,T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize),t.spotShadowMap[f]=S,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=T,f++;else if(b.isRectAreaLight)(T=e.get(b)).color.copy(x).multiplyScalar(w),T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),i.identity(),n.copy(b.matrixWorld),n.premultiply(v),i.extractRotation(n),T.halfWidth.set(.5*b.width,0,0),T.halfHeight.set(0,.5*b.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),t.rectArea[p]=T,p++;else if(b.isPointLight)(T=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(v),T.color.copy(b.color).multiplyScalar(b.intensity),T.distance=b.distance,T.decay=0===b.distance?0:b.decay,T.shadow=b.castShadow,b.castShadow&&(M=b.shadow,T.shadowBias=M.bias,T.shadowRadius=M.radius,T.shadowMapSize=M.mapSize,T.shadowCameraNear=M.camera.near,T.shadowCameraFar=M.camera.far),t.pointShadowMap[d]=S,t.pointShadowMatrix[d]=b.shadow.matrix,t.point[d]=T,d++;else if(b.isHemisphereLight){var T;(T=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),T.direction.transformDirection(v),T.direction.normalize(),T.skyColor.copy(b.color).multiplyScalar(w),T.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[m]=T,m++}}t.ambient[0]=c,t.ambient[1]=u,t.ambient[2]=l,t.directional.length=h,t.spot.length=f,t.rectArea.length=p,t.point.length=d,t.hemi.length=m,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=d,t.hash.spotLength=f,t.hash.rectAreaLength=p,t.hash.hemiLength=m,t.hash.shadowsLength=a.length},state:t}}function Dd(){var e=new Id,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(n){e.setup(t,r,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function Fd(){var e={};return{get:function(t,r){var n;return void 0===e[t.id]?(n=new Dd,e[t.id]={},e[t.id][r.id]=n):void 0===e[t.id][r.id]?(n=new Dd,e[t.id][r.id]=n):n=e[t.id][r.id],n},dispose:function(){e={}}}}function Ud(e,t,r){for(var n=new nh,i=new a,o=new x,c=new x(r,r),u=new s,l=new s,h=1,d=2,f=1+(h|d),p=new Array(f),m=new Array(f),v={},g={0:Y,1:q,2:J},y=[new s(1,0,0),new s(-1,0,0),new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0)],b=[new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,0,1),new s(0,0,-1)],w=[new S,new S,new S,new S,new S,new S],_=0;_!==f;++_){var M=0!=(_&h),T=0!=(_&d),A=new dn({depthPacking:nr,morphTargets:M,skinning:T});p[_]=A;var E=new fn({morphTargets:M,skinning:T});m[_]=E}var C=this;function L(t,r,n,i,o,a){var s=t.geometry,c=null,u=p,l=t.customDepthMaterial;if(n&&(u=m,l=t.customDistanceMaterial),l)c=l;else{var f=!1;r.morphTargets&&(s&&s.isBufferGeometry?f=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(f=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("WebGLShadowMap: SkinnedMesh with material.skinning set to false:",t);var y=t.isSkinnedMesh&&r.skinning,b=0;f&&(b|=h),y&&(b|=d),c=u[b]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var x=c.uuid,w=r.uuid,_=v[x];void 0===_&&(_={},v[x]=_);var S=_[w];void 0===S&&(S=c.clone(),_[w]=S),c=S}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=null!=r.shadowSide?r.shadowSide:g[r.side],c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=o,c.farDistance=a),c}function P(r,i,o,a){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var s=t.update(r),c=r.material;if(Array.isArray(c))for(var u=s.groups,h=0,d=u.length;h<d;h++){var f=u[h],p=c[f.materialIndex];if(p&&p.visible){var m=L(r,p,a,l,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,f)}}else if(c.visible){m=L(r,c,a,l,o.near,o.far);e.renderBufferDirect(o,null,s,m,r,null)}}for(var v=r.children,g=0,y=v.length;g<y;g++)P(v[g],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=H,this.render=function(t,r,a){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var s,h=e.context,d=e.state;d.disable(h.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var m=t[f],v=m.shadow,g=m&&m.isPointLight;if(void 0!==v){var x=v.camera;if(o.copy(v.mapSize),o.min(c),g){var _=o.x,S=o.y;w[0].set(2*_,S,_,S),w[1].set(0,S,_,S),w[2].set(3*_,S,_,S),w[3].set(_,S,_,S),w[4].set(3*_,0,_,S),w[5].set(_,0,_,S),o.x*=4,o.y*=2}if(null===v.map){var M={minFilter:Ye,magFilter:Ye,format:pt};v.map=new Kr(o.x,o.y,M),v.map.texture.name=m.name+".shadowMap",x.updateProjectionMatrix()}v.isSpotLightShadow&&v.update(m);var T=v.map,A=v.matrix;l.setFromMatrixPosition(m.matrixWorld),x.position.copy(l),g?(s=6,A.makeTranslation(-l.x,-l.y,-l.z)):(s=1,u.setFromMatrixPosition(m.target.matrixWorld),x.lookAt(u),x.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(x.projectionMatrix),A.multiply(x.matrixWorldInverse)),e.setRenderTarget(T),e.clear();for(var E=0;E<s;E++){if(g){u.copy(x.position),u.add(y[E]),x.up.copy(b[E]),x.lookAt(u),x.updateMatrixWorld();var L=w[E];d.viewport(L)}i.multiplyMatrices(x.projectionMatrix,x.matrixWorldInverse),n.setFromMatrix(i),P(r,a,x,g)}}else console.warn("WebGLShadowMap:",m,"has no shadow.")}C.needsUpdate=!1}}}function kd(e,t,r,n){var i=new function(){var t=!1,r=new S,n=null,i=new S(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),r.set(t,n,o,a),!1===i.equals(r)&&(e.clearColor(t,n,o,a),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,r=null,n=null,i=null;return{setTest:function(t){t?z(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case we:e.depthFunc(e.NEVER);break;case _e:e.depthFunc(e.ALWAYS);break;case Se:e.depthFunc(e.LESS);break;case Me:e.depthFunc(e.LEQUAL);break;case Te:e.depthFunc(e.EQUAL);break;case Ae:e.depthFunc(e.GEQUAL);break;case Ee:e.depthFunc(e.GREATER);break;case Ce:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},a=new function(){var t=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(t){t?z(e.STENCIL_TEST):j(e.STENCIL_TEST)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,a){n===t&&i===r&&o===a||(e.stencilFunc(t,r,a),n=t,i=r,o=a)},setOp:function(t,r,n){a===t&&s===r&&c===n||(e.stencilOp(t,r,n),a=t,s=r,c=n)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,r=null,n=null,i=null,o=null,a=null,s=null,c=null,u=null}}},s=e.getParameter(e.MAX_VERTEX_ATTRIBS),c=new Uint8Array(s),u=new Uint8Array(s),l=new Uint8Array(s),h={},d=null,f=null,p=null,m=null,v=null,g=null,y=null,b=null,x=null,w=null,_=!1,M=null,T=null,A=null,E=null,C=null,L=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),P=!1,O=0,N=e.getParameter(e.VERSION);-1!==N.indexOf("WebGL")?(O=parseFloat(/^WebGL\ ([0-9])/.exec(N)[1]),P=O>=1):-1!==N.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(N)[1]),P=O>=2);var R=null,I={},D=new S,F=new S;function U(t,r,n){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<n;a++)e.texImage2D(r+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var k={};function B(r,i){(c[r]=1,0===u[r]&&(e.enableVertexAttribArray(r),u[r]=1),l[r]!==i)&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),l[r]=i)}function z(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function j(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}function H(t,n,i,o,a,s,c,u){if(t!==$){if(p||(z(e.BLEND),p=!0),t===ie)a=a||n,s=s||i,c=c||o,n===v&&a===b||(e.blendEquationSeparate(r.convert(n),r.convert(a)),v=n,b=a),i===g&&o===y&&s===x&&c===w||(e.blendFuncSeparate(r.convert(i),r.convert(o),r.convert(s),r.convert(c)),g=i,y=o,x=s,w=c),m=t,_=null;else if(t!==m||u!==_){if(v===oe&&b===oe||(e.blendEquation(e.FUNC_ADD),v=oe,b=oe),u)switch(t){case ee:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case te:e.blendFunc(e.ONE,e.ONE);break;case re:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case ne:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("WebGLState: Invalid blending: ",t)}else switch(t){case ee:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case te:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case re:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case ne:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("WebGLState: Invalid blending: ",t)}g=null,y=null,x=null,w=null,m=t,_=u}}else p&&(j(e.BLEND),p=!1)}function X(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function q(t){t!==V?(z(e.CULL_FACE),t!==T&&(t===G?e.cullFace(e.BACK):t===W?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),T=t}function Q(t,r,n){t?(z(e.POLYGON_OFFSET_FILL),E===r&&C===n||(e.polygonOffset(r,n),E=r,C=n)):j(e.POLYGON_OFFSET_FILL)}function Z(t){void 0===t&&(t=e.TEXTURE0+L-1),R!==t&&(e.activeTexture(t),R=t)}return k[e.TEXTURE_2D]=U(e.TEXTURE_2D,e.TEXTURE_2D,1),k[e.TEXTURE_CUBE_MAP]=U(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),z(e.DEPTH_TEST),o.setFunc(Me),X(!1),q(G),z(e.CULL_FACE),H($),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=c.length;e<t;e++)c[e]=0},enableAttribute:function(e){B(e,0)},enableAttributeAndDivisor:B,disableUnusedAttributes:function(){for(var t=0,r=u.length;t!==r;++t)u[t]!==c[t]&&(e.disableVertexAttribArray(t),u[t]=0)},enable:z,disable:j,getCompressedTextureFormats:function(){if(null===d&&(d=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)d.push(r[n]);return d},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:H,setMaterial:function(t,r){t.side===J?j(e.CULL_FACE):z(e.CULL_FACE);var n=t.side===Y;r&&(n=!n),X(n),t.blending===ee&&!1===t.transparent?H($):H(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite),Q(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:X,setCullFace:q,setLineWidth:function(t){t!==A&&(P&&e.lineWidth(t),A=t)},setPolygonOffset:Q,setScissorTest:function(t){t?z(e.SCISSOR_TEST):j(e.SCISSOR_TEST)},activeTexture:Z,bindTexture:function(t,r){null===R&&Z();var n=I[R];void 0===n&&(n={type:void 0,texture:void 0},I[R]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||k[t]),n.type=t,n.texture=r)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("WebGLState:",e)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){for(var t=0;t<u.length;t++)1===u[t]&&(e.disableVertexAttribArray(t),u[t]=0);h={},d=null,R=null,I={},f=null,m=null,M=null,T=null,i.reset(),o.reset(),a.reset()}}}function Bd(e,t,r,n,i,a,s){var c,u={};function l(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var r=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height),n}return e}function h(e){return o.isPowerOfTwo(e.width)&&o.isPowerOfTwo(e.height)}function d(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ye&&e.minFilter!==Ze}function f(t,r,i,o){e.generateMipmap(t),n.get(r).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function p(t,r){if(!i.isWebGL2)return t;if(t===e.RGB){if(r===e.FLOAT)return e.RGB32F;if(r===e.HALF_FLOAT)return e.RGB16F;if(r===e.UNSIGNED_BYTE)return e.RGB8}if(t===e.RGBA){if(r===e.FLOAT)return e.RGBA32F;if(r===e.HALF_FLOAT)return e.RGBA16F;if(r===e.UNSIGNED_BYTE)return e.RGBA8}return t}function m(t){return t===Ye||t===Je||t===Qe?e.NEAREST:e.LINEAR}function v(t){var r=t.target;r.removeEventListener("dispose",v),function(t){var r=n.get(t);if(t.image&&r.__image__webglTextureCube)e.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture)}n.remove(t)}(r),r.isVideoTexture&&delete u[r.id],s.memory.textures--}function g(t){var r=t.target;r.removeEventListener("dispose",g),function(t){var r=n.get(t),i=n.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[o]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}(r),s.memory.textures--}function y(t,m){var g=n.get(t);if(t.isVideoTexture&&function(e){var t=e.id,r=s.render.frame;u[t]!==r&&(u[t]=r,e.update())}(t),t.version>0&&g.__version!==t.version){var y=t.image;if(void 0===y)console.warn("WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==y.complete)return void function(t,n,u){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",v),t.__webglTexture=e.createTexture(),s.memory.textures++);r.activeTexture(e.TEXTURE0+u),r.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var m=l(n.image,i.maxTextureSize);(function(e){return!i.isWebGL2&&(e.wrapS!==Xe||e.wrapT!==Xe||e.minFilter!==Ye&&e.minFilter!==Ze)})(n)&&!1===h(m)&&(m=function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===c&&(c=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),c.width=o.floorPowerOfTwo(e.width),c.height=o.floorPowerOfTwo(e.height),c.getContext("2d").drawImage(e,0,0,c.width,c.height),console.warn("WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+c.width+"x"+c.height),c):e}(m));var g=h(m),y=a.convert(n.format),x=a.convert(n.type),w=p(y,x);b(e.TEXTURE_2D,n,g);var _,S=n.mipmaps;if(n.isDepthTexture){if(w=e.DEPTH_COMPONENT,n.type===at){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");w=e.DEPTH_COMPONENT32F}else i.isWebGL2&&(w=e.DEPTH_COMPONENT16);n.format===yt&&w===e.DEPTH_COMPONENT&&n.type!==nt&&n.type!==ot&&(console.warn("WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=nt,x=a.convert(n.type)),n.format===bt&&(w=e.DEPTH_STENCIL,n.type!==ht&&(console.warn("WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=ht,x=a.convert(n.type))),r.texImage2D(e.TEXTURE_2D,0,w,m.width,m.height,0,y,x,null)}else if(n.isDataTexture)if(S.length>0&&g){for(var M=0,T=S.length;M<T;M++)_=S[M],r.texImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,y,x,_.data);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,w,m.width,m.height,0,y,x,m.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(var M=0,T=S.length;M<T;M++)_=S[M],n.format!==pt&&n.format!==ft?r.getCompressedTextureFormats().indexOf(y)>-1?r.compressedTexImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,_.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,M,w,_.width,_.height,0,y,x,_.data);t.__maxMipLevel=S.length-1}else if(S.length>0&&g){for(var M=0,T=S.length;M<T;M++)_=S[M],r.texImage2D(e.TEXTURE_2D,M,w,y,x,_);n.generateMipmaps=!1,t.__maxMipLevel=S.length-1}else r.texImage2D(e.TEXTURE_2D,0,w,y,x,m),t.__maxMipLevel=0;d(n,g)&&f(e.TEXTURE_2D,n,m.width,m.height);t.__version=n.version,n.onUpdate&&n.onUpdate(n)}(g,t,m);console.warn("WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(e.TEXTURE0+m),r.bindTexture(e.TEXTURE_2D,g.__webglTexture)}function b(r,o,s){var c;if(s?(e.texParameteri(r,e.TEXTURE_WRAP_S,a.convert(o.wrapS)),e.texParameteri(r,e.TEXTURE_WRAP_T,a.convert(o.wrapT)),e.texParameteri(r,e.TEXTURE_MAG_FILTER,a.convert(o.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,a.convert(o.minFilter))):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),o.wrapS===Xe&&o.wrapT===Xe||console.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to ClampToEdgeWrapping."),e.texParameteri(r,e.TEXTURE_MAG_FILTER,m(o.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,m(o.minFilter)),o.minFilter!==Ye&&o.minFilter!==Ze&&console.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to NearestFilter or LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(o.type===at&&null===t.get("OES_texture_float_linear"))return;if(o.type===st&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(e.texParameterf(r,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function x(t,i,o,s){var c=a.convert(i.texture.format),u=a.convert(i.texture.type),l=p(c,u);r.texImage2D(s,0,l,i.width,i.height,0,c,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,o,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function w(t,r){e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):r.depthBuffer&&r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,r.width,r.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function _(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),y(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===yt)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==bt)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=e.createRenderbuffer(),w(r.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),w(r.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=y,this.setTextureCube=function(t,o){var c=n.get(t);if(6===t.image.length)if(t.version>0&&c.__version!==t.version){c.__image__webglTextureCube||(t.addEventListener("dispose",v),c.__image__webglTextureCube=e.createTexture(),s.memory.textures++),r.activeTexture(e.TEXTURE0+o),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var u=t&&t.isCompressedTexture,m=t.image[0]&&t.image[0].isDataTexture,g=[],y=0;y<6;y++)g[y]=u||m?m?t.image[y].image:t.image[y]:l(t.image[y],i.maxCubemapSize);var x=g[0],w=h(x),_=a.convert(t.format),S=a.convert(t.type),M=p(_,S);for(b(e.TEXTURE_CUBE_MAP,t,w),y=0;y<6;y++)if(u)for(var T,A=g[y].mipmaps,E=0,C=A.length;E<C;E++)T=A[E],t.format!==pt&&t.format!==ft?r.getCompressedTextureFormats().indexOf(_)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,E,M,T.width,T.height,0,T.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,E,M,T.width,T.height,0,_,S,T.data);else m?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,M,g[y].width,g[y].height,0,_,S,g[y].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,M,_,S,g[y]);c.__maxMipLevel=u?A.length-1:0,d(t,w)&&f(e.TEXTURE_CUBE_MAP,t,x.width,x.height),c.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(e.TEXTURE0+o),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,i){r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var i=n.get(t),o=n.get(t.texture);t.addEventListener("dispose",g),o.__webglTexture=e.createTexture(),s.memory.textures++;var a=!0===t.isWebGLRenderTargetCube,c=h(t);if(a){i.__webglFramebuffer=[];for(var u=0;u<6;u++)i.__webglFramebuffer[u]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(a){for(r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),b(e.TEXTURE_CUBE_MAP,t.texture,c),u=0;u<6;u++)x(i.__webglFramebuffer[u],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+u);d(t.texture,c)&&f(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else r.bindTexture(e.TEXTURE_2D,o.__webglTexture),b(e.TEXTURE_2D,t.texture,c),x(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),d(t.texture,c)&&f(e.TEXTURE_2D,t.texture,t.width,t.height),r.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&_(t)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(d(i,h(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=n.get(i).__webglTexture;r.bindTexture(o,a),f(o,i,t.width,t.height),r.bindTexture(o,null)}}}function zd(e,t,r){return{convert:function(n){var i;if(n===He)return e.REPEAT;if(n===Xe)return e.CLAMP_TO_EDGE;if(n===qe)return e.MIRRORED_REPEAT;if(n===Ye)return e.NEAREST;if(n===Je)return e.NEAREST_MIPMAP_NEAREST;if(n===Qe)return e.NEAREST_MIPMAP_LINEAR;if(n===Ze)return e.LINEAR;if(n===Ke)return e.LINEAR_MIPMAP_NEAREST;if(n===$e)return e.LINEAR_MIPMAP_LINEAR;if(n===et)return e.UNSIGNED_BYTE;if(n===ct)return e.UNSIGNED_SHORT_4_4_4_4;if(n===ut)return e.UNSIGNED_SHORT_5_5_5_1;if(n===lt)return e.UNSIGNED_SHORT_5_6_5;if(n===tt)return e.BYTE;if(n===rt)return e.SHORT;if(n===nt)return e.UNSIGNED_SHORT;if(n===it)return e.INT;if(n===ot)return e.UNSIGNED_INT;if(n===at)return e.FLOAT;if(n===st){if(r.isWebGL2)return e.HALF_FLOAT;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(n===dt)return e.ALPHA;if(n===ft)return e.RGB;if(n===pt)return e.RGBA;if(n===mt)return e.LUMINANCE;if(n===vt)return e.LUMINANCE_ALPHA;if(n===yt)return e.DEPTH_COMPONENT;if(n===bt)return e.DEPTH_STENCIL;if(n===oe)return e.FUNC_ADD;if(n===ae)return e.FUNC_SUBTRACT;if(n===se)return e.FUNC_REVERSE_SUBTRACT;if(n===le)return e.ZERO;if(n===he)return e.ONE;if(n===de)return e.SRC_COLOR;if(n===fe)return e.ONE_MINUS_SRC_COLOR;if(n===pe)return e.SRC_ALPHA;if(n===me)return e.ONE_MINUS_SRC_ALPHA;if(n===ve)return e.DST_ALPHA;if(n===ge)return e.ONE_MINUS_DST_ALPHA;if(n===ye)return e.DST_COLOR;if(n===be)return e.ONE_MINUS_DST_COLOR;if(n===xe)return e.SRC_ALPHA_SATURATE;if((n===xt||n===wt||n===_t||n===St)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(n===xt)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===wt)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===_t)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===St)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Mt||n===Tt||n===At||n===Et)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(n===Mt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Tt)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===At)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Et)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Ct&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((n===Lt||n===Pt||n===Ot||n===Nt||n===Rt||n===It||n===Dt||n===Ft||n===Ut||n===kt||n===Bt||n===zt||n===jt||n===Vt)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return n;if(n===ce||n===ue){if(r.isWebGL2){if(n===ce)return e.MIN;if(n===ue)return e.MAX}if(null!==(i=t.get("EXT_blend_minmax"))){if(n===ce)return i.MIN_EXT;if(n===ue)return i.MAX_EXT}}if(n===ht){if(r.isWebGL2)return e.UNSIGNED_INT_24_8;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function jd(e){Wr.call(this),this.cameras=e||[]}function Vd(e){var t=this,r=null,n=null,o=null,u=[],l=new a,h=new a,d="stage";void 0!==i&&"VRFrameData"in i&&(n=new i.VRFrameData,i.addEventListener("vrdisplaypresentchange",_,!1));var f=new a,p=new c,m=new s,v=new Wr;v.bounds=new S(0,0,.5,1),v.layers.enable(1);var g=new Wr;g.bounds=new S(.5,0,.5,1),g.layers.enable(2);var y,b,x=new jd([v,g]);function w(){return null!==r&&!0===r.isPresenting}function _(){if(w()){var n=r.getEyeParameters("left"),i=n.renderWidth,o=n.renderHeight;b=e.getPixelRatio(),y=e.getSize(),e.setDrawingBufferSize(2*i,o,1),A.start()}else t.enabled&&e.setDrawingBufferSize(y.width,y.height,b),A.stop()}x.layers.enable(1),x.layers.enable(2);var M=[];function T(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0,i=t.length;r<i;r++){var o=t[r];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(n===e)return o;n++}}}this.enabled=!1,this.getController=function(e){var t=u[e];return void 0===t&&((t=new oo).matrixAutoUpdate=!1,t.visible=!1,u[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),A.setContext(e)},this.setFrameOfReferenceType=function(e){d=e},this.setPoseTarget=function(e){void 0!==e&&(o=e)},this.getCamera=function(e){var t="stage"===d?1.6:0;if(null===r)return e.position.set(0,t,0),e;if(r.depthNear=e.near,r.depthFar=e.far,r.getFrameData(n),"stage"===d){var i=r.stageParameters;i?l.fromArray(i.sittingToStandingTransform):l.makeTranslation(0,t,0)}var a=n.pose,s=null!==o?o:e;if(s.matrix.copy(l),s.matrix.decompose(s.position,s.quaternion,s.scale),null!==a.orientation&&(p.fromArray(a.orientation),s.quaternion.multiply(p)),null!==a.position&&(p.setFromRotationMatrix(l),m.fromArray(a.position),m.applyQuaternion(p),s.position.add(m)),s.updateMatrixWorld(),!1===r.isPresenting)return e;v.near=e.near,g.near=e.near,v.far=e.far,g.far=e.far,x.matrixWorld.copy(e.matrixWorld),x.matrixWorldInverse.copy(e.matrixWorldInverse),v.matrixWorldInverse.fromArray(n.leftViewMatrix),g.matrixWorldInverse.fromArray(n.rightViewMatrix),h.getInverse(l),"stage"===d&&(v.matrixWorldInverse.multiply(h),g.matrixWorldInverse.multiply(h));var c=s.parent;null!==c&&(f.getInverse(c.matrixWorld),v.matrixWorldInverse.multiply(f),g.matrixWorldInverse.multiply(f)),v.matrixWorld.getInverse(v.matrixWorldInverse),g.matrixWorld.getInverse(g.matrixWorldInverse),v.projectionMatrix.fromArray(n.leftProjectionMatrix),g.projectionMatrix.fromArray(n.rightProjectionMatrix),x.projectionMatrix.copy(v.projectionMatrix);var y=r.getLayers();if(y.length){var b=y[0];null!==b.leftBounds&&4===b.leftBounds.length&&v.bounds.fromArray(b.leftBounds),null!==b.rightBounds&&4===b.rightBounds.length&&g.bounds.fromArray(b.rightBounds)}return function(){for(var e=0;e<u.length;e++){var t=u[e],r=T(e);if(void 0!==r&&void 0!==r.pose){if(null===r.pose)return;var n=r.pose;!1===n.hasPosition&&t.position.set(.2,-.6,-.05),null!==n.position&&t.position.fromArray(n.position),null!==n.orientation&&t.quaternion.fromArray(n.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(l),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===r.id?0:1;M[e]!==r.buttons[i].pressed&&(M[e]=r.buttons[i].pressed,!0===M[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),x},this.getStandingMatrix=function(){return l},this.isPresenting=w;var A=new gh;this.setAnimationLoop=function(e){A.setAnimationLoop(e)},this.submitFrame=function(){w()&&r.submitFrame()},this.dispose=function(){void 0!==i&&i.removeEventListener("vrdisplaypresentchange",_)}}function Gd(e){var t=e.context,r=null,n=null,i=null,o="stage",s=null,c=[],u=[];function l(){return null!==n&&null!==i}var h=new Wr;h.layers.enable(1),h.viewport=new S;var d=new Wr;d.layers.enable(2),d.viewport=new S;var f=new jd([h,d]);function p(e){var t=c[u.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function m(){e.setFramebuffer(null),y.stop()}function v(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=c[e];return void 0===t&&((t=new oo).matrixAutoUpdate=!1,t.visible=!1,c[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),e instanceof XRDevice&&t.setCompatibleXRDevice(e)},this.setFrameOfReferenceType=function(e){o=e},this.setSession=function(r){null!==(n=r)&&(n.addEventListener("select",p),n.addEventListener("selectstart",p),n.addEventListener("selectend",p),n.addEventListener("end",m),n.baseLayer=new XRWebGLLayer(n,t),n.requestFrameOfReference(o).then(function(t){i=t,e.setFramebuffer(n.baseLayer.framebuffer),y.setContext(n),y.start()}),u=n.getInputSources(),n.addEventListener("inputsourceschange",function(){u=n.getInputSources(),console.log(u)}))},this.getCamera=function(e){if(l()){var t=e.parent,r=f.cameras;v(f,t);for(var n=0;n<r.length;n++)v(r[n],t);e.matrixWorld.copy(f.matrixWorld);for(var i=e.children,o=(n=0,i.length);n<o;n++)i[n].updateMatrixWorld(!0);return f}return e},this.isPresenting=l;var g=null;var y=new gh;y.setAnimationLoop(function(e,t){if(null!==(s=t.getDevicePose(i)))for(var r=n.baseLayer,o=t.views,a=0;a<o.length;a++){var l=o[a],h=r.getViewport(l),d=s.getViewMatrix(l),p=f.cameras[a];p.matrix.fromArray(d).getInverse(p.matrix),p.projectionMatrix.fromArray(l.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===a&&(f.matrix.copy(p.matrix),f.projectionMatrix.copy(p.projectionMatrix))}for(a=0;a<c.length;a++){var m=c[a],v=u[a];if(v){var y=t.getInputPose(v,i);if(null!==y){"targetRay"in y?m.matrix.elements=y.targetRay.transformMatrix:"pointerMatrix"in y&&(m.matrix.elements=y.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}g&&g(e)}),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("WebXRManager: getStandingMatrix() is no longer needed."),new a},this.submitFrame=function(){}}function Wd(e){console.log("WebGLRenderer",z);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,c=void 0===e.depth||e.depth,u=void 0===e.stencil||e.stencil,l=void 0!==e.antialias&&e.antialias,h=void 0===e.premultipliedAlpha||e.premultipliedAlpha,d=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,f=void 0!==e.powerPreference?e.powerPreference:"default",p=null,m=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Re,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var v,g,y,b,x,w,_,M,T,A,E,C,L,P,O,N,R,I,D=this,F=!1,U=null,k=null,B=null,j=-1,V={geometry:null,program:null,wireframe:!1},G=null,W=null,H=new S,X=new S,q=null,J=0,Q=t.width,Z=t.height,K=1,$=new S(0,0,Q,Z),ee=new S(0,0,Q,Z),te=!1,re=new nh,ne=new _h,ie=!1,oe=!1,ae=new a,se=new s;function ce(){return null===k?K:1}try{var ue={alpha:n,depth:c,stencil:u,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:d,powerPreference:f};if(t.addEventListener("webglcontextlost",fe,!1),t.addEventListener("webglcontextrestored",pe,!1),null===(v=r||t.getContext("webgl",ue)||t.getContext("experimental-webgl",ue)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===v.getShaderPrecisionFormat&&(v.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("WebGLRenderer: "+e.message)}function le(){g=new Sh(v),(y=new wh(v,g,e)).isWebGL2||(g.get("WEBGL_depth_texture"),g.get("OES_texture_float"),g.get("OES_texture_half_float"),g.get("OES_texture_half_float_linear"),g.get("OES_standard_derivatives"),g.get("OES_element_index_uint"),g.get("ANGLE_instanced_arrays")),g.get("OES_texture_float_linear"),I=new zd(v,g,y),(b=new kd(v,g,I,y)).scissor(X.copy(ee).multiplyScalar(K)),b.viewport(H.copy($).multiplyScalar(K)),x=new Ah(v),w=new Ld,_=new Bd(v,g,b,w,y,I,x),M=new yh(v),T=new Mh(v,M,x),A=new Lh(T,x),O=new Ch(v),E=new Cd(D,g,y),C=new Nd,L=new Fd,P=new bh(D,b,A,h),N=new xh(v,g,x,y),R=new Th(v,g,x,y),x.programs=E.programs,D.context=v,D.capabilities=y,D.extensions=g,D.properties=w,D.renderLists=C,D.state=b,D.info=x}le();var he="xr"in navigator?new Gd(D):new Vd(D);this.vr=he;var de=new Ud(D,A,y.maxTextureSize);function fe(e){e.preventDefault(),console.log("WebGLRenderer: Context Lost."),F=!0}function pe(){console.log("WebGLRenderer: Context Restored."),F=!1,le()}function me(e){var t=e.target;t.removeEventListener("dispose",me),function(e){ve(e),w.remove(e)}(t)}function ve(e){var t=w.get(e).program;e.program=void 0,void 0!==t&&E.releaseProgram(t)}this.shadowMap=de,this.getContext=function(){return v},this.getContextAttributes=function(){return v.getContextAttributes()},this.forceContextLoss=function(){var e=g.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=g.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(e){void 0!==e&&(K=e,this.setSize(Q,Z,!1))},this.getSize=function(){return{width:Q,height:Z}},this.setSize=function(e,r,n){he.isPresenting()?console.warn("WebGLRenderer: Can't change size while VR device is presenting."):(Q=e,Z=r,t.width=e*K,t.height=r*K,!1!==n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(){return{width:Q*K,height:Z*K}},this.setDrawingBufferSize=function(e,r,n){Q=e,Z=r,K=n,t.width=e*n,t.height=r*n,this.setViewport(0,0,e,r)},this.getCurrentViewport=function(){return H},this.setViewport=function(e,t,r,n){$.set(e,Z-t-n,r,n),b.viewport(H.copy($).multiplyScalar(K))},this.setScissor=function(e,t,r,n){ee.set(e,Z-t-n,r,n),b.scissor(X.copy(ee).multiplyScalar(K))},this.setScissorTest=function(e){b.setScissorTest(te=e)},this.getClearColor=function(){return P.getClearColor()},this.setClearColor=function(){P.setClearColor.apply(P,arguments)},this.getClearAlpha=function(){return P.getClearAlpha()},this.setClearAlpha=function(){P.setClearAlpha.apply(P,arguments)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=v.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=v.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=v.STENCIL_BUFFER_BIT),v.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.dispose=function(){t.removeEventListener("webglcontextlost",fe,!1),t.removeEventListener("webglcontextrestored",pe,!1),C.dispose(),L.dispose(),w.dispose(),A.dispose(),he.dispose(),ye.stop()},this.renderBufferImmediate=function(e,t){b.initAttributes();var r=w.get(e);e.hasPositions&&!r.position&&(r.position=v.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=v.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=v.createBuffer()),e.hasColors&&!r.color&&(r.color=v.createBuffer());var n=t.getAttributes();e.hasPositions&&(v.bindBuffer(v.ARRAY_BUFFER,r.position),v.bufferData(v.ARRAY_BUFFER,e.positionArray,v.DYNAMIC_DRAW),b.enableAttribute(n.position),v.vertexAttribPointer(n.position,3,v.FLOAT,!1,0,0)),e.hasNormals&&(v.bindBuffer(v.ARRAY_BUFFER,r.normal),v.bufferData(v.ARRAY_BUFFER,e.normalArray,v.DYNAMIC_DRAW),b.enableAttribute(n.normal),v.vertexAttribPointer(n.normal,3,v.FLOAT,!1,0,0)),e.hasUvs&&(v.bindBuffer(v.ARRAY_BUFFER,r.uv),v.bufferData(v.ARRAY_BUFFER,e.uvArray,v.DYNAMIC_DRAW),b.enableAttribute(n.uv),v.vertexAttribPointer(n.uv,2,v.FLOAT,!1,0,0)),e.hasColors&&(v.bindBuffer(v.ARRAY_BUFFER,r.color),v.bufferData(v.ARRAY_BUFFER,e.colorArray,v.DYNAMIC_DRAW),b.enableAttribute(n.color),v.vertexAttribPointer(n.color,3,v.FLOAT,!1,0,0)),b.disableUnusedAttributes(),v.drawArrays(v.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,n,i,o){var a=i.isMesh&&i.normalMatrix.determinant()<0;b.setMaterial(n,a);var s=_e(e,t,n,i),c=!1;V.geometry===r.id&&V.program===s.id&&V.wireframe===(!0===n.wireframe)||(V.geometry=r.id,V.program=s.id,V.wireframe=!0===n.wireframe,c=!0),i.morphTargetInfluences&&(O.update(i,r,n,s),c=!0);var u,l=r.index,h=r.attributes.position,d=1;!0===n.wireframe&&(l=T.getWireframeAttribute(r),d=2);var f=N;null!==l&&(u=M.get(l),(f=R).setIndex(u)),c&&(!function(e,t,r){if(r&&r.isInstancedBufferGeometry&!y.isWebGL2&&null===g.get("ANGLE_instanced_arrays"))return void console.error("WebGLRenderer.setupVertexAttributes: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b.initAttributes();var n=r.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var c=n[a];if(void 0!==c){var u=c.normalized,l=c.itemSize,h=M.get(c);if(void 0===h)continue;var d=h.buffer,f=h.type,p=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,x=m.stride,w=c.offset;m&&m.isInstancedInterleavedBuffer?(b.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=m.meshPerAttribute*m.count)):b.enableAttribute(s),v.bindBuffer(v.ARRAY_BUFFER,d),v.vertexAttribPointer(s,l,f,u,x*p,w*p)}else c.isInstancedBufferAttribute?(b.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)):b.enableAttribute(s),v.bindBuffer(v.ARRAY_BUFFER,d),v.vertexAttribPointer(s,l,f,u,0,0)}else if(void 0!==o){var _=o[a];if(void 0!==_)switch(_.length){case 2:v.vertexAttrib2fv(s,_);break;case 3:v.vertexAttrib3fv(s,_);break;case 4:v.vertexAttrib4fv(s,_);break;default:v.vertexAttrib1fv(s,_)}}}}b.disableUnusedAttributes()}(n,s,r),null!==l&&v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,u.buffer));var p=1/0;null!==l?p=l.count:void 0!==h&&(p=h.count);var m=r.drawRange.start*d,x=r.drawRange.count*d,w=null!==o?o.start*d:0,_=null!==o?o.count*d:1/0,S=Math.max(m,w),A=Math.min(p,m+x,w+_)-1,E=Math.max(0,A-S+1);if(0!==E){if(i.isMesh)if(!0===n.wireframe)b.setLineWidth(n.wireframeLinewidth*ce()),f.setMode(v.LINES);else switch(i.drawMode){case Xt:f.setMode(v.TRIANGLES);break;case qt:f.setMode(v.TRIANGLE_STRIP);break;case Yt:f.setMode(v.TRIANGLE_FAN)}else if(i.isLine){var C=n.linewidth;void 0===C&&(C=1),b.setLineWidth(C*ce()),i.isLineSegments?f.setMode(v.LINES):i.isLineLoop?f.setMode(v.LINE_LOOP):f.setMode(v.LINE_STRIP)}else i.isPoints?f.setMode(v.POINTS):i.isSprite&&f.setMode(v.TRIANGLES);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&f.renderInstances(r,S,E):f.render(S,E)}},this.compile=function(e,t){(m=L.get(e,t)).init(),e.traverse(function(e){e.isLight&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))}),m.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)we(t.material[r],e.fog,t);else we(t.material,e.fog,t)})};var ge=null;var ye=new gh;function be(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=void 0===n?a.material:n,l=a.group;if(r.isArrayCamera){W=r;for(var h=r.cameras,d=0,f=h.length;d<f;d++){var p=h[d];if(s.layers.test(p.layers)){if("viewport"in p)b.viewport(H.copy(p.viewport));else{var v=p.bounds,g=v.x*Q,y=v.y*Z,x=v.z*Q,w=v.w*Z;b.viewport(H.set(g,y,x,w).multiplyScalar(K))}m.setupLights(p),xe(s,t,p,c,u,l)}}}else W=null,xe(s,t,r,c,u,l)}}function xe(e,t,r,n,i,o){if(e.onBeforeRender(D,t,r,n,i,o),m=L.get(t,W||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){b.setMaterial(i);var a=_e(r,t.fog,i,e);V.geometry=null,V.program=null,V.wireframe=!1,function(e,t){e.render(function(e){D.renderBufferImmediate(e,t)})}(e,a)}else D.renderBufferDirect(r,t.fog,n,i,e,o);e.onAfterRender(D,t,r,n,i,o),m=L.get(t,W||r)}function we(e,t,r){var n=w.get(e),i=m.state.lights,o=m.state.shadowsArray,a=n.lightsHash,s=i.state.hash,c=E.getParameters(e,i.state,o,t,ne.numPlanes,ne.numIntersection,r),u=E.getProgramCode(e,c),l=n.program,h=!0;if(void 0===l)e.addEventListener("dispose",me);else if(l.code!==u)ve(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,h=!1;else{if(void 0!==c.shaderID)return;h=!1}if(h){if(c.shaderID){var d=Li[c.shaderID];n.shader={name:e.type,uniforms:Hr.clone(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader,D),u=E.getProgramCode(e,c),l=E.acquireProgram(e,n.shader,c,u),n.program=l,e.program=l}var f=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<D.maxMorphTargets;p++)f["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<D.maxMorphNormals;p++)f["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var v=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=ne.numPlanes,n.numIntersection=ne.numIntersection,v.clippingPlanes=ne.uniform),n.fog=t,void 0===a&&(n.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(v.ambientLightColor.value=i.state.ambient,v.directionalLights.value=i.state.directional,v.spotLights.value=i.state.spot,v.rectAreaLights.value=i.state.rectArea,v.pointLights.value=i.state.point,v.hemisphereLights.value=i.state.hemi,v.directionalShadowMap.value=i.state.directionalShadowMap,v.directionalShadowMatrix.value=i.state.directionalShadowMatrix,v.spotShadowMap.value=i.state.spotShadowMap,v.spotShadowMatrix.value=i.state.spotShadowMatrix,v.pointShadowMap.value=i.state.pointShadowMap,v.pointShadowMatrix.value=i.state.pointShadowMatrix);var g=n.program.getUniforms(),y=gd.seqWithValue(g.seq,v);n.uniformsList=y}function _e(e,t,r,n){J=0;var i=w.get(r),a=m.state.lights,s=i.lightsHash,c=a.state.hash;if(ie&&(oe||e!==G)){var u=e===G&&r.id===j;ne.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,u)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:(!r.lights||s.stateID===c.stateID&&s.directionalLength===c.directionalLength&&s.pointLength===c.pointLength&&s.spotLength===c.spotLength&&s.rectAreaLength===c.rectAreaLength&&s.hemiLength===c.hemiLength&&s.shadowsLength===c.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===ne.numPlanes&&i.numIntersection===ne.numIntersection)||(r.needsUpdate=!0)),r.needsUpdate&&(we(r,t,n),r.needsUpdate=!1);var l=!1,h=!1,d=!1,f=i.program,p=f.getUniforms(),g=i.shader.uniforms;if(b.useProgram(f.program)&&(l=!0,h=!0,d=!0),r.id!==j&&(j=r.id,h=!0),l||G!==e){if(p.setValue(v,"projectionMatrix",e.projectionMatrix),y.logarithmicDepthBuffer&&p.setValue(v,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),G!==e&&(G=e,h=!0,d=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var x=p.map.cameraPosition;void 0!==x&&x.setValue(v,se.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&p.setValue(v,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){p.setOptional(v,n,"bindMatrix"),p.setOptional(v,n,"bindMatrixInverse");var _=n.skeleton;if(_){var S=_.bones;if(y.floatVertexTextures){if(void 0===_.boneTexture){var M=Math.sqrt(4*S.length);M=o.ceilPowerOfTwo(M),M=Math.max(M,4);var T=new Float32Array(M*M*4);T.set(_.boneMatrices);var A=new Vi(T,M,M,pt,at);A.needsUpdate=!0,_.boneMatrices=T,_.boneTexture=A,_.boneTextureSize=M}p.setValue(v,"boneTexture",_.boneTexture),p.setValue(v,"boneTextureSize",_.boneTextureSize)}else p.setOptional(v,_,"boneMatrices")}}return h&&(p.setValue(v,"toneMappingExposure",D.toneMappingExposure),p.setValue(v,"toneMappingWhitePoint",D.toneMappingWhitePoint),r.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(g,d),t&&r.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(g,t),r.isMeshBasicMaterial?Se(g,r):r.isMeshLambertMaterial?(Se(g,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(g,r)):r.isMeshPhongMaterial?(Se(g,r),r.isMeshToonMaterial?function(e,t){Me(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(g,r):Me(g,r)):r.isMeshStandardMaterial?(Se(g,r),r.isMeshPhysicalMaterial?function(e,t){Te(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(g,r):Te(g,r)):r.isMeshDepthMaterial?(Se(g,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(g,r)):r.isMeshDistanceMaterial?(Se(g,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(g,r)):r.isMeshNormalMaterial?(Se(g,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Y&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Y&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(g,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(g,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(g,r)):r.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*K,e.scale.value=.5*Z,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(g,r):r.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(g,r):r.isShadowMaterial&&(g.color.value=r.color,g.opacity.value=r.opacity),void 0!==g.ltc_1&&(g.ltc_1.value=Ci.LTC_1),void 0!==g.ltc_2&&(g.ltc_2.value=Ci.LTC_2),gd.upload(v,i.uniformsList,g,D)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(gd.upload(v,i.uniformsList,g,D),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&p.setValue(v,"center",n.center),p.setValue(v,"modelViewMatrix",n.modelViewMatrix),p.setValue(v,"normalMatrix",n.normalMatrix),p.setValue(v,"modelMatrix",n.matrixWorld),f}function Se(e,t){var r;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=w.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}function Me(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Y&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Y&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Te(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Y&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Y&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}ye.setAnimationLoop(function(e){he.isPresenting()||ge&&ge(e)}),void 0!==i&&ye.setContext(i),this.setAnimationLoop=function(e){ge=e,he.setAnimationLoop(e),ye.start()},this.render=function(e,t,r,n){if(t&&t.isCamera){if(!F){V.geometry=null,V.program=null,V.wireframe=!1,j=-1,G=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),he.enabled&&(t=he.getCamera(t)),(m=L.get(e,t)).init(),e.onBeforeRender(D,e,t,r),ae.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),re.setFromMatrix(ae),oe=this.localClippingEnabled,ie=ne.init(this.clippingPlanes,oe,t),(p=C.get(e,t)).init(),function e(t,r,n){if(!1===t.visible)return;var i=t.layers.test(r.layers);if(i)if(t.isLight)m.pushLight(t),t.castShadow&&m.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||re.intersectsSprite(t)){n&&se.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ae);var o=A.update(t),a=t.material;p.push(t,o,a,se.z,null)}}else if(t.isImmediateRenderObject)n&&se.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ae),p.push(t,null,t.material,se.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||re.intersectsObject(t))){n&&se.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ae);var o=A.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,c=0,u=s.length;c<u;c++){var l=s[c],h=a[l.materialIndex];h&&h.visible&&p.push(t,o,h,se.z,l)}else a.visible&&p.push(t,o,a,se.z,null)}var d=t.children;for(var c=0,u=d.length;c<u;c++)e(d[c],r,n)}(e,t,D.sortObjects),!0===D.sortObjects&&p.sort(),ie&&ne.beginShadows();var i=m.state.shadowsArray;de.render(i,e,t),m.setupLights(t),ie&&ne.endShadows(),this.info.autoReset&&this.info.reset(),void 0===r&&(r=null),this.setRenderTarget(r),P.render(p,e,t,n);var o=p.opaque,a=p.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&be(o,e,t,s),a.length&&be(a,e,t,s)}else o.length&&be(o,e,t),a.length&&be(a,e,t);r&&_.updateRenderTargetMipmap(r),b.buffers.depth.setTest(!0),b.buffers.depth.setMask(!0),b.buffers.color.setMask(!0),b.setPolygonOffset(!1),e.onAfterRender(D,e,t),he.enabled&&he.submitFrame(),p=null,m=null}}else console.error("WebGLRenderer.render: camera is not an instance of Camera.")},this.allocTextureUnit=function(){var e=J;return e>=y.maxTextures&&console.warn("WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+y.maxTextures),J+=1,e},this.setTexture2D=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTarget&&(e||(console.warn("WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),_.setTexture2D(t,r)}}(),this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),_.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?_.setTextureCube(t,r):_.setTextureCubeDynamic(t,r)}}(),this.setFramebuffer=function(e){U=e},this.getRenderTarget=function(){return k},this.setRenderTarget=function(e){k=e,e&&void 0===w.get(e).__webglFramebuffer&&_.setupRenderTarget(e);var t=U,r=!1;if(e){var n=w.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=n[e.activeCubeFace],r=!0):t=n,H.copy(e.viewport),X.copy(e.scissor),q=e.scissorTest}else H.copy($).multiplyScalar(K),X.copy(ee).multiplyScalar(K),q=te;if(B!==t&&(v.bindFramebuffer(v.FRAMEBUFFER,t),B=t),b.viewport(H),b.scissor(X),b.setScissorTest(q),r){var i=w.get(e.texture);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(e&&e.isWebGLRenderTarget){var a=w.get(e).__webglFramebuffer;if(a){var s=!1;a!==B&&(v.bindFramebuffer(v.FRAMEBUFFER,a),s=!0);try{var c=e.texture,u=c.format,l=c.type;if(u!==pt&&I.convert(u)!==v.getParameter(v.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===et||I.convert(l)===v.getParameter(v.IMPLEMENTATION_COLOR_READ_TYPE)||l===at&&(y.isWebGL2||g.get("OES_texture_float")||g.get("WEBGL_color_buffer_float"))||l===st&&(y.isWebGL2?g.get("EXT_color_buffer_float"):g.get("EXT_color_buffer_half_float"))))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");v.checkFramebufferStatus(v.FRAMEBUFFER)===v.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&v.readPixels(t,r,n,i,I.convert(u),I.convert(l),o):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&v.bindFramebuffer(v.FRAMEBUFFER,B)}}}else console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,r){var n=t.image.width,i=t.image.height,o=I.convert(t.format);this.setTexture2D(t,0),v.copyTexImage2D(v.TEXTURE_2D,r||0,o,e.x,e.y,n,i,0)},this.copyTextureToTexture=function(e,t,r,n){var i=t.image.width,o=t.image.height,a=I.convert(r.format),s=I.convert(r.type);this.setTexture2D(r,0),t.isDataTexture?v.texSubImage2D(v.TEXTURE_2D,n||0,e.x,e.y,i,o,a,s,t.image.data):v.texSubImage2D(v.TEXTURE_2D,n||0,e.x,e.y,a,s,t.image)}}function Hd(e){"string"==typeof e&&(console.warn("Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}jd.prototype=Object.assign(Object.create(Wr.prototype),{constructor:jd,isArrayCamera:!0}),Hd.prototype.clone=function(){return new Hd(void 0===this.value.clone?this.value:this.value.clone())};var Xd={uniforms:{tDiffuse:{value:null},resolution:{value:new x(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","","","","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","","#if (FXAA_PC == 1)","","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","    #endif","","                        }","                        #endif","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},qd={packVector3:["float vec3_to_float( vec3 data ) {","\tconst float unit = 255.0/256.0;","\thighp float compressed = fract( data.x * unit ) + floor( data.y * unit * 255.0 ) + floor( data.z * unit * 255.0 ) * 255.0;","\treturn compressed;","}"].join("\n"),unpackFloat:["vec3 float_to_vec3( float data ) {","\tconst float unit = 255.0;","\tvec3 uncompressed;","\tuncompressed.x = fract( data );","\tfloat zInt = floor( data / unit );","\tuncompressed.z = fract( zInt / unit );","\tuncompressed.y = fract( floor( data - ( zInt * unit ) ) / unit );","\treturn uncompressed;","}"].join("\n"),packNormal:["vec2 normal_to_vec2( vec3 normal ) {","\treturn normal.xy / sqrt( normal.z * 8.0 + 8.0 ) + 0.5;","}"].join("\n"),unpackVector2:["vec3 vec2_to_normal( vec2 data ) {","\tvec2 fenc = data * 4.0 - 2.0;","\tfloat f = dot( fenc, fenc );","\tfloat g = sqrt( 1.0 - f / 4.0 );","\tvec3 normal;","\tnormal.xy = fenc * g;","\tnormal.z = 1.0 - f / 2.0;","\treturn normal;","}"].join("\n"),computeTextureCoord:["vec2 texCoord = gl_FragCoord.xy / vec2( viewWidth, viewHeight );"].join("\n"),packNormalDepth:["vec4 packedNormalDepth;","packedNormalDepth.xyz = normal * 0.5 + 0.5;","packedNormalDepth.w = position.z / position.w;"].join("\n"),unpackNormalDepth:["vec4 normalDepthMap = texture2D( samplerNormalDepth, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = normalDepthMap.xyz * 2.0 - 1.0;"].join("\n"),packNormalDepthShininess:["vec4 packedNormalDepthShininess;","packedNormalDepthShininess.xy = normal_to_vec2( normal );","packedNormalDepthShininess.z = shininess;","packedNormalDepthShininess.w = position.z / position.w;"].join("\n"),unpackNormalDepthShininess:["vec4 normalDepthMap = texture2D( samplerNormalDepthShininess, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = vec2_to_normal( normalDepthMap.xy );","float shininess = normalDepthMap.z;"].join("\n"),packColor:["vec4 packedColor;","packedColor.x = vec3_to_float( diffuseColor.rgb );","packedColor.y = vec3_to_float( emissiveColor );","packedColor.z = vec3_to_float( specularColor );","packedColor.w = shininess;"].join("\n"),unpackColor:["vec4 colorMap = texture2D( samplerColor, texCoord );","vec3 diffuseColor = float_to_vec3( colorMap.x );","vec3 emissiveColor = float_to_vec3( colorMap.y );","vec3 specularColor = float_to_vec3( colorMap.z );","float shininess = colorMap.w;"].join("\n"),packLight:["vec4 packedLight;","packedLight.xyz = lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * attenuation;","packedLight.w = lightIntensity * specular * max( dot( lightVector, normal ), 0.0 ) * attenuation;"].join("\n"),computeVertexPositionVS:["vec2 xy = texCoord * 2.0 - 1.0;","vec4 vertexPositionProjected = vec4( xy, depth, 1.0 );","vec4 vertexPositionVS = matProjInverse * vertexPositionProjected;","vertexPositionVS.xyz /= vertexPositionVS.w;","vertexPositionVS.w = 1.0;"].join("\n"),computeSpecular:["vec3 halfVector = normalize( lightVector - normalize( vertexPositionVS.xyz ) );","float dotNormalHalf = max( dot( normal, halfVector ), 0.0 );","float specular = 0.31830988618 * ( shininess * 0.5 + 1.0 ) * pow( dotNormalHalf, shininess );"].join("\n"),combine:["gl_FragColor = vec4( lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * ( diffuseColor + specular * specularColor ) * attenuation, 1.0 );"].join("\n")},Yd={commonUniforms:{matProjInverse:new Hd(new a),viewWidth:new Hd(800),viewHeight:new Hd(600)}},Jd={normalDepth:{uniforms:{},vertexShader:["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","varying vec4 vPosition;","void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",qd.packNormalDepth,"\tgl_FragColor = packedNormalDepth;","}"].join("\n")},color:{uniforms:{map:new Hd(null),offsetRepeat:new Hd(new S(0,0,1,1)),diffuse:new Hd(new v(0)),emissive:new Hd(new v(0)),specular:new Hd(new v(0)),shininess:new Hd(30)},vertexShader:["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","#include <uv_pars_fragment>","#include <map_pars_fragment>",qd.packVector3,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;","#include <map_fragment>",qd.packColor,"\tgl_FragColor = packedColor;","}"].join("\n")},emissiveLight:{uniforms:Object.assign({samplerColor:new Hd(null)},Yd.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;",qd.unpackFloat,"void main() {",qd.computeTextureCoord,qd.unpackColor,"\tgl_FragColor = vec4( emissiveColor, 1.0 );","}"].join("\n")},pointLight:{uniforms:Object.assign({samplerNormalDepth:new Hd(null),samplerColor:new Hd(null),lightColor:new Hd(new v(0)),lightPositionVS:new Hd(new s(0,1,0)),lightIntensity:new Hd(1),lightRadius:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",qd.unpackFloat,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepth,qd.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",qd.unpackColor,qd.computeSpecular,"\t//float cutoff = 0.3;","\t//float denom = distance / lightRadius + 1.0;","\t//float attenuation = 1.0 / ( denom * denom );","\t//attenuation = ( attenuation - cutoff ) / ( 1.0 - cutoff );","\t//attenuation = max( attenuation, 0.0 );","\t//attenuation *= attenuation;","\t//diffuseColor *= saturate( -distance / lightRadius + 1.0 );","\t//float attenuation = 1.0;","\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",qd.combine,"}"].join("\n")},spotLight:{uniforms:Object.assign({samplerNormalDepth:new Hd(null),samplerColor:new Hd(null),lightColor:new Hd(new v(0)),lightDirectionVS:new Hd(new s(0,1,0)),lightPositionVS:new Hd(new s(0,1,0)),lightAngle:new Hd(1),lightIntensity:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",qd.unpackFloat,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepth,qd.computeVertexPositionVS,qd.unpackColor,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}","\tdiffuseColor *= spot;",qd.computeSpecular,"\tconst float attenuation = 1.0;",qd.combine,"}"].join("\n")},directionalLight:{uniforms:Object.assign({samplerNormalDepth:new Hd(null),samplerColor:new Hd(null),lightColor:new Hd(new v(0)),lightDirectionVS:new Hd(new s(0,1,0)),lightIntensity:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",qd.unpackFloat,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepth,qd.computeVertexPositionVS,qd.unpackColor,"\tvec3 lightVector = normalize( lightDirectionVS );",qd.computeSpecular,"\tconst float attenuation = 1.0;",qd.combine,"}"].join("\n")},normalDepthShininess:{uniforms:{shininess:new Hd(30)},vertexShader:["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","varying vec4 vPosition;","uniform float shininess;",qd.packNormal,"void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",qd.packNormalDepthShininess,"\tgl_FragColor = packedNormalDepthShininess;","}"].join("\n")},pointLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Hd(null),lightColor:new Hd(new v(0)),lightPositionVS:new Hd(new s(0,1,0)),lightIntensity:new Hd(1),lightRadius:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",qd.unpackFloat,qd.unpackVector2,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepthShininess,qd.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",qd.computeSpecular,"\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",qd.packLight,"\tgl_FragColor = packedLight;","}"].join("\n")},spotLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Hd(null),lightColor:new Hd(new v(0)),lightDirectionVS:new Hd(new s(0,1,0)),lightPositionVS:new Hd(new s(0,1,0)),lightAngle:new Hd(1),lightIntensity:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",qd.unpackFloat,qd.unpackVector2,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepthShininess,qd.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}",qd.computeSpecular,"\tconst float attenuation = 1.0;",qd.packLight,"\tgl_FragColor = spot * packedLight;","}"].join("\n")},directionalLightPre:{uniforms:Object.assign({samplerNormalDepthShininess:new Hd(null),lightColor:new Hd(new v(0)),lightDirectionVS:new Hd(new s(0,1,0)),lightIntensity:new Hd(1)},Yd.commonUniforms),vertexShader:["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",qd.unpackFloat,qd.unpackVector2,"void main() {",qd.computeTextureCoord,qd.unpackNormalDepthShininess,qd.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightDirectionVS );",qd.computeSpecular,"\tconst float attenuation = 1.0;",qd.packLight,"\tgl_FragColor = packedLight;","}"].join("\n")},reconstruction:{uniforms:Object.assign({samplerLight:new Hd(null),map:new Hd(null),offsetRepeat:new Hd(new S(0,0,1,1)),diffuse:new Hd(new v(0)),emissive:new Hd(new v(0)),specular:new Hd(new v(0)),shininess:new Hd(30)},Yd.commonUniforms),vertexShader:["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D samplerLight;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float viewHeight;","uniform float viewWidth;","#include <uv_pars_fragment>","#include <map_pars_fragment>",qd.unpackFloat,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;",qd.computeTextureCoord,"\tvec4 light = texture2D( samplerLight, texCoord );","#include <map_fragment>","\tvec3 diffuseFinal = diffuseColor.rgb * light.rgb;","\tvec3 emissiveFinal = emissiveColor;","\tvec3 specularFinal = specularColor * light.rgb * light.a;","\tgl_FragColor = vec4( diffuseFinal + emissiveFinal + specularFinal, 1.0 );","}"].join("\n")},final:{uniforms:{samplerResult:new Hd(null)},vertexShader:["varying vec2 texCoord;","void main() {","\tvec4 pos = vec4( sign( position.xy ), 0.0, 1.0 );","\ttexCoord = pos.xy * vec2( 0.5 ) + 0.5;","\tgl_Position = pos;","}"].join("\n"),fragmentShader:["varying vec2 texCoord;","uniform sampler2D samplerResult;","void main() {","\tgl_FragColor = texture2D( samplerResult, texCoord );","}"].join("\n")}};function Qd(e,t){U.call(this);var r=[],n=[],i=[],o=[1,1,1],a=[1,1,0],u=new s(0,1,0),l=new s,h=new s,d=new c,f=new c;f.setFromAxisAngle(u,Math.PI/2);var p=new s,m=new s;m.copy(e.getPointAt(0));for(var v=[new s(-.225,0,0),new s(0,-.05,0),new s(0,-.175,0),new s(0,-.05,0),new s(.225,0,0),new s(0,-.175,0)],g=2*Math.PI,y=5,b=[],x=0;x<y;x++){var w=x/y*g;b.push(new s(.06*Math.sin(w),.06*Math.cos(w),0))}y=6;var _=[];for(x=0;x<y;x++){w=x/y*g;_.push(new s(.025*Math.sin(w),.025*Math.cos(w),0))}var S=new s,T=new s;function A(e,t){T.set(0,0,-1).applyQuaternion(d);for(var o=0;o<e.length;o++)S.copy(e[o]),S.applyQuaternion(d),S.add(p),r.push(S.x,S.y,S.z),n.push(T.x,T.y,T.z),i.push(t[0],t[1],t[2]);T.set(0,0,1).applyQuaternion(d);for(o=e.length-1;o>=0;o--)S.copy(e[o]),S.applyQuaternion(d),S.add(p),r.push(S.x,S.y,S.z),n.push(T.x,T.y,T.z),i.push(t[0],t[1],t[2])}var E=new s,C=new s,L=new s,P=new s,O=new s,N=new s,R=new s,I=new s;function D(e,t,o){for(var a=0,s=e.length;a<s;a++){var c=e[a],u=e[(a+1)%s];E.copy(c).add(t),E.applyQuaternion(d),E.add(p),C.copy(u).add(t),C.applyQuaternion(d),C.add(p),L.copy(u).add(t),L.applyQuaternion(f),L.add(m),P.copy(c).add(t),P.applyQuaternion(f),P.add(m),r.push(E.x,E.y,E.z),r.push(C.x,C.y,C.z),r.push(P.x,P.y,P.z),r.push(C.x,C.y,C.z),r.push(L.x,L.y,L.z),r.push(P.x,P.y,P.z),O.copy(c),O.applyQuaternion(d),O.normalize(),N.copy(u),N.applyQuaternion(d),N.normalize(),R.copy(u),R.applyQuaternion(f),R.normalize(),I.copy(c),I.applyQuaternion(f),I.normalize(),n.push(O.x,O.y,O.z),n.push(N.x,N.y,N.z),n.push(I.x,I.y,I.z),n.push(N.x,N.y,N.z),n.push(R.x,R.y,R.z),n.push(I.x,I.y,I.z),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2]),i.push(o[0],o[1],o[2])}}var F=new s;for(x=1;x<=t;x++){p.copy(e.getPointAt(x/t)),u.set(0,1,0),l.subVectors(p,m).normalize(),h.crossVectors(u,l).normalize(),u.crossVectors(l,h);w=Math.atan2(l.x,l.z);d.setFromAxisAngle(u,w),x%2==0&&A(v,a),D(b,F.set(0,-.125,0),a),D(_,F.set(.2,0,0),o),D(_,F.set(-.2,0,0),o),m.copy(p),f.copy(d)}this.addAttribute("position",new M(new Float32Array(r),3)),this.addAttribute("normal",new M(new Float32Array(n),3)),this.addAttribute("color",new M(new Float32Array(i),3))}function Zd(e,t){U.call(this);var r=[],n=[],i=new c,o=new s(0,1,0),a=new s,u=new s,l=[new s(0,.05,-.05),new s(0,.05,.05),new s(0,-.05,0)],h=[new s(-.05,0,.05),new s(-.05,0,-.05),new s(.05,0,0)],d=[new s(.05,0,-.05),new s(.05,0,.05),new s(-.05,0,0)],f=new s,p=new s,m=new s,v=new s,g=new s,y=new s,b=new s,x=new s;function w(e,t,o){for(var a=0,s=e.length;a<s;a++){var c=e[a],u=e[(a+1)%s];f.copy(c),f.applyQuaternion(i),f.add(t),p.copy(u),p.applyQuaternion(i),p.add(t),m.copy(u),m.applyQuaternion(i),m.add(o),v.copy(c),v.applyQuaternion(i),v.add(o),r.push(f.x,f.y,f.z),r.push(p.x,p.y,p.z),r.push(v.x,v.y,v.z),r.push(p.x,p.y,p.z),r.push(m.x,m.y,m.z),r.push(v.x,v.y,v.z),g.copy(c),g.applyQuaternion(i),g.normalize(),y.copy(u),y.applyQuaternion(i),y.normalize(),b.copy(u),b.applyQuaternion(i),b.normalize(),x.copy(c),x.applyQuaternion(i),x.normalize(),n.push(g.x,g.y,g.z),n.push(y.x,y.y,y.z),n.push(x.x,x.y,x.z),n.push(y.x,y.y,y.z),n.push(b.x,b.y,b.z),n.push(x.x,x.y,x.z)}}for(var _=new s,S=new s,T=1;T<=t;T++){a.copy(e.getPointAt(T/t)),u.copy(e.getTangentAt(T/t));var A=Math.atan2(u.x,u.z);i.setFromAxisAngle(o,A),a.y>10?(_.set(-.75,-.35,0),_.applyQuaternion(i),_.add(a),S.set(.75,-.35,0),S.applyQuaternion(i),S.add(a),w(l,_,S),_.set(-.7,-.3,0),_.applyQuaternion(i),_.add(a),S.set(-.7,-a.y,0),S.applyQuaternion(i),S.add(a),w(h,_,S),_.set(.7,-.3,0),_.applyQuaternion(i),_.add(a),S.set(.7,-a.y,0),S.applyQuaternion(i),S.add(a),w(d,_,S)):(_.set(0,-.2,0),_.applyQuaternion(i),_.add(a),S.set(0,-a.y,0),S.applyQuaternion(i),S.add(a),w(d,_,S))}this.addAttribute("position",new M(new Float32Array(r),3)),this.addAttribute("normal",new M(new Float32Array(n),3))}function Kd(e,t){U.call(this);var r=[],n=new s(0,1,0),i=new s,o=new c,a=new c;a.setFromAxisAngle(n,Math.PI/2);var u=new s,l=new s;l.copy(e.getPointAt(0)),l.y=0;for(var h=new s,d=new s,f=new s,p=new s,m=1;m<=t;m++){u.copy(e.getPointAt(m/t)),u.y=0,i.subVectors(u,l);var v=Math.atan2(i.x,i.z);o.setFromAxisAngle(n,v),h.set(-.3,0,0),h.applyQuaternion(o),h.add(u),d.set(.3,0,0),d.applyQuaternion(o),d.add(u),f.set(.3,0,0),f.applyQuaternion(a),f.add(l),p.set(-.3,0,0),p.applyQuaternion(a),p.add(l),r.push(h.x,h.y,h.z),r.push(d.x,d.y,d.z),r.push(p.x,p.y,p.z),r.push(d.x,d.y,d.z),r.push(f.x,f.y,f.z),r.push(p.x,p.y,p.z),l.copy(u),a.copy(o)}this.addAttribute("position",new M(new Float32Array(r),3))}function $d(){U.call(this);for(var e=[],t=0;t<100;t++){var r=800*Math.random()-400,n=50*Math.random()+50,i=800*Math.random()-400,o=40*Math.random()+20;e.push(r-o,n,i-o),e.push(r+o,n,i-o),e.push(r-o,n,i+o),e.push(r+o,n,i-o),e.push(r+o,n,i+o),e.push(r-o,n,i+o)}this.addAttribute("position",new M(new Float32Array(e),3))}function ef(e){U.call(this);var t=[],r=[],n=new Nn;n.ray.direction.set(0,-1,0);for(var i=0;i<2e3;i++){var o=500*Math.random()-250,a=500*Math.random()-250;n.ray.origin.set(o,50,a);var s=n.intersectObject(e);if(0!==s.length){var c=s[0].point.y,u=5*Math.random()+.5,l=Math.random()*Math.PI*2;t.push(o+Math.sin(l),c,a+Math.cos(l)),t.push(o,c+u,a),t.push(o+Math.sin(l+Math.PI),c,a+Math.cos(l+Math.PI)),l+=Math.PI/2,t.push(o+Math.sin(l),c,a+Math.cos(l)),t.push(o,c+u,a),t.push(o+Math.sin(l+Math.PI),c,a+Math.cos(l+Math.PI));for(var h=.1*Math.random(),d=0;d<6;d++)r.push(.2+h,.4+h,0)}}this.addAttribute("position",new M(new Float32Array(t),3)),this.addAttribute("color",new M(new Float32Array(r),3))}Qd.prototype=Object.create(U.prototype),Zd.prototype=Object.create(U.prototype),Kd.prototype=Object.create(U.prototype),$d.prototype=Object.create(U.prototype),ef.prototype=Object.create(U.prototype);var tf={godrays_depthMask:{uniforms:{tInput:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tInput;","void main() {","\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );","}"].join("\n")},godrays_generate:{uniforms:{tInput:{value:null},fStepSize:{value:1},vSunPositionScreenSpace:{value:new x(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec2 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","vec2 delta = vSunPositionScreenSpace - vUv;","float dist = length( delta );","vec2 stepv = fStepSize * delta / dist;","float iters = dist/fStepSize;","vec2 uv = vUv.xy;","float col = 0.0;","if ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","gl_FragColor = vec4( col/TAPS_PER_PASS );","gl_FragColor.a = 1.0;","}"].join("\n")},godrays_combine:{uniforms:{tColors:{value:null},tGodRays:{value:null},fGodRayIntensity:{value:.69},vSunPositionScreenSpace:{value:new x(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform vec2 vSunPositionScreenSpace;","uniform float fGodRayIntensity;","void main() {","gl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","gl_FragColor.a = 1.0;","}"].join("\n")},godrays_fake_sun:{uniforms:{vSunPositionScreenSpace:{value:new x(.5,.5)},fAspect:{value:1},sunColor:{value:new v(16772608)},bgColor:{value:new v(0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform vec2 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","vec2 diff = vUv - vSunPositionScreenSpace;","diff.x *= fAspect;","float prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","prop = 0.35 * pow( 1.0 - prop, 3.0 );","gl_FragColor.xyz = mix( sunColor, bgColor, 1.0 - prop );","gl_FragColor.w = 1.0;","}"].join("\n")}},rf={uniforms:{},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},nf={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 base = texture2D( tDiffuse, vUv );","vec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","float lum = dot( lumCoeff, base.rgb );","vec3 blend = vec3( lum );","float L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","vec3 result1 = 2.0 * base.rgb * blend;","vec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","vec3 newColor = mix( result1, result2, L );","float A2 = opacity * base.a;","vec3 mixRGB = A2 * newColor.rgb;","mixRGB += ( ( 1.0 - A2 ) * base.rgb );","gl_FragColor = vec4( mixRGB, base.a );","}"].join("\n")},of={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")},af={uniforms:{tDiffuse:{value:null},brightness:{value:0},contrast:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb += brightness;","if (contrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","}","}"].join("\n")},sf={uniforms:{tDiffuse:{value:null},powRGB:{value:new s(2,2,2)},mulRGB:{value:new s(1,1,1)},addRGB:{value:new s(0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n")},cf={uniforms:{tDiffuse:{value:null},color:{value:new v(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","gl_FragColor = vec4( v * color, texel.w );","}"].join("\n")},uf={uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},maxblur:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","vec4 depth = texture2D( tDepth, vUv );","float factor = depth.x - focus;","vec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","gl_FragColor = col;","gl_FragColor.a = 1.0;","}"].join("\n")},lf={uniforms:{tDiffuse:{value:null},screenWidth:{value:1024},screenHeight:{value:1024},sampleDistance:{value:.94},waveFactor:{value:.00125}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color, org, tmp, add;","float sample_dist, f;","vec2 vin;","vec2 uv = vUv;","add = color = org = texture2D( tDiffuse, uv );","vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","sample_dist = dot( vin, vin ) * 2.0;","f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n")},hf={uniforms:{tDiffuse:{value:null},aspect:{value:new x(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","G[0] = g0,","G[1] = g1,","G[2] = g2,","G[3] = g3,","G[4] = g4,","G[5] = g5,","G[6] = g6,","G[7] = g7,","G[8] = g8;","mat3 I;","float cnv[9];","vec3 sample;","for (float i=0.0; i<3.0; i++) {","for (float j=0.0; j<3.0; j++) {","sample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","I[int(i)][int(j)] = length(sample);","}","}","for (int i=0; i<9; i++) {","float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","cnv[i] = dp3 * dp3;","}","float M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","float S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","gl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")},df={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vReflect = reflect( I, worldNormal );","vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","vec4 refractedColor = vec4( 1.0 );","refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n")},ff={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","gl_FragColor = LinearToGamma( tex, float( GAMMA_FACTOR ) );","}"].join("\n")},pf={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},mf={uniforms:{tDiffuse:{value:null},h:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float hh = h * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},vf={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","float angle = hue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(gl_FragColor.rgb);","gl_FragColor.rgb = vec3(","dot(gl_FragColor.rgb, weights.xyz),","dot(gl_FragColor.rgb, weights.zxy),","dot(gl_FragColor.rgb, weights.yzx)",");","float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","if (saturation > 0.0) {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","} else {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","}","}"].join("\n")},gf={uniforms:{tDiffuse:{value:null},sides:{value:6},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 p = vUv - 0.5;","float r = length(p);","float a = atan(p.y, p.x) + angle;","float tau = 2. * 3.1416 ;","a = mod(a, tau/sides);","a = abs(a - tau/sides/2.) ;","p = r * vec2(cos(a), sin(a));","vec4 color = texture2D(tDiffuse, p + 0.5);","gl_FragColor = color;","}"].join("\n")},yf={uniforms:{tDiffuse:{value:null},side:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","vec2 p = vUv;","if (side == 0){","if (p.x > 0.5) p.x = 1.0 - p.x;","}else if (side == 1){","if (p.x < 0.5) p.x = 1.0 - p.x;","}else if (side == 2){","if (p.y < 0.5) p.y = 1.0 - p.y;","}else if (side == 3){","if (p.y > 0.5) p.y = 1.0 - p.y;","} ","vec4 color = texture2D(tDiffuse, p);","gl_FragColor = color;","}"].join("\n")},bf={uniforms:{heightMap:{value:null},resolution:{value:new x(512,512)},scale:{value:new x(1,1)},height:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","float val = texture2D( heightMap, vUv ).x;","float valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","float valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","gl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n")},xf={modes:{none:"NO_PARALLAX",basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"},uniforms:{bumpMap:{value:null},map:{value:null},parallaxScale:{value:null},parallaxMinLayers:{value:null},parallaxMaxLayers:{value:null}},vertexShader:["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","vUv = uv;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","vec2 parallaxMap( in vec3 V ) {","float initialHeight = texture2D( bumpMap, vUv ).r;","vec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","return vUv - texCoordOffset;","}","#else","vec2 parallaxMap( in vec3 V ) {","float numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","float layerHeight = 1.0 / numLayers;","float currentLayerHeight = 0.0;","vec2 dtex = parallaxScale * V.xy / V.z / numLayers;","vec2 currentTextureCoords = vUv;","float heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","for ( int i = 0; i < 30; i += 1 ) {","if ( heightFromTexture <= currentLayerHeight ) {","break;","}","currentLayerHeight += layerHeight;","currentTextureCoords -= dtex;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","}","#ifdef USE_STEEP_PARALLAX","return currentTextureCoords;","#elif defined( USE_RELIEF_PARALLAX )","vec2 deltaTexCoord = dtex / 2.0;","float deltaHeight = layerHeight / 2.0;","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","const int numSearches = 5;","for ( int i = 0; i < numSearches; i += 1 ) {","deltaTexCoord /= 2.0;","deltaHeight /= 2.0;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","if( heightFromTexture > currentLayerHeight ) {","currentTextureCoords -= deltaTexCoord;","currentLayerHeight += deltaHeight;","} else {","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","}","}","return currentTextureCoords;","#elif defined( USE_OCLUSION_PARALLAX )","vec2 prevTCoords = currentTextureCoords + dtex;","float nextH = heightFromTexture - currentLayerHeight;","float prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","float weight = nextH / ( nextH - prevH );","return prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","#else","return vUv;","#endif","}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","vec2 texDx = dFdx( vUv );","vec2 texDy = dFdy( vUv );","vec3 vSigmaX = dFdx( surfPosition );","vec3 vSigmaY = dFdy( surfPosition );","vec3 vR1 = cross( vSigmaY, surfNormal );","vec3 vR2 = cross( surfNormal, vSigmaX );","float fDet = dot( vSigmaX, vR1 );","vec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","vec3 vProjVtex;","vProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","vProjVtex.z = dot( surfNormal, viewPosition );","return parallaxMap( vProjVtex );","}","void main() {","vec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","gl_FragColor = texture2D( map, mapUv );","}"].join("\n")},wf={uniforms:{tDiffuse:{value:null},resolution:{value:null},pixelSize:{value:1}},vertexShader:["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n")},_f={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")},Sf={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color = texture2D( tDiffuse, vUv );","vec3 c = color.rgb;","color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")},Mf={uniforms:{tDiffuse:{value:null},resolution:{value:new x}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","vec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","const mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","const mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","float tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","float tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","float tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","float tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","float tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","float tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","float tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","float tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","float tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","float valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","Gx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","Gx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","float valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","Gy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","Gy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","float G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","gl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")},Tf={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","vec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","gl_FragColor = newTex;","}"].join("\n")},Af={uniforms:{texture:{value:null},delta:{value:new x(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","vec4 color = vec4( 0.0 );","float total = 0.0;","float offset = rand( vUv );","for ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","float percent = ( t + offset - 0.5 ) / ITERATIONS;","float weight = 1.0 - abs( percent );","color += texture2D( texture, vUv + delta * percent ) * weight;","total += weight;","}","gl_FragColor = color / total;","}"].join("\n")},Ef={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},Cf={uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},Lf={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")},Pf={uniforms:{color:{type:"c",value:null},time:{type:"f",value:0},tDiffuse:{type:"t",value:null},tDudv:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")},Of={skinSimple:{uniforms:Hr.merge([Ci.fog,Ci.lights,{enableBump:{value:0},enableSpecular:{value:0},tDiffuse:{value:null},tBeckmann:{value:null},diffuse:{value:new v(15658734)},specular:{value:new v(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75},bumpMap:{value:null},bumpScale:{value:1},specularMap:{value:null},offsetRepeat:{value:new S(0,0,1,1)},uWrapRGB:{value:new s(.75,.375,.1875)}}]),fragmentShader:["#define USE_BUMPMAP","uniform bool enableBump;","uniform bool enableSpecular;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform vec3 uWrapRGB;","uniform sampler2D tDiffuse;","uniform sampler2D tBeckmann;","uniform sampler2D specularMap;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,Ei.bsdfs,Ei.packing,Ei.lights_pars_begin,Ei.shadowmap_pars_fragment,Ei.fog_pars_fragment,Ei.bumpmap_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse.rgb *= colDiffuse.rgb;","diffuseColor = diffuseColor * colDiffuse;","vec3 normal = normalize( vNormal );","vec3 viewerDirection = normalize( vViewPosition );","float specularStrength;","if ( enableSpecular ) {","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","} else {","specularStrength = 1.0;","}","#ifdef USE_BUMPMAP","if ( enableBump ) normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","vec3 totalSpecularLight = vec3( 0.0 );","vec3 totalDiffuseLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","float pointDiffuseWeightFull = max( dot( normal, lVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, lVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), uWrapRGB );","float pointSpecularWeight = KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += pointLight[ i ].color * ( pointDiffuseWeight * attenuation );","totalSpecularLight += pointLight[ i ].color * specular * ( pointSpecularWeight * specularStrength * attenuation );","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeightFull = max( dot( normal, dirVector ), 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3 ( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), uWrapRGB );","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * ( dirSpecularWeight * specularStrength );","}","#endif","#if NUM_HEMI_LIGHTS > 0","for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","hemiSpecularWeight += KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","vec3 lVectorGround = -lVector;","hemiSpecularWeight += KS_Skin_Specular( normal, lVectorGround, viewerDirection, uRoughness, uSpecularBrightness );","vec3 hemiSpecularColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","totalSpecularLight += hemiSpecularColor * specular * ( hemiSpecularWeight * specularStrength );","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor * diffuse ) + totalSpecularLight;","gl_FragColor = linearToOutputTexel( vec4( outgoingLight, diffuseColor.a ) );",Ei.fog_fragment,"}"].join("\n"),vertexShader:["uniform vec4 offsetRepeat;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,Ei.lights_pars_begin,Ei.shadowmap_pars_vertex,Ei.fog_pars_vertex,"void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","gl_Position = projectionMatrix * mvPosition;",Ei.shadowmap_vertex,Ei.fog_vertex,"}"].join("\n")},skin:{uniforms:Hr.merge([Ci.fog,Ci.lights,{passID:{value:0},tDiffuse:{value:null},tNormal:{value:null},tBlur1:{value:null},tBlur2:{value:null},tBlur3:{value:null},tBlur4:{value:null},tBeckmann:{value:null},uNormalScale:{value:1},diffuse:{value:new v(15658734)},specular:{value:new v(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75}}]),fragmentShader:["uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform int passID;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tBlur1;","uniform sampler2D tBlur2;","uniform sampler2D tBlur3;","uniform sampler2D tBlur4;","uniform sampler2D tBeckmann;","uniform float uNormalScale;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,Ei.lights_pars_begin,Ei.fog_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 mSpecular = vec4( specular, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse *= colDiffuse;","diffuseColor *= colDiffuse;","vec4 posAndU = vec4( -vViewPosition, vUv.x );","vec4 posAndU_dx = dFdx( posAndU ),  posAndU_dy = dFdy( posAndU );","vec3 tangent = posAndU_dx.w * posAndU_dx.xyz + posAndU_dy.w * posAndU_dy.xyz;","vec3 normal = normalize( vNormal );","vec3 binormal = normalize( cross( tangent, normal ) );","tangent = cross( normal, binormal );","mat3 tsb = mat3( tangent, binormal, normal );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","vec3 finalNormal = tsb * normalTex;","normal = normalize( finalNormal );","vec3 viewerDirection = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 pointVector = normalize( pointLights[ i ].direction );","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","totalDiffuseLight += pointLightColor[ i ] * ( pointDiffuseWeight * attenuation );","if ( passID == 1 ) {","float pointSpecularWeight = KS_Skin_Specular( normal, pointVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += pointLightColor[ i ] * mSpecular.xyz * ( pointSpecularWeight * attenuation );","}","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","if ( passID == 1 ) {","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += directionalLights[ i ].color * mSpecular.xyz * dirSpecularWeight;","}","}","#endif","outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalSpecularLight );","if ( passID == 0 ) {","outgoingLight = sqrt( outgoingLight );","} else if ( passID == 1 ) {","#ifdef VERSION1","vec3 nonblurColor = sqrt(outgoingLight );","#else","vec3 nonblurColor = outgoingLight;","#endif","vec3 blur1Color = texture2D( tBlur1, vUv ).xyz;","vec3 blur2Color = texture2D( tBlur2, vUv ).xyz;","vec3 blur3Color = texture2D( tBlur3, vUv ).xyz;","vec3 blur4Color = texture2D( tBlur4, vUv ).xyz;","outgoingLight = vec3( vec3( 0.22,  0.437, 0.635 ) * nonblurColor + ","vec3( 0.101, 0.355, 0.365 ) * blur1Color + ","vec3( 0.119, 0.208, 0.0 )   * blur2Color + ","vec3( 0.114, 0.0,   0.0 )   * blur3Color + ","vec3( 0.444, 0.0,   0.0 )   * blur4Color );","outgoingLight *= sqrt( colDiffuse.xyz );","outgoingLight += ambientLightColor * diffuse * colDiffuse.xyz + totalSpecularLight;","#ifndef VERSION1","outgoingLight = sqrt( outgoingLight );","#endif","}","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",Ei.fog_fragment,"}"].join("\n"),vertexShader:["#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,Ei.fog_pars_vertex,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec4 displacedPosition = vec4( vNormal.xyz * df, 0.0 ) + mvPosition;","gl_Position = projectionMatrix * displacedPosition;","#else","gl_Position = projectionMatrix * mvPosition;","#endif",Ei.fog_vertex,"}"].join("\n"),vertexShaderUV:["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","gl_Position = vec4( uv.x * 2.0 - 1.0, uv.y * 2.0 - 1.0, 0.0, 1.0 );","}"].join("\n")},beckmann:{uniforms:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","float PHBeckmann( float ndoth, float m ) {","float alpha = acos( ndoth );","float ta = tan( alpha );","float val = 1.0 / ( m * m * pow( ndoth, 4.0 ) ) * exp( -( ta * ta ) / ( m * m ) );","return val;","}","float KSTextureCompute( vec2 tex ) {","return 0.5 * pow( PHBeckmann( tex.x, tex.y ), 0.1 );","}","void main() {","float x = KSTextureCompute( vUv );","gl_FragColor = vec4( x, x, x, 1.0 );","}"].join("\n")}},Nf={terrain:{uniforms:Hr.merge([Ci.fog,Ci.lights,{enableDiffuse1:{value:0},enableDiffuse2:{value:0},enableSpecular:{value:0},enableReflection:{value:0},tDiffuse1:{value:null},tDiffuse2:{value:null},tDetail:{value:null},tNormal:{value:null},tSpecular:{value:null},tDisplacement:{value:null},uNormalScale:{value:1},uDisplacementBias:{value:0},uDisplacementScale:{value:1},diffuse:{value:new v(15658734)},specular:{value:new v(1118481)},shininess:{value:30},opacity:{value:1},uRepeatBase:{value:new x(1,1)},uRepeatOverlay:{value:new x(1,1)},uOffset:{value:new x(0,0)}}]),fragmentShader:["uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse1;","uniform bool enableDiffuse2;","uniform bool enableSpecular;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","uniform sampler2D tDetail;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tDisplacement;","uniform float uNormalScale;","uniform vec2 uRepeatOverlay;","uniform vec2 uRepeatBase;","uniform vec2 uOffset;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,Ei.bsdfs,Ei.lights_pars_begin,Ei.shadowmap_pars_fragment,Ei.fog_pars_fragment,"float calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {","if ( decayExponent > 0.0 ) {","return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );","}","return 1.0;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec3 specularTex = vec3( 1.0 );","vec2 uvOverlay = uRepeatOverlay * vUv + uOffset;","vec2 uvBase = uRepeatBase * vUv;","vec3 normalTex = texture2D( tDetail, uvOverlay ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse1 && enableDiffuse2 ) {","vec4 colDiffuse1 = texture2D( tDiffuse1, uvOverlay );","vec4 colDiffuse2 = texture2D( tDiffuse2, uvOverlay );","colDiffuse1 = GammaToLinear( colDiffuse1, float( GAMMA_FACTOR ) );","colDiffuse2 = GammaToLinear( colDiffuse2, float( GAMMA_FACTOR ) );","diffuseColor *= mix ( colDiffuse1, colDiffuse2, 1.0 - texture2D( tDisplacement, uvBase ) );"," } else if( enableDiffuse1 ) {","diffuseColor *= texture2D( tDiffuse1, uvOverlay );","} else if( enableDiffuse2 ) {","diffuseColor *= texture2D( tDiffuse2, uvOverlay );","}","if( enableSpecular )","specularTex = texture2D( tSpecular, uvOverlay ).xyz;","mat3 tsb = mat3( vTangent, vBinormal, vNormal );","vec3 finalNormal = tsb * normalTex;","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointDiffuseWeight = max( dot( normal, lVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += attenuation * pointLights[ i ].color * pointDiffuseWeight;","totalSpecularLight += attenuation * pointLights[ i ].color * specular * pointSpecularWeight * pointDiffuseWeight;","}","#endif","#if NUM_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * specular * dirSpecularWeight * dirDiffuseWeight;","}","#endif","#if NUM_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","totalSpecularLight += specular * mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight ) * hemiSpecularWeight * hemiDiffuseWeight;","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor + totalSpecularLight );","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",Ei.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uRepeatBase;","uniform sampler2D tNormal;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.shadowmap_pars_vertex,Ei.fog_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","vBinormal = cross( vNormal, vTangent ) * tangent.w;","vBinormal = normalize( vBinormal );","vUv = uv;","vec2 uvBase = uv * uRepeatBase;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uvBase ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec3 displacedPosition = normal * df + position;","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","#else","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","vec3 normalTex = texture2D( tNormal, uvBase ).xyz * 2.0 - 1.0;","vNormal = normalMatrix * normalTex;",Ei.shadowmap_vertex,Ei.fog_vertex,"}"].join("\n")}},Rf={toon1:{uniforms:{uDirLightPos:{value:new s},uDirLightColor:{value:new v(15658734)},uAmbientLightColor:{value:new v(328965)},uBaseColor:{value:new v(16777215)}},vertexShader:["varying vec3 vNormal;","varying vec3 vRefract;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vNormal = normalize( normalMatrix * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vRefract = refract( normalize( I ), worldNormal, 1.02 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","varying vec3 vRefract;","void main() {","float directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","float intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );","intensity += length(lightWeighting) * 0.2;","float cameraWeighting = dot( normalize( vNormal ), vRefract );","intensity += pow( 1.0 - length( cameraWeighting ), 6.0 );","intensity = intensity * 0.2 + 0.3;","if ( intensity < 0.50 ) {","gl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );","} else {","gl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );","}","}"].join("\n")},toon2:{uniforms:{uDirLightPos:{value:new s},uDirLightColor:{value:new v(15658734)},uAmbientLightColor:{value:new v(328965)},uBaseColor:{value:new v(15658734)},uLineColor1:{value:new v(8421504)},uLineColor2:{value:new v(0)},uLineColor3:{value:new v(0)},uLineColor4:{value:new v(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);","float light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {","gl_FragColor *= vec4( uLineColor1, 1.0 );","}","if ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {","gl_FragColor *= vec4( uLineColor2, 1.0 );","}","}"].join("\n")},hatching:{uniforms:{uDirLightPos:{value:new s},uDirLightColor:{value:new v(15658734)},uAmbientLightColor:{value:new v(328965)},uBaseColor:{value:new v(16777215)},uLineColor1:{value:new v(0)},uLineColor2:{value:new v(0)},uLineColor3:{value:new v(0)},uLineColor4:{value:new v(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.75 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor2, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor3, 1.0 );","}","}","if ( length(lightWeighting) < 0.3465 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor4, 1.0 );","}","}","}"].join("\n")},dotted:{uniforms:{uDirLightPos:{value:new s},uDirLightColor:{value:new v(15658734)},uAmbientLightColor:{value:new v(328965)},uBaseColor:{value:new v(16777215)},uLineColor1:{value:new v(0)}},vertexShader:["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","}"].join("\n")}},If=function(e){void 0==e&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};If.prototype.dot=function(e,t,r){return e[0]*t+e[1]*r},If.prototype.dot3=function(e,t,r,n){return e[0]*t+e[1]*r+e[2]*n},If.prototype.dot4=function(e,t,r,n,i){return e[0]*t+e[1]*r+e[2]*n+e[3]*i},If.prototype.noise=function(e,t){var r,n,i=(e+t)*(.5*(Math.sqrt(3)-1)),o=Math.floor(e+i),a=Math.floor(t+i),s=(3-Math.sqrt(3))/6,c=(o+a)*s,u=e-(o-c),l=t-(a-c);u>l?(r=1,n=0):(r=0,n=1);var h=u-r+s,d=l-n+s,f=u-1+2*s,p=l-1+2*s,m=255&o,v=255&a,g=this.perm[m+this.perm[v]]%12,y=this.perm[m+r+this.perm[v+n]]%12,b=this.perm[m+1+this.perm[v+1]]%12,x=.5-u*u-l*l,w=.5-h*h-d*d,_=.5-f*f-p*p;return 70*((x<0?0:(x*=x)*x*this.dot(this.grad3[g],u,l))+(w<0?0:(w*=w)*w*this.dot(this.grad3[y],h,d))+(_<0?0:(_*=_)*_*this.dot(this.grad3[b],f,p)))},If.prototype.noise3d=function(e,t,r){var n,i,o,a,s,c,u=(e+t+r)*(1/3),l=Math.floor(e+u),h=Math.floor(t+u),d=Math.floor(r+u),f=1/6,p=(l+h+d)*f,m=e-(l-p),v=t-(h-p),g=r-(d-p);m>=v?v>=g?(n=1,i=0,o=0,a=1,s=1,c=0):m>=g?(n=1,i=0,o=0,a=1,s=0,c=1):(n=0,i=0,o=1,a=1,s=0,c=1):v<g?(n=0,i=0,o=1,a=0,s=1,c=1):m<g?(n=0,i=1,o=0,a=0,s=1,c=1):(n=0,i=1,o=0,a=1,s=1,c=0);var y=m-n+f,b=v-i+f,x=g-o+f,w=m-a+2*f,_=v-s+2*f,S=g-c+2*f,M=m-1+.5,T=v-1+.5,A=g-1+.5,E=255&l,C=255&h,L=255&d,P=this.perm[E+this.perm[C+this.perm[L]]]%12,O=this.perm[E+n+this.perm[C+i+this.perm[L+o]]]%12,N=this.perm[E+a+this.perm[C+s+this.perm[L+c]]]%12,R=this.perm[E+1+this.perm[C+1+this.perm[L+1]]]%12,I=.6-m*m-v*v-g*g,D=.6-y*y-b*b-x*x,F=.6-w*w-_*_-S*S,U=.6-M*M-T*T-A*A;return 32*((I<0?0:(I*=I)*I*this.dot3(this.grad3[P],m,v,g))+(D<0?0:(D*=D)*D*this.dot3(this.grad3[O],y,b,x))+(F<0?0:(F*=F)*F*this.dot3(this.grad3[N],w,_,S))+(U<0?0:(U*=U)*U*this.dot3(this.grad3[R],M,T,A)))},If.prototype.noise4d=function(e,t,r,n){var i,o,a,s,c,u,l,h,d,f,p,m,v=this.grad4,g=this.simplex,y=this.perm,b=(Math.sqrt(5)-1)/4,x=(5-Math.sqrt(5))/20,w=(e+t+r+n)*b,_=Math.floor(e+w),S=Math.floor(t+w),M=Math.floor(r+w),T=Math.floor(n+w),A=(_+S+M+T)*x,E=e-(_-A),C=t-(S-A),L=r-(M-A),P=n-(T-A),O=(E>C?32:0)+(E>L?16:0)+(C>L?8:0)+(E>P?4:0)+(C>P?2:0)+(L>P?1:0),N=E-(i=g[O][0]>=3?1:0)+x,R=C-(o=g[O][1]>=3?1:0)+x,I=L-(a=g[O][2]>=3?1:0)+x,D=P-(s=g[O][3]>=3?1:0)+x,F=E-(c=g[O][0]>=2?1:0)+2*x,U=C-(u=g[O][1]>=2?1:0)+2*x,k=L-(l=g[O][2]>=2?1:0)+2*x,B=P-(h=g[O][3]>=2?1:0)+2*x,z=E-(d=g[O][0]>=1?1:0)+3*x,j=C-(f=g[O][1]>=1?1:0)+3*x,V=L-(p=g[O][2]>=1?1:0)+3*x,G=P-(m=g[O][3]>=1?1:0)+3*x,W=E-1+4*x,H=C-1+4*x,X=L-1+4*x,q=P-1+4*x,Y=255&_,J=255&S,Q=255&M,Z=255&T,K=y[Y+y[J+y[Q+y[Z]]]]%32,$=y[Y+i+y[J+o+y[Q+a+y[Z+s]]]]%32,ee=y[Y+c+y[J+u+y[Q+l+y[Z+h]]]]%32,te=y[Y+d+y[J+f+y[Q+p+y[Z+m]]]]%32,re=y[Y+1+y[J+1+y[Q+1+y[Z+1]]]]%32,ne=.6-E*E-C*C-L*L-P*P,ie=.6-N*N-R*R-I*I-D*D,oe=.6-F*F-U*U-k*k-B*B,ae=.6-z*z-j*j-V*V-G*G,se=.6-W*W-H*H-X*X-q*q;return 27*((ne<0?0:(ne*=ne)*ne*this.dot4(v[K],E,C,L,P))+(ie<0?0:(ie*=ie)*ie*this.dot4(v[$],N,R,I,D))+(oe<0?0:(oe*=oe)*oe*this.dot4(v[ee],F,U,k,B))+(ae<0?0:(ae*=ae)*ae*this.dot4(v[te],z,j,V,G))+(se<0?0:(se*=se)*se*this.dot4(v[re],W,H,X,q)))};var Df=function(e,t,r){this._scene=e,this._trackInfo=t,this._onUpdate=r,this._mixer=new Ir(e),this._clip=null,this._action=null,this._tracks={},this._propRefs={},this._channelNames=[]};Df.prototype={constructor:Df,init:function(e){for(var t=[],r=this._trackInfo,n=0,i=r.length;n!==i;++n){var o=r[n];t.push(this._addTrack(o.type,o.propertyPath,o.initialValue,o.interpolation))}this._clip=new Nr("editclip",0,t),this._action=this._mixer.clipAction(this._clip).play()},setDisplayTime:function(e){this._action.time=e,this._mixer.update(0),this._onUpdate()},setDuration:function(e){this._clip.duration=e},getChannelNames:function(){return this._channelNames},getChannelKeyTimes:function(e){return this._tracks[e].times},setKeyframe:function(e,t){var r=this._tracks[e],n=r.times,i=Timeliner.binarySearch(n,t),o=r.values,a=r.getValueSize(),s=i*a;if(i<0){s=(i=~i)*a;for(var c=n.length+1,u=o.length+a,l=c-1;l!==i;--l)n[l]=n[l-1];l=u-1;for(var h=s+a-1;l!==h;--l)o[l]=o[l-a]}n[i]=t,this._propRefs[e].getValue(o,s)},delKeyframe:function(e,t){var r=this._tracks[e],n=r.times,i=Timeliner.binarySearch(n,t);if(n.length>1&&i>=0){for(var o=n.length-1,a=r.values,s=r.getValueSize(),c=a.length-s,u=i;u!==o;++u)n[u]=n[u+1];n.pop();for(var l=i*s;l!==c;++l)a[l]=a[l+s];a.length=c}},moveKeyframe:function(e,t,r,n){var i=this._tracks[e],o=i.times,a=Timeliner.binarySearch(o,t);if(a>=0){for(var s=n?o.length:a+1,c=o[a-1]<=t||!n&&t>=o[a+1];a!==s;)o[a++]+=r;c&&this._sort(i)}},serialize:function(){for(var e={duration:this._clip.duration,channels:{}},t=this._channelNames,r=this._tracks,n=e.channels,i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a];n[a]={times:s.times,values:s.values}}return e},deserialize:function(e){var t=this._channelNames,r=this._tracks,n=e.channels;this.setDuration(e.duration);for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a],c=n[a];this._setArray(s.times,c.times),this._setArray(s.values,c.values)}this.setDisplayTime(this._mixer.time)},_sort:function(e){var t=e.times,r=wr.getKeyframeOrder(t);this._setArray(t,wr.sortedArray(t,1,r));var n=e.values,i=e.getValueSize();this._setArray(n,wr.sortedArray(n,i,r))},_setArray:function(e,t){e.length=0,e.push.apply(e,t)},_addTrack:function(e,t,r,n){var i=new e(t,[0],r,n);return i.times=Array.prototype.slice.call(i.times),i.values=Array.prototype.slice.call(i.values),this._channelNames.push(t),this._tracks[t]=i,this._propRefs[t]=new br(this._scene,t),i}};var Ff={quicksortIP:function(e,t,r){for(var n,i,o=[],a=-1,s=0,c=e.length/t-1,u=0,l=0,h=0,d=function(r,n){for(r*=t,n*=t,h=0;h<t;h++)u=e[r+h],e[r+h]=e[n+h],e[n+h]=u},f=new Float32Array(t),p=new Float32Array(t);;)if(c-s<=25){for(i=s+1;i<=c;i++){for(l=0;l<t;l++)f[l]=e[i*t+l];for(n=i-1;n>=s&&e[n*t+r]>f[r];){for(l=0;l<t;l++)e[(n+1)*t+l]=e[n*t+l];n--}for(l=0;l<t;l++)e[(n+1)*t+l]=f[l]}if(-1==a)break;c=o[a--],s=o[a--]}else{for(i=c,d(s+c>>1,n=s+1),e[s*t+r]>e[c*t+r]&&d(s,c),e[n*t+r]>e[c*t+r]&&d(n,c),e[s*t+r]>e[n*t+r]&&d(s,n),l=0;l<t;l++)p[l]=e[n*t+l];for(;;){do{n++}while(e[n*t+r]<p[r]);do{i--}while(e[i*t+r]>p[r]);if(i<n)break;d(n,i)}for(l=0;l<t;l++)e[(s+1)*t+l]=e[i*t+l],e[i*t+l]=p[l];c-n+1>=i-s?(o[++a]=n,o[++a]=c,c=i-1):(o[++a]=s,o[++a]=i-1,s=n)}return e},Kdtree:function(e,t,r){var n=this,i=0,o=function(e,t){return e.subarray(t*r,t*r+r)};this.root=function e(t,a,s,c){var u,l,h=a%r,d=t.length/r;return a>i&&(i=a),0===d?null:1===d?new n.Node(o(t,0),a,s,c):(Ff.quicksortIP(t,r,h),u=Math.floor(d/2),(l=new n.Node(o(t,u),a,s,u+c)).left=e(t.subarray(0,u*r),a+1,l,c),l.right=e(t.subarray((u+1)*r,t.length),a+1,l,c+u+1),l)}(e,0,null,0),this.getMaxDepth=function(){return i},this.nearest=function(e,i,o){var a,s,c;if(c=new Ff.Kdtree.BinaryHeap(function(e){return-e[1]}),o)for(a=0;a<i;a+=1)c.push([null,o]);for(function n(o){var a,s,u,l,h=o.depth%r,d=t(e,o.obj),f=[];function p(e,t){c.push([e,t]),c.size()>i&&c.pop()}for(l=0;l<r;l+=1)l===o.depth%r?f[l]=e[l]:f[l]=o.obj[l];s=t(f,o.obj),null!==o.right||null!==o.left?(n(a=null===o.right?o.left:null===o.left?o.right:e[h]<o.obj[h]?o.left:o.right),(c.size()<i||d<c.peek()[1])&&p(o,d),(c.size()<i||Math.abs(s)<c.peek()[1])&&null!==(u=a===o.left?o.right:o.left)&&n(u)):(c.size()<i||d<c.peek()[1])&&p(o,d)}(n.root),s=[],a=0;a<i;a+=1)c.content[a][0]&&s.push([c.content[a][0],c.content[a][1]]);return s}}};Ff.Kdtree.prototype.Node=function(e,t,r,n){this.obj=e,this.left=null,this.right=null,this.parent=r,this.depth=t,this.pos=n},Ff.Kdtree.BinaryHeap=function(e){this.content=[],this.scoreFunction=e},Ff.Kdtree.BinaryHeap.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,r=0;r<t;r++)if(this.content[r]==e){var n=this.content.pop();return void(r!=t-1&&(this.content[r]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.bubbleUp(r):this.sinkDown(r)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];e>0;){var r=Math.floor((e+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[r]=t,this.content[e]=n,e=r}},sinkDown:function(e){for(var t=this.content.length,r=this.content[e],n=this.scoreFunction(r);;){var i=2*(e+1),o=i-1,a=null;if(o<t){var s=this.content[o],c=this.scoreFunction(s);c<n&&(a=o)}if(i<t){var u=this.content[i];this.scoreFunction(u)<(null===a?n:c)&&(a=i)}if(null===a)break;this.content[e]=this.content[a],this.content[a]=r,e=a}}};var Uf={merge:function(e,t,r){var n;console.warn("GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t instanceof dr&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},randomPointInTriangle:function(){var e=new s;return function(t,r,n){var i=new s,o=Math.random(),a=Math.random();o+a>1&&(o=1-o,a=1-a);var c=1-o-a;return i.copy(t),i.multiplyScalar(o),e.copy(r),e.multiplyScalar(a),i.add(e),e.copy(n),e.multiplyScalar(c),i.add(e),i}}(),randomPointInFace:function(e,t){var r,n,i;return r=t.vertices[e.a],n=t.vertices[e.b],i=t.vertices[e.c],Uf.randomPointInTriangle(r,n,i)},randomPointsInGeometry:function(e,t){var r,n,i,o,a,s=e.faces,c=e.vertices,u=s.length,l=0,h=[];for(n=0;n<u;n++)i=c[(r=s[n]).a],o=c[r.b],a=c[r.c],r._area=Uf.triangleArea(i,o,a),l+=r._area,h[n]=l;function d(e){return function t(r,n){if(n<r)return r;var i=r+Math.floor((n-r)/2);return h[i]>e?t(r,i-1):h[i]<e?t(i+1,n):i}(0,h.length-1)}var f,p=[];for(n=0;n<t;n++)f=d(Math.random()*l),p[n]=Uf.randomPointInFace(s[f],e);return p},randomPointsInBufferGeometry:function(e,t){var r,n,i,o,a=e.attributes.position.array,c=0,u=[];n=new s,i=new s,o=new s;var l=a.length/9;for(r=0;r<l;r++)n.set(a[9*r+0],a[9*r+1],a[9*r+2]),i.set(a[9*r+3],a[9*r+4],a[9*r+5]),o.set(a[9*r+6],a[9*r+7],a[9*r+8]),c+=Uf.triangleArea(n,i,o),u.push(c);function h(e){return function t(r,n){if(n<r)return r;var i=r+Math.floor((n-r)/2);return u[i]>e?t(r,i-1):u[i]<e?t(i+1,n):i}(0,u.length-1)}var d,f=[];for(r=0;r<t;r++)d=h(Math.random()*c),n.set(a[9*d+0],a[9*d+1],a[9*d+2]),i.set(a[9*d+3],a[9*d+4],a[9*d+5]),o.set(a[9*d+6],a[9*d+7],a[9*d+8]),f[r]=Uf.randomPointInTriangle(n,i,o);return f},triangleArea:function(){var e=new s,t=new s;return function(r,n,i){return e.subVectors(n,r),t.subVectors(i,r),e.cross(t),.5*e.length()}}(),center:function(e){return console.warn("GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},kf={setQuaternionFromProperEuler:function(e,t,r,n,i){var o=Math.cos,a=Math.sin,s=o(r/2),c=a(r/2),u=o((t+n)/2),l=a((t+n)/2),h=o((t-n)/2),d=a((t-n)/2),f=o((n-t)/2),p=a((n-t)/2);"XYX"===i?e.set(s*l,c*h,c*d,s*u):"YZY"===i?e.set(c*d,s*l,c*h,s*u):"ZXZ"===i?e.set(c*h,c*d,s*l,s*u):"XZX"===i?e.set(s*l,c*p,c*f,s*u):"YXY"===i?e.set(c*f,s*l,c*p,s*u):"ZYZ"===i?e.set(c*p,c*f,s*l,s*u):console.warn("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}},Bf={createMultiMaterialObject:function(e,t){for(var r=new oo,n=0,i=t.length;n<i;n++)r.add(new dr(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){e.applyMatrix((new a).getInverse(r.matrixWorld)),t.remove(e),r.add(e)}},zf=function(e){var t,r=this,n=void 0!==e.name&&""!==e.name,o=10,a=10,s=256,c=256,u=new Yr(i.innerWidth/-2,i.innerWidth/2,i.innerHeight/2,i.innerHeight/-2,1,10);u.position.set(0,0,2);var l,h,d=new qr,f=Hl,p=new Hr.clone(f.uniforms),m=new Xr({uniforms:p,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}),v=new dr(new en(s,c),m);if(d.add(v),n){var g=(l=document.createElement("canvas")).getContext("2d");g.font="Bold 20px Arial";var y=g.measureText(e.name).width;l.width=y,l.height=25,g.font="Bold 20px Arial",g.fillStyle="rgba( 255, 0, 0, 1 )",g.fillText(e.name,0,20);var b=new Zr(l);b.magFilter=Ze,b.minFilter=Ze,b.needsUpdate=!0;var x=new cr({map:b,side:J});x.transparent=!0;var w=new en(l.width,l.height);h=new dr(w,x),d.add(h)}this.enabled=!0,this.size={width:s,height:c,set:function(e,t){this.width=e,this.height=t,v.scale.set(this.width/s,this.height/c,1),r.position.set(r.position.x,r.position.y)}},this.position={x:o,y:a,set:function(e,t){this.x=e,this.y=t;var o=r.size.width,a=r.size.height;v.position.set(-i.innerWidth/2+o/2+this.x,i.innerHeight/2-a/2-this.y,0),n&&h.position.set(v.position.x,v.position.y-r.size.height/2+l.height/2,0)}},this.render=function(r){this.enabled&&(p.tDiffuse.value=e.shadow.map.texture,t=r.autoClear,r.autoClear=!1,r.clearDepth(),r.render(d,u),r.autoClear=t)},this.updateForWindowResize=function(){this.enabled&&(u.left=i.innerWidth/-2,u.right=i.innerWidth/2,u.top=i.innerHeight/2,u.bottom=i.innerHeight/-2,u.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()};function jf(e){for(var t=function e(t){var r=[];t&&t.isBone&&r.push(t);for(var n=0;n<t.children.length;n++)r.push.apply(r,e(t.children[n]));return r}(e),r=new U,n=[],i=[],o=new v(0,0,1),a=new v(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}r.addAttribute("position",new N(n,3)),r.addAttribute("color",new N(i,3));var u=new ur({vertexColors:K,depthTest:!1,depthWrite:!1,transparent:!0});Eo.call(this,r,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}zf.prototype.constructor=zf,jf.prototype=Object.create(Eo.prototype),jf.prototype.constructor=jf,jf.prototype.updateMatrixWorld=function(){var e=new s,t=new a,r=new a;return function(n){var i=this.bones,o=this.geometry,a=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(t.multiplyMatrices(r,u.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(r,u.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c+1,e.x,e.y,e.z),c+=2)}o.getAttribute("position").needsUpdate=!0,p.prototype.updateMatrixWorld.call(this,n)}}();var Vf={retarget:function(){var e=new s,t=new c,r=new s,n=new a,i=new a,o=new a;return function(a,s,c){(c=c||{}).preserveMatrix=void 0===c.preserveMatrix||c.preserveMatrix,c.preservePosition=void 0===c.preservePosition||c.preservePosition,c.preserveHipPosition=void 0!==c.preserveHipPosition&&c.preserveHipPosition,c.useTargetMatrix=void 0!==c.useTargetMatrix&&c.useTargetMatrix,c.hip=void 0!==c.hip?c.hip:"hip",c.names=c.names||{};var u,l,h,d,f,p,m=s.isObject3D?s.skeleton.bones:this.getBones(s),v=a.isObject3D?a.skeleton.bones:this.getBones(a);if(a.isObject3D?a.skeleton.pose():(c.useTargetMatrix=!0,c.preserveMatrix=!1),c.preservePosition)for(f=[],p=0;p<v.length;p++)f.push(v[p].position.clone());if(c.preserveMatrix)for(a.updateMatrixWorld(),a.matrixWorld.identity(),p=0;p<a.children.length;++p)a.children[p].updateMatrixWorld(!0);if(c.offsets)for(u=[],p=0;p<v.length;++p)l=v[p],h=c.names[l.name]||l.name,c.offsets&&c.offsets[h]&&(l.matrix.multiply(c.offsets[h]),l.matrix.decompose(l.position,l.quaternion,l.scale),l.updateMatrixWorld()),u.push(l.matrixWorld.clone());for(p=0;p<v.length;++p){if(l=v[p],h=c.names[l.name]||l.name,d=this.getBoneByName(h,m),o.copy(l.matrixWorld),d){if(d.updateMatrixWorld(),c.useTargetMatrix?i.copy(d.matrixWorld):(i.getInverse(a.matrixWorld),i.multiply(d.matrixWorld)),r.setFromMatrixScale(i),i.scale(r.set(1/r.x,1/r.y,1/r.z)),o.makeRotationFromQuaternion(t.setFromRotationMatrix(i)),a.isObject3D){var g=v.indexOf(l),y=u?u[g]:n.getInverse(a.skeleton.boneInverses[g]);o.multiply(y)}o.copyPosition(i)}l.parent&&l.parent.isBone?(l.matrix.getInverse(l.parent.matrixWorld),l.matrix.multiply(o)):l.matrix.copy(o),c.preserveHipPosition&&h===c.hip&&l.matrix.setPosition(e.set(0,l.position.y,0)),l.matrix.decompose(l.position,l.quaternion,l.scale),l.updateMatrixWorld()}if(c.preservePosition)for(p=0;p<v.length;++p)l=v[p],(h=c.names[l.name]||l.name)!==c.hip&&l.position.copy(f[p]);c.preserveMatrix&&a.updateMatrixWorld(!0)}}(),retargetClip:function(e,t,r,n){(n=n||{}).useFirstFramePosition=void 0!==n.useFirstFramePosition&&n.useFirstFramePosition,n.fps=void 0!==n.fps?n.fps:30,n.names=n.names||[],t.isObject3D||(t=this.getHelperFromSkeleton(t));var i,o,a,s,c,u,l=Math.round(r.duration*(n.fps/1e3)*1e3),h=1/n.fps,d=[],f=new Ir(t),p=this.getBones(e.skeleton),m=[];for(f.clipAction(r).play(),f.update(0),t.updateMatrixWorld(),c=0;c<l;++c){var v=c*h;for(this.retarget(e,t,n),u=0;u<p.length;++u)s=n.names[p[u].name]||p[u].name,this.getBoneByName(s,t.skeleton)&&(o=p[u],a=m[u]=m[u]||{bone:o},n.hip===s&&(a.pos||(a.pos={times:new Float32Array(l),values:new Float32Array(3*l)}),n.useFirstFramePosition&&(0===c&&(i=o.position.clone()),o.position.sub(i)),a.pos.times[c]=v,o.position.toArray(a.pos.values,3*c)),a.quat||(a.quat={times:new Float32Array(l),values:new Float32Array(4*l)}),a.quat.times[c]=v,o.quaternion.toArray(a.quat.values,4*c));f.update(h),t.updateMatrixWorld()}for(c=0;c<m.length;++c)(a=m[c])&&(a.pos&&d.push(new Or(".bones["+a.bone.name+"].position",a.pos.times,a.pos.values)),d.push(new Lr(".bones["+a.bone.name+"].quaternion",a.quat.times,a.quat.values)));return f.uncacheAction(r),new Nr(r.name,-1,d)},getHelperFromSkeleton:function(e){var t=new jf(e.bones[0]);return t.skeleton=e,t},getSkeletonOffsets:function(){var e=new s,t=new s,r=new s,n=new s,i=new x,o=new x;return function(s,c,u){(u=u||{}).hip=void 0!==u.hip?u.hip:"hip",u.names=u.names||{},c.isObject3D||(c=this.getHelperFromSkeleton(c));var h,d,f,p,m=Object.keys(u.names),v=Object.values(u.names),g=c.isObject3D?c.skeleton.bones:this.getBones(c),y=s.isObject3D?s.skeleton.bones:this.getBones(s),b=[];for(s.skeleton.pose(),p=0;p<y.length;++p)if(h=y[p],f=u.names[h.name]||h.name,(d=this.getBoneByName(f,g))&&f!==u.hip){var w=this.getNearestBone(h.parent,m),_=this.getNearestBone(d.parent,v);w.updateMatrixWorld(),_.updateMatrixWorld(),e.setFromMatrixPosition(w.matrixWorld),t.setFromMatrixPosition(h.matrixWorld),r.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(d.matrixWorld),i.subVectors(new x(t.x,t.y),new x(e.x,e.y)).normalize(),o.subVectors(new x(n.x,n.y),new x(r.x,r.y)).normalize();var S=i.angle()-o.angle(),M=(new a).makeRotationFromEuler(new l(0,0,S));h.matrix.multiply(M),h.matrix.decompose(h.position,h.quaternion,h.scale),h.updateMatrixWorld(),b[f]=M}return b}}(),renameBones:function(e,t){for(var r=this.getBones(e),n=0;n<r.length;++n){var i=r[n];t[i.name]&&(i.name=t[i.name])}return this},getBones:function(e){return Array.isArray(e)?e:e.bones},getBoneByName:function(e,t){for(var r=0,n=this.getBones(t);r<n.length;r++)if(e===n[r].name)return n[r]},getNearestBone:function(e,t){for(;e.isBone;){if(-1!==t.indexOf(e.name))return e;e=e.parent}},findBoneTrackData:function(e,t){for(var r=/\[(.*)\]\.(.*)/,n={name:e},i=0;i<t.length;++i){var o=r.exec(t[i].name);o&&e===o[1]&&(n[o[2]]=i)}return n},getEqualsBonesNames:function(e,t){var r=this.getBones(e),n=this.getBones(t),i=[];e:for(var o=0;o<r.length;o++)for(var a=r[o].name,s=0;s<n.length;s++)if(a===n[s].name){i.push(a);continue e}return i}},Gf=function(e,t,r){var n=this;this.volume=e,t=t||0,Object.defineProperty(this,"index",{get:function(){return t},set:function(e){return t=e,n.geometryNeedsUpdate=!0,t}}),this.axis=r||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var i=new Zr(this.canvas);i.minFilter=Ze,i.wrapS=i.wrapT=Xe;var o=new cr({map:i,side:J,transparent:!0});this.mesh=new dr(this.geometry,o),this.geometryNeedsUpdate=!0,this.repaint()};Gf.prototype={constructor:Gf,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,t=this.jLength,r=this.sliceAccess,n=this.volume,i=this.canvasBuffer,o=this.ctxBuffer,a=o.getImageData(0,0,e,t),s=a.data,c=n.data,u=n.upperThreshold,l=n.lowerThreshold,h=n.windowLow,d=n.windowHigh,f=0;if("label"===n.dataType)for(var p=0;p<t;p++)for(var m=0;m<e;m++){var v=c[r(m,p)];v=v>=this.colorMap.length?v%this.colorMap.length+1:v;var g=this.colorMap[v];s[4*f]=g>>24&255,s[4*f+1]=g>>16&255,s[4*f+2]=g>>8&255,s[4*f+3]=255&g,f++}else for(p=0;p<t;p++)for(m=0;m<e;m++){var y=c[r(m,p)],b=255;b=u>=y&&l<=y?b:0,y=(y=Math.floor(255*(y-h)/(d-h)))>255?255:y<0?0:0|y,s[4*f]=y,s[4*f+1]=y,s[4*f+2]=y,s[4*f+3]=b,f++}o.putImageData(a,0,0),this.ctx.drawImage(i,0,0,e,t,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var e=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=e.sliceAccess,this.jLength=e.jLength,this.iLength=e.iLength,this.matrix=e.matrix,this.canvas.width=e.planeWidth,this.canvas.height=e.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry=new en(e.planeWidth,e.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix=(new a).identity(),this.mesh.applyMatrix(this.matrix)),this.geometryNeedsUpdate=!1}};var Wf=function(){p.call(this);var e,t=this,r=[0,0],n=!1,i=new s;this.matrixAutoUpdate=!1,this.getGamepad=function(){return e},this.getTouchpadState=function(){return n},this.update=function(){if(void 0!==(e=function(){for(var e=navigator.getGamepads&&navigator.getGamepads(),t=0;t<4;t++){var r=e[t];if(r&&"Daydream Controller"===r.id)return r}}())&&void 0!==e.pose){var o=e.pose;if(null===o)return;null!==o.orientation&&t.quaternion.fromArray(o.orientation),t.updateMatrix(),t.visible=!0,null===o.angularVelocity||i.equals(o.angularVelocity)||(i.fromArray(o.angularVelocity),t.dispatchEvent({type:"angularvelocitychanged",angularVelocity:i})),r[0]===e.axes[0]&&r[1]===e.axes[1]||(r[0]=e.axes[0],r[1]=e.axes[1],t.dispatchEvent({type:"axischanged",axes:r})),n!==e.buttons[0].pressed&&(n=e.buttons[0].pressed,t.dispatchEvent({type:n?"touchpaddown":"touchpadup"}))}else t.visible=!1},this.getTouchPadState=function(){return console.warn("DaydreamController: getTouchPadState() is now getTouchpadState()"),n}};(Wf.prototype=Object.create(p.prototype)).constructor=Wf;var Hf=function(){p.call(this);var e,t=this,r=[0,0],n=!1,i=!1,o=new s;this.matrixAutoUpdate=!0,this.getGamepad=function(){return e},this.getTouchpadState=function(){return n},this.update=function(){if(void 0!==(e=function(){for(var e=navigator.getGamepads&&navigator.getGamepads(),t=0;t<4;t++){var r=e[t];if(r&&("Gear VR Controller"===r.id||"Oculus Go Controller"===r.id))return r}}())&&void 0!==e.pose){var a=e.pose;if(null===a)return;null!==a.orientation&&t.quaternion.fromArray(a.orientation),t.updateMatrix(),t.visible=!0,null===a.angularVelocity||o.equals(a.angularVelocity)||(o.fromArray(a.angularVelocity),t.dispatchEvent({type:"angularvelocitychanged",angularVelocity:o})),r[0]===e.axes[0]&&r[1]===e.axes[1]||(r[0]=e.axes[0],r[1]=e.axes[1],t.dispatchEvent({type:"axischanged",axes:r})),n!==e.buttons[0].pressed&&(n=e.buttons[0].pressed,t.dispatchEvent({type:n?"touchpaddown":"touchpadup",axes:r})),i!==e.buttons[1].pressed&&(i=e.buttons[1].pressed,t.dispatchEvent({type:i?"triggerdown":"triggerup"}))}else t.visible=!1},this.getTouchPadState=function(){return console.warn("GearVRController: getTouchPadState() is now getTouchpadState()"),n},this.setHand=function(){console.warn("GearVRController: setHand() has been removed.")}};(Hf.prototype=Object.create(p.prototype)).constructor=Hf;var Xf=function(e){p.call(this);var t,r=this,n=[0,0],i=!1,o=!1,s=!1,c=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new a,this.getGamepad=function(){return t},this.getButtonState=function(e){return"thumbpad"===e?i:"trigger"===e?o:"grips"===e?s:"menu"===e?c:void 0},this.update=function(){if(void 0!==(t=function(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0;r<t.length;r++){var i=t[r];if(i&&("OpenVR Gamepad"===i.id||i.id.startsWith("Oculus Touch")||i.id.startsWith("Spatial Controller"))){if(n===e)return i;n++}}}(e))&&void 0!==t.pose){if(null===t.pose)return;var a=t.pose;null!==a.position&&r.position.fromArray(a.position),null!==a.orientation&&r.quaternion.fromArray(a.orientation),r.matrix.compose(r.position,r.quaternion,r.scale),r.matrix.premultiply(r.standingMatrix),r.matrixWorldNeedsUpdate=!0,r.visible=!0,n[0]===t.axes[0]&&n[1]===t.axes[1]||(n[0]=t.axes[0],n[1]=t.axes[1],r.dispatchEvent({type:"axischanged",axes:n})),i!==t.buttons[0].pressed&&(i=t.buttons[0].pressed,r.dispatchEvent({type:i?"thumbpaddown":"thumbpadup",axes:n})),o!==t.buttons[1].pressed&&(o=t.buttons[1].pressed,r.dispatchEvent({type:o?"triggerdown":"triggerup"})),s!==t.buttons[2].pressed&&(s=t.buttons[2].pressed,r.dispatchEvent({type:s?"gripsdown":"gripsup"})),c!==t.buttons[3].pressed&&(c=t.buttons[3].pressed,r.dispatchEvent({type:c?"menudown":"menuup"}))}else r.visible=!1}};function qf(e,t,r,n){_.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new Yf(e,t,r,n)),this.mergeVertices()}function Yf(e,t,r,n){U.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o,a=[],c=[],u=[],l=[],h=new s,d=new x;for(c.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var f=r+o/t*n;h.x=e*Math.cos(f),h.y=e*Math.sin(f),c.push(h.x,h.y,h.z),u.push(0,0,1),d.x=(c[i]/e+1)/2,d.y=(c[i+1]/e+1)/2,l.push(d.x,d.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new N(c,3)),this.addAttribute("normal",new N(u,3)),this.addAttribute("uv",new N(l,2))}function Jf(e,t){_.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Qf(e,t)),this.mergeVertices()}function Qf(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];Gn.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Zf(e,t){_.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Kf(e,t)),this.mergeVertices()}function Kf(e,t){U.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var r=[],n=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))u(e);else for(var c=0;c<e.length;c++)u(e[c]),this.addGroup(a,s,c),a+=s,s=0;function u(e){var a,c,u,l=n.length/3,h=e.extractPoints(t),d=h.shape,f=h.holes;if(!1===ws.isClockWise(d))for(d=d.reverse(),a=0,c=f.length;a<c;a++)u=f[a],!0===ws.isClockWise(u)&&(f[a]=u.reverse());var p=ws.triangulateShape(d,f);for(a=0,c=f.length;a<c;a++)u=f[a],d=d.concat(u);for(a=0,c=d.length;a<c;a++){var m=d[a];n.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=p.length;a<c;a++){var v=p[a],g=v[0]+l,y=v[1]+l,b=v[2]+l;r.push(g,y,b),s+=3}}this.setIndex(r),this.addAttribute("position",new N(n,3)),this.addAttribute("normal",new N(i,3)),this.addAttribute("uv",new N(o,2))}function $f(e,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(Xf.prototype=Object.create(p.prototype)).constructor=Xf,qf.prototype=Object.create(_.prototype),qf.prototype.constructor=qf,Yf.prototype=Object.create(U.prototype),Yf.prototype.constructor=Yf,Jf.prototype=Object.create(_.prototype),Jf.prototype.constructor=Jf,Qf.prototype=Object.create(Gn.prototype),Qf.prototype.constructor=Qf,Zf.prototype=Object.create(_.prototype),Zf.prototype.constructor=Zf,Zf.prototype.toJSON=function(){var e=_.prototype.toJSON.call(this);return $f(this.parameters.shapes,e)},Kf.prototype=Object.create(U.prototype),Kf.prototype.constructor=Kf,Kf.prototype.toJSON=function(){var e=U.prototype.toJSON.call(this);return $f(this.parameters.shapes,e)};var ep=function(e){Xf.call(this,e);var t=2*Math.PI,r={COLOR:0,SIZE:1},n=r.COLOR,i=new v(1,1,1),o=1;var a=new dr(s=new Yf(1,32),d=new cr({map:function(){var e=document.createElement("canvas");e.width=256,e.height=256;for(var r=e.getContext("2d"),n=r.getImageData(0,0,256,256),i=n.data,o=new v,a=0,s=0;a<i.length;a+=4,s++){var c=s%256/256-.5,u=Math.floor(s/256)/256-.5;o.setHSL(Math.atan2(u,c)/t,1,2*(.5-Math.sqrt(c*c+u*u))),i[a+0]=256*o.r,i[a+1]=256*o.g,i[a+2]=256*o.b,i[a+3]=256}return r.putImageData(n,0,0),new xc(e)}()}));a.position.set(0,.005,.0495),a.rotation.x=-1.45,a.scale.setScalar(.02),this.add(a);var s=new Qf(.1,2);(d=new cr).color=i;var c=new dr(s,d);a.add(c);var u=new oo;u.position.set(0,.005,.0495),u.rotation.x=-1.45,u.scale.setScalar(.02),this.add(u);var l=new Ka;l.moveTo(0,-1),l.lineTo(1,1),l.lineTo(-1,1);var h=new dr(s=new Kf(l),d=new cr({color:2236962,wireframe:!0}));h.position.z=.001,p(h.geometry,1),u.add(h);var d;s=new Kf(l);(d=new cr({side:J})).color=i;var f=new dr(s,d);function p(e,t){var r=Math.atan(.25),n=1.5*t,i=Math.tan(r)*n*2,o=e.attributes.position;o.setXYZ(0,0,-.75,0),o.setXYZ(1,0+i/2,-.75+n,0),o.setXYZ(2,0-i/2,-.75+n,0),o.needsUpdate=!0}f.position.z=.0011,p(f.geometry,.5),u.add(f),u.visible=!1,this.getColor=function(){return i},this.getSize=function(){return o},this.addEventListener("axischanged",function(e){if(!1!==this.getButtonState("thumbpad")){var a=e.axes[0]/2,s=-e.axes[1]/2;if(n===r.COLOR&&(i.setHSL(Math.atan2(s,a)/t,1,2*(.5-Math.sqrt(a*a+s*s))),c.position.set(e.axes[0],e.axes[1],0)),n===r.SIZE){var u=.5-s;o=2*u,p(f.geometry,u)}}}),this.addEventListener("gripsdown",function(){return n===r.COLOR?(n=r.SIZE,a.visible=!1,void(u.visible=!0)):n===r.SIZE?(n=r.COLOR,a.visible=!0,void(u.visible=!1)):void 0})};(ep.prototype=Object.create(Xf.prototype)).constructor=ep;var tp,rp={createButton:function(e,t){function r(t){a.style.display="",a.style.cursor="pointer",a.style.left="calc(50% - 50px)",a.style.width="100px",a.textContent="ENTER VR",a.onmouseenter=function(){a.style.opacity="1.0"},a.onmouseleave=function(){a.style.opacity="0.5"},a.onclick=function(){t.isPresenting?t.exitPresent():t.requestPresent([{source:e.domElement}])},e.vr.setDevice(t)}function n(){a.style.display="",a.style.cursor="auto",a.style.left="calc(50% - 75px)",a.style.width="150px",a.textContent="VR NOT FOUND",a.onmouseenter=null,a.onmouseleave=null,a.onclick=null,e.vr.setDevice(null)}function o(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}var a;if(t&&t.frameOfReferenceType&&e.vr.setFrameOfReferenceType(t.frameOfReferenceType),"xr"in navigator)return(a=document.createElement("button")).style.display="none",o(a),navigator.xr.requestDevice().then(function(t){t.supportsSession({immersive:!0,exclusive:!0}).then(function(){!function(t){var r=null;function n(t){t.addEventListener("end",i),e.vr.setSession(t),a.textContent="EXIT VR",r=t}function i(t){r.removeEventListener("end",i),e.vr.setSession(null),a.textContent="ENTER VR",r=null}a.style.display="",a.style.cursor="pointer",a.style.left="calc(50% - 50px)",a.style.width="100px",a.textContent="ENTER VR",a.onmouseenter=function(){a.style.opacity="1.0"},a.onmouseleave=function(){a.style.opacity="0.5"},a.onclick=function(){null===r?t.requestSession({immersive:!0,exclusive:!0}).then(n):r.end()},e.vr.setDevice(t)}(t)}).catch(n)}).catch(n),a;if("getVRDisplays"in navigator)return(a=document.createElement("button")).style.display="none",o(a),i.addEventListener("vrdisplayconnect",function(e){r(e.display)},!1),i.addEventListener("vrdisplaydisconnect",function(e){n()},!1),i.addEventListener("vrdisplaypresentchange",function(e){a.textContent=e.display.isPresenting?"EXIT VR":"ENTER VR"},!1),i.addEventListener("vrdisplayactivate",function(t){t.display.requestPresent([{source:e.domElement}])},!1),navigator.getVRDisplays().then(function(e){e.length>0?r(e[0]):n()}).catch(n),a;var s=document.createElement("a");return s.href="https://webvr.info",s.innerHTML="WEBVR NOT SUPPORTED",s.style.left="calc(50% - 90px)",s.style.width="180px",s.style.textDecoration="none",o(s),s},checkAvailability:function(){return console.warn("WEBVR.checkAvailability has been deprecated."),new Promise(function(){})},getMessageContainer:function(){return console.warn("WEBVR.getMessageContainer has been deprecated."),document.createElement("div")},getButton:function(){return console.warn("WEBVR.getButton has been deprecated."),document.createElement("div")},getVRDisplay:function(){console.warn("WEBVR.getVRDisplay has been deprecated.")}};function np(){var e=arguments;this.uuid=o.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,n=arguments.length;r!==n;++r)t[e[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function ip(e){p.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function op(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}Object.assign(np.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=arguments,t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,u=void 0,l=0,h=arguments.length;l!==h;++l){var d=e[l],f=d.uuid,p=i[f];if(void 0===p){p=r++,i[f]=p,t.push(d);for(var m=0,v=c;m!==v;++m)s[m].push(new br(d,o[m],a[m]))}else if(p<n){u=t[p];var g=--n,y=t[g];i[y.uuid]=p,t[p]=y,i[f]=g,t[g]=d;for(m=0,v=c;m!==v;++m){var b=s[m],x=b[g],w=b[p];b[p]=x,void 0===w&&(w=new br(d,o[m],a[m])),b[g]=w}}else t[p]!==u&&console.error("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=arguments,t=this._objects,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=e[a],u=c.uuid,l=n[u];if(void 0!==l&&l>=r){var h=r++,d=t[h];n[d.uuid]=l,t[l]=d,n[u]=h,t[h]=c;for(var f=0,p=o;f!==p;++f){var m=i[f],v=m[h],g=m[l];m[l]=v,m[h]=g}}}this.nCachedObjects_=r},uncache:function(){for(var e=arguments,t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var u=e[s].uuid,l=i[u];if(void 0!==l)if(delete i[u],l<n){var h=--n,d=t[h],f=t[y=--r];i[d.uuid]=l,t[l]=d,i[f.uuid]=h,t[h]=f,t.pop();for(var p=0,m=a;p!==m;++p){var v=(b=o[p])[h],g=b[y];b[l]=v,b[h]=g,b.pop()}}else{var y;i[(f=t[y=--r]).uuid]=l,t[l]=f,t.pop();for(p=0,m=a;p!==m;++p){var b;(b=o[p])[l]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);n=i.length,r[e]=n,o.push(e),a.push(t),i.push(l);for(var h=u,d=s.length;h!==d;++h){var f=s[h];l[h]=new br(f,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=r,o[r]=s,o.pop(),i[r]=i[a],i.pop(),n[r]=n[a],n.pop()}}}),ip.prototype=Object.assign(Object.create(p.prototype),{constructor:ip,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("Audio: this Audio has no playback control.")}else console.warn("Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Object.assign(op.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}});var ap={getContext:function(){return void 0===tp&&(tp=new(i.AudioContext||i.webkitAudioContext)),tp},setContext:function(e){tp=e}};function sp(){p.call(this),this.type="AudioListener",this.context=ap.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function cp(e){ip.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function up(e,t,r){p.call(this),this.type="CubeCamera";var n=new Wr(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new s(1,0,0)),this.add(n);var i=new Wr(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new s(-1,0,0)),this.add(i);var o=new Wr(90,1,e,t);o.up.set(0,0,1),o.lookAt(new s(0,1,0)),this.add(o);var a=new Wr(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new s(0,-1,0)),this.add(a);var c=new Wr(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new s(0,0,1)),this.add(c);var u=new Wr(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new s(0,0,-1)),this.add(u);var l={format:ft,magFilter:Ze,minFilter:Ze};this.renderTarget=new Fo(r,r,l),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,s=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,n,r),r.activeCubeFace=1,e.render(t,i,r),r.activeCubeFace=2,e.render(t,o,r),r.activeCubeFace=3,e.render(t,a,r),r.activeCubeFace=4,e.render(t,c,r),r.texture.generateMipmaps=s,r.activeCubeFace=5,e.render(t,u,r),e.setRenderTarget(null)},this.clear=function(e,t,r,n){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,r,n);e.setRenderTarget(null)}}function lp(e,t,r,n){"number"==typeof r&&(n=r,r=!1,console.error("InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),M.call(this,e,t,r),this.meshPerAttribute=n||1}function hp(e){this.type="Font",this.data=e}function dp(e,t,r,n,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,c,u,l,h,d,f,p=new Ms;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*t+r,s=m[v++]*t+n,p.moveTo(a,s);break;case"l":a=m[v++]*t+r,s=m[v++]*t+n,p.lineTo(a,s);break;case"q":c=m[v++]*t+r,u=m[v++]*t+n,l=m[v++]*t+r,h=m[v++]*t+n,p.quadraticCurveTo(l,h,c,u);break;case"b":c=m[v++]*t+r,u=m[v++]*t+n,l=m[v++]*t+r,h=m[v++]*t+n,d=m[v++]*t+r,f=m[v++]*t+n,p.bezierCurveTo(l,h,d,f,c,u)}}return{offsetX:o.ha*t,path:p}}}function fp(e,t,r,n,i,o,a){kr.call(this,0,e,t,r,n,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function pp(e,t,r,n,i,o,a){Br.call(this,0,e,t,r,n,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function mp(e,t){_.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new vp(e,t)),this.mergeVertices()}function vp(e,t){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];Gn.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function gp(e,t){U.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var r,n,i,a,s=[],c=Math.cos(o.DEG2RAD*t),u=[0,0],l={},h=["a","b","c"];e.isBufferGeometry?(a=new _).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var d=a.vertices,f=a.faces,p=0,m=f.length;p<m;p++)for(var v=f[p],g=0;g<3;g++)r=v[h[g]],n=v[h[(g+1)%3]],u[0]=Math.min(r,n),u[1]=Math.max(r,n),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:p,face2:void 0}:l[i].face2=p;for(i in l){var y=l[i];if(void 0===y.face2||f[y.face1].normal.dot(f[y.face2].normal)<=c){var b=d[y.index1];s.push(b.x,b.y,b.z),b=d[y.index2],s.push(b.x,b.y,b.z)}}this.addAttribute("position",new N(s,3))}function yp(e,t){_.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new bp(e,t)),this.mergeVertices()}function bp(e,t){U.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t};for(var r=this,n=[],i=[],o=0,a=(e=Array.isArray(e)?e:[e]).length;o<a;o++){c(e[o])}function c(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,c=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:h-2,f=void 0!==t.bevelSegments?t.bevelSegments:3,p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:_p;void 0!==t.amount&&(console.warn("ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);var v,g,y,b,w,_,S,M,T=!1;p&&(v=p.getSpacedPoints(c),T=!0,l=!1,g=p.computeFrenetFrames(c,!1),y=new s,b=new s,w=new s),l||(f=0,h=0,d=0);var A=e.extractPoints(a),E=A.shape,C=A.holes;if(!ws.isClockWise(E))for(E=E.reverse(),S=0,M=C.length;S<M;S++)_=C[S],ws.isClockWise(_)&&(C[S]=_.reverse());var L=ws.triangulateShape(E,C),P=E;for(S=0,M=C.length;S<M;S++)_=C[S],E=E.concat(_);function O(e,t,r){return t||console.error("ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}var N,R,I,D,F,U,k=E.length,B=L.length;function z(e,t,r){var n,i,o,a=e.x-t.x,s=e.y-t.y,c=r.x-e.x,u=r.y-e.y,l=a*a+s*s,h=a*u-s*c;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(l),f=Math.sqrt(c*c+u*u),p=t.x-s/d,m=t.y+a/d,v=((r.x-u/f-p)*u-(r.y+c/f-m)*c)/(a*u-s*c),g=(n=p+a*v-e.x)*n+(i=m+s*v-e.y)*i;if(g<=2)return new x(n,i);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?c>Number.EPSILON&&(y=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(n=-s,i=a,o=Math.sqrt(l)):(n=a,i=s,o=Math.sqrt(l/2))}return new x(n/o,i/o)}for(var j=[],V=0,G=P.length,W=G-1,H=V+1;V<G;V++,W++,H++)W===G&&(W=0),H===G&&(H=0),j[V]=z(P[V],P[W],P[H]);var X,q,Y=[],J=j.concat();for(S=0,M=C.length;S<M;S++){for(_=C[S],X=[],V=0,W=(G=_.length)-1,H=V+1;V<G;V++,W++,H++)W===G&&(W=0),H===G&&(H=0),X[V]=z(_[V],_[W],_[H]);Y.push(X),J=J.concat(X)}for(N=0;N<f;N++){for(I=N/f,D=h*Math.cos(I*Math.PI/2),R=d*Math.sin(I*Math.PI/2),V=0,G=P.length;V<G;V++)Z((F=O(P[V],j[V],R)).x,F.y,-D);for(S=0,M=C.length;S<M;S++)for(_=C[S],X=Y[S],V=0,G=_.length;V<G;V++)Z((F=O(_[V],X[V],R)).x,F.y,-D)}for(R=d,V=0;V<k;V++)F=l?O(E[V],J[V],R):E[V],T?(b.copy(g.normals[0]).multiplyScalar(F.x),y.copy(g.binormals[0]).multiplyScalar(F.y),w.copy(v[0]).add(b).add(y),Z(w.x,w.y,w.z)):Z(F.x,F.y,0);for(q=1;q<=c;q++)for(V=0;V<k;V++)F=l?O(E[V],J[V],R):E[V],T?(b.copy(g.normals[q]).multiplyScalar(F.x),y.copy(g.binormals[q]).multiplyScalar(F.y),w.copy(v[q]).add(b).add(y),Z(w.x,w.y,w.z)):Z(F.x,F.y,u/c*q);for(N=f-1;N>=0;N--){for(I=N/f,D=h*Math.cos(I*Math.PI/2),R=d*Math.sin(I*Math.PI/2),V=0,G=P.length;V<G;V++)Z((F=O(P[V],j[V],R)).x,F.y,u+D);for(S=0,M=C.length;S<M;S++)for(_=C[S],X=Y[S],V=0,G=_.length;V<G;V++)F=O(_[V],X[V],R),T?Z(F.x,F.y+v[c-1].y,v[c-1].x+D):Z(F.x,F.y,u+D)}function Q(e,t){var r,n;for(V=e.length;--V>=0;){r=V,(n=V-1)<0&&(n=e.length-1);var i=0,o=c+2*f;for(i=0;i<o;i++){var a=k*i,s=k*(i+1);$(t+r+a,t+n+a,t+n+s,t+r+s)}}}function Z(e,t,r){o.push(e),o.push(t),o.push(r)}function K(e,t,i){ee(e),ee(t),ee(i);var o=n.length/3,a=m.generateTopUV(r,n,o-3,o-2,o-1);te(a[0]),te(a[1]),te(a[2])}function $(e,t,i,o){ee(e),ee(t),ee(o),ee(t),ee(i),ee(o);var a=n.length/3,s=m.generateSideWallUV(r,n,a-6,a-3,a-2,a-1);te(s[0]),te(s[1]),te(s[3]),te(s[1]),te(s[2]),te(s[3])}function ee(e){n.push(o[3*e+0]),n.push(o[3*e+1]),n.push(o[3*e+2])}function te(e){i.push(e.x),i.push(e.y)}!function(){var e=n.length/3;if(l){var t=0,i=k*t;for(V=0;V<B;V++)K((U=L[V])[2]+i,U[1]+i,U[0]+i);for(i=k*(t=c+2*f),V=0;V<B;V++)K((U=L[V])[0]+i,U[1]+i,U[2]+i)}else{for(V=0;V<B;V++)K((U=L[V])[2],U[1],U[0]);for(V=0;V<B;V++)K((U=L[V])[0]+k*c,U[1]+k*c,U[2]+k*c)}r.addGroup(e,n.length/3-e,0)}(),function(){var e=n.length/3,t=0;for(Q(P,t),t+=P.length,S=0,M=C.length;S<M;S++)Q(_=C[S],t),t+=_.length;r.addGroup(e,n.length/3-e,1)}()}this.addAttribute("position",new N(n,3)),this.addAttribute("uv",new N(i,2)),this.computeVertexNormals()}sp.prototype=Object.assign(Object.create(p.prototype),{constructor:sp,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new s,t=new c,r=new s,n=new s;return function(i){p.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),cp.prototype=Object.assign(Object.create(ip.prototype),{constructor:cp,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(){var e=new s,t=new c,r=new s,n=new s;return function(i){p.prototype.updateMatrixWorld.call(this,i);var o=this.panner;this.matrixWorld.decompose(e,t,r),n.set(0,0,1).applyQuaternion(t),o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z)}}()}),up.prototype=Object.create(p.prototype),up.prototype.constructor=up,lp.prototype=Object.assign(Object.create(M.prototype),{constructor:lp,isInstancedBufferAttribute:!0,copy:function(e){return M.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(hp.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var r=[],n=function(e,t,r){for(var n=Array.from?Array.from(e):String(e).split(""),i=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,a=[],s=0,c=0,u=0;u<n.length;u++){var l=n[u];if("\n"===l)s=0,c-=o;else{var h=dp(l,i,s,c,r);s+=h.offsetX,a.push(h.path)}}return a}(e,t,this.data),i=0,o=n.length;i<o;i++)Array.prototype.push.apply(r,n[i].toShapes());return r}}),fp.prototype=Object.create(kr.prototype),fp.prototype.constructor=fp,pp.prototype=Object.create(Br.prototype),pp.prototype.constructor=pp,mp.prototype=Object.create(_.prototype),mp.prototype.constructor=mp,vp.prototype=Object.create(Gn.prototype),vp.prototype.constructor=vp,gp.prototype=Object.create(U.prototype),gp.prototype.constructor=gp,yp.prototype=Object.create(_.prototype),yp.prototype.constructor=yp,yp.prototype.toJSON=function(){var e=_.prototype.toJSON.call(this);return Sp(this.parameters.shapes,this.parameters.options,e)},bp.prototype=Object.create(U.prototype),bp.prototype.constructor=bp,bp.prototype.toJSON=function(){var e=U.prototype.toJSON.call(this);return Sp(this.parameters.shapes,this.parameters.options,e)};var xp,wp,_p={generateTopUV:function(e,t,r,n,i){var o=t[3*r],a=t[3*r+1],s=t[3*n],c=t[3*n+1],u=t[3*i],l=t[3*i+1];return[new x(o,a),new x(s,c),new x(u,l)]},generateSideWallUV:function(e,t,r,n,i,o){var a=t[3*r],s=t[3*r+1],c=t[3*r+2],u=t[3*n],l=t[3*n+1],h=t[3*n+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*o],v=t[3*o+1],g=t[3*o+2];return Math.abs(s-l)<.01?[new x(a,1-c),new x(u,1-h),new x(d,1-p),new x(m,1-g)]:[new x(s,1-c),new x(l,1-h),new x(f,1-p),new x(v,1-g)]}};function Sp(e,t,r){if(r.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var o=e[n];r.shapes.push(o.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function Mp(e,t,r,n){_.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new Tp(e,t,r,n)),this.mergeVertices()}function Tp(e,t,r,n){U.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=o.clamp(n,0,2*Math.PI);var i,a,c,u=[],l=[],h=[],d=1/t,f=new s,p=new x;for(a=0;a<=t;a++){var m=r+a*d*n,v=Math.sin(m),g=Math.cos(m);for(c=0;c<=e.length-1;c++)f.x=e[c].x*v,f.y=e[c].y,f.z=e[c].x*g,l.push(f.x,f.y,f.z),p.x=a/t,p.y=c/(e.length-1),h.push(p.x,p.y)}for(a=0;a<t;a++)for(c=0;c<e.length-1;c++){var y=i=c+a*e.length,b=i+e.length,w=i+e.length+1,_=i+1;u.push(y,b,_),u.push(b,w,_)}if(this.setIndex(u),this.addAttribute("position",new N(l,3)),this.addAttribute("uv",new N(h,2)),this.computeVertexNormals(),n===2*Math.PI){var S=this.attributes.normal.array,M=new s,T=new s,A=new s;for(i=t*e.length*3,a=0,c=0;a<e.length;a++,c+=3)M.x=S[c+0],M.y=S[c+1],M.z=S[c+2],T.x=S[i+c+0],T.y=S[i+c+1],T.z=S[i+c+2],A.addVectors(M,T).normalize(),S[c+0]=S[i+c+0]=A.x,S[c+1]=S[i+c+1]=A.y,S[c+2]=S[i+c+2]=A.z}}function Ap(e,t,r){_.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new Ep(e,t,r)),this.mergeVertices()}function Ep(e,t,r){U.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,o=[],a=[],c=[],u=[],l=new s,h=new s,d=new s,f=new s,p=new s;e.length<3&&console.error("ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(n=0;n<=r;n++){var v=n/r;for(i=0;i<=t;i++){var g=i/t;e(g,v,h),a.push(h.x,h.y,h.z),g-1e-5>=0?(e(g-1e-5,v,d),f.subVectors(h,d)):(e(g+1e-5,v,d),f.subVectors(d,h)),v-1e-5>=0?(e(g,v-1e-5,d),p.subVectors(h,d)):(e(g,v+1e-5,d),p.subVectors(d,h)),l.crossVectors(f,p).normalize(),c.push(l.x,l.y,l.z),u.push(g,v)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var y=n*m+i,b=n*m+i+1,x=(n+1)*m+i+1,w=(n+1)*m+i;o.push(y,b,w),o.push(b,x,w)}this.setIndex(o),this.addAttribute("position",new N(a,3)),this.addAttribute("normal",new N(c,3)),this.addAttribute("uv",new N(u,2))}function Cp(e,t,r,n,i,o){_.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Lp(e,t,r,n,i,o)),this.mergeVertices()}function Lp(e,t,r,n,i,o){U.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,c,u,l=[],h=[],d=[],f=[],p=e,m=(t-e)/(n=void 0!==n?Math.max(1,n):1),v=new s,g=new x;for(c=0;c<=n;c++){for(u=0;u<=r;u++)a=i+u/r*o,v.x=p*Math.cos(a),v.y=p*Math.sin(a),h.push(v.x,v.y,v.z),d.push(0,0,1),g.x=(v.x/t+1)/2,g.y=(v.y/t+1)/2,f.push(g.x,g.y);p+=m}for(c=0;c<n;c++){var y=c*(r+1);for(u=0;u<r;u++){var b=a=u+y,w=a+r+1,_=a+r+2,S=a+1;l.push(b,w,S),l.push(w,_,S)}}this.setIndex(l),this.addAttribute("position",new N(h,3)),this.addAttribute("normal",new N(d,3)),this.addAttribute("uv",new N(f,2))}function Pp(e,t){_.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Op(e,t)),this.mergeVertices()}function Op(e,t){Gn.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Np(e,t){_.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Rp(e,t)),this.mergeVertices()}function Rp(e,t){var r=(t=t||{}).font;if(!r||!r.isFont)return console.error("TextGeometry: font parameter is not an instance of Font."),new _;var n=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),bp.call(this,n,t),this.type="TextBufferGeometry"}function Ip(e,t,r,n,i,o,a){_.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==a&&console.warn("TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Dp(e,t,r,n,i,o)),this.mergeVertices()}function Dp(e,t,r,n,i,o){U.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},e=e||1,t=t||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var a,c,u=[],l=[],h=[],d=[],f=new s,p=new s,m=new s,v=new s,g=new s,y=new s,b=new s;for(a=0;a<=r;++a){var x=a/r*i*Math.PI*2;for(C(x,i,o,e,m),C(x+.01,i,o,e,v),y.subVectors(v,m),b.addVectors(v,m),g.crossVectors(y,b),b.crossVectors(g,y),g.normalize(),b.normalize(),c=0;c<=n;++c){var w=c/n*Math.PI*2,_=-t*Math.cos(w),S=t*Math.sin(w);f.x=m.x+(_*b.x+S*g.x),f.y=m.y+(_*b.y+S*g.y),f.z=m.z+(_*b.z+S*g.z),l.push(f.x,f.y,f.z),p.subVectors(f,m).normalize(),h.push(p.x,p.y,p.z),d.push(a/r),d.push(c/n)}}for(c=1;c<=r;c++)for(a=1;a<=n;a++){var M=(n+1)*(c-1)+(a-1),T=(n+1)*c+(a-1),A=(n+1)*c+a,E=(n+1)*(c-1)+a;u.push(M,T,E),u.push(T,A,E)}function C(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e),s=r/t*e,c=Math.cos(s);i.x=n*(2+c)*.5*o,i.y=n*(2+c)*a*.5,i.z=n*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",new N(l,3)),this.addAttribute("normal",new N(h,3)),this.addAttribute("uv",new N(d,2))}function Fp(e,t,r,n,i,o){_.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("TubeGeometry: taper has been removed.");var a=new Up(e,t,r,n,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Up(e,t,r,n,i){U.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},t=t||64,r=r||1,n=n||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,c,u=new s,l=new s,h=new x,d=new s,f=[],p=[],m=[],v=[];function g(i){d=e.getPointAt(i/t,d);var a=o.normals[i],s=o.binormals[i];for(c=0;c<=n;c++){var h=c/n*Math.PI*2,m=Math.sin(h),v=-Math.cos(h);l.x=v*a.x+m*s.x,l.y=v*a.y+m*s.y,l.z=v*a.z+m*s.z,l.normalize(),p.push(l.x,l.y,l.z),u.x=d.x+r*l.x,u.y=d.y+r*l.y,u.z=d.z+r*l.z,f.push(u.x,u.y,u.z)}}!function(){for(a=0;a<t;a++)g(a);g(!1===i?t:0),function(){for(a=0;a<=t;a++)for(c=0;c<=n;c++)h.x=a/t,h.y=c/n,m.push(h.x,h.y)}(),function(){for(c=1;c<=t;c++)for(a=1;a<=n;a++){var e=(n+1)*(c-1)+(a-1),r=(n+1)*c+(a-1),i=(n+1)*c+a,o=(n+1)*(c-1)+a;v.push(e,r,o),v.push(r,i,o)}}()}(),this.setIndex(v),this.addAttribute("position",new N(f,3)),this.addAttribute("normal",new N(p,3)),this.addAttribute("uv",new N(m,2))}function kp(e,t,r,n,i,o){p.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===xp&&((xp=new U).addAttribute("position",new N([0,0,0,0,1,0],3)),(wp=new Br(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new fr(xp,new ur({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new dr(wp,new cr({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,o)}function Bp(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new U;r.addAttribute("position",new N(t,3)),r.addAttribute("color",new N([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new ur({vertexColors:K});Eo.call(this,r,n)}function zp(e,t){this.type="Box3Helper",this.box=e;var r=void 0!==t?t:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new U;i.setIndex(new M(n,1)),i.addAttribute("position",new N([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Eo.call(this,i,new ur({color:r})),this.geometry.computeBoundingSphere()}function jp(e){var t=new U,r=new ur({color:16777215,vertexColors:Z}),n=[],i=[],o={},a=new v(16755200),s=new v(16711680),c=new v(43775),u=new v(16777215),l=new v(3355443);function h(e,t,r){d(e,r),d(t,r)}function d(e,t){n.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",u),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),t.addAttribute("position",new N(n,3)),t.addAttribute("color",new N(i,3)),Eo.call(this,t,r),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Vp(e,t,r){p.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);var n=new U;n.addAttribute("position",new N([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new ur({fog:!1});this.lightPlane=new fr(n,i),this.add(this.lightPlane),(n=new U).addAttribute("position",new N([0,0,0,0,0,1],3)),this.targetLine=new fr(n,i),this.add(this.targetLine),this.update()}function Gp(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("FaceNormalsHelper: only Geometry is supported. Use VertexNormalsHelper, instead.");var c=new U,u=new N(2*a*3,3);c.addAttribute("position",u),Eo.call(this,c,new ur({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Wp(e,t,r,n){e=e||10,t=t||10,r=new v(void 0!==r?r:4473924),n=new v(void 0!==n?n:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],c=[],u=0,l=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=u===i?r:n;d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3}var f=new U;f.addAttribute("position",new N(s,3)),f.addAttribute("color",new N(c,3));var p=new ur({vertexColors:K});Eo.call(this,f,p)}function Hp(e,t,r){p.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new Hn(t);n.rotateY(.5*Math.PI),this.material=new cr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=K);var i=n.getAttribute("position"),o=new Float32Array(3*i.count);n.addAttribute("color",new M(o,3)),this.add(new dr(n,this.material)),this.update()}function Xp(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==r?r:16776960,i=new U;i.addAttribute("position",new N([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),fr.call(this,i,new ur({color:n}));var o=new U;o.addAttribute("position",new N([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new dr(o,new cr({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function qp(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;var n=new B(t,4,2),i=new cr({wireframe:!0,fog:!1});dr.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Yp(e,t,r,n,i,o){e=e||10,t=t||16,r=r||8,n=n||64,i=new v(void 0!==i?i:4473924),o=new v(void 0!==o?o:8947848);var a,s,c,u,l,h,d,f=[],p=[];for(u=0;u<=t;u++)c=u/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,f.push(0,0,0),f.push(a,0,s),d=1&u?i:o,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=r;u++)for(d=1&u?i:o,h=e-e/r*u,l=0;l<n;l++)c=l/n*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,f.push(a,0,s),p.push(d.r,d.g,d.b),c=(l+1)/n*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,f.push(a,0,s),p.push(d.r,d.g,d.b);var m=new U;m.addAttribute("position",new N(f,3)),m.addAttribute("color",new N(p,3));var g=new ur({vertexColors:K});Eo.call(this,m,g)}function Jp(e,t){p.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var r=new ur({fog:!1}),n=new U;n.addAttribute("position",new M(new Float32Array(15),3)),this.line=new fr(n,r),this.add(this.line),this.update()}function Qp(e,t){p.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var r=new U,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}r.addAttribute("position",new N(n,3));var c=new ur({fog:!1});this.cone=new Eo(r,c),this.add(this.cone),this.update()}function Zp(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new U,u=new N(2*a*3,3);c.addAttribute("position",u),Eo.call(this,c,new ur({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Kp(e,t,r,n){vo.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function $p(e){this.manager=void 0!==e?e:cn}function em(e){this.manager=void 0!==e?e:cn}function tm(e){this.manager=void 0!==e?e:cn}Mp.prototype=Object.create(_.prototype),Mp.prototype.constructor=Mp,Tp.prototype=Object.create(U.prototype),Tp.prototype.constructor=Tp,Ap.prototype=Object.create(_.prototype),Ap.prototype.constructor=Ap,Ep.prototype=Object.create(U.prototype),Ep.prototype.constructor=Ep,Cp.prototype=Object.create(_.prototype),Cp.prototype.constructor=Cp,Lp.prototype=Object.create(U.prototype),Lp.prototype.constructor=Lp,Pp.prototype=Object.create(_.prototype),Pp.prototype.constructor=Pp,Op.prototype=Object.create(Gn.prototype),Op.prototype.constructor=Op,Np.prototype=Object.create(_.prototype),Np.prototype.constructor=Np,Rp.prototype=Object.create(bp.prototype),Rp.prototype.constructor=Rp,Ip.prototype=Object.create(_.prototype),Ip.prototype.constructor=Ip,Dp.prototype=Object.create(U.prototype),Dp.prototype.constructor=Dp,Fp.prototype=Object.create(_.prototype),Fp.prototype.constructor=Fp,Up.prototype=Object.create(U.prototype),Up.prototype.constructor=Up,kp.prototype=Object.create(p.prototype),kp.prototype.constructor=kp,kp.prototype.setDirection=function(){var e,t=new s;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),kp.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},kp.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Bp.prototype=Object.create(Eo.prototype),Bp.prototype.constructor=Bp,zp.prototype=Object.create(Eo.prototype),zp.prototype.constructor=zp,zp.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),p.prototype.updateMatrixWorld.call(this,e))},jp.prototype=Object.create(Eo.prototype),jp.prototype.constructor=jp,jp.prototype.update=function(){var e,t,r=new s,n=new Gr;function i(i,o,a,s){r.set(o,a,s).unproject(n);var c=t[i];if(void 0!==c)for(var u=e.getAttribute("position"),l=0,h=c.length;l<h;l++)u.setXYZ(c[l],r.x,r.y,r.z)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Vp.prototype=Object.create(p.prototype),Vp.prototype.constructor=Vp,Vp.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Vp.prototype.update=function(){var e=new s,t=new s,r=new s;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(r),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(r),this.targetLine.scale.z=r.length()}}(),Gp.prototype=Object.create(Eo.prototype),Gp.prototype.constructor=Gp,Gp.prototype.update=function(){var e=new s,t=new s,r=new d;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,u=0,l=s.length;u<l;u++){var h=s[u],d=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(n),t.copy(d).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),c+=1,i.setXYZ(c,t.x,t.y,t.z),c+=1}i.needsUpdate=!0}}(),Wp.prototype=Object.create(Eo.prototype),Wp.prototype.constructor=Wp,Hp.prototype=Object.create(p.prototype),Hp.prototype.constructor=Hp,Hp.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Hp.prototype.update=function(){var e=new s,t=new v,r=new v;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:r;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Xp.prototype=Object.create(fr.prototype),Xp.prototype.constructor=Xp,Xp.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Y:q,this.lookAt(this.plane.normal),p.prototype.updateMatrixWorld.call(this,e)},qp.prototype=Object.create(dr.prototype),qp.prototype.constructor=qp,qp.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},qp.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Yp.prototype=Object.create(Eo.prototype),Yp.prototype.constructor=Yp,Jp.prototype=Object.create(p.prototype),Jp.prototype.constructor=Jp,Jp.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Jp.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,r=this.line.geometry.attributes.position,n=r.array;n[0]=e,n[1]=-t,n[2]=0,n[3]=e,n[4]=t,n[5]=0,n[6]=-e,n[7]=t,n[8]=0,n[9]=-e,n[10]=-t,n[11]=0,n[12]=e,n[13]=-t,n[14]=0,r.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Qp.prototype=Object.create(p.prototype),Qp.prototype.constructor=Qp,Qp.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Qp.prototype.update=function(){var e=new s,t=new s;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Zp.prototype=Object.create(Eo.prototype),Zp.prototype.constructor=Zp,Zp.prototype.update=function(){var e=new s,t=new s,r=new d;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,u=0,l=0,h=c.length;l<h;l++)for(var d=c[l],f=0,p=d.vertexNormals.length;f<p;f++){var m=s[d[n[f]]],v=d.vertexNormals[f];e.copy(m).applyMatrix4(i),t.copy(v).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry){var g=a.attributes.position,y=a.attributes.normal;for(u=0,f=0,p=g.count;f<p;f++)e.set(g.getX(f),g.getY(f),g.getZ(f)).applyMatrix4(i),t.set(y.getX(f),y.getY(f),y.getZ(f)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),Kp.prototype=Object.assign(Object.create(vo.prototype),{constructor:Kp,isRectAreaLight:!0,copy:function(e){return vo.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=vo.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign($p.prototype,{load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e,t){for(var r=[],n=0;n<e.length;n++){var i=Nr.parse(e[n]);r.push(i)}t(r)}}),Object.assign(em.prototype,{load:function(e,t,r,n){var i=new ln(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){var r=e.slice(0);ap.getContext().decodeAudioData(r,function(e){t(e)})},r,n)}}),Object.assign(tm.prototype,{load:function(e,t,r,n){var i=this;new ln(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new U,r=e.data.index;if(void 0!==r){var n=new rm[r.type](r.array);t.setIndex(new M(n,1))}var i=e.data.attributes;for(var o in i){var a=i[o];n=new rm[a.type](a.array);t.addAttribute(o,new M(n,a.itemSize,a.normalized))}var c=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==c)for(var u=0,l=c.length;u!==l;++u){var h=c[u];t.addGroup(h.start,h.count,h.materialIndex)}var d=e.data.boundingSphere;if(void 0!==d){var f=new s;void 0!==d.center&&f.fromArray(d.center),t.boundingSphere=new b(f,d.radius)}return t}});var rm={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function nm(e){this.manager=void 0!==e?e:cn}function im(e){this.manager=void 0!==e?e:cn}function om(e){"undefined"==typeof createImageBitmap&&console.warn("ImageBitmapLoader: createImageBitmap() not supported."),void 0===n&&console.warn("ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:cn,this.options=void 0}function am(){p.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function sm(e,t,r){this.name="",this.color=new v(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function cm(e,t){this.name="",this.color=new v(e),this.density=void 0!==t?t:25e-5}Object.assign(nm.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new Xo,o=new Tn(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(r){o.load(e[r],function(e){i.images[r]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(var c=0;c<e.length;++c)s(c);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(im.prototype,{load:function(e,t,r,n){var i=this,o=new ln(this.manager);o.setPath(this.path),o.load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new hp(e)},setPath:function(e){return this.path=e,this}}),om.prototype={constructor:om,setOptions:function(e){return this.options=e,this},load:function(e,t,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,a=an.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout(function(){t&&t(a),o.manager.itemEnd(e)},0),a;n(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,o.options)}).then(function(r){an.add(e,r),t&&t(r),o.manager.itemEnd(e)}).catch(function(t){i&&i(t),o.manager.itemEnd(e),o.manager.itemError(e)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},am.prototype=Object.assign(Object.create(p.prototype),{constructor:am,copy:function(e){p.prototype.copy.call(this,e,!1);for(var t=e.levels,r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new s;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),update:function(){var e=new s,t=new s;return function(r){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(e){var t=p.prototype.toJSON.call(this,e);t.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),sm.prototype.isFog=!0,sm.prototype.clone=function(){return new sm(this.color,this.near,this.far)},sm.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},cm.prototype.isFogExp2=!0,cm.prototype.clone=function(){return new cm(this.color,this.density)},cm.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};var um={WireframeGeometry:Zi,TetrahedronGeometry:Pp,TetrahedronBufferGeometry:Op,OctahedronGeometry:Wn,OctahedronBufferGeometry:Hn,IcosahedronGeometry:Jf,IcosahedronBufferGeometry:Qf,DodecahedronGeometry:mp,DodecahedronBufferGeometry:vp,PolyhedronGeometry:Vn,PolyhedronBufferGeometry:Gn,TubeGeometry:Fp,TubeBufferGeometry:Up,TorusKnotGeometry:Ip,TorusGeometry:Xn,TorusBufferGeometry:qn,TextGeometry:Np,TextBufferGeometry:Rp,SphereGeometry:k,SphereBufferGeometry:B,RingGeometry:Cp,RingBufferGeometry:Lp,PlaneGeometry:$r,PlaneBufferGeometry:en,LatheGeometry:Mp,LatheBufferGeometry:Tp,ShapeGeometry:Zf,ShapeBufferGeometry:Kf,ExtrudeGeometry:yp,ExtrudeBufferGeometry:bp,EdgesGeometry:gp,ConeGeometry:fp,ConeBufferGeometry:pp,CylinderGeometry:kr,CylinderBufferGeometry:Br,CircleGeometry:qf,CircleBufferGeometry:Yf,BoxGeometry:Fr,BoxBufferGeometry:Ur};function lm(e){this.manager=void 0!==e?e:cn,this.texturePath=""}Object.assign(lm.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new ln(i.manager).load(e,function(r){var o=null;try{o=JSON.parse(r)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("ObjectLoader: Can't load "+e+". Use JSONLoader instead.")},r,n)},setTexturePath:function(e){return this.texturePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,n,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var r=0,n=e.length;r<n;r++){var i=(new Ka).fromJSON(e[r]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var r={};if(void 0!==e)for(var n=new Ln,i=new tm,o=0,a=e.length;o<a;o++){var s,c=e[o];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new um[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new um[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new um[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new um[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new um[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new um[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new um[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new um[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new um[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new um[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new um[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new um[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,h=c.shapes.length;l<h;l++){var d=t[c.shapes[l]];u.push(d)}s=new um[c.type](u,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,h=c.shapes.length;l<h;l++){d=t[c.shapes[l]];u.push(d)}var f=c.options.extrudePath;void 0!==f&&(c.options.extrudePath=(new Curves[f.type]).fromJSON(f)),s=new um[c.type](u,c.options);break;case"BufferGeometry":s=i.parse(c);break;case"Geometry":s=n.parse(c,this.texturePath).geometry;break;default:console.warn('ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),r[c.uuid]=s}return r},parseMaterials:function(e,t){var r={};if(void 0!==e){var n=new Mn;n.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++)s.push(n.parse(a.materials[c]));r[a.uuid]=s}else r[a.uuid]=n.parse(a)}}return r},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=Nr.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),t.push(i)}return t},parseImages:function(e,t){var r=this,n={};function i(e){return r.manager.itemStart(e),o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemEnd(e),r.manager.itemError(e)})}if(void 0!==e&&e.length>0){var o=new Tn(new sn(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var c=e[a],u=c.url;if(Array.isArray(u)){n[c.uuid]=[];for(var l=0,h=u.length;l<h;l++){var d=u[l],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:r.texturePath+d;n[c.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;n[c.uuid]=i(f)}}}return n},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new Xo(t[s.image]):new Zr(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=r(s.mapping,hm)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=r(s.wrap[0],dm),a.wrapT=r(s.wrap[1],dm)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=r(s.minFilter,fm)),void 0!==s.magFilter&&(a.magFilter=r(s.magFilter,fm)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),n[s.uuid]=a}return n},parseObject:function(e,t,r){var n;function i(e){return void 0===t[e]&&console.warn("ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var o=e[n];void 0===r[o]&&console.warn("ObjectLoader: Undefined material",o),t.push(r[o])}return t}return void 0===r[e]&&console.warn("ObjectLoader: Undefined material",e),r[e]}}switch(e.type){case"Scene":n=new qr,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new v(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new sm(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new cm(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new Wr(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new Yr(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new Ao(e.color,e.intensity);break;case"DirectionalLight":n=new xo(e.color,e.intensity);break;case"PointLight":n=new yo(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new Kp(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new _o(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new So(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);n=a.bones&&a.bones.length>0?new lo(a,s):new dr(a,s);break;case"LOD":n=new am;break;case"Line":n=new fr(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":n=new Ro(i(e.geometry),o(e.material));break;case"LineSegments":n=new Eo(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":n=new Gi(i(e.geometry),o(e.material));break;case"Sprite":n=new wc(o(e.material));break;case"Group":n=new oo;break;default:n=new p}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,u=0;u<c.length;u++)n.add(this.parseObject(c[u],t,r));if("LOD"===e.type)for(var l=e.levels,h=0;h<l.length;h++){var d=l[h],f=n.getObjectByProperty("uuid",d.object);void 0!==f&&n.addLevel(f,d.distance)}return n}});var hm={UVMapping:Ue,CubeReflectionMapping:ke,CubeRefractionMapping:Be,EquirectangularReflectionMapping:ze,EquirectangularRefractionMapping:je,SphericalReflectionMapping:Ve,CubeUVReflectionMapping:Ge,CubeUVRefractionMapping:We},dm={RepeatWrapping:He,ClampToEdgeWrapping:Xe,MirroredRepeatWrapping:qe},fm={NearestFilter:Ye,NearestMipMapNearestFilter:Je,NearestMipMapLinearFilter:Qe,LinearFilter:Ze,LinearMipMapNearestFilter:Ke,LinearMipMapLinearFilter:$e};function pm(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}function mm(e,t,r,n,i,o,a,s,c){Zr.call(this,e,t,r,n,i,o,a,s,c),this.generateMipmaps=!1}Object.assign(pm.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}}),mm.prototype=Object.assign(Object.create(Zr.prototype),{constructor:mm,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),t.CCDIKSolver=pr,t.MMDAnimationHelper=jr,t.MMDPhysics=zr,t.AnimationClipCreator=Vr,t.CinematicCamera=on,t.Car=function(){var e=this;function t(t,r){e.bodyGeometry=t,e.bodyMaterials=r,n()}function r(t,r){e.wheelGeometry=t,e.wheelMaterials=r,n()}function n(){if(e.bodyGeometry&&e.wheelGeometry){if(e.autoWheelGeometry){e.wheelGeometry.computeBoundingBox();var t=e.wheelGeometry.boundingBox;e.wheelOffset.addVectors(t.min,t.max),e.wheelOffset.multiplyScalar(.5),e.wheelDiameter=t.max.y-t.min.y,e.wheelGeometry.center()}var r=e.modelScale,n=new s,i=e.bodyMaterials,o=e.wheelMaterials;e.bodyMesh=new dr(e.bodyGeometry,i),e.bodyMesh.scale.set(r,r,r),e.root.add(e.bodyMesh),n.multiplyVectors(e.wheelOffset,new s(r,r,r)),e.frontLeftWheelRoot.position.add(n),e.frontLeftWheelMesh=new dr(e.wheelGeometry,o),e.frontLeftWheelMesh.scale.set(r,r,r),e.frontLeftWheelRoot.add(e.frontLeftWheelMesh),e.root.add(e.frontLeftWheelRoot),n.multiplyVectors(e.wheelOffset,new s(-r,r,r)),e.frontRightWheelRoot.position.add(n),e.frontRightWheelMesh=new dr(e.wheelGeometry,o),e.frontRightWheelMesh.scale.set(r,r,r),e.frontRightWheelMesh.rotation.z=Math.PI,e.frontRightWheelRoot.add(e.frontRightWheelMesh),e.root.add(e.frontRightWheelRoot),n.multiplyVectors(e.wheelOffset,new s(r,r,-r)),n.z-=e.backWheelOffset,e.backLeftWheelMesh=new dr(e.wheelGeometry,o),e.backLeftWheelMesh.position.add(n),e.backLeftWheelMesh.scale.set(r,r,r),e.root.add(e.backLeftWheelMesh),n.multiplyVectors(e.wheelOffset,new s(-r,r,-r)),n.z-=e.backWheelOffset,e.backRightWheelMesh=new dr(e.wheelGeometry,o),e.backRightWheelMesh.position.add(n),e.backRightWheelMesh.scale.set(r,r,r),e.backRightWheelMesh.rotation.z=Math.PI,e.root.add(e.backRightWheelMesh),e.meshes=[e.bodyMesh,e.frontLeftWheelMesh,e.frontRightWheelMesh,e.backLeftWheelMesh,e.backRightWheelMesh],e.loaded=!0,e.callback&&e.callback(e)}}function i(e){return 1===e?1:1-Math.pow(2,-10*e)}this.modelScale=1,this.backWheelOffset=2,this.autoWheelGeometry=!0,this.wheelOffset=new s,this.wheelDiameter=1,this.MAX_SPEED=2200,this.MAX_REVERSE_SPEED=-1500,this.MAX_WHEEL_ROTATION=.6,this.FRONT_ACCELERATION=1250,this.BACK_ACCELERATION=1500,this.WHEEL_ANGULAR_ACCELERATION=1.5,this.FRONT_DECCELERATION=750,this.WHEEL_ANGULAR_DECCELERATION=1,this.STEERING_RADIUS_RATIO=.0023,this.MAX_TILT_SIDES=.05,this.MAX_TILT_FRONTBACK=.015,this.speed=0,this.acceleration=0,this.wheelOrientation=0,this.carOrientation=0,this.root=new p,this.frontLeftWheelRoot=new p,this.frontRightWheelRoot=new p,this.bodyMesh=null,this.frontLeftWheelMesh=null,this.frontRightWheelMesh=null,this.backLeftWheelMesh=null,this.backRightWheelMesh=null,this.bodyGeometry=null,this.wheelGeometry=null,this.bodyMaterials=null,this.wheelMaterials=null,this.loaded=!1,this.meshes=[],this.enableShadows=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].castShadow=e,this.meshes[t].receiveShadow=e},this.setVisible=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].visible=e,this.meshes[t].visible=e},this.loadPartsJSON=function(e,n){var i=new Ln;i.load(e,function(e,r){t(e,r)}),i.load(n,function(e,t){r(e,t)})},this.loadPartsBinary=function(e,n){var i=new Pn;i.load(e,function(e,r){t(e,r)}),i.load(n,function(e,t){r(e,t)})},this.updateCarModel=function(e,t){if(t.moveForward&&(this.speed=o.clamp(this.speed+e*this.FRONT_ACCELERATION,this.MAX_REVERSE_SPEED,this.MAX_SPEED),this.acceleration=o.clamp(this.acceleration+e,-1,1)),t.moveBackward&&(this.speed=o.clamp(this.speed-e*this.BACK_ACCELERATION,this.MAX_REVERSE_SPEED,this.MAX_SPEED),this.acceleration=o.clamp(this.acceleration-e,-1,1)),t.moveLeft&&(this.wheelOrientation=o.clamp(this.wheelOrientation+e*this.WHEEL_ANGULAR_ACCELERATION,-this.MAX_WHEEL_ROTATION,this.MAX_WHEEL_ROTATION)),t.moveRight&&(this.wheelOrientation=o.clamp(this.wheelOrientation-e*this.WHEEL_ANGULAR_ACCELERATION,-this.MAX_WHEEL_ROTATION,this.MAX_WHEEL_ROTATION)),!t.moveForward&&!t.moveBackward)if(this.speed>0){var r=i(this.speed/this.MAX_SPEED);this.speed=o.clamp(this.speed-r*e*this.FRONT_DECCELERATION,0,this.MAX_SPEED),this.acceleration=o.clamp(this.acceleration-r*e,0,1)}else r=i(this.speed/this.MAX_REVERSE_SPEED),this.speed=o.clamp(this.speed+r*e*this.BACK_ACCELERATION,this.MAX_REVERSE_SPEED,0),this.acceleration=o.clamp(this.acceleration+r*e,-1,0);t.moveLeft||t.moveRight||(this.wheelOrientation>0?this.wheelOrientation=o.clamp(this.wheelOrientation-e*this.WHEEL_ANGULAR_DECCELERATION,0,this.MAX_WHEEL_ROTATION):this.wheelOrientation=o.clamp(this.wheelOrientation+e*this.WHEEL_ANGULAR_DECCELERATION,-this.MAX_WHEEL_ROTATION,0));var n=this.speed*e;this.carOrientation+=n*this.STEERING_RADIUS_RATIO*this.wheelOrientation,this.root.position.x+=Math.sin(this.carOrientation)*n,this.root.position.z+=Math.cos(this.carOrientation)*n,this.root.rotation.y=this.carOrientation,this.loaded&&(this.bodyMesh.rotation.z=this.MAX_TILT_SIDES*this.wheelOrientation*(this.speed/this.MAX_SPEED),this.bodyMesh.rotation.x=-this.MAX_TILT_FRONTBACK*this.acceleration);var a=n*(1/(this.modelScale*(this.wheelDiameter/2)));this.loaded&&(this.frontLeftWheelMesh.rotation.x+=a,this.frontRightWheelMesh.rotation.x+=a,this.backLeftWheelMesh.rotation.x+=a,this.backRightWheelMesh.rotation.x+=a),this.frontLeftWheelRoot.rotation.y=this.wheelOrientation,this.frontRightWheelRoot.rotation.y=this.wheelOrientation}},t.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var r=function(e){t.deviceOrientation=e},n=function(){t.screenOrientation=i.orientation||0},a=function(){var e=new s(0,0,1),t=new l,r=new c,n=new c(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(i,o,a,s,c){t.set(a,o,-s,"YXZ"),i.setFromEuler(t),i.multiply(n),i.multiply(r.setFromAxisAngle(e,-c))}}();this.connect=function(){n(),i.addEventListener("orientationchange",n,!1),i.addEventListener("deviceorientation",r,!1),t.enabled=!0},this.disconnect=function(){i.removeEventListener("orientationchange",n,!1),i.removeEventListener("deviceorientation",r,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var r=e.alpha?o.degToRad(e.alpha)+t.alphaOffset:0,n=e.beta?o.degToRad(e.beta):0,i=e.gamma?o.degToRad(e.gamma):0,s=t.screenOrientation?o.degToRad(t.screenOrientation):0;a(t.object.quaternion,r,n,i,s)}}},this.dispose=function(){t.disconnect()},this.connect()},t.DragControls=Dn,t.EditorControls=Un,t.FirstPersonControls=function(e,t){function r(e){e.preventDefault()}this.object=e,this.target=new s(0,0,0),this.domElement=void 0!==t?t:document,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=i.innerWidth/2,this.viewHalfY=i.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(e){this.domElement===document?(this.mouseX=e.pageX-this.viewHalfX,this.mouseY=e.pageY-this.viewHalfY):(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}},this.onKeyUp=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(e){if(!1!==this.enabled){if(this.heightSpeed){var t=o.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=e*(t*this.heightCoef)}else this.autoSpeedFactor=0;var r=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(r+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(r),this.moveLeft&&this.object.translateX(-r),this.moveRight&&this.object.translateX(r),this.moveUp&&this.object.translateY(r),this.moveDown&&this.object.translateY(-r);var n=e*this.lookSpeed;this.activeLook||(n=0);var i=1;this.constrainVertical&&(i=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*n,this.lookVertical&&(this.lat-=this.mouseY*n*i),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=o.degToRad(90-this.lat),this.theta=o.degToRad(this.lon),this.constrainVertical&&(this.phi=o.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var a=this.target,s=this.object.position;a.x=s.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=s.y+100*Math.cos(this.phi),a.z=s.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a)}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",r,!1),this.domElement.removeEventListener("mousedown",a,!1),this.domElement.removeEventListener("mousemove",n,!1),this.domElement.removeEventListener("mouseup",c,!1),i.removeEventListener("keydown",u,!1),i.removeEventListener("keyup",l,!1)};var n=h(this,this.onMouseMove),a=h(this,this.onMouseDown),c=h(this,this.onMouseUp),u=h(this,this.onKeyDown),l=h(this,this.onKeyUp);function h(e,t){return function(){t.apply(e,arguments)}}this.domElement.addEventListener("contextmenu",r,!1),this.domElement.addEventListener("mousemove",n,!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mouseup",c,!1),i.addEventListener("keydown",u,!1),i.addEventListener("keyup",l,!1),this.handleResize()},t.FlyControls=function(e,t){function r(e,t){return function(){t.apply(e,arguments)}}function n(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,t&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this.tmpQuaternion=new c,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new s(0,0,0),this.rotationVector=new s(0,0,0),this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(e){if(!this.dragToLook||this.mouseStatus>0){var t=this.getContainerDimensions(),r=t.size[0]/2,n=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,this.moveState.pitchDown=(e.pageY-t.offset[1]-n)/n,this.updateRotationVector()}},this.mouseup=function(e){if(e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(e){var t=e*this.movementSpeed,r=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*r,this.rotationVector.y*r,this.rotationVector.z*r,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)},this.updateMovementVector=function(){var e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[i.innerWidth,i.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",n,!1),this.domElement.removeEventListener("mousedown",a,!1),this.domElement.removeEventListener("mousemove",o,!1),this.domElement.removeEventListener("mouseup",u,!1),i.removeEventListener("keydown",l,!1),i.removeEventListener("keyup",h,!1)};var o=r(this,this.mousemove),a=r(this,this.mousedown),u=r(this,this.mouseup),l=r(this,this.keydown),h=r(this,this.keyup);this.domElement.addEventListener("contextmenu",n,!1),this.domElement.addEventListener("mousemove",o,!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mouseup",u,!1),i.addEventListener("keydown",l,!1),i.addEventListener("keyup",h,!1),this.updateMovementVector(),this.updateRotationVector()},t.MapControls=kn,t.OrbitControls=Bn,t.OrthographicTrackballControls=zn,t.PointerLockControls=function(e){var t=this;e.rotation.set(0,0,0);var r=new p;r.add(e);var n=new p;n.position.y=10,n.add(r);var i=Math.PI/2,o=function(e){if(!1!==t.enabled){var o=e.movementX||e.mozMovementX||e.webkitMovementX||0,a=e.movementY||e.mozMovementY||e.webkitMovementY||0;n.rotation.y-=.002*o,r.rotation.x-=.002*a,r.rotation.x=Math.max(-i,Math.min(i,r.rotation.x))}};this.dispose=function(){document.removeEventListener("mousemove",o,!1)},document.addEventListener("mousemove",o,!1),this.enabled=!1,this.getObject=function(){return n},this.getDirection=function(){var e=new s(0,0,-1),t=new l(0,0,0,"YXZ");return function(i){return t.set(r.rotation.x,n.rotation.y,0),i.copy(e).applyEuler(t),i}}()},t.TrackballControls=jn,t.TransformControls=Yn,t.TransformControlsGizmo=Jn,t.TransformControlsPlane=Qn,t.ConvexObjectBreaker=ai,t.GrannyKnot=ci,t.HeartCurve=ui,t.VivianiCurve=li,t.KnotCurve=hi,t.HelixCurve=di,t.TrefoilKnot=fi,t.TorusKnot=pi,t.CinquefoilKnot=mi,t.TrefoilPolynomialKnot=vi,t.FigureEightPolynomialKnot=gi,t.DecoratedTorusKnot4a=yi,t.DecoratedTorusKnot4b=bi,t.DecoratedTorusKnot5a=xi,t.DecoratedTorusKnot5c=wi,t.NURBSCurve=Si,t.NURBSSurface=Mi,t.NURBSUtils=_i,t.Detector=Ti,t.AnaglyphEffect=function(e,t,r){this.colorMatrixLeft=(new d).fromArray([1.0671679973602295,-.0016435992438346148,.0001777536963345483,-.028107794001698494,-.00019593400065787137,-.0002875397040043026,-.04279090091586113,15809757314855233e-21,-.00024287120322696865]),this.colorMatrixRight=(new d).fromArray([-.0355340838432312,-.06440307199954987,.018319187685847282,-.10269022732973099,.8079727292060852,-.04835830628871918,.0001224992738571018,-.009558862075209618,.567823588848114]);var n=new Yr(-1,1,1,-1,0,1),i=new qr,o=new Ai,a={minFilter:Ze,magFilter:Ye,format:pt};void 0===t&&(t=512),void 0===r&&(r=512);var s=new Kr(t,r,a),c=new Kr(t,r,a),u=new Xr({uniforms:{mapLeft:{value:s.texture},mapRight:{value:c.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),l=new dr(new en(2,2),u);i.add(l),this.setSize=function(t,r){e.setSize(t,r);var n=e.getPixelRatio();s.setSize(t*n,r*n),c.setSize(t*n,r*n)},this.render=function(t,r){t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),o.update(r),e.render(t,o.cameraL,s,!0),e.render(t,o.cameraR,c,!0),e.render(i,n)},this.dispose=function(){s&&s.dispose(),c&&c.dispose(),l&&l.geometry.dispose(),u&&u.dispose()}},t.AsciiEffect=function(e,t,r){t=void 0===t?" .:-=+*#%@":t,r||(r={});var n,i,o=r.resolution?r.resolution:.15,a=r.scale?r.scale:1,s=!!r.color&&r.color,c=!!r.alpha&&r.alpha,u=!!r.block&&r.block,l=!!r.invert&&r.invert,h=document.createElement("div");h.style.cursor="default";var d,f,p,m=document.createElement("table");h.appendChild(m),this.setSize=function(t,r){n=t,i=r,e.setSize(t,r),function(){d=Math.round(n*S),f=Math.round(i*S),x.width=d,x.height=f,(p=e.domElement).style.backgroundColor&&(m.rows[0].cells[0].style.backgroundColor=p.style.backgroundColor,m.rows[0].cells[0].style.color=p.style.color),m.cellSpacing=0,m.cellPadding=0;var t=m.style;t.display="inline",t.width=Math.round(d/S*a)+"px",t.height=Math.round(f/S*a)+"px",t.whiteSpace="pre",t.margin="0px",t.padding="0px",t.letterSpacing=A+"px",t.fontFamily=y,t.fontSize=M+"px",t.lineHeight=T+"px",t.textAlign="left",t.textDecoration="none"}()},this.render=function(t,r){e.render(t,r),function(e,t){w.clearRect(0,0,d,f),w.drawImage(b,0,0,d,f);for(var r=w.getImageData(0,0,d,f).data,n="",i=0;i<f;i+=2){for(var o=0;o<d;o++){var a,h,p=4*(i*d+o),m=r[p],v=r[p+1],g=r[p+2],y=r[p+3];h=(.3*m+.59*v+.11*g)/255,0==y&&(h=1),a=Math.floor((1-h)*(_.length-1)),l&&(a=_.length-a-1);var x=_[a];void 0!==x&&" "!=x||(x="&nbsp;"),n+=s?"<span style='color:rgb("+m+","+v+","+g+");"+(u?"background-color:rgb("+m+","+v+","+g+");":"")+(c?"opacity:"+y/255+";":"")+"'>"+x+"</span>":x}n+="<br/>"}t.innerHTML="<tr><td>"+n+"</td></tr>"}(0,m)},this.domElement=h;var v=" .,:;i1tfLCG08@".split(""),g=" CGO08@".split(""),y="courier new, monospace",b=e.domElement,x=document.createElement("canvas");if(x.getContext){var w=x.getContext("2d");if(w.getImageData){var _=s?g:v;t&&(_=t);var S=.5;S=.25,o&&(S=o);var M=2/S*a,T=2/S*a,A=0;switch(a){case 1:A=-1;break;case 2:case 3:A=-2.1;break;case 4:A=-3.1;break;case 5:A=-4.15}}}},t.OutlineEffect=function(e,t){t=t||{},this.enabled=!0;var r=void 0!==t.defaultThickness?t.defaultThickness:.003,n=(new v).fromArray(void 0!==t.defaultColor?t.defaultColor:[0,0,0]),i=void 0!==t.defaultAlpha?t.defaultAlpha:1,o=void 0!==t.defaultKeepAlive&&t.defaultKeepAlive,a={},s=60,c={},u={},l={MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical"},h={outlineThickness:{type:"f",value:r},outlineColor:{type:"c",value:n},outlineAlpha:{type:"f",value:i}},d=["#include <fog_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 objectNormal, vec4 skinned ) {","\tfloat thickness = outlineThickness;","\tconst float ratio = 1.0;","\tvec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + objectNormal, 1.0 );","\tvec4 norm = normalize( pos - pos2 );","\treturn pos + norm * thickness * pos.w * ratio;","}"].join("\n"),f=["#if ! defined( LAMBERT ) && ! defined( PHONG ) && ! defined( TOON ) && ! defined( PHYSICAL )","\t#ifndef USE_ENVMAP","\t\tvec3 objectNormal = normalize( normal );","\t#endif","#endif","#ifdef FLIP_SIDED","\tobjectNormal = -objectNormal;","#endif","#ifdef DECLARE_TRANSFORMED","\tvec3 transformed = vec3( position );","#endif","gl_Position = calculateOutline( gl_Position, objectNormal, vec4( transformed, 1.0 ) );","#include <fog_vertex>"].join("\n"),p=["#include <common>","#include <fog_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","\tgl_FragColor = vec4( outlineColor, outlineAlpha );","\t#include <fog_fragment>","}"].join("\n");function m(){return new Xr({name:"invisible",visible:!1})}function g(e){var t=a[e.uuid];return void 0===t&&(t={material:function(e){var t,r,n=l[e.type];if(e.userData.outlineParameters,void 0!==n){var i=Li[n];t=i.uniforms,r=i.vertexShader}else if(!0===e.isRawShaderMaterial){if(t=e.uniforms,r=e.vertexShader,!/attribute\s+vec3\s+position\s*;/.test(r)||!/attribute\s+vec3\s+normal\s*;/.test(r))return console.warn("OutlineEffect requires both vec3 position and normal attributes in vertex shader, does not draw outline for "+e.name+"(uuid:"+e.uuid+") material."),m()}else{if(!0!==e.isShaderMaterial)return m();t=e.uniforms,r=e.vertexShader}var o=Object.assign({},t,h),a=r.replace(/void\s+main\s*\(\s*\)/,d+"\nvoid main()").replace(/\}\s*$/,f+"\n}").replace(/#include\s+<[\w_]*light[\w_]*>/g,""),s={};return/vec3\s+transformed\s*=/.test(r)||/#include\s+<begin_vertex>/.test(r)||(s.DECLARE_TRANSFORMED=!0),new Xr({defines:s,uniforms:o,vertexShader:a,fragmentShader:p,side:Y,skinning:!1,morphTargets:!1,morphNormals:!1,fog:!1})}(e),used:!0,keepAlive:o,count:0},a[e.uuid]=t),t.used=!0,t.material}function y(e){var t=g(e);return c[t.uuid]=e,function(e,t){if("invisible"!==e.name){var r=t.userData.outlineParameters;e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.fog=t.fog,void 0!==r?(!1===t.visible?e.visible=!1:e.visible=void 0===r.visible||r.visible,e.transparent=void 0!==r.alpha&&r.alpha<1||t.transparent,void 0!==r.keepAlive&&(a[t.uuid].keepAlive=r.keepAlive)):(e.transparent=t.transparent,e.visible=t.visible),!0!==t.wireframe&&!1!==t.depthTest||(e.visible=!1)}}(t,e),t}function b(e){if(void 0!==e.material){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=y(e.material[t]);else e.material=y(e.material);u[e.uuid]=e.onBeforeRender,e.onBeforeRender=w}}function x(e){if(void 0!==e.material){if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=c[e.material[t].uuid];else e.material=c[e.material.uuid];e.onBeforeRender=u[e.uuid]}}function w(e,t,r,n,i,o){var a=c[i.uuid];void 0!==a&&function(e,t){var r=t.userData.outlineParameters;e.uniforms.outlineAlpha.value=t.opacity,void 0!==r&&(void 0!==r.thickness&&(e.uniforms.outlineThickness.value=r.thickness),void 0!==r.color&&e.uniforms.outlineColor.value.fromArray(r.color),void 0!==r.alpha&&(e.uniforms.outlineAlpha.value=r.alpha))}(i,a)}this.render=function(t,r,n,i){if(!1!==this.enabled){var o=e.autoClear;e.autoClear=this.autoClear,e.render(t,r,n,i);var l=t.autoUpdate,h=t.background,d=e.shadowMap.enabled;t.autoUpdate=!1,t.background=null,e.autoClear=!1,e.shadowMap.enabled=!1,t.traverse(b),e.render(t,r,n),t.traverse(x),function(){for(var e,t=0,r=(e=Object.keys(c)).length;t<r;t++)c[e[t]]=void 0;for(t=0,r=(e=Object.keys(u)).length;t<r;t++)u[e[t]]=void 0;for(t=0,r=(e=Object.keys(a)).length;t<r;t++){var n=e[t];!1===a[n].used?(a[n].count++,!1===a[n].keepAlive&&a[n].count>s&&delete a[n]):(a[n].used=!1,a[n].count=0)}}(),t.autoUpdate=l,t.background=h,e.autoClear=o,e.shadowMap.enabled=d}else e.render(t,r,n,i)},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap,this.clear=function(t,r,n){e.clear(t,r,n)},this.getPixelRatio=function(){return e.getPixelRatio()},this.setPixelRatio=function(t){e.setPixelRatio(t)},this.getSize=function(){return e.getSize()},this.setSize=function(t,r,n){e.setSize(t,r,n)},this.setViewport=function(t,r,n,i){e.setViewport(t,r,n,i)},this.setScissor=function(t,r,n,i){e.setScissor(t,r,n,i)},this.setScissorTest=function(t){e.setScissorTest(t)},this.setRenderTarget=function(t){e.setRenderTarget(t)}},t.ParallaxBarrierEffect=function(e){var t=new Yr(-1,1,1,-1,0,1),r=new qr,n=new Ai,i={minFilter:Ze,magFilter:Ye,format:pt},o=new Kr(512,512,i),a=new Kr(512,512,i),s=new Xr({uniforms:{mapLeft:{value:o.texture},mapRight:{value:a.texture}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","\tvec2 uv = vUv;","\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {","\t\tgl_FragColor = texture2D( mapLeft, uv );","\t} else {","\t\tgl_FragColor = texture2D( mapRight, uv );","\t}","}"].join("\n")}),c=new dr(new en(2,2),s);r.add(c),this.setSize=function(t,r){e.setSize(t,r);var n=e.getPixelRatio();o.setSize(t*n,r*n),a.setSize(t*n,r*n)},this.render=function(i,s){i.updateMatrixWorld(),null===s.parent&&s.updateMatrixWorld(),n.update(s),e.render(i,n.cameraL,o,!0),e.render(i,n.cameraR,a,!0),e.render(r,t)}},t.PeppersGhostEffect=function(e){var t,r,n,i=this;i.cameraDistance=15,i.reflectFromAbove=!1;var o=new Wr,a=new Wr,u=new Wr,l=new Wr,h=new s,d=new c,f=new s;e.autoClear=!1,this.setSize=function(i,o){t=i/2,i<o?(r=i/3,n=i/3):(r=o/3,n=o/3),e.setSize(i,o)},this.render=function(s,c){s.updateMatrixWorld(),null===c.parent&&c.updateMatrixWorld(),c.matrixWorld.decompose(h,d,f),o.position.copy(h),o.quaternion.copy(d),o.translateZ(i.cameraDistance),o.lookAt(s.position),a.position.copy(h),a.quaternion.copy(d),a.translateZ(-i.cameraDistance),a.lookAt(s.position),a.rotation.z+=Math.PI/180*180,u.position.copy(h),u.quaternion.copy(d),u.translateX(-i.cameraDistance),u.lookAt(s.position),u.rotation.x+=Math.PI/180*90,l.position.copy(h),l.quaternion.copy(d),l.translateX(i.cameraDistance),l.lookAt(s.position),l.rotation.x+=Math.PI/180*90,e.clear(),e.setScissorTest(!0),e.setScissor(t-r/2,2*n,r,n),e.setViewport(t-r/2,2*n,r,n),i.reflectFromAbove?e.render(s,a):e.render(s,o),e.setScissor(t-r/2,0,r,n),e.setViewport(t-r/2,0,r,n),i.reflectFromAbove?e.render(s,o):e.render(s,a),e.setScissor(t-r/2-r,n,r,n),e.setViewport(t-r/2-r,n,r,n),i.reflectFromAbove?e.render(s,l):e.render(s,u),e.setScissor(t+r/2,n,r,n),e.setViewport(t+r/2,n,r,n),i.reflectFromAbove?e.render(s,u):e.render(s,l),e.setScissorTest(!1)}},t.StereoEffect=function(e){var t=new Ai;t.aspect=.5,this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,r){e.setSize(t,r)},this.render=function(r,n){r.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),t.update(n);var i=e.getSize();e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,i.width/2,i.height),e.setViewport(0,0,i.width/2,i.height),e.render(r,t.cameraL),e.setScissor(i.width/2,0,i.width/2,i.height),e.setViewport(i.width/2,0,i.width/2,i.height),e.render(r,t.cameraR),e.setScissorTest(!1)}},t.ColladaExporter=Pi,t.GLTFExporter=Ii,t.MMDExporter=function(){var e;this.parseVpd=function(t,r,n){if(!0!==t.isSkinnedMesh)return console.warn("MMDExporter: parseVpd() requires SkinnedMesh instance."),null;function i(e){Math.abs(e)<1e-6&&(e=0);var t=e.toString();-1===t.indexOf(".")&&(t+=".");var r=(t+="000000").indexOf(".");return t.slice(0,r)+"."+t.slice(r+1,r+7)}function o(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(i(e[r]));return t.join(",")}t.updateMatrixWorld(!0);var u=t.skeleton.bones,l=function(e){var t=e.clone();return t.pose(),t.skeleton.bones}(t),h=new s,d=new c,f=new c,p=new a,m=[];m.push("Vocaloid Pose Data file"),m.push(""),m.push((""!==t.name?t.name.replace(/\s/g,"_"):"skin")+".osm;"),m.push(u.length+";"),m.push("");for(var v=0,g=u.length;v<g;v++){var y=u[v],b=l[v];!0===n&&void 0!==y.userData.ik&&void 0!==y.userData.ik.originalMatrix?p.fromArray(y.userData.ik.originalMatrix):p.copy(y.matrix),h.setFromMatrixPosition(p),d.setFromRotationMatrix(p);var x=h.sub(b.position).toArray(),w=f.copy(b.quaternion).conjugate().multiply(d).toArray();x[2]=-x[2],w[0]=-w[0],w[1]=-w[1],m.push("Bone"+v+"{"+y.name),m.push("  "+o(x)+";"),m.push("  "+o(w)+";"),m.push("}"),m.push("")}m.push("");var _=m.join("\n");return!0===r?function(t){if(void 0===e){var r=(new MMDParser.CharsetEncoder).s2uTable;e={};for(var n=Object.keys(r),i=0,o=n.length;i<o;i++){var a=n[i],s=r[a];a=parseInt(a),e[s]=a}}var c=[];for(i=0,o=t.length;i<o;i++){var u=t.charCodeAt(i);if(void 0===(s=e[u]))throw"cannot convert charcode 0x"+u.toString(16);s>255?(c.push(s>>8&255),c.push(255&s)):c.push(255&s)}return new Uint8Array(c)}(_):_}},t.OBJExporter=Di,t.PLYExporter=Fi,t.STLExporter=Ui,t.TypedGeometryExporter=ki,t.ConvexGeometry=ii,t.ConvexBufferGeometry=oi,t.DecalGeometry=Bi,t.hilbert2D=function e(t,r,n,i,o,a,c){t=void 0!==t?t:new s(0,0,0);var u=(r=void 0!==r?r:10)/2,l=(n=void 0!==n?n:1,i=void 0!==i?i:0,o=void 0!==o?o:1,a=void 0!==a?a:2,c=void 0!==c?c:3,[new s(t.x-u,t.y,t.z-u),new s(t.x-u,t.y,t.z+u),new s(t.x+u,t.y,t.z+u),new s(t.x+u,t.y,t.z-u)]),h=[l[i],l[o],l[a],l[c]];if(0<=--n){var d=[];return Array.prototype.push.apply(d,e(h[0],u,n,i,c,a,o)),Array.prototype.push.apply(d,e(h[1],u,n,i,o,a,c)),Array.prototype.push.apply(d,e(h[2],u,n,i,o,a,c)),Array.prototype.push.apply(d,e(h[3],u,n,a,o,i,c)),d}return h},t.hilbert3D=function e(t,r,n,i,o,a,c,u,l,h,d){t=void 0!==t?t:new s(0,0,0);var f=(r=void 0!==r?r:10)/2,p=(n=void 0!==n?n:1,i=void 0!==i?i:0,o=void 0!==o?o:1,a=void 0!==a?a:2,c=void 0!==c?c:3,u=void 0!==u?u:4,l=void 0!==l?l:5,h=void 0!==h?h:6,d=void 0!==d?d:7,[new s(t.x-f,t.y+f,t.z-f),new s(t.x-f,t.y+f,t.z+f),new s(t.x-f,t.y-f,t.z+f),new s(t.x-f,t.y-f,t.z-f),new s(t.x+f,t.y-f,t.z-f),new s(t.x+f,t.y-f,t.z+f),new s(t.x+f,t.y+f,t.z+f),new s(t.x+f,t.y+f,t.z-f)]),m=[p[i],p[o],p[a],p[c],p[u],p[l],p[h],p[d]];if(--n>=0){var v=[];return Array.prototype.push.apply(v,e(m[0],f,n,i,c,u,d,h,l,a,o)),Array.prototype.push.apply(v,e(m[1],f,n,i,d,h,o,a,l,u,c)),Array.prototype.push.apply(v,e(m[2],f,n,i,d,h,o,a,l,u,c)),Array.prototype.push.apply(v,e(m[3],f,n,a,c,i,o,h,d,u,l)),Array.prototype.push.apply(v,e(m[4],f,n,a,c,i,o,h,d,u,l)),Array.prototype.push.apply(v,e(m[5],f,n,u,c,a,l,h,o,i,d)),Array.prototype.push.apply(v,e(m[6],f,n,u,c,a,l,h,o,i,d)),Array.prototype.push.apply(v,e(m[7],f,n,h,l,a,o,i,c,u,d)),v}return m},t.TeapotBufferGeometry=ji,t.GPUComputationRenderer=function(e,t,r){this.variables=[],this.currentTextureIndex=0;var n=new qr,i=new Gr;i.position.z=1;var o={texture:{value:null}},a=u("uniform sampler2D texture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( texture, uv );\n\n}\n",o),s=new dr(new en(2,2),a);function c(r){r.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function u(e,t){var r=new Xr({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return c(r),r}n.add(s),this.addVariable=function(e,t,r){var n={name:e,initialValueTexture:r,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Ye,magFilter:Ye};return this.variables.push(n),n},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!r.extensions.get("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===r.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var n=0;n<this.variables.length;n++){var i=this.variables[n];i.renderTargets[0]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),i.renderTargets[1]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),this.renderTexture(i.initialValueTexture,i.renderTargets[0]),this.renderTexture(i.initialValueTexture,i.renderTargets[1]);var o=i.material,a=o.uniforms;if(null!==i.dependencies)for(var s=0;s<i.dependencies.length;s++){var c=i.dependencies[s];if(c.name!==i.name){for(var u=!1,l=0;l<this.variables.length;l++)if(c.name===this.variables[l].name){u=!0;break}if(!u)return"Variable dependency not found. Variable="+i.name+", dependency="+c.name}a[c.name]={value:null},o.fragmentShader="\nuniform sampler2D "+c.name+";\n"+o.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0,r=0,n=this.variables.length;r<n;r++){var i=this.variables[r];if(null!==i.dependencies)for(var o=i.material.uniforms,a=0,s=i.dependencies.length;a<s;a++){var c=i.dependencies[a];o[c.name].value=c.renderTargets[e].texture}this.doRenderTarget(i.material,i.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=c,this.createShaderMaterial=u,this.createRenderTarget=function(r,n,i,o,a,s){return new Kr(r=r||e,n=n||t,{wrapS:i=i||Xe,wrapT:o=o||Xe,minFilter:a=a||Ye,magFilter:s=s||Ye,format:pt,type:/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?st:at,stencilBuffer:!1,depthBuffer:!1})},this.createTexture=function(){var r=new Vi(new Float32Array(e*t*4),e,t,pt,at);return r.needsUpdate=!0,r},this.renderTexture=function(e,t){o.texture.value=e,this.doRenderTarget(a,t),o.texture.value=null},this.doRenderTarget=function(e,t){s.material=e,r.render(n,i,t),s.material=a}},t.GPUParticleSystem=Wi,t.GPUParticleContainer=Hi,t.Gyroscope=Xi,t.ImprovedNoise=function(){for(var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=0;t<256;t++)e[256+t]=e[t];function r(e){return e*e*e*(e*(6*e-15)+10)}function n(e,t,r){return t+e*(r-t)}function i(e,t,r,n){var i=15&e,o=i<8?t:r,a=i<4?r:12==i||14==i?t:n;return(0==(1&i)?o:-o)+(0==(2&i)?a:-a)}return{noise:function(t,o,a){var s=Math.floor(t),c=Math.floor(o),u=Math.floor(a),l=255&s,h=255&c,d=255&u,f=(t-=s)-1,p=(o-=c)-1,m=(a-=u)-1,v=r(t),g=r(o),y=r(a),b=e[l]+h,x=e[b]+d,w=e[b+1]+d,_=e[l+1]+h,S=e[_]+d,M=e[_+1]+d;return n(y,n(g,n(v,i(e[x],t,o,a),i(e[S],f,o,a)),n(v,i(e[w],t,p,a),i(e[M],f,p,a))),n(g,n(v,i(e[x+1],t,o,m),i(e[S+1],f,o,a-1)),n(v,i(e[w+1],t,p,m),i(e[M+1],f,p,m))))}}},t.Line2=ro,t.LineGeometry=to,t.LineMaterial=$i,t.LineSegments2=eo,t.LineSegmentsGeometry=Ki,t.Wireframe=no,t.WireframeGeometry2=io,t.ThreeMFLoader=ao,t.AMFLoader=so,t.AssimpJSONLoader=co,t.AssimpLoader=ho,t.AWDLoader=mo,t.BabylonLoader=Mo,t.BinaryLoader=Pn,t.BVHLoader=To,t.ColladaLoader=Lo,t.DDSLoader=No,t.LegacyGLTFLoader=Io,t.DRACOLoader=Do,t.EquirectangularToCubeGenerator=Uo,t.EXRLoader=Bo,t.FBXLoader=zo,t.GCodeLoader=jo,t.GLTFLoader=Go,t.HDRCubeTextureLoader=qo,t.KMZLoader=Yo,t.KTXLoader=Jo,t.LoaderSupport=Zo,t.MD2Loader=Ko,t.MMDLoader=$o,t.MTLLoader=ea,t.NodeMaterialLoader=va,t.OBJLoader=ga,t.OBJLoader2=ya,t.PCDLoader=ba,t.PDBLoader=xa,t.PlayCanvasLoader=wa,t.PLYLoader=_a,t.PRWMLoader=Ca,t.PVRLoader=La,t.HDRLoader=Ho,t.RGBELoader=Wo,t.STLLoader=Pa,t.SVGLoader=Ts,t.TDSLoader=As,t.TGALoader=Co,t.TTFLoader=lc,t.VRMLLoader=hc,t.VRMLoader=dc,t.VTKLoader=fc,t.MarchingCubes=mc,t.ColorConverter=bc,t.Lut=_c,t.MD2Character=function(){var e=this;function t(e,t){for(var r=new An,i=[],o=0;o<t.length;o++)i[o]=r.load(e+t[o],n),i[o].mapping=Ue,i[o].name=t[o];return i}function r(e,t){var r=new pn({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),n=new pn({color:16777215,wireframe:!1,map:t,morphTargets:!0,morphNormals:!0}),i=new dr(e,n);return i.rotation.y=-Math.PI/2,i.castShadow=!0,i.receiveShadow=!0,i.materialTexture=n,i.materialWireframe=r,i}function n(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}this.scale=1,this.animationFPS=6,this.root=new p,this.meshBody=null,this.meshWeapon=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.activeAnimation=null,this.mixer=null,this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(i){this.loadCounter=2*i.weapons.length+i.skins.length+1;for(var o=[],a=0;a<i.weapons.length;a++)o[a]=i.weapons[a][1];this.skinsBody=t(i.baseUrl+"skins/",i.skins),this.skinsWeapon=t(i.baseUrl+"skins/",o);var s=new Ko;s.load(i.baseUrl+i.body,function(t){t.computeBoundingBox(),e.root.position.y=-e.scale*t.boundingBox.min.y;var i=r(t,e.skinsBody[0]);i.scale.set(e.scale,e.scale,e.scale),e.root.add(i),e.meshBody=i,e.meshBody.clipOffset=0,e.activeAnimationClipName=i.geometry.animations[0].name,e.mixer=new Ir(i),n()});var c=function(t,i){return function(o){var a=r(o,e.skinsWeapon[t]);a.scale.set(e.scale,e.scale,e.scale),a.visible=!1,a.name=i,e.root.add(a),e.weapons[t]=a,e.meshWeapon=a,n()}};for(a=0;a<i.weapons.length;a++)s.load(i.baseUrl+i.weapons[a][0],c(a,i.weapons[a][0]))},this.setPlaybackRate=function(e){this.mixer.timeScale=0!==e?1/e:0},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e])},this.setWeapon=function(t){for(var r=0;r<this.weapons.length;r++)this.weapons[r].visible=!1;var n=this.weapons[t];n&&(n.visible=!0,this.meshWeapon=n,e.syncWeaponAnimation())},this.setAnimation=function(t){if(this.meshBody){this.meshBody.activeAction&&(this.meshBody.activeAction.stop(),this.meshBody.activeAction=null);var r=this.mixer.clipAction(t,this.meshBody);r&&(this.meshBody.activeAction=r.play())}e.activeClipName=t,e.syncWeaponAnimation()},this.syncWeaponAnimation=function(){var t=e.activeClipName;if(e.meshWeapon){this.meshWeapon.activeAction&&(this.meshWeapon.activeAction.stop(),this.meshWeapon.activeAction=null);var r=this.mixer.clipAction(t,this.meshWeapon);r&&(this.meshWeapon.activeAction=r.syncWith(this.meshBody.activeAction).play())}},this.update=function(e){this.mixer&&this.mixer.update(e)}},t.MD2CharacterComplex=function(){var e=this;function t(e,t){for(var r=new An,i=[],o=0;o<t.length;o++)i[o]=r.load(e+t[o],n),i[o].mapping=Ue,i[o].name=t[o];return i}function r(t,r){var n=new pn({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),i=new pn({color:16777215,wireframe:!1,map:r,morphTargets:!0,morphNormals:!0}),o=new Mc(t,i);return o.rotation.y=-Math.PI/2,o.materialTexture=i,o.materialWireframe=n,o.autoCreateAnimations(e.animationFPS),o}function n(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}function i(e){return 1===e?1:1-Math.pow(2,-10*e)}this.scale=1,this.animationFPS=6,this.transitionFrames=15,this.maxSpeed=275,this.maxReverseSpeed=-275,this.frontAcceleration=600,this.backAcceleration=600,this.frontDecceleration=600,this.angularSpeed=2.5,this.root=new p,this.meshBody=null,this.meshWeapon=null,this.controls=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.currentSkin=void 0,this.onLoadComplete=function(){},this.meshes=[],this.animations={},this.loadCounter=0,this.speed=0,this.bodyOrientation=0,this.walkSpeed=this.maxSpeed,this.crouchSpeed=.5*this.maxSpeed,this.activeAnimation=null,this.oldAnimation=null,this.enableShadows=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].castShadow=e,this.meshes[t].receiveShadow=e},this.setVisible=function(e){for(var t=0;t<this.meshes.length;t++)this.meshes[t].visible=e,this.meshes[t].visible=e},this.shareParts=function(e){this.animations=e.animations,this.walkSpeed=e.walkSpeed,this.crouchSpeed=e.crouchSpeed,this.skinsBody=e.skinsBody,this.skinsWeapon=e.skinsWeapon;var t=r(e.meshBody.geometry,this.skinsBody[0]);t.scale.set(this.scale,this.scale,this.scale),this.root.position.y=e.root.position.y,this.root.add(t),this.meshBody=t,this.meshes.push(t);for(var n=0;n<e.weapons.length;n++){var i=r(e.weapons[n].geometry,this.skinsWeapon[n]);i.scale.set(this.scale,this.scale,this.scale),i.visible=!1,i.name=e.weapons[n].name,this.root.add(i),this.weapons[n]=i,this.meshWeapon=i,this.meshes.push(i)}},this.loadParts=function(i){this.animations=i.animations,this.walkSpeed=i.walkSpeed,this.crouchSpeed=i.crouchSpeed,this.loadCounter=2*i.weapons.length+i.skins.length+1;for(var o=[],a=0;a<i.weapons.length;a++)o[a]=i.weapons[a][1];this.skinsBody=t(i.baseUrl+"skins/",i.skins),this.skinsWeapon=t(i.baseUrl+"skins/",o);var s=new Ko;s.load(i.baseUrl+i.body,function(t){t.computeBoundingBox(),e.root.position.y=-e.scale*t.boundingBox.min.y;var i=r(t,e.skinsBody[0]);i.scale.set(e.scale,e.scale,e.scale),e.root.add(i),e.meshBody=i,e.meshes.push(i),n()});var c=function(t,i){return function(o){var a=r(o,e.skinsWeapon[t]);a.scale.set(e.scale,e.scale,e.scale),a.visible=!1,a.name=i,e.root.add(a),e.weapons[t]=a,e.meshWeapon=a,e.meshes.push(a),n()}};for(a=0;a<i.weapons.length;a++)s.load(i.baseUrl+i.weapons[a][0],c(a,i.weapons[a][0]))},this.setPlaybackRate=function(e){this.meshBody&&(this.meshBody.duration=this.meshBody.baseDuration/e),this.meshWeapon&&(this.meshWeapon.duration=this.meshWeapon.baseDuration/e)},this.setWireframe=function(e){e?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(e){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[e],this.currentSkin=e)},this.setWeapon=function(e){for(var t=0;t<this.weapons.length;t++)this.weapons[t].visible=!1;var r=this.weapons[e];r&&(r.visible=!0,this.meshWeapon=r,this.activeAnimation&&(r.playAnimation(this.activeAnimation),this.meshWeapon.setAnimationTime(this.activeAnimation,this.meshBody.getAnimationTime(this.activeAnimation))))},this.setAnimation=function(e){e!==this.activeAnimation&&e&&(this.meshBody&&(this.meshBody.setAnimationWeight(e,0),this.meshBody.playAnimation(e),this.oldAnimation=this.activeAnimation,this.activeAnimation=e,this.blendCounter=this.transitionFrames),this.meshWeapon&&(this.meshWeapon.setAnimationWeight(e,0),this.meshWeapon.playAnimation(e)))},this.update=function(e){this.controls&&this.updateMovementModel(e),this.animations&&(this.updateBehaviors(e),this.updateAnimations(e))},this.updateAnimations=function(e){var t=1;this.blendCounter>0&&(t=(this.transitionFrames-this.blendCounter)/this.transitionFrames,this.blendCounter-=1),this.meshBody&&(this.meshBody.update(e),this.meshBody.setAnimationWeight(this.activeAnimation,t),this.meshBody.setAnimationWeight(this.oldAnimation,1-t)),this.meshWeapon&&(this.meshWeapon.update(e),this.meshWeapon.setAnimationWeight(this.activeAnimation,t),this.meshWeapon.setAnimationWeight(this.oldAnimation,1-t))},this.updateBehaviors=function(e){var t,r,n=this.controls,i=this.animations;n.crouch?(t=i.crouchMove,r=i.crouchIdle):(t=i.move,r=i.idle),n.jump&&(t=i.jump,r=i.jump),n.attack&&(n.crouch?(t=i.crouchAttack,r=i.crouchAttack):(t=i.attack,r=i.attack)),(n.moveForward||n.moveBackward||n.moveLeft||n.moveRight)&&this.activeAnimation!==t&&this.setAnimation(t),Math.abs(this.speed)<.2*this.maxSpeed&&!(n.moveLeft||n.moveRight||n.moveForward||n.moveBackward)&&this.activeAnimation!==r&&this.setAnimation(r),n.moveForward&&(this.meshBody&&(this.meshBody.setAnimationDirectionForward(this.activeAnimation),this.meshBody.setAnimationDirectionForward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionForward(this.activeAnimation),this.meshWeapon.setAnimationDirectionForward(this.oldAnimation))),n.moveBackward&&(this.meshBody&&(this.meshBody.setAnimationDirectionBackward(this.activeAnimation),this.meshBody.setAnimationDirectionBackward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionBackward(this.activeAnimation),this.meshWeapon.setAnimationDirectionBackward(this.oldAnimation)))},this.updateMovementModel=function(e){var t=this.controls;if(t.crouch?this.maxSpeed=this.crouchSpeed:this.maxSpeed=this.walkSpeed,this.maxReverseSpeed=-this.maxSpeed,t.moveForward&&(this.speed=o.clamp(this.speed+e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),t.moveBackward&&(this.speed=o.clamp(this.speed-e*this.backAcceleration,this.maxReverseSpeed,this.maxSpeed)),t.moveLeft&&(this.bodyOrientation+=e*this.angularSpeed,this.speed=o.clamp(this.speed+1*e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),t.moveRight&&(this.bodyOrientation-=e*this.angularSpeed,this.speed=o.clamp(this.speed+1*e*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),!t.moveForward&&!t.moveBackward)if(this.speed>0){var r=i(this.speed/this.maxSpeed);this.speed=o.clamp(this.speed-r*e*this.frontDecceleration,0,this.maxSpeed)}else r=i(this.speed/this.maxReverseSpeed),this.speed=o.clamp(this.speed+r*e*this.backAcceleration,this.maxReverseSpeed,0);var n=this.speed*e;this.root.position.x+=Math.sin(this.bodyOrientation)*n,this.root.position.z+=Math.cos(this.bodyOrientation)*n,this.root.rotation.y=this.bodyOrientation}},t.ExplodeModifier=Tc,t.SimplifyModifier=Ac,t.SubdivisionModifier=Ec,t.TessellateModifier=Cc,t.MorphAnimMesh=Lc,t.MorphBlendMesh=Mc,t.CameraNode=ma,t.ColorsNode=Nc,t.LightNode=Rc,t.NormalNode=ua,t.PositionNode=ca,t.ReflectNode=Ic,t.ResolutionNode=iu,t.ScreenUVNode=ou,t.UVNode=sa,t.BlinnExponentToRoughnessNode=Xc,t.BlinnShininessExponentNode=Hc,t.RoughnessToBlinnExponentNode=su,t.AttributeNode=cu,t.ConstNode=pa,t.ExpressionNode=uu,t.FunctionCallNode=lu,t.FunctionNode=na,t.InputNode=la,t.Node=ta,t.NodeBuilder=$c,t.NodeFrame=hu,t.NodeLib=ia,t.NodeUniform=Fc,t.NodeUtils=Dc,t.StructNode=Bc,t.TempNode=ra,t.VarNode=du,t.BlurNode=fu,t.ColorAdjustmentNode=mu,t.LuminanceNode=pu,t.ColorNode=eu,t.CubeTextureNode=Wc,t.FloatNode=ha,t.IntNode=vu,t.Matrix3Node=gu,t.Matrix4Node=yu,t.PropertyNode=bu,t.ReflectorNode=wu,t.RTTNode=_u,t.ScreenNode=Su,t.TextureNode=Gc,t.Vector2Node=nu,t.Vector3Node=zc,t.Vector4Node=jc,t.MeshStandardNodeMaterial=Cu,t.NodeMaterial=ru,t.MeshStandardNode=Eu,t.PhongNode=Lu,t.RawNode=tu,t.SpriteNode=Pu,t.StandardNode=Mu,t.PhongNodeMaterial=Ou,t.SpriteNodeMaterial=Nu,t.StandardNodeMaterial=Ru,t.CondNode=Iu,t.Math1Node=Du,t.Math2Node=Fu,t.Math3Node=Uu,t.OperatorNode=xu,t.BumpMapNode=ku,t.NormalMapNode=Au,t.TextureCubeNode=Yc,t.TextureCubeUVNode=qc,t.NodePass=ju,t.NodePostProcessing=Vu,t.CheckerNode=Gu,t.NoiseNode=Wu,t.BypassNode=Hu,t.ColorSpaceNode=Vc,t.JoinNode=qu,t.MaxMIPLevelNode=au,t.SwitchNode=Tu,t.TimerNode=da,t.UVTransformNode=Yu,t.VelocityNode=Ju,t.Lensflare=Zu,t.LensflareElement=Ku,t.Reflector=$u,t.ReflectorRTT=el,t.Refractor=tl,t.ShadowMesh=rl,t.Sky=nl,t.Water=il,t.Water2=al,t.Ocean=sl,t.Octree=dl,t.OctreeObjectData=fl,t.OctreeNode=pl,t.PMREMCubeUVPacker=ml,t.PMREMGenerator=vl,t.AdaptiveToneMappingPass=xl,t.AfterimagePass=_l,t.BloomPass=Ml,t.BokehPass=Tl,t.ClearPass=Al,t.CubeTexturePass=El,t.DotScreenPass=Ll,t.EffectComposer=Nl,t.FilmPass=Il,t.GlitchPass=Fl,t.HalftonePass=kl,t.MaskPass=Pl,t.ClearMaskPass=Ol,t.OutlinePass=Bl,t.Pass=Bu,t.RenderPass=zl,t.SAOPass=Xl,t.SavePass=ql,t.ShaderPass=zu,t.SMAAPass=Jl,t.SSAARenderPass=Ql,t.SSAOPass=Kl,t.TAARenderPass=$l,t.TexturePass=eh,t.UnrealBloomPass=rh,t.PRNG=function(){this.seed=1,this.next=function(){return this.gen()/2147483647},this.nextRange=function(e,t){return e+(t-e)*this.next()},this.gen=function(){return this.seed=16807*this.seed%2147483647}},t.QuickHull=$n,t.SpriteCanvasMaterial=lh,t.CanvasRenderer=function(e){console.log("CanvasRenderer",z),e=e||{};var t,r,n,i,o,a,c,u,l,h,f,p,m,g,y,b,x,w,_,S=this,M=new uh,T=void 0!==e.canvas?e.canvas:document.createElement("canvas"),A=T.width,E=T.height,C=Math.floor(A/2),L=Math.floor(E/2),P=0,O=0,N=A,R=E,I=1,D=T.getContext("2d",{alpha:!0===e.alpha}),F=new v(0),U=!0===e.alpha?0:1,k=1,B=0,j=null,V=null,G=null,W=null,H=null,X=[],q=new v,Y=new v,J=new v,Q=new v,$={},ie=new Qu,oe=new Qu,ae=new Qu,se=new v,ce=new v,ue=new v,le=new s,he=new s,de=new s,fe=new d;function pe(e,t,r){_e(r.opacity),Se(r.blending);var n=t.scale.x*C,i=t.scale.y*L,o=Math.sqrt(n*n+i*i);if(ae.min.set(e.x-o,e.y-o),ae.max.set(e.x+o,e.y+o),r.isSpriteMaterial){var a=r.map;if(null!==a){var s=$[a.id];if(void 0!==s&&s.version===a.version||(s=be(a),$[a.id]=s),void 0!==s.canvas){Ce(s.canvas);var c=a.image,u=c.width*a.offset.x,l=c.height*a.offset.y,h=c.width*a.repeat.x,d=c.height*a.repeat.y,f=n/h,p=i/d;D.save(),D.translate(e.x,e.y),0!==r.rotation&&D.rotate(r.rotation),D.translate(-n/2,-i/2),D.scale(f,p),D.translate(-u,-l),D.fillRect(u,l,h,d),D.restore()}}else Ce(r.color.getStyle()),D.save(),D.translate(e.x,e.y),0!==r.rotation&&D.rotate(r.rotation),D.scale(n,-i),D.fillRect(-.5,-.5,1,1),D.restore()}else r.isSpriteCanvasMaterial?(Ee(r.color.getStyle()),Ce(r.color.getStyle()),D.save(),D.translate(e.x,e.y),0!==r.rotation&&D.rotate(r.rotation),D.scale(n,i),r.program(D),D.restore()):r.isPointsMaterial&&(Ce(r.color.getStyle()),D.save(),D.translate(e.x,e.y),0!==r.rotation&&D.rotate(r.rotation),D.scale(n*r.size,-i*r.size),D.fillRect(-.5,-.5,1,1),D.restore())}function me(e,t,r,n){if(_e(n.opacity),Se(n.blending),D.beginPath(),D.moveTo(e.positionScreen.x,e.positionScreen.y),D.lineTo(t.positionScreen.x,t.positionScreen.y),n.isLineBasicMaterial){if(Me(n.linewidth),Te(n.linecap),Ae(n.linejoin),n.vertexColors!==K)Ee(n.color.getStyle());else{var i=r.vertexColors[0].getStyle(),o=r.vertexColors[1].getStyle();if(i===o)Ee(i);else{try{var a=D.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,i),a.addColorStop(1,o)}catch(e){a=i}Ee(a)}}n.isLineDashedMaterial&&Le([n.dashSize,n.gapSize]),D.stroke(),ae.expandByScalar(2*n.linewidth),n.isLineDashedMaterial&&Le([])}}function ve(e,t,r,i,o,a,s,d){S.info.render.vertices+=3,S.info.render.faces++,_e(d.opacity),Se(d.blending),c=e.positionScreen.x,u=e.positionScreen.y,l=t.positionScreen.x,h=t.positionScreen.y,f=r.positionScreen.x,p=r.positionScreen.y,function(e,t,r,n,i,o){D.beginPath(),D.moveTo(e,t),D.lineTo(r,n),D.lineTo(i,o),D.closePath()}(c,u,l,h,f,p),(d.isMeshLambertMaterial||d.isMeshPhongMaterial||d.isMeshStandardMaterial)&&null===d.map?(Y.copy(d.color),J.copy(d.emissive),d.vertexColors===Z&&Y.multiply(s.color),q.copy(se),he.copy(e.positionWorld).add(t.positionWorld).add(r.positionWorld).divideScalar(3),function(e,t,r){for(var i=0,o=n.length;i<o;i++){var a=n[i];if(Q.copy(a.color),a.isDirectionalLight){var s=le.setFromMatrixPosition(a.matrixWorld).normalize();if((c=t.dot(s))<=0)continue;c*=a.intensity,r.add(Q.multiplyScalar(c))}else if(a.isPointLight){var c;if(s=le.setFromMatrixPosition(a.matrixWorld),(c=t.dot(le.subVectors(s,e).normalize()))<=0)continue;if(0==(c*=0==a.distance?1:1-Math.min(e.distanceTo(s)/a.distance,1)))continue;c*=a.intensity,r.add(Q.multiplyScalar(c))}}}(he,s.normalModel,q),q.multiply(Y).add(J),!0===d.wireframe?ge(q,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):ye(q)):d.isMeshBasicMaterial||d.isMeshLambertMaterial||d.isMeshPhongMaterial||d.isMeshStandardMaterial?null!==d.map?d.map.mapping===Ue&&(m=s.uvs,xe(c,u,l,h,f,p,m[i].x,m[i].y,m[o].x,m[o].y,m[a].x,m[a].y,d.map)):null!==d.envMap?d.envMap.mapping===Ve&&(de.copy(s.vertexNormalsModel[i]).applyMatrix3(fe),g=.5*de.x+.5,y=.5*de.y+.5,de.copy(s.vertexNormalsModel[o]).applyMatrix3(fe),b=.5*de.x+.5,x=.5*de.y+.5,de.copy(s.vertexNormalsModel[a]).applyMatrix3(fe),w=.5*de.x+.5,_=.5*de.y+.5,xe(c,u,l,h,f,p,g,y,b,x,w,_,d.envMap)):(q.copy(d.color),d.vertexColors===Z&&q.multiply(s.color),!0===d.wireframe?ge(q,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):ye(q)):d.isMeshNormalMaterial?(de.copy(s.normalModel).applyMatrix3(fe),q.setRGB(de.x,de.y,de.z).multiplyScalar(.5).addScalar(.5),!0===d.wireframe?ge(q,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):ye(q)):(q.setRGB(1,1,1),!0===d.wireframe?ge(q,d.wireframeLinewidth,d.wireframeLinecap,d.wireframeLinejoin):ye(q))}function ge(e,t,r,n){Me(t),Te(r),Ae(n),Ee(e.getStyle()),D.stroke(),ae.expandByScalar(2*t)}function ye(e){Ce(e.getStyle()),D.fill()}function be(e){if(0===e.version||e instanceof Po||e instanceof Vi)return{canvas:void 0,version:e.version};var t=e.image;if(!1===t.complete)return{canvas:void 0,version:0};var r=e.wrapS===He||e.wrapS===qe,n=e.wrapT===He||e.wrapT===qe,i=e.wrapS===qe,o=e.wrapT===qe,a=document.createElement("canvas");a.width=t.width*(i?2:1),a.height=t.height*(o?2:1);var s=a.getContext("2d");s.setTransform(1,0,0,-1,0,t.height),s.drawImage(t,0,0),!0===i&&(s.setTransform(-1,0,0,-1,t.width,t.height),s.drawImage(t,-t.width,0)),!0===o&&(s.setTransform(1,0,0,1,0,0),s.drawImage(t,0,t.height)),!0===i&&!0===o&&(s.setTransform(-1,0,0,1,t.width,0),s.drawImage(t,-t.width,t.height));var c="no-repeat";!0===r&&!0===n?c="repeat":!0===r?c="repeat-x":!0===n&&(c="repeat-y");var u=D.createPattern(a,c);return e.onUpdate&&e.onUpdate(e),{canvas:u,version:e.version}}function xe(e,t,r,n,i,o,a,s,c,u,l,h,d){var f=$[d.id];if(void 0!==f&&f.version===d.version||(f=be(d),$[d.id]=f),void 0===f.canvas)return Ce("rgba( 0, 0, 0, 1)"),void D.fill();Ce(f.canvas);var p,m,v,g,y,b,x,w,_=d.offset.x/d.repeat.x,S=d.offset.y/d.repeat.y,M=d.image.width*d.repeat.x,T=d.image.height*d.repeat.y;c=(c+_)*M,u=(u+S)*T,l=(l+_)*M,h=(h+S)*T,r-=e,n-=t,i-=e,o-=t,0!=(x=(c-=a=(a+_)*M)*(h-=s=(s+S)*T)-(l-=a)*(u-=s))&&(y=e-(p=(h*r-u*i)*(w=1/x))*a-(v=(c*i-l*r)*w)*s,b=t-(m=(h*n-u*o)*w)*a-(g=(c*o-l*n)*w)*s,D.save(),D.transform(p,m,v,g,y,b),D.fill(),D.restore())}function we(e,t,r){var n,i=t.x-e.x,o=t.y-e.y,a=i*i+o*o;0!==a&&(i*=n=r/Math.sqrt(a),o*=n,t.x+=i,t.y+=o,e.x-=i,e.y-=o)}function _e(e){k!==e&&(D.globalAlpha=e,k=e)}function Se(e){B!==e&&(e===ee?D.globalCompositeOperation="source-over":e===te?D.globalCompositeOperation="lighter":e===re?D.globalCompositeOperation="darker":e===ne&&(D.globalCompositeOperation="multiply"),B=e)}function Me(e){G!==e&&(D.lineWidth=e,G=e)}function Te(e){W!==e&&(D.lineCap=e,W=e)}function Ae(e){H!==e&&(D.lineJoin=e,H=e)}function Ee(e){j!==e&&(D.strokeStyle=e,j=e)}function Ce(e){V!==e&&(D.fillStyle=e,V=e)}function Le(e){X.length!==e.length&&(D.setLineDash(e),X=e)}void 0===D.setLineDash&&(D.setLineDash=function(){}),this.domElement=T,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.getContext=function(){return D},this.getContextAttributes=function(){return D.getContextAttributes()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(e){void 0!==e&&(I=e)},this.setSize=function(e,t,r){A=e*I,E=t*I,T.width=A,T.height=E,C=Math.floor(A/2),L=Math.floor(E/2),!1!==r&&(T.style.width=e+"px",T.style.height=t+"px"),ie.min.set(-C,-L),ie.max.set(C,L),oe.min.set(-C,-L),oe.max.set(C,L),k=1,B=0,j=null,V=null,G=null,W=null,H=null,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,n){P=e*I,O=t*I,N=r*I,R=n*I},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(e,t){F.set(e),U=void 0!==t?t:1,oe.min.set(-C,-L),oe.max.set(C,L)},this.setClearColorHex=function(e,t){console.warn("CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return F},this.getClearAlpha=function(){return U},this.getMaxAnisotropy=function(){return 0},this.clear=function(){!1===oe.isEmpty()&&(oe.intersect(ie),oe.expandByScalar(2),oe.min.x=oe.min.x+C,oe.min.y=-oe.min.y+L,oe.max.x=oe.max.x+C,oe.max.y=-oe.max.y+L,U<1&&D.clearRect(0|oe.min.x,0|oe.max.y,oe.max.x-oe.min.x|0,oe.min.y-oe.max.y|0),U>0&&(_e(1),Se(ee),Ce("rgba("+Math.floor(255*F.r)+","+Math.floor(255*F.g)+","+Math.floor(255*F.b)+","+U+")"),D.fillRect(0|oe.min.x,0|oe.max.y,oe.max.x-oe.min.x|0,oe.min.y-oe.max.y|0)),oe.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,s){if(void 0!==s.isCamera){var c=e.background;c&&c.isColor?(_e(1),Se(ee),Ce(c.getStyle()),D.fillRect(0,0,A,E)):!0===this.autoClear&&this.clear(),S.info.render.vertices=0,S.info.render.faces=0,D.setTransform(N/A,0,0,-R/E,P,E-O),D.translate(C,L),t=M.projectScene(e,s,this.sortObjects,this.sortElements),r=t.elements,n=t.lights,fe.getNormalMatrix(s.matrixWorldInverse),function(){se.setRGB(0,0,0),ce.setRGB(0,0,0),ue.setRGB(0,0,0);for(var e=0,t=n.length;e<t;e++){var r=n[e],i=r.color;r.isAmbientLight?se.add(i):r.isDirectionalLight?ce.add(i):r.isPointLight&&ue.add(i)}}();for(var u=0,l=r.length;u<l;u++){var h=r[u],d=h.material;if(void 0!==d&&0!==d.opacity){if(ae.makeEmpty(),h instanceof ch)(i=h).x*=C,i.y*=L,pe(i,h,d);else if(h instanceof sh)i=h.v1,o=h.v2,i.positionScreen.x*=C,i.positionScreen.y*=L,o.positionScreen.x*=C,o.positionScreen.y*=L,ae.setFromPoints([i.positionScreen,o.positionScreen]),!0===ie.intersectsBox(ae)&&me(i,o,h,d);else if(h instanceof oh){if(i=h.v1,o=h.v2,a=h.v3,i.positionScreen.z<-1||i.positionScreen.z>1)continue;if(o.positionScreen.z<-1||o.positionScreen.z>1)continue;if(a.positionScreen.z<-1||a.positionScreen.z>1)continue;i.positionScreen.x*=C,i.positionScreen.y*=L,o.positionScreen.x*=C,o.positionScreen.y*=L,a.positionScreen.x*=C,a.positionScreen.y*=L,d.overdraw>0&&(we(i.positionScreen,o.positionScreen,d.overdraw),we(o.positionScreen,a.positionScreen,d.overdraw),we(a.positionScreen,i.positionScreen,d.overdraw)),ae.setFromPoints([i.positionScreen,o.positionScreen,a.positionScreen]),!0===ie.intersectsBox(ae)&&ve(i,o,a,0,1,2,h,d)}oe.union(ae)}}D.setTransform(1,0,0,1,0,0)}else console.error("CanvasRenderer.render: camera is not an instance of Camera.")}},t.CSS2DObject=hh,t.CSS2DRenderer=function(){var e,t,r,n;console.log("CSS2DRenderer",z);var i=new s,o=new a,c=new a,u={objects:new WeakMap},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:e,height:t}},this.setSize=function(i,o){r=(e=i)/2,n=(t=o)/2,l.style.width=i+"px",l.style.height=o+"px"};var h=function(e,t){if(e instanceof hh){i.setFromMatrixPosition(e.matrixWorld),i.applyMatrix4(c);var o=e.element,a="translate(-50%,-50%) translate("+(i.x*r+r)+"px,"+(-i.y*n+n)+"px)";o.style.WebkitTransform=a,o.style.MozTransform=a,o.style.oTransform=a,o.style.transform=a;var s={distanceToCameraSquared:d(t,e)};u.objects.set(e,s),o.parentNode!==l&&l.appendChild(o)}for(var f=0,p=e.children.length;f<p;f++)h(e.children[f],t)},d=function(){var e=new s,t=new s;return function(r,n){return e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(n.matrixWorld),e.distanceToSquared(t)}}(),f=function(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof hh&&t.push(e)}),t}(e).sort(function(e,t){return u.objects.get(e).distanceToCameraSquared-u.objects.get(t).distanceToCameraSquared}),r=t.length,n=0,i=t.length;n<i;n++)t[n].element.style.zIndex=r-n};this.render=function(e,t){e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),o.copy(t.matrixWorldInverse),c.multiplyMatrices(t.projectionMatrix,o),h(e,t),f(e)}},t.CSS3DObject=dh,t.CSS3DSprite=fh,t.CSS3DRenderer=function(){var e,t,r,n;console.log("CSS3DRenderer",z);var i=new a,o={camera:{fov:0,style:""},objects:new WeakMap},c=document.createElement("div");c.style.overflow="hidden",this.domElement=c;var u=document.createElement("div");u.style.WebkitTransformStyle="preserve-3d",u.style.transformStyle="preserve-3d",c.appendChild(u);var l=/Trident/i.test(navigator.userAgent);function h(e){return Math.abs(e)<1e-10?0:e}function d(e){var t=e.elements;return"matrix3d("+h(t[0])+","+h(-t[1])+","+h(t[2])+","+h(t[3])+","+h(t[4])+","+h(-t[5])+","+h(t[6])+","+h(t[7])+","+h(t[8])+","+h(-t[9])+","+h(t[10])+","+h(t[11])+","+h(t[12])+","+h(-t[13])+","+h(t[14])+","+h(t[15])+")"}function f(e,t){var i=e.elements,o="matrix3d("+h(i[0])+","+h(i[1])+","+h(i[2])+","+h(i[3])+","+h(-i[4])+","+h(-i[5])+","+h(-i[6])+","+h(-i[7])+","+h(i[8])+","+h(i[9])+","+h(i[10])+","+h(i[11])+","+h(i[12])+","+h(i[13])+","+h(i[14])+","+h(i[15])+")";return l?"translate(-50%,-50%)translate("+r+"px,"+n+"px)"+t+o:"translate(-50%,-50%)"+o}this.getSize=function(){return{width:e,height:t}},this.setSize=function(i,o){r=(e=i)/2,n=(t=o)/2,c.style.width=i+"px",c.style.height=o+"px",u.style.width=i+"px",u.style.height=o+"px"};var p=function(){var e=new s,t=new s;return function(r,n){return e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(n.matrixWorld),e.distanceToSquared(t)}}();function m(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof dh&&t.push(e)}),t}(e).sort(function(e,t){return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared}),r=t.length,n=0,i=t.length;n<i;n++)t[n].element.style.zIndex=r-n}this.render=function(e,t){var a=t.projectionMatrix.elements[5]*n;o.camera.fov!==a&&(t.isPerspectiveCamera&&(c.style.WebkitPerspective=a+"px",c.style.perspective=a+"px"),o.camera.fov=a),e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld();var s=t.isOrthographicCamera?"scale("+a+")"+d(t.matrixWorldInverse):"translateZ("+a+"px)"+d(t.matrixWorldInverse),h=s+"translate("+r+"px,"+n+"px)";o.camera.style===h||l||(u.style.WebkitTransform=h,u.style.transform=h,o.camera.style=h),function e(t,r,n){if(t instanceof dh){var a;t instanceof fh?(i.copy(r.matrixWorldInverse),i.transpose(),i.copyPosition(t.matrixWorld),i.scale(t.scale),i.elements[3]=0,i.elements[7]=0,i.elements[11]=0,i.elements[15]=1,a=f(i,n)):a=f(t.matrixWorld,n);var s=t.element,c=o.objects.get(t);if(void 0===c||c!==a){s.style.WebkitTransform=a,s.style.transform=a;var h={style:a};l&&(h.distanceToCameraSquared=p(r,t)),o.objects.set(t,h)}s.parentNode!==u&&u.appendChild(s)}for(var d=0,m=t.children.length;d<m;d++)e(t.children[d],r,n)}(e,t,s),l&&m(e)}},t.RenderableObject=ih,t.RenderableFace=oh,t.RenderableVertex=ah,t.RenderableLine=sh,t.RenderableSprite=ch,t.Projector=uh,t.RaytracingRenderer=ph,t.SoftwareRenderer=mh,t.SVGObject=vh,t.SVGRenderer=function(){console.log("SVGRenderer",z);var e,t,r,n,i,o,c,u,l,h,f,p,m,g=this,y=new uh,b=document.createElementNS("http://www.w3.org/2000/svg","svg"),x=new Qu,w=new Qu,_=new v,S=new v,M=new v,T=new v,A=new v,E=new v,C=1,L=new s,P=new s,O=new s,N=new d,R=new a,I=new a,D=[],F=0,U=1,k=null;function B(){for(F=0;b.childNodes.length>0;)b.removeChild(b.childNodes[0])}function j(e,t){var r=Math.floor(255*e.r)+","+Math.floor(255*e.g)+","+Math.floor(255*e.b);return void 0===t||1===t?"rgb("+r+")":"rgb("+r+"); fill-opacity: "+t}function V(e){return null!==k?e.toFixed(k):e}function G(e,t,r){var n=t.scale.x*o,i=t.scale.y*c;r.isPointsMaterial&&(n*=r.size,i*=r.size);var a="M"+V(e.x-.5*n)+","+V(e.y-.5*i)+"h"+V(n)+"v"+V(i)+"h"+V(-n)+"z",s="";(r.isSpriteMaterial||r.isPointsMaterial)&&(s="fill:"+j(r.color,r.opacity)),X(s,a)}function W(e,t,r,n){var i="M"+V(e.positionScreen.x)+","+V(e.positionScreen.y)+"L"+V(t.positionScreen.x)+","+V(t.positionScreen.y);if(n.isLineBasicMaterial){var o="fill:none;stroke:"+j(n.color,n.opacity)+";stroke-width:"+n.linewidth+";stroke-linecap:"+n.linecap;n.isLineDashedMaterial&&(o=o+";stroke-dasharray:"+n.dashSize+","+n.gapSize),X(o,i)}}function H(e,t,n,i,o){g.info.render.vertices+=3,g.info.render.faces++;var a="M"+V(e.positionScreen.x)+","+V(e.positionScreen.y)+"L"+V(t.positionScreen.x)+","+V(t.positionScreen.y)+"L"+V(n.positionScreen.x)+","+V(n.positionScreen.y)+"z";o.isMeshBasicMaterial?(_.copy(o.color),o.vertexColors===Z&&_.multiply(i.color)):o.isMeshLambertMaterial||o.isMeshPhongMaterial||o.isMeshStandardMaterial?(S.copy(o.color),o.vertexColors===Z&&S.multiply(i.color),_.copy(M),P.copy(e.positionWorld).add(t.positionWorld).add(n.positionWorld).divideScalar(3),function(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.color;if(a.isDirectionalLight){var c=L.setFromMatrixPosition(a.matrixWorld).normalize();if((u=r.dot(c))<=0)continue;u*=a.intensity,n.r+=s.r*u,n.g+=s.g*u,n.b+=s.b*u}else if(a.isPointLight){var u;if(c=L.setFromMatrixPosition(a.matrixWorld),(u=r.dot(L.subVectors(c,t).normalize()))<=0)continue;if(0==(u*=0==a.distance?1:1-Math.min(t.distanceTo(c)/a.distance,1)))continue;u*=a.intensity,n.r+=s.r*u,n.g+=s.g*u,n.b+=s.b*u}}}(r,P,i.normalModel,_),_.multiply(S).add(o.emissive)):o.isMeshNormalMaterial&&(O.copy(i.normalModel).applyMatrix3(N),_.setRGB(O.x,O.y,O.z).multiplyScalar(.5).addScalar(.5)),X(o.wireframe?"fill:none;stroke:"+j(_,o.opacity)+";stroke-width:"+o.wireframeLinewidth+";stroke-linecap:"+o.wireframeLinecap+";stroke-linejoin:"+o.wireframeLinejoin:"fill:"+j(_,o.opacity),a)}function X(e,t){m===e?p+=t:(q(),m=e,p=t)}function q(){p&&((f=function(e){return null==D[e]?(D[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==U&&D[e].setAttribute("shape-rendering","crispEdges"),D[e]):D[e]}(F++)).setAttribute("d",p),f.setAttribute("style",m),b.appendChild(f)),p="",m=""}this.domElement=b,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":U=1;break;case"low":U=0}},this.setClearColor=function(e,t){E.set(e),C=void 0!==t?t:1},this.setPixelRatio=function(){},this.setSize=function(e,t){o=(n=e)/2,c=(i=t)/2,b.setAttribute("viewBox",-o+" "+-c+" "+n+" "+i),b.setAttribute("width",n),b.setAttribute("height",i),x.min.set(-o,-c),x.max.set(o,c)},this.setPrecision=function(e){k=e},this.clear=function(){B(),b.style.backgroundColor=j(E,C)},this.render=function(n,i){if(i instanceof Gr!=0){var a=n.background;a&&a.isColor?(B(),b.style.backgroundColor=j(a)):!0===this.autoClear&&this.clear(),g.info.render.vertices=0,g.info.render.faces=0,R.copy(i.matrixWorldInverse),I.multiplyMatrices(i.projectionMatrix,R),e=y.projectScene(n,i,this.sortObjects,this.sortElements),t=e.elements,r=e.lights,N.getNormalMatrix(i.matrixWorldInverse),function(e){M.setRGB(0,0,0),T.setRGB(0,0,0),A.setRGB(0,0,0);for(var t=0,r=e.length;t<r;t++){var n=e[t],i=n.color;n.isAmbientLight?(M.r+=i.r,M.g+=i.g,M.b+=i.b):n.isDirectionalLight?(T.r+=i.r,T.g+=i.g,T.b+=i.b):n.isPointLight&&(A.r+=i.r,A.g+=i.g,A.b+=i.b)}}(r),p="",m="";for(var s=0,d=t.length;s<d;s++){var f=t[s],v=f.material;if(void 0!==v&&0!==v.opacity)if(w.makeEmpty(),f instanceof ch)(u=f).x*=o,u.y*=-c,G(u,f,v);else if(f instanceof sh)u=f.v1,l=f.v2,u.positionScreen.x*=o,u.positionScreen.y*=-c,l.positionScreen.x*=o,l.positionScreen.y*=-c,w.setFromPoints([u.positionScreen,l.positionScreen]),!0===x.intersectsBox(w)&&W(u,l,0,v);else if(f instanceof oh){if(u=f.v1,l=f.v2,h=f.v3,u.positionScreen.z<-1||u.positionScreen.z>1)continue;if(l.positionScreen.z<-1||l.positionScreen.z>1)continue;if(h.positionScreen.z<-1||h.positionScreen.z>1)continue;u.positionScreen.x*=o,u.positionScreen.y*=-c,l.positionScreen.x*=o,l.positionScreen.y*=-c,h.positionScreen.x*=o,h.positionScreen.y*=-c,w.setFromPoints([u.positionScreen,l.positionScreen,h.positionScreen]),!0===x.intersectsBox(w)&&H(u,l,h,f,v)}}q(),n.traverseVisible(function(e){if(e instanceof vh){L.setFromMatrixPosition(e.matrixWorld),L.applyMatrix4(I);var t=L.x*o,r=-L.y*c,n=e.node;n.setAttribute("transform","translate("+t+","+r+")"),b.appendChild(n)}})}else console.error("SVGRenderer.render: camera is not an instance of Camera.")}},t.WebGLDeferredRenderer=function(e){e=e||{};var t,r,n,i,o,a,c,u,l,h,d,f,p,m,v,g,y,b,x,w,_,S=this,M=!1,T=!1,A=!1,E=!1,C=new Xr({visible:!1}),L=new s,P={},O={},N={},R={},I={},D={},F={},U={},k={},z=60,j={},V={},G={};function W(e){var t=P[e.uuid],r=O[e.uuid];if(void 0===t&&((n=new qr).userData.lights={},(t=Le()).scene=n,P[e.uuid]=t),void 0===r){var n;(n=new qr).userData.lights={};var o=function(){var e=Jd.emissiveLight,t=new Xr({uniforms:Object.assign({},e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,blending:$,depthWrite:!1}),r=new dr(new en(2,2),t);return r.onBeforeRender=function(e,t,r,n,o,a){o.uniforms.samplerColor.value=i.renderTarget2.texture},r}();n.userData.emissiveLight=o,n.add(o),(r=Le()).scene=n,O[e.uuid]=r}t.used=!0,r.used=!0;var a=t.scene,s=r.scene;s.userData.emissiveLight.visible=!A,w=a,_=s}function H(e,t,r,n){var i=t[e.uuid];return void 0===i&&((i=Le()).material=r(e),t[e.uuid]=i),i.used=!0,n(i.material,e),j[i.material.uuid]=e,i.material}function X(e,t,r){if(void 0!==e.material){if(Array.isArray(e.material))for(var n=0,i=e.material.length;n<i;n++)e.material[n]=t(e.material[n]);else e.material=t(e.material);e.onBeforeRender=r}}function q(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t]=j[e.material[t].uuid];else e.material=j[e.material.uuid]}function J(e){X(e,Q,ee)}function Q(e){return H(e,A?R:N,Z,K)}function Z(e){var t=A?Jd.normalDepthShininess:Jd.normalDepth;return new Xr({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:$})}function K(e,t){void 0!==t.skinning&&(e.skinning=t.skinning),void 0!==t.morphTargets&&(e.morphTargets=t.morphTargets),!0===t.visible?e.visible=!t.transparent:e.visible=!1}function ee(e,t,r,n,i,o){if(A){var a=j[i.uuid];void 0!==a&&void 0!==a.shininess&&(i.uniforms.shininess.value=a.shininess)}}function re(e){X(e,ne,ae)}function ne(e){return H(e,I,ie,oe)}function ie(e){var t=Jd.color,r=new Xr({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:$});return void 0!==e.map&&(r.map=e.map),r}function oe(e,t){void 0!==t.map&&(e.map=t.map),void 0!==t.skinning&&(e.skinning=t.skinning),void 0!==t.morphTargets&&(e.morphTargets=t.morphTargets),!0===t.visible?e.visible=!t.transparent:e.visible=!1}function ae(e,t,r,n,i,o){var a,s,c=j[i.uuid],u=i.uniforms;!0===c.isMeshBasicMaterial?s=c.color:(a=c.color,s=c.emissive);var l=c.specular,h=c.shininess,d=c.map;void 0!==a&&u.diffuse.value.copy(a),void 0!==s&&u.emissive.value.copy(s),void 0!==l&&u.specular.value.copy(l),void 0!==h&&void 0!==u.shininess&&(u.shininess.value=h),void 0!==d&&(u.map.value=d)}function se(e){X(e,ce,he)}function ce(e){return!0===e.transparent?(j[e.uuid]=e,e):H(e,D,ue,le)}function ue(e){var t=Jd.reconstruction,r=new Xr({uniforms:Object.assign({},t.uniforms),fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,blending:$});return void 0!==e.map&&(r.map=e.map),r}function le(e,t){oe(e,t)}function he(e,t,r,n,i,o){if(!0!==i.transparent)ae(0,0,0,0,i),i.uniforms.samplerLight.value=d.renderTarget2.texture;else{var a=V[this.uuid];a&&a.call(this,e,t,r,n,i,o)}}function de(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)void 0===G[e.material[t].uuid]&&(G[e.material[t].uuid]=e.material[t].visible,e.material[t].visible=e.material[t].transparent&&e.material[t].visible);else void 0===G[e.material.uuid]&&(G[e.material.uuid]=e.material.visible,e.material.visible=e.material.transparent&&e.material.visible)}function fe(e){if(void 0!==e.material)if(Array.isArray(e.material))for(var t=0,r=e.material.length;t<r;t++)e.material[t].visible=G[e.material[t].uuid];else e.material.visible=G[e.material.uuid]}function pe(e){return e.isPointLight?function(e){var t=ye(e,new B(1,16,8));return t.onBeforeRender=we,t}(e):e.isSpotLight?function(e){var t=ye(e,new en(2,2));return t.onBeforeRender=_e,t}(e):e.isDirectionalLight?function(e){var t=ye(e,new en(2,2));return t.onBeforeRender=Se,t}(e):null}function me(e){return e.isPointLight?function(){var e=be(A?Jd.pointLightPre:Jd.pointLight);return e.side=Y,e.depthFunc=Ae,e}():e.isSpotLight?function(){var e=be(A?Jd.spotLightPre:Jd.spotLight);return e.depthTest=!1,e}():e.isDirectionalLight?function(){var e=be(A?Jd.directionalLightPre:Jd.directionalLight);return e.depthTest=!1,e}():null}function ve(e){var t=A?k:U,r=t[e.uuid];return void 0===r&&((r=Le()).material=me(e.userData.originalLight),t[e.uuid]=r),r.used=!0,r.material}function ge(e){e.userData.originalLight.isPointLight&&function(e){var t=e.userData.originalLight,r=t.distance;r>0&&(e.scale.set(1,1,1).multiplyScalar(r),e.position.setFromMatrixPosition(t.matrixWorld))}(e)}function ye(e,t){var r=new dr(t,C);return r.userData.originalLight=e,r}function be(e){var t=new Xr({uniforms:Object.assign({},e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,transparent:!0,blending:te,depthWrite:!1});return A&&(t.premultipliedAlpha=!0),t}function xe(e){A?e.samplerNormalDepthShininess.value=h.renderTarget2.texture:(e.samplerNormalDepth.value=h.renderTarget2.texture,e.samplerColor.value=i.renderTarget2.texture)}function we(e,t,r,n,i,o){var a=this.userData.originalLight,s=a.distance,c=i.uniforms;c.lightColor.value.copy(a.color),s>0?(c.lightRadius.value=s,c.lightIntensity.value=a.intensity,c.lightPositionVS.value.setFromMatrixPosition(a.matrixWorld).applyMatrix4(x.matrixWorldInverse)):c.lightRadius.value=1/0,xe(c)}function _e(e,t,r,n,i,o){var a=this.userData.originalLight,s=this.material.uniforms;s.lightAngle.value=a.angle,s.lightColor.value.copy(a.color),s.lightIntensity.value=a.intensity,s.lightPositionVS.value.setFromMatrixPosition(a.matrixWorld).applyMatrix4(x.matrixWorldInverse);var c=s.lightDirectionVS.value,u=L;c.setFromMatrixPosition(a.matrixWorld),u.setFromMatrixPosition(a.target.matrixWorld),c.sub(u).normalize().transformDirection(x.matrixWorldInverse),xe(s)}function Se(e,t,r,n,i,o){var a=this.userData.originalLight,s=this.material.uniforms;s.lightColor.value.copy(a.color),s.lightIntensity.value=a.intensity;var c=s.lightDirectionVS.value,u=L;c.setFromMatrixPosition(a.matrixWorld),u.setFromMatrixPosition(a.target.matrixWorld),c.sub(u).normalize().transformDirection(x.matrixWorldInverse),xe(s)}function Me(e){if(void 0!==e.material&&(V[e.uuid]=e.onBeforeRender,!T&&!A&&e.visible))if(Array.isArray(e.material)){for(var t=0,r=e.material.length;t<r;t++)if(!0===e.material[t].visible&&!0===e.material[t].transparent){T=!0;break}}else!0===e.material.visible&&!0===e.material.transparent&&(T=!0)}function Te(e){void 0!==e.material&&(e.onBeforeRender=V[e.uuid])}function Ee(e){if(!0===e.isLight){var t=F[e.uuid];void 0===t&&((t=Le()).light=pe(e),F[e.uuid]=t),t.used=!0;var r=t.light;if(null!==r){var n=!0===e.isPointLight?w:_,i=n.userData.lights;void 0===i[r.uuid]&&(n.add(r),i[r.uuid]={light:r,found:!0}),i[r.uuid].found=!0}}}function Ce(e){for(var t=e.userData.lights,r=Object.keys(t),n=0,i=r.length;n<i;n++){var o=r[n];if(!1===t[o].found)e.remove(t[o].light),delete t[o];else{var a=t[o].light;a.material=ve(a),ge(a),t[o].found=!1}}}function Le(){return{used:!0,keepAlive:E,count:0}}function Pe(e){for(var t=Object.keys(e),r=0,n=t.length;r<n;r++){var i=t[r];!1===e[i].used?(e[i].count++,!1===e[i].keepAlive&&e[i].count>z&&delete e[i]):(e[i].used=!1,e[i].count=0)}}function Oe(e){for(var t=Object.keys(e),r=0,n=t.length;r<n;r++)e[t[r]]=void 0}function Ne(e,t){!A&&T&&(e.traverse(de),e.traverse(Te),a.scene=e,a.camera=t),A?(a.renderToScreen=!1,a.enabled=!1,c.renderToScreen=!1,c.enabled=!1,M?(g.renderToScreen=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!0,y.renderToScreen=!1,y.enabled=!1)):T?M?(g.renderToScreen=!1,a.renderToScreen=!1,a.enabled=!0,c.renderToScreen=!1,c.enabled=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!1,a.renderToScreen=!1,a.enabled=!0,c.renderToScreen=!0,c.enabled=!0,y.renderToScreen=!1,y.enabled=!1):M?(g.renderToScreen=!1,a.renderToScreen=!1,a.enabled=!1,c.renderToScreen=!1,c.enabled=!1,y.renderToScreen=!0,y.enabled=!0):(g.renderToScreen=!0,a.renderToScreen=!1,a.enabled=!1,c.renderToScreen=!1,c.enabled=!1,y.renderToScreen=!1,y.enabled=!1),S.renderer.autoClearDepth=!1,S.renderer.autoClearStencil=!1,f.render(),!A&&T&&e.traverse(fe)}this.renderer=void 0,this.domElement=void 0,this.forwardRendering=!1,this.setSize=function(e,t){r=e,n=t,this.renderer.setSize(r,n),h.setSize(r,n),i.setSize(r,n),d.setSize(r,n),u.setSize(r,n),f.setSize(r,n),b.image.width=r,b.image.height=n,b.needsUpdate=!0,y.uniforms.resolution.value.set(1/r,1/n)},this.setAntialias=function(e){M=e},this.enableLightPrePass=function(e){A=e,g.uniforms.samplerResult.value=A?u.renderTarget2.texture:d.renderTarget2.texture},this.render=function(e,a){if(this.forwardRendering)this.renderer.render(e,a);else{var s=e.autoUpdate,c=this.renderer.autoClearColor,f=this.renderer.autoClearDepth,g=this.renderer.autoClearStencil;x=a,W(e),e.autoUpdate=!1,e.updateMatrixWorld(),T=!1,e.traverse(Me),function(e){var t=Yd.commonUniforms;t.viewWidth.value=r,t.viewHeight.value=n,t.matProjInverse.value.getInverse(e.projectionMatrix)}(a),function(e,r){e.traverse(J),p.scene=e,p.camera=r,S.renderer.autoClearDepth=!0,S.renderer.autoClearStencil=!0,t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,4294967295),t.stencilOp(t.REPLACE,t.REPLACE,t.REPLACE),h.render(),e.traverse(q)}(e,a),A?(function(e,r){e.traverse(Ee),Ce(w),Ce(_),m.scene=w,m.camera=r,v.scene=_,S.renderer.autoClearDepth=!1,S.renderer.autoClearStencil=!1,t.stencilFunc(t.EQUAL,1,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),d.render()}(e,a),function(e,r){e.traverse(se),l.scene=e,l.camera=r,S.renderer.autoClearDepth=!1,S.renderer.autoClearStencil=!1,u.render(),t.disable(t.STENCIL_TEST),e.traverse(q)}(e,a)):(function(e,r){e.traverse(re),o.scene=e,o.camera=r,S.renderer.autoClearDepth=!1,S.renderer.autoClearStencil=!1,t.stencilFunc(t.EQUAL,1,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),i.render(),e.traverse(q)}(e,a),function(e,r){e.traverse(Ee),Ce(w),Ce(_),m.scene=w,m.camera=r,v.scene=_,S.renderer.autoClearDepth=!1,S.renderer.autoClearStencil=!1,d.render(),t.disable(t.STENCIL_TEST)}(e,a)),Ne(e,a),e.traverse(Te),Pe(P),Pe(O),Pe(N),Pe(R),Pe(I),Pe(D),Pe(U),Pe(k),Pe(F),Oe(j),Oe(V),Oe(G),e.autoUpdate=s,this.renderer.autoClearColor=c,this.renderer.autoClearDepth=f,this.renderer.autoClearStencil=g}},function(e){S.renderer=void 0!==e.renderer?e.renderer:new Wd,S.domElement=S.renderer.domElement,t=S.renderer.context,r=void 0!==e.width?e.width:S.renderer.getSize().width,n=void 0!==e.height?e.height:S.renderer.getSize().height;var s=void 0!==e.antialias&&e.antialias;void 0!==e.cacheKeepAlive&&(E=e.cacheKeepAlive),b=new jl(r,n,ht,void 0,void 0,void 0,void 0,void 0,void 0,bt),function(){(p=new zl).clear=!0;var e=new Kr(r,n,{minFilter:Ye,magFilter:Ye,format:pt,type:at,stencilBuffer:!0,depthTexture:b});e.texture.generateMipamps=!1,(h=new Nl(S.renderer,e)).addPass(p)}(),function(){(o=new zl).clear=!0;var e=new Kr(r,n,{minFilter:Ye,magFilter:Ye,format:pt,type:at,depthTexture:b});e.texture.generateMipamps=!1,(i=new Nl(S.renderer,e)).addPass(o)}(),function(){(v=new zl).clear=!0,v.camera=new Yr(-1,1,1,-1,0,1),(m=new zl).clear=!1;var e=new Kr(r,n,{minFilter:Ye,magFilter:Ye,format:pt,type:at,depthTexture:b});e.texture.generateMipamps=!1,(d=new Nl(S.renderer,e)).addPass(v),d.addPass(m)}(),function(){(l=new zl).clear=!0;var e=new Kr(r,n,{minFilter:Ye,magFilter:Ye,format:pt,type:at,depthTexture:b});e.texture.generateMipamps=!1,(u=new Nl(S.renderer,e)).addPass(l)}(),function(){(g=new zu(Jd.final)).clear=!0,g.uniforms.samplerResult.value=d.renderTarget2.texture,g.material.blending=$,g.material.depthWrite=!1,g.material.depthTest=!1,(a=new zl).clear=!1,c=new zu(gl),y=new zu(Xd);var e=new Kr(r,n,{minFilter:Ye,magFilter:Ze,format:ft,type:et,depthTexture:b});e.texture.generateMipamps=!1,(f=new Nl(S.renderer,e)).addPass(g),f.addPass(a),f.addPass(c),f.addPass(y)}(),S.setSize(r,n),S.setAntialias(s),S.enableLightPrePass(!1)}(e)},t.RollerCoasterGeometry=Qd,t.RollerCoasterLiftersGeometry=Zd,t.RollerCoasterShadowGeometry=Kd,t.SkyGeometry=$d,t.TreesGeometry=ef,t.ShaderGodRays=tf,t.AfterimageShader=wl,t.BasicShader=rf,t.BleachBypassShader=nf,t.BlendShader=of,t.BokehShader=tn,t.BokehShader2=rn,t.BokehDepthShader=nn,t.BrightnessContrastShader=af,t.ColorCorrectionShader=sf,t.ColorifyShader=cf,t.ConvolutionShader=Sl,t.CopyShader=gl,t.DepthLimitedBlurShader=Gl,t.BlurShaderUtils=Wl,t.DigitalGlitch=Dl,t.DOFMipMapShader=uf,t.DotScreenShader=Cl,t.FilmShader=Rl,t.FocusShader=lf,t.FreiChenShader=hf,t.FresnelShader=df,t.FXAAShader=Xd,t.GammaCorrectionShader=ff,t.HalftoneShader=Ul,t.HorizontalBlurShader=pf,t.HorizontalTiltShiftShader=mf,t.HueSaturationShader=vf,t.KaleidoShader=gf,t.LuminosityHighPassShader=th,t.LuminosityShader=yl,t.MirrorShader=yf,t.NormalMapShader=bf,t.ParallaxShader=xf,t.PixelShader=wf,t.RGBShiftShader=_f,t.SAOShader=Vl,t.SepiaShader=Sf,t.SMAAShader=Yl,t.SobelOperatorShader=Mf,t.SSAOShader=Zl,t.TechnicolorShader=Tf,t.ToneMapShader=bl,t.TriangleBlurShader=Af,t.UnpackDepthRGBAShader=Hl,t.VerticalBlurShader=Ef,t.VerticalTiltShiftShader=Cf,t.VignetteShader=Lf,t.WaterRefractionShader=Pf,t.ShaderSkin=Of,t.ShaderTerrain=Nf,t.ShaderToon=Rf,t.TranslucentShader=function(){this.uniforms=Hr.merge([Ci.common,Ci.lights,{color:{value:new v(16777215)},diffuse:{value:new v(16777215)},specular:{value:new v(16777215)},emissive:{value:new v(0)},opacity:{value:1},shininess:{value:1},thicknessMap:{value:null},thicknessColor:{value:new v(16777215)},thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}}]),this.fragmentShader=["#define USE_MAP","#define PHONG","#define TRANSLUCENT","#include <common>","#include <bsdfs>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <lights_phong_pars_fragment>","varying vec3 vColor;","uniform vec3 diffuse;","uniform vec3 specular;","uniform vec3 emissive;","uniform float opacity;","uniform float shininess;","uniform sampler2D thicknessMap;","uniform float thicknessPower;","uniform float thicknessScale;","uniform float thicknessDistortion;","uniform float thicknessAmbient;","uniform float thicknessAttenuation;","uniform vec3 thicknessColor;",Ei.lights_pars_begin,"void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {","\tvec3 thickness = thicknessColor * texture2D(thicknessMap, uv).r;","\tvec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));","\tfloat scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;","\tvec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;","\treflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;","}","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 viewerDirection = normalize( vViewPosition );","\tvec4 diffuseColor = vec4( diffuse, opacity );","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",Ei.map_fragment,Ei.color_fragment,Ei.specularmap_fragment,"\tvec3 totalEmissiveRadiance = emissive;",Ei.lights_phong_fragment,"\tGeometricContext geometry;","\tgeometry.position = - vViewPosition;","\tgeometry.normal = normal;","\tgeometry.viewDir = normalize( vViewPosition );","\tIncidentLight directLight;","\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )","\t\tPointLight pointLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","\t\t \tpointLight = pointLights[ i ];","\t\t \tgetPointDirectLightIrradiance( pointLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_MAP )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t\t#endif","\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )","\t\tDirectionalLight directionalLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {","\t\t\tdirectionalLight = directionalLights[ i ];","\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_MAP )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t#endif","\t#if defined( RE_IndirectDiffuse )","\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );","\t\t#if ( NUM_HEMI_LIGHTS > 0 )","\t\t\t#pragma unroll_loop","\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );","\t\t\t}","\t\t#endif","\t#endif","\t#if defined( RE_IndirectSpecular )","\t\tvec3 radiance = vec3( 0.0 );","\t\tvec3 clearCoatRadiance = vec3( 0.0 );","\t#endif",Ei.lights_fragment_end,"\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );",Ei.encodings_fragment,"}"].join("\n"),this.vertexShader=["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Ei.common,"void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvViewPosition = -mvPosition.xyz;","\tvNormal = normalize( normalMatrix * normal );","\tvUv = uv;","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n")},t.SimplexNoise=If,t.TimelinerController=Df,t.TypedArrayUtils=Ff,t.UCSCharacter=function(){var e,t=this;this.scale=1,this.root=new p,this.numSkins=void 0,this.numMorphs=void 0,this.skins=[],this.materials=[],this.morphs=[],this.mixer=new Ir(this.root),this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(r){this.numSkins=r.skins.length,this.numMorphs=r.morphs.length,this.loadCounter=1+r.skins.length,this.skins=function(e,r){for(var n=new An,i=[],o=0;o<r.length;o++)i[o]=n.load(e+r[o],t.checkLoadComplete),i[o].mapping=Ue,i[o].name=r[o];return i}(r.baseUrl+"skins/",r.skins),this.materials=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=new pn({color:15658734,specular:10,map:e[r],skinning:!0,morphTargets:!0});return t}(this.skins),this.morphs=r.morphs;var n=new Ln;console.log(r.baseUrl+r.character),n.load(r.baseUrl+r.character,function(n){n.computeBoundingBox(),n.computeVertexNormals(),(e=new lo(n,[])).name=r.character,t.root.add(e);var i=n.boundingBox;t.root.scale.set(r.s,r.s,r.s),t.root.position.set(r.x,r.y-i.min.y*r.s,r.z),e.castShadow=!0,e.receiveShadow=!0,t.mixer.clipAction(n.animations[0],e).play(),t.setSkin(0),t.checkLoadComplete()})},this.setSkin=function(r){e&&t.materials&&(e.material=t.materials[r])},this.updateMorphs=function(r){if(e)for(var n=0;n<t.numMorphs;n++)e.morphTargetInfluences[n]=r[t.morphs[n]]/100},this.checkLoadComplete=function(){t.loadCounter-=1,0===t.loadCounter&&t.onLoadComplete()}},t.BufferGeometryUtils=Vo,t.GeometryUtils=Uf,t.MathUtils=kf,t.SceneUtils=Bf,t.ShadowMapViewer=zf,t.SkeletonUtils=Vf,t.UVsDebug=function(e,t){var r="abc",n=new x,i=new x,o=[new x,new x,new x],a=[],s=document.createElement("canvas"),c=t||1024,u=t||1024;s.width=c,s.height=u;var l=s.getContext("2d");if(l.lineWidth=2,l.strokeStyle="rgba( 0, 0, 0, 1.0 )",l.textAlign="center",l.fillStyle="rgba( 255, 255, 255, 1.0 )",l.fillRect(0,0,c,u),e.isGeometry)for(var h=e.faces,d=e.faceVertexUvs[0],f=0,p=d.length;f<p;f++){a=h[f];var m=d[f];a[0]=a.a,a[1]=a.b,a[2]=a.c,o[0].copy(m[0]),o[1].copy(m[1]),o[2].copy(m[2]),y(a,o,f)}else{var v=e.index,g=e.attributes.uv;if(v)for(f=0,p=v.count;f<p;f+=3)a[0]=v.getX(f),a[1]=v.getX(f+1),a[2]=v.getX(f+2),o[0].fromBufferAttribute(g,a[0]),o[1].fromBufferAttribute(g,a[1]),o[2].fromBufferAttribute(g,a[2]),y(a,o,f);else for(f=0,p=g.count;f<p;f+=3)a[0]=f,a[1]=f+1,a[2]=f+2,o[0].fromBufferAttribute(g,a[0]),o[1].fromBufferAttribute(g,a[1]),o[2].fromBufferAttribute(g,a[2]),y(a,o,f)}return s;function y(e,t,o){l.beginPath(),n.set(0,0);for(var a=0,s=t.length;a<s;a++){var h=t[a];n.x+=h.x,n.y+=h.y,0===a?l.moveTo(h.x*c,(1-h.y)*u):l.lineTo(h.x*c,(1-h.y)*u)}for(l.closePath(),l.stroke(),n.divideScalar(t.length),l.font="12pt Arial bold",l.fillStyle="rgba( 0, 0, 0, 1.0 )",l.fillText(o,n.x*c,(1-n.y)*u),n.x>.95&&l.fillText(o,n.x%1*c,(1-n.y)*u),l.font="8pt Arial bold",l.fillStyle="rgba( 0, 0, 0, 1.0 )",a=0,s=t.length;a<s;a++){h=t[a],i.addVectors(n,h).divideScalar(2);var d=e[a];l.fillText(r[a]+d,i.x*c,(1-i.y)*u),i.x>.95&&l.fillText(r[a]+d,i.x%1*c,(1-i.y)*u)}}},t.VolumeSlice=Gf,t.DaydreamController=Wf,t.GearVRController=Hf,t.PaintViveController=ep,t.ViveController=Xf,t.WebVR=rp,t.AnimationAction=mr,t.AnimationClip=Nr,t.AnimationMixer=Ir,t.AnimationObjectGroup=np,t.AnimationUtils=wr,t.KeyframeTrack=Mr,t.PropertyBinding=br,t.PropertyMixer=xr,t.BooleanKeyframeTrack=Tr,t.ColorKeyframeTrack=Ar,t.NumberKeyframeTrack=Er,t.QuaternionKeyframeTrack=Lr,t.StringKeyframeTrack=Pr,t.VectorKeyframeTrack=Or,t.Audio=ip,t.AudioAnalyser=op,t.AudioContext=ap,t.AudioListener=sp,t.PositionalAudio=cp,t.ArrayCamera=jd,t.Camera=Gr,t.CubeCamera=up,t.OrthographicCamera=Yr,t.PerspectiveCamera=Wr,t.StereoCamera=Ai,t.REVISION=z,t.MOUSE=j,t.CullFaceNone=V,t.CullFaceBack=G,t.CullFaceFront=W,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=H,t.PCFSoftShadowMap=X,t.FrontSide=q,t.BackSide=Y,t.DoubleSide=J,t.FlatShading=1,t.SmoothShading=2,t.NoColors=Q,t.FaceColors=Z,t.VertexColors=K,t.NoBlending=$,t.NormalBlending=ee,t.AdditiveBlending=te,t.SubtractiveBlending=re,t.MultiplyBlending=ne,t.CustomBlending=ie,t.AddEquation=oe,t.SubtractEquation=ae,t.ReverseSubtractEquation=se,t.MinEquation=ce,t.MaxEquation=ue,t.ZeroFactor=le,t.OneFactor=he,t.SrcColorFactor=de,t.OneMinusSrcColorFactor=fe,t.SrcAlphaFactor=pe,t.OneMinusSrcAlphaFactor=me,t.DstAlphaFactor=ve,t.OneMinusDstAlphaFactor=ge,t.DstColorFactor=ye,t.OneMinusDstColorFactor=be,t.SrcAlphaSaturateFactor=xe,t.NeverDepth=we,t.AlwaysDepth=_e,t.LessDepth=Se,t.LessEqualDepth=Me,t.EqualDepth=Te,t.GreaterEqualDepth=Ae,t.GreaterDepth=Ee,t.NotEqualDepth=Ce,t.MultiplyOperation=Le,t.MixOperation=Pe,t.AddOperation=Oe,t.NoToneMapping=Ne,t.LinearToneMapping=Re,t.ReinhardToneMapping=Ie,t.Uncharted2ToneMapping=De,t.CineonToneMapping=Fe,t.UVMapping=Ue,t.CubeReflectionMapping=ke,t.CubeRefractionMapping=Be,t.EquirectangularReflectionMapping=ze,t.EquirectangularRefractionMapping=je,t.SphericalReflectionMapping=Ve,t.CubeUVReflectionMapping=Ge,t.CubeUVRefractionMapping=We,t.RepeatWrapping=He,t.ClampToEdgeWrapping=Xe,t.MirroredRepeatWrapping=qe,t.NearestFilter=Ye,t.NearestMipMapNearestFilter=Je,t.NearestMipMapLinearFilter=Qe,t.LinearFilter=Ze,t.LinearMipMapNearestFilter=Ke,t.LinearMipMapLinearFilter=$e,t.UnsignedByteType=et,t.ByteType=tt,t.ShortType=rt,t.UnsignedShortType=nt,t.IntType=it,t.UnsignedIntType=ot,t.FloatType=at,t.HalfFloatType=st,t.UnsignedShort4444Type=ct,t.UnsignedShort5551Type=ut,t.UnsignedShort565Type=lt,t.UnsignedInt248Type=ht,t.AlphaFormat=dt,t.RGBFormat=ft,t.RGBAFormat=pt,t.LuminanceFormat=mt,t.LuminanceAlphaFormat=vt,t.RGBEFormat=gt,t.DepthFormat=yt,t.DepthStencilFormat=bt,t.RGB_S3TC_DXT1_Format=xt,t.RGBA_S3TC_DXT1_Format=wt,t.RGBA_S3TC_DXT3_Format=_t,t.RGBA_S3TC_DXT5_Format=St,t.RGB_PVRTC_4BPPV1_Format=Mt,t.RGB_PVRTC_2BPPV1_Format=Tt,t.RGBA_PVRTC_4BPPV1_Format=At,t.RGBA_PVRTC_2BPPV1_Format=Et,t.RGB_ETC1_Format=Ct,t.RGBA_ASTC_4x4_Format=Lt,t.RGBA_ASTC_5x4_Format=Pt,t.RGBA_ASTC_5x5_Format=Ot,t.RGBA_ASTC_6x5_Format=Nt,t.RGBA_ASTC_6x6_Format=Rt,t.RGBA_ASTC_8x5_Format=It,t.RGBA_ASTC_8x6_Format=Dt,t.RGBA_ASTC_8x8_Format=Ft,t.RGBA_ASTC_10x5_Format=Ut,t.RGBA_ASTC_10x6_Format=kt,t.RGBA_ASTC_10x8_Format=Bt,t.RGBA_ASTC_10x10_Format=zt,t.RGBA_ASTC_12x10_Format=jt,t.RGBA_ASTC_12x12_Format=Vt,t.LoopOnce=2200,t.LoopRepeat=Gt,t.LoopPingPong=2202,t.InterpolateDiscrete=Wt,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=Ht,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=Xt,t.TriangleStripDrawMode=qt,t.TriangleFanDrawMode=Yt,t.LinearEncoding=Jt,t.sRGBEncoding=Qt,t.GammaEncoding=Zt,t.RGBEEncoding=Kt,t.LogLuvEncoding=3003,t.RGBM7Encoding=$t,t.RGBM16Encoding=er,t.RGBDEncoding=tr,t.BasicDepthPacking=rr,t.RGBADepthPacking=nr,t.TangentSpaceNormalMap=ir,t.ObjectSpaceNormalMap=or,t.Float64BufferAttribute=R,t.Float32BufferAttribute=N,t.Uint32BufferAttribute=O,t.Int32BufferAttribute=P,t.Uint16BufferAttribute=L,t.Int16BufferAttribute=C,t.Uint8ClampedBufferAttribute=E,t.Uint8BufferAttribute=A,t.Int8BufferAttribute=T,t.BufferAttribute=M,t.BufferGeometry=U,t.Clock=ol,t.DirectGeometry=I,t.EventDispatcher=u,t.Face3=g,t.Geometry=_,t.InstancedBufferAttribute=lp,t.InstancedBufferGeometry=qi,t.InstancedInterleavedBuffer=Ji,t.InterleavedBuffer=Yi,t.InterleavedBufferAttribute=Qi,t.Layers=h,t.Object3D=p,t.Raycaster=Nn,t.Uniform=Hd,t.Curve=si,t.CurvePath=Qa,t.Font=hp,t.CatmullRom=Ba,t.QuadraticBezier=za,t.CubicBezier=ja,t.Path=Za,t.Shape=Ka,t.ShapePath=Ms,t.ArcCurve=Na,t.CatmullRomCurve3=ka,t.CubicBezierCurve=Va,t.CubicBezierCurve3=Ga,t.EllipseCurve=Oa,t.LineCurve=Wa,t.LineCurve3=Ha,t.QuadraticBezierCurve=Xa,t.QuadraticBezierCurve3=qa,t.SplineCurve=Ya,t.Earcut=$a,t.ImageUtils=Jr,t.ImmediateRenderObject=pc,t.ShapeUtils=ws,t.BoxGeometry=Fr,t.BoxBufferGeometry=Ur,t.CircleGeometry=qf,t.CircleBufferGeometry=Yf,t.ConeGeometry=fp,t.ConeBufferGeometry=pp,t.CylinderGeometry=kr,t.CylinderBufferGeometry=Br,t.DodecahedronGeometry=mp,t.DodecahedronBufferGeometry=vp,t.EdgesGeometry=gp,t.ExtrudeGeometry=yp,t.ExtrudeBufferGeometry=bp,t.IcosahedronGeometry=Jf,t.IcosahedronBufferGeometry=Qf,t.LatheGeometry=Mp,t.LatheBufferGeometry=Tp,t.OctahedronGeometry=Wn,t.OctahedronBufferGeometry=Hn,t.ParametricGeometry=Ap,t.ParametricBufferGeometry=Ep,t.PlaneGeometry=$r,t.PlaneBufferGeometry=en,t.PolyhedronGeometry=Vn,t.PolyhedronBufferGeometry=Gn,t.RingGeometry=Cp,t.RingBufferGeometry=Lp,t.ShapeGeometry=Zf,t.ShapeBufferGeometry=Kf,t.SphereGeometry=k,t.SphereBufferGeometry=B,t.TetrahedronGeometry=Pp,t.TetrahedronBufferGeometry=Op,t.TextGeometry=Np,t.TextBufferGeometry=Rp,t.TorusGeometry=Xn,t.TorusBufferGeometry=qn,t.TorusKnotGeometry=Ip,t.TorusKnotBufferGeometry=Dp,t.TubeGeometry=Fp,t.TubeBufferGeometry=Up,t.WireframeGeometry=Zi,t.ArrowHelper=kp,t.AxesHelper=Bp,t.Box3Helper=zp,t.BoxHelper=cl,t.CameraHelper=jp,t.DirectionalLightHelper=Vp,t.FaceNormalsHelper=Gp,t.GridHelper=Wp,t.HemisphereLightHelper=Hp,t.PlaneHelper=Xp,t.PointLightHelper=qp,t.PolarGridHelper=Yp,t.RectAreaLightHelper=Jp,t.SkeletonHelper=jf,t.SpotLightHelper=Qp,t.VertexNormalsHelper=Zp,t.AmbientLight=Ao,t.DirectionalLight=xo,t.DirectionalLightShadow=bo,t.HemisphereLight=So,t.Light=vo,t.LightShadow=go,t.PointLight=yo,t.RectAreaLight=Kp,t.SpotLight=_o,t.SpotLightShadow=wo,t.AnimationLoader=$p,t.AudioLoader=em,t.BufferGeometryLoader=tm,t.Cache=an,t.CompressedTextureLoader=Oo,t.CubeTextureLoader=nm,t.DataTextureLoader=ko,t.FileLoader=ln,t.FontLoader=im,t.ImageBitmapLoader=om,t.ImageLoader=Tn,t.JSONLoader=Ln,t.Loader=En,t.LoaderUtils=Cn,t.DefaultLoadingManager=cn,t.LoadingManager=sn,t.MaterialLoader=Mn,t.ObjectLoader=lm,t.TextureLoader=An,t.LineBasicMaterial=ur,t.LineDashedMaterial=hn,t.Material=sr,t.MeshBasicMaterial=cr,t.MeshDepthMaterial=dn,t.MeshDistanceMaterial=fn,t.MeshLambertMaterial=pn,t.MeshNormalMaterial=mn,t.MeshPhongMaterial=vn,t.MeshPhysicalMaterial=yn,t.MeshStandardMaterial=gn,t.MeshToonMaterial=bn,t.PointsMaterial=xn,t.RawShaderMaterial=wn,t.ShaderMaterial=Xr,t.ShadowMaterial=_n,t.SpriteMaterial=Sn,t.Box2=Qu,t.Box3=y,t.Color=v,t.Cylindrical=pm,t.Euler=l,t.Frustum=nh,t.Interpolant=vr,t.CubicInterpolant=_r,t.DiscreteInterpolant=Sr,t.LinearInterpolant=gr,t.QuaternionLinearInterpolant=Cr,t.Line3=Zn,t._Math=o,t.Matrix3=d,t.Matrix4=a,t.Plane=On,t.Quaternion=c,t.Ray=lr,t.Sphere=b,t.Spherical=Fn,t.Triangle=hr,t.Vector2=x,t.Vector3=s,t.Vector4=S,t.Bone=Dr,t.Group=oo,t.Line=fr,t.LineLoop=Ro,t.LineSegments=Eo,t.LOD=am,t.Mesh=dr,t.Points=Gi,t.Skeleton=uo,t.SkinnedMesh=lo,t.Sprite=wc,t.ShaderChunk=Ei,t.ShaderLib=Li,t.UniformsLib=Ci,t.UniformsUtils=Hr,t.WebGLAnimation=gh,t.WebGLAttributes=yh,t.WebGLBackground=bh,t.WebGLBufferRenderer=xh,t.WebGLCapabilities=wh,t.WebGLClipping=_h,t.WebGLExtensions=Sh,t.WebGLGeometries=Mh,t.WebGLIndexedBufferRenderer=Th,t.WebGLInfo=Ah,t.WebGLLights=Id,t.WebGLMorphtargets=Ch,t.WebGLObjects=Lh,t.WebGLProgram=Ed,t.WebGLPrograms=Cd,t.WebGLProperties=Ld,t.WebGLRenderLists=Nd,t.WebGLRenderStates=Fd,t.WebGLShader=yd,t.WebGLShadowMap=Ud,t.WebGLState=kd,t.WebGLTextures=Bd,t.WebGLUniforms=gd,t.WebGLUtils=zd,t.WebGL2Renderer=function(e){console.log("WebGL2Renderer",z);var t,r=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,c=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default";try{var h={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:l};if(r.addEventListener("webglcontextlost",function(e){e.preventDefault()},!1),r.addEventListener("webglcontextrestored",function(){}),null===(t=n||r.getContext("webgl2",h)))throw null!==r.getContext("webgl2")?new Error("Error creating WebGL2 context with your selected attributes."):new Error("Error creating WebGL2 context.")}catch(e){console.error("WebGL2Renderer: "+e.message)}var d=!0,f=!0,p=!0,m=new v(0),g=0,y=r.width,b=r.height,x=1,w=new S(0,0,y,b),_=new Sh(t),M=new kd(t,_,function(){});function T(e,t,n){y=e,b=t,r.width=e*x,r.height=t*x,!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),function(e,t,r,n){M.viewport(w.set(e,t,r,n))}(0,0,e,t)}return{domElement:r,clear:function(e,r,n){var i=0;(void 0===e||e)&&(i|=t.COLOR_BUFFER_BIT),(void 0===r||r)&&(i|=t.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=t.STENCIL_BUFFER_BIT),t.clear(i)},setPixelRatio:function(e){void 0!==e&&(x=e,T(w.z,w.w,!1))},setSize:T,render:function(e,t){if(void 0===t||!0===t.isCamera){var r=e.background;null===r?M.buffers.color.setClear(m.r,m.g,m.b,g,c):r&&r.isColor&&M.buffers.color.setClear(r.r,r.g,r.b,1,c),this.clear(d,f,p)}else console.error("WebGL2Renderer.render: camera is not an instance of Camera.")}}},t.WebGLRenderer=Wd,t.WebGLRenderTarget=Kr,t.WebGLRenderTargetCube=Fo,t.WebVRManager=Vd,t.WebXRManager=Gd,t.Fog=sm,t.FogExp2=cm,t.Scene=qr,t.CanvasTexture=xc,t.CompressedTexture=Po,t.CubeTexture=Xo,t.DataTexture=Vi,t.DepthTexture=jl,t.Texture=Zr,t.VideoTexture=mm,t.arrayMin=function(e){if(0===e.length)return 1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]<t&&(t=e[r]);return t},t.arrayMax=D}).call(this,r("698d75b157f24ae829cc"),r("11d2d9cd5d1b52a535e7"),r("5e511fa944f88972e69c"))},"503a0df91bcab33c39b8":function(e,t,r){var n=r("88db22626e6c88b175cf");e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},"51a5b67212dfc6f7022a":function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("cf8d6afd09746a2b5bc3"),o=r("1b01d0e59d3af79760a0").f,a=r("a9e0e4b5ca884ed0dd59").f,s=r("1582553a0f2276f66f2f"),c=r("f936413e306f54e59a2a"),u=n.RegExp,l=u,h=u.prototype,d=/a/g,f=/a/g,p=new u(d)!==d;if(r("5975c7ea3ecd56e534e3")&&(!p||r("7a7739dd8a198a2cfcb5")(function(){return f[r("621a65702ee1a566fd32")("match")]=!1,u(d)!=d||u(f)==f||"/a/i"!=u(d,"i")}))){u=function(e,t){var r=this instanceof u,n=s(e),o=void 0===t;return!r&&n&&e.constructor===u&&o?e:i(p?new l(n&&!o?e.source:e,t):l((n=e instanceof u)?e.source:e,n&&o?c.call(e):t),r?this:h,u)};for(var m=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},v=a(l),g=0;v.length>g;)m(v[g++]);h.constructor=u,u.prototype=h,r("88db22626e6c88b175cf")(n,"RegExp",u)}r("89a21af31babcdc56725")("RegExp")},"531aa4a3a0a8a597b4b4":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Object",{setPrototypeOf:r("0d694d86343010af9d4f").set})},"54f683fcda7806277002":function(e,t,r){e.exports=function(){"use strict";var e=Array.prototype.slice;function t(e,t){t&&(e.prototype=Object.create(t.prototype)),e.prototype.constructor=e}function r(e){return a(e)?e:X(e)}function n(e){return s(e)?e:q(e)}function i(e){return c(e)?e:Y(e)}function o(e){return a(e)&&!u(e)?e:J(e)}function a(e){return!(!e||!e[h])}function s(e){return!(!e||!e[d])}function c(e){return!(!e||!e[f])}function u(e){return s(e)||c(e)}function l(e){return!(!e||!e[p])}t(n,r),t(i,r),t(o,r),r.isIterable=a,r.isKeyed=s,r.isIndexed=c,r.isAssociative=u,r.isOrdered=l,r.Keyed=n,r.Indexed=i,r.Set=o;var h="@@__IMMUTABLE_ITERABLE__@@",d="@@__IMMUTABLE_KEYED__@@",f="@@__IMMUTABLE_INDEXED__@@",p="@@__IMMUTABLE_ORDERED__@@",m=5,v=1<<m,g=v-1,y={},b={value:!1},x={value:!1};function w(e){return e.value=!1,e}function _(e){e&&(e.value=!0)}function S(){}function M(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),i=0;i<r;i++)n[i]=e[i+t];return n}function T(e){return void 0===e.size&&(e.size=e.__iterate(E)),e.size}function A(e,t){if("number"!=typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?T(e)+t:t}function E(){return!0}function C(e,t,r){return(0===e||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function L(e,t){return O(e,t,0)}function P(e,t){return O(e,t,t)}function O(e,t,r){return void 0===e?r:e<0?Math.max(0,t+e):void 0===t?e:Math.min(t,e)}var N=0,R=1,I=2,D="function"==typeof Symbol&&Symbol.iterator,F="@@iterator",U=D||F;function k(e){this.next=e}function B(e,t,r,n){var i=0===e?t:1===e?r:[t,r];return n?n.value=i:n={value:i,done:!1},n}function z(){return{value:void 0,done:!0}}function j(e){return!!W(e)}function V(e){return e&&"function"==typeof e.next}function G(e){var t=W(e);return t&&t.call(e)}function W(e){var t=e&&(D&&e[D]||e[F]);if("function"==typeof t)return t}function H(e){return e&&"number"==typeof e.length}function X(e){return null===e||void 0===e?oe():a(e)?e.toSeq():function(e){var t=ce(e)||"object"==typeof e&&new te(e);if(!t)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+e);return t}(e)}function q(e){return null===e||void 0===e?oe().toKeyedSeq():a(e)?s(e)?e.toSeq():e.fromEntrySeq():ae(e)}function Y(e){return null===e||void 0===e?oe():a(e)?s(e)?e.entrySeq():e.toIndexedSeq():se(e)}function J(e){return(null===e||void 0===e?oe():a(e)?s(e)?e.entrySeq():e:se(e)).toSetSeq()}k.prototype.toString=function(){return"[Iterator]"},k.KEYS=N,k.VALUES=R,k.ENTRIES=I,k.prototype.inspect=k.prototype.toSource=function(){return this.toString()},k.prototype[U]=function(){return this},t(X,r),X.of=function(){return X(arguments)},X.prototype.toSeq=function(){return this},X.prototype.toString=function(){return this.__toString("Seq {","}")},X.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},X.prototype.__iterate=function(e,t){return ue(this,e,t,!0)},X.prototype.__iterator=function(e,t){return le(this,e,t,!0)},t(q,X),q.prototype.toKeyedSeq=function(){return this},t(Y,X),Y.of=function(){return Y(arguments)},Y.prototype.toIndexedSeq=function(){return this},Y.prototype.toString=function(){return this.__toString("Seq [","]")},Y.prototype.__iterate=function(e,t){return ue(this,e,t,!1)},Y.prototype.__iterator=function(e,t){return le(this,e,t,!1)},t(J,X),J.of=function(){return J(arguments)},J.prototype.toSetSeq=function(){return this},X.isSeq=ie,X.Keyed=q,X.Set=J,X.Indexed=Y;var Q,Z,K,$="@@__IMMUTABLE_SEQ__@@";function ee(e){this._array=e,this.size=e.length}function te(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}function re(e){this._iterable=e,this.size=e.length||e.size}function ne(e){this._iterator=e,this._iteratorCache=[]}function ie(e){return!(!e||!e[$])}function oe(){return Q||(Q=new ee([]))}function ae(e){var t=Array.isArray(e)?new ee(e).fromEntrySeq():V(e)?new ne(e).fromEntrySeq():j(e)?new re(e).fromEntrySeq():"object"==typeof e?new te(e):void 0;if(!t)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+e);return t}function se(e){var t=ce(e);if(!t)throw new TypeError("Expected Array or iterable object of values: "+e);return t}function ce(e){return H(e)?new ee(e):V(e)?new ne(e):j(e)?new re(e):void 0}function ue(e,t,r,n){var i=e._cache;if(i){for(var o=i.length-1,a=0;a<=o;a++){var s=i[r?o-a:a];if(!1===t(s[1],n?s[0]:a,e))return a+1}return a}return e.__iterateUncached(t,r)}function le(e,t,r,n){var i=e._cache;if(i){var o=i.length-1,a=0;return new k(function(){var e=i[r?o-a:a];return a++>o?{value:void 0,done:!0}:B(t,n?e[0]:a-1,e[1])})}return e.__iteratorUncached(t,r)}function he(e,t){return t?function e(t,r,n,i){return Array.isArray(r)?t.call(i,n,Y(r).map(function(n,i){return e(t,n,i,r)})):fe(r)?t.call(i,n,q(r).map(function(n,i){return e(t,n,i,r)})):r}(t,e,"",{"":e}):de(e)}function de(e){return Array.isArray(e)?Y(e).map(de).toList():fe(e)?q(e).map(de).toMap():e}function fe(e){return e&&(e.constructor===Object||void 0===e.constructor)}function pe(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if(e=e.valueOf(),t=t.valueOf(),e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!("function"!=typeof e.equals||"function"!=typeof t.equals||!e.equals(t))}function me(e,t){if(e===t)return!0;if(!a(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||s(e)!==s(t)||c(e)!==c(t)||l(e)!==l(t))return!1;if(0===e.size&&0===t.size)return!0;var r=!u(e);if(l(e)){var n=e.entries();return t.every(function(e,t){var i=n.next().value;return i&&pe(i[1],e)&&(r||pe(i[0],t))})&&n.next().done}var i=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{i=!0;var o=e;e=t,t=o}var h=!0,d=t.__iterate(function(t,n){if(r?!e.has(t):i?!pe(t,e.get(n,y)):!pe(e.get(n,y),t))return h=!1,!1});return h&&e.size===d}function ve(e,t){if(!(this instanceof ve))return new ve(e,t);if(this._value=e,this.size=void 0===t?1/0:Math.max(0,t),0===this.size){if(Z)return Z;Z=this}}function ge(e,t){if(!e)throw new Error(t)}function ye(e,t,r){if(!(this instanceof ye))return new ye(e,t,r);if(ge(0!==r,"Cannot step a Range by 0"),e=e||0,void 0===t&&(t=1/0),r=void 0===r?1:Math.abs(r),t<e&&(r=-r),this._start=e,this._end=t,this._step=r,this.size=Math.max(0,Math.ceil((t-e)/r-1)+1),0===this.size){if(K)return K;K=this}}function be(){throw TypeError("Abstract")}function xe(){}function we(){}function _e(){}X.prototype[$]=!0,t(ee,Y),ee.prototype.get=function(e,t){return this.has(e)?this._array[A(this,e)]:t},ee.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length-1,i=0;i<=n;i++)if(!1===e(r[t?n-i:i],i,this))return i+1;return i},ee.prototype.__iterator=function(e,t){var r=this._array,n=r.length-1,i=0;return new k(function(){return i>n?{value:void 0,done:!0}:B(e,i,r[t?n-i++:i++])})},t(te,q),te.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},te.prototype.has=function(e){return this._object.hasOwnProperty(e)},te.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,i=n.length-1,o=0;o<=i;o++){var a=n[t?i-o:o];if(!1===e(r[a],a,this))return o+1}return o},te.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,i=n.length-1,o=0;return new k(function(){var a=n[t?i-o:o];return o++>i?{value:void 0,done:!0}:B(e,a,r[a])})},te.prototype[p]=!0,t(re,Y),re.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r=this._iterable,n=G(r),i=0;if(V(n))for(var o;!(o=n.next()).done&&!1!==e(o.value,i++,this););return i},re.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=this._iterable,n=G(r);if(!V(n))return new k(z);var i=0;return new k(function(){var t=n.next();return t.done?t:B(e,i++,t.value)})},t(ne,Y),ne.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);for(var r,n=this._iterator,i=this._iteratorCache,o=0;o<i.length;)if(!1===e(i[o],o++,this))return o;for(;!(r=n.next()).done;){var a=r.value;if(i[o]=a,!1===e(a,o++,this))break}return o},ne.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=this._iterator,n=this._iteratorCache,i=0;return new k(function(){if(i>=n.length){var t=r.next();if(t.done)return t;n[i]=t.value}return B(e,i,n[i++])})},t(ve,Y),ve.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},ve.prototype.get=function(e,t){return this.has(e)?this._value:t},ve.prototype.includes=function(e){return pe(this._value,e)},ve.prototype.slice=function(e,t){var r=this.size;return C(e,t,r)?this:new ve(this._value,P(t,r)-L(e,r))},ve.prototype.reverse=function(){return this},ve.prototype.indexOf=function(e){return pe(this._value,e)?0:-1},ve.prototype.lastIndexOf=function(e){return pe(this._value,e)?this.size:-1},ve.prototype.__iterate=function(e,t){for(var r=0;r<this.size;r++)if(!1===e(this._value,r,this))return r+1;return r},ve.prototype.__iterator=function(e,t){var r=this,n=0;return new k(function(){return n<r.size?B(e,n++,r._value):{value:void 0,done:!0}})},ve.prototype.equals=function(e){return e instanceof ve?pe(this._value,e._value):me(e)},t(ye,Y),ye.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},ye.prototype.get=function(e,t){return this.has(e)?this._start+A(this,e)*this._step:t},ye.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},ye.prototype.slice=function(e,t){return C(e,t,this.size)?this:(e=L(e,this.size),(t=P(t,this.size))<=e?new ye(0,0):new ye(this.get(e,this._end),this.get(t,this._end),this._step))},ye.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var r=t/this._step;if(r>=0&&r<this.size)return r}return-1},ye.prototype.lastIndexOf=function(e){return this.indexOf(e)},ye.prototype.__iterate=function(e,t){for(var r=this.size-1,n=this._step,i=t?this._start+r*n:this._start,o=0;o<=r;o++){if(!1===e(i,o,this))return o+1;i+=t?-n:n}return o},ye.prototype.__iterator=function(e,t){var r=this.size-1,n=this._step,i=t?this._start+r*n:this._start,o=0;return new k(function(){var a=i;return i+=t?-n:n,o>r?{value:void 0,done:!0}:B(e,o++,a)})},ye.prototype.equals=function(e){return e instanceof ye?this._start===e._start&&this._end===e._end&&this._step===e._step:me(this,e)},t(be,r),t(xe,be),t(we,be),t(_e,be),be.Keyed=xe,be.Indexed=we,be.Set=_e;var Se="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var r=65535&(e|=0),n=65535&(t|=0);return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function Me(e){return e>>>1&1073741824|3221225471&e}function Te(e){if(!1===e||null===e||void 0===e)return 0;if("function"==typeof e.valueOf&&(!1===(e=e.valueOf())||null===e||void 0===e))return 0;if(!0===e)return 1;var t=typeof e;if("number"===t){if(e!=e||e===1/0)return 0;var r=0|e;for(r!==e&&(r^=4294967295*e);e>4294967295;)r^=e/=4294967295;return Me(r)}if("string"===t)return e.length>Re?function(e){var t=Fe[e];return void 0===t&&(t=Ae(e),De===Ie&&(De=0,Fe={}),De++,Fe[e]=t),t}(e):Ae(e);if("function"==typeof e.hashCode)return e.hashCode();if("object"===t)return function(e){var t;if(Pe&&void 0!==(t=Ee.get(e)))return t;if(void 0!==(t=e[Ne]))return t;if(!Le){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[Ne]))return t;if(void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e)))return t}if(t=++Oe,1073741824&Oe&&(Oe=0),Pe)Ee.set(e,t);else{if(void 0!==Ce&&!1===Ce(e))throw new Error("Non-extensible objects are not allowed as keys.");if(Le)Object.defineProperty(e,Ne,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[Ne]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[Ne]=t}}return t}(e);if("function"==typeof e.toString)return Ae(e.toString());throw new Error("Value type "+t+" cannot be hashed.")}function Ae(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return Me(t)}var Ee,Ce=Object.isExtensible,Le=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}(),Pe="function"==typeof WeakMap;Pe&&(Ee=new WeakMap);var Oe=0,Ne="__immutablehash__";"function"==typeof Symbol&&(Ne=Symbol(Ne));var Re=16,Ie=255,De=0,Fe={};function Ue(e){ge(e!==1/0,"Cannot perform this action with an infinite size.")}function ke(e){return null===e||void 0===e?Ke():Be(e)&&!l(e)?e:Ke().withMutations(function(t){var r=n(e);Ue(r.size),r.forEach(function(e,r){return t.set(r,e)})})}function Be(e){return!(!e||!e[je])}t(ke,xe),ke.of=function(){var t=e.call(arguments,0);return Ke().withMutations(function(e){for(var r=0;r<t.length;r+=2){if(r+1>=t.length)throw new Error("Missing value for key: "+t[r]);e.set(t[r],t[r+1])}})},ke.prototype.toString=function(){return this.__toString("Map {","}")},ke.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},ke.prototype.set=function(e,t){return $e(this,e,t)},ke.prototype.setIn=function(e,t){return this.updateIn(e,y,function(){return t})},ke.prototype.remove=function(e){return $e(this,e,y)},ke.prototype.deleteIn=function(e){return this.updateIn(e,function(){return y})},ke.prototype.update=function(e,t,r){return 1===arguments.length?e(this):this.updateIn([e],t,r)},ke.prototype.updateIn=function(e,t,r){r||(r=t,t=void 0);var n=function e(t,r,n,i){var o=t===y,a=r.next();if(a.done){var s=o?n:t,c=i(s);return c===s?t:c}ge(o||t&&t.set,"invalid keyPath");var u=a.value,l=o?y:t.get(u,y),h=e(l,r,n,i);return h===l?t:h===y?t.remove(u):(o?Ke():t).set(u,h)}(this,rr(e),t,r);return n===y?void 0:n},ke.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Ke()},ke.prototype.merge=function(){return nt(this,void 0,arguments)},ke.prototype.mergeWith=function(t){var r=e.call(arguments,1);return nt(this,t,r)},ke.prototype.mergeIn=function(t){var r=e.call(arguments,1);return this.updateIn(t,Ke(),function(e){return"function"==typeof e.merge?e.merge.apply(e,r):r[r.length-1]})},ke.prototype.mergeDeep=function(){return nt(this,it,arguments)},ke.prototype.mergeDeepWith=function(t){var r=e.call(arguments,1);return nt(this,ot(t),r)},ke.prototype.mergeDeepIn=function(t){var r=e.call(arguments,1);return this.updateIn(t,Ke(),function(e){return"function"==typeof e.mergeDeep?e.mergeDeep.apply(e,r):r[r.length-1]})},ke.prototype.sort=function(e){return Lt(Ht(this,e))},ke.prototype.sortBy=function(e,t){return Lt(Ht(this,t,e))},ke.prototype.withMutations=function(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this},ke.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new S)},ke.prototype.asImmutable=function(){return this.__ensureOwner()},ke.prototype.wasAltered=function(){return this.__altered},ke.prototype.__iterator=function(e,t){return new Ye(this,e,t)},ke.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate(function(t){return n++,e(t[1],t[0],r)},t),n},ke.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Ze(this.size,this._root,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},ke.isMap=Be;var ze,je="@@__IMMUTABLE_MAP__@@",Ve=ke.prototype;function Ge(e,t){this.ownerID=e,this.entries=t}function We(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r}function He(e,t,r){this.ownerID=e,this.count=t,this.nodes=r}function Xe(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r}function qe(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r}function Ye(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&Qe(e._root)}function Je(e,t){return B(e,t[0],t[1])}function Qe(e,t){return{node:e,index:0,__prev:t}}function Ze(e,t,r,n){var i=Object.create(Ve);return i.size=e,i._root=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Ke(){return ze||(ze=Ze(0))}function $e(e,t,r){var n,i;if(e._root){var o=w(b),a=w(x);if(n=et(e._root,e.__ownerID,0,void 0,t,r,o,a),!a.value)return e;i=e.size+(o.value?r===y?-1:1:0)}else{if(r===y)return e;i=1,n=new Ge(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=i,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?Ze(i,n):Ke()}function et(e,t,r,n,i,o,a,s){return e?e.update(t,r,n,i,o,a,s):o===y?e:(_(s),_(a),new qe(t,n,[i,o]))}function tt(e){return e.constructor===qe||e.constructor===Xe}function rt(e,t,r,n,i){if(e.keyHash===n)return new Xe(t,n,[e.entry,i]);var o,a=(0===r?e.keyHash:e.keyHash>>>r)&g,s=(0===r?n:n>>>r)&g,c=a===s?[rt(e,t,r+m,n,i)]:(o=new qe(t,n,i),a<s?[e,o]:[o,e]);return new We(t,1<<a|1<<s,c)}function nt(e,t,r){for(var i=[],o=0;o<r.length;o++){var s=r[o],c=n(s);a(s)||(c=c.map(function(e){return he(e)})),i.push(c)}return at(e,t,i)}function it(e,t,r){return e&&e.mergeDeep&&a(t)?e.mergeDeep(t):pe(e,t)?e:t}function ot(e){return function(t,r,n){if(t&&t.mergeDeepWith&&a(r))return t.mergeDeepWith(e,r);var i=e(t,r,n);return pe(t,i)?t:i}}function at(e,t,r){return 0===(r=r.filter(function(e){return 0!==e.size})).length?e:0!==e.size||e.__ownerID||1!==r.length?e.withMutations(function(e){for(var n=t?function(r,n){e.update(n,y,function(e){return e===y?r:t(e,r,n)})}:function(t,r){e.set(r,t)},i=0;i<r.length;i++)r[i].forEach(n)}):e.constructor(r[0])}function st(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,127&(e+=e>>16)}function ct(e,t,r,n){var i=n?e:M(e);return i[t]=r,i}Ve[je]=!0,Ve.delete=Ve.remove,Ve.removeIn=Ve.deleteIn,Ge.prototype.get=function(e,t,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(pe(r,i[o][0]))return i[o][1];return n},Ge.prototype.update=function(e,t,r,n,i,o,a){for(var s=i===y,c=this.entries,u=0,l=c.length;u<l&&!pe(n,c[u][0]);u++);var h=u<l;if(h?c[u][1]===i:s)return this;if(_(a),(s||!h)&&_(o),!s||1!==c.length){if(!h&&!s&&c.length>=ut)return function(e,t,r,n){e||(e=new S);for(var i=new qe(e,Te(r),[r,n]),o=0;o<t.length;o++){var a=t[o];i=i.update(e,0,void 0,a[0],a[1])}return i}(e,c,n,i);var d=e&&e===this.ownerID,f=d?c:M(c);return h?s?u===l-1?f.pop():f[u]=f.pop():f[u]=[n,i]:f.push([n,i]),d?(this.entries=f,this):new Ge(e,f)}},We.prototype.get=function(e,t,r,n){void 0===t&&(t=Te(r));var i=1<<((0===e?t:t>>>e)&g),o=this.bitmap;return 0==(o&i)?n:this.nodes[st(o&i-1)].get(e+m,t,r,n)},We.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Te(n));var s=(0===t?r:r>>>t)&g,c=1<<s,u=this.bitmap,l=0!=(u&c);if(!l&&i===y)return this;var h=st(u&c-1),d=this.nodes,f=l?d[h]:void 0,p=et(f,e,t+m,r,n,i,o,a);if(p===f)return this;if(!l&&p&&d.length>=lt)return function(e,t,r,n,i){for(var o=0,a=new Array(v),s=0;0!==r;s++,r>>>=1)a[s]=1&r?t[o++]:void 0;return a[n]=i,new He(e,o+1,a)}(e,d,u,s,p);if(l&&!p&&2===d.length&&tt(d[1^h]))return d[1^h];if(l&&p&&1===d.length&&tt(p))return p;var b=e&&e===this.ownerID,x=l?p?u:u^c:u|c,w=l?p?ct(d,h,p,b):function(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var i=new Array(n),o=0,a=0;a<n;a++)a===t&&(o=1),i[a]=e[a+o];return i}(d,h,b):function(e,t,r,n){var i=e.length+1;if(n&&t+1===i)return e[t]=r,e;for(var o=new Array(i),a=0,s=0;s<i;s++)s===t?(o[s]=r,a=-1):o[s]=e[s+a];return o}(d,h,p,b);return b?(this.bitmap=x,this.nodes=w,this):new We(e,x,w)},He.prototype.get=function(e,t,r,n){void 0===t&&(t=Te(r));var i=(0===e?t:t>>>e)&g,o=this.nodes[i];return o?o.get(e+m,t,r,n):n},He.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Te(n));var s=(0===t?r:r>>>t)&g,c=i===y,u=this.nodes,l=u[s];if(c&&!l)return this;var h=et(l,e,t+m,r,n,i,o,a);if(h===l)return this;var d=this.count;if(l){if(!h&&--d<ht)return function(e,t,r,n){for(var i=0,o=0,a=new Array(r),s=0,c=1,u=t.length;s<u;s++,c<<=1){var l=t[s];void 0!==l&&s!==n&&(i|=c,a[o++]=l)}return new We(e,i,a)}(e,u,d,s)}else d++;var f=e&&e===this.ownerID,p=ct(u,s,h,f);return f?(this.count=d,this.nodes=p,this):new He(e,d,p)},Xe.prototype.get=function(e,t,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(pe(r,i[o][0]))return i[o][1];return n},Xe.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Te(n));var s=i===y;if(r!==this.keyHash)return s?this:(_(a),_(o),rt(this,e,t,r,[n,i]));for(var c=this.entries,u=0,l=c.length;u<l&&!pe(n,c[u][0]);u++);var h=u<l;if(h?c[u][1]===i:s)return this;if(_(a),(s||!h)&&_(o),s&&2===l)return new qe(e,this.keyHash,c[1^u]);var d=e&&e===this.ownerID,f=d?c:M(c);return h?s?u===l-1?f.pop():f[u]=f.pop():f[u]=[n,i]:f.push([n,i]),d?(this.entries=f,this):new Xe(e,this.keyHash,f)},qe.prototype.get=function(e,t,r,n){return pe(r,this.entry[0])?this.entry[1]:n},qe.prototype.update=function(e,t,r,n,i,o,a){var s=i===y,c=pe(n,this.entry[0]);return(c?i===this.entry[1]:s)?this:(_(a),s?void _(o):c?e&&e===this.ownerID?(this.entry[1]=i,this):new qe(e,this.keyHash,[n,i]):(_(o),rt(this,e,t,Te(n),[n,i])))},Ge.prototype.iterate=Xe.prototype.iterate=function(e,t){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(!1===e(r[t?i-n:n]))return!1},We.prototype.iterate=He.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[t?i-n:n];if(o&&!1===o.iterate(e,t))return!1}},qe.prototype.iterate=function(e,t){return e(this.entry)},t(Ye,k),Ye.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r,n=t.node,i=t.index++;if(n.entry){if(0===i)return Je(e,n.entry)}else if(n.entries){if(r=n.entries.length-1,i<=r)return Je(e,n.entries[this._reverse?r-i:i])}else if(r=n.nodes.length-1,i<=r){var o=n.nodes[this._reverse?r-i:i];if(o){if(o.entry)return Je(e,o.entry);t=this._stack=Qe(o,t)}continue}t=this._stack=this._stack.__prev}return{value:void 0,done:!0}};var ut=v/4,lt=v/2,ht=v/4;function dt(e){var t=_t();if(null===e||void 0===e)return t;if(ft(e))return e;var r=i(e),n=r.size;return 0===n?t:(Ue(n),n>0&&n<v?wt(0,n,m,null,new vt(r.toArray())):t.withMutations(function(e){e.setSize(n),r.forEach(function(t,r){return e.set(r,t)})}))}function ft(e){return!(!e||!e[pt])}t(dt,we),dt.of=function(){return this(arguments)},dt.prototype.toString=function(){return this.__toString("List [","]")},dt.prototype.get=function(e,t){if((e=A(this,e))>=0&&e<this.size){var r=Tt(this,e+=this._origin);return r&&r.array[e&g]}return t},dt.prototype.set=function(e,t){return function(e,t,r){if((t=A(e,t))!=t)return e;if(t>=e.size||t<0)return e.withMutations(function(e){t<0?At(e,t).set(0,r):At(e,0,t+1).set(t,r)});t+=e._origin;var n=e._tail,i=e._root,o=w(x);return t>=Ct(e._capacity)?n=St(n,e.__ownerID,0,t,r,o):i=St(i,e.__ownerID,e._level,t,r,o),o.value?e.__ownerID?(e._root=i,e._tail=n,e.__hash=void 0,e.__altered=!0,e):wt(e._origin,e._capacity,e._level,i,n):e}(this,e,t)},dt.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},dt.prototype.insert=function(e,t){return this.splice(e,0,t)},dt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=m,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):_t()},dt.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations(function(r){At(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])})},dt.prototype.pop=function(){return At(this,0,-1)},dt.prototype.unshift=function(){var e=arguments;return this.withMutations(function(t){At(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])})},dt.prototype.shift=function(){return At(this,1)},dt.prototype.merge=function(){return Et(this,void 0,arguments)},dt.prototype.mergeWith=function(t){var r=e.call(arguments,1);return Et(this,t,r)},dt.prototype.mergeDeep=function(){return Et(this,it,arguments)},dt.prototype.mergeDeepWith=function(t){var r=e.call(arguments,1);return Et(this,ot(t),r)},dt.prototype.setSize=function(e){return At(this,0,e)},dt.prototype.slice=function(e,t){var r=this.size;return C(e,t,r)?this:At(this,L(e,r),P(t,r))},dt.prototype.__iterator=function(e,t){var r=0,n=xt(this,t);return new k(function(){var t=n();return t===bt?{value:void 0,done:!0}:B(e,r++,t)})},dt.prototype.__iterate=function(e,t){for(var r,n=0,i=xt(this,t);(r=i())!==bt&&!1!==e(r,n++,this););return n},dt.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?wt(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):(this.__ownerID=e,this)},dt.isList=ft;var pt="@@__IMMUTABLE_LIST__@@",mt=dt.prototype;function vt(e,t){this.array=e,this.ownerID=t}mt[pt]=!0,mt.delete=mt.remove,mt.setIn=Ve.setIn,mt.deleteIn=mt.removeIn=Ve.removeIn,mt.update=Ve.update,mt.updateIn=Ve.updateIn,mt.mergeIn=Ve.mergeIn,mt.mergeDeepIn=Ve.mergeDeepIn,mt.withMutations=Ve.withMutations,mt.asMutable=Ve.asMutable,mt.asImmutable=Ve.asImmutable,mt.wasAltered=Ve.wasAltered,vt.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&g;if(n>=this.array.length)return new vt([],e);var i,o=0===n;if(t>0){var a=this.array[n];if((i=a&&a.removeBefore(e,t-m,r))===a&&o)return this}if(o&&!i)return this;var s=Mt(this,e);if(!o)for(var c=0;c<n;c++)s.array[c]=void 0;return i&&(s.array[n]=i),s},vt.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,i=r-1>>>t&g;if(i>=this.array.length)return this;if(t>0){var o=this.array[i];if((n=o&&o.removeAfter(e,t-m,r))===o&&i===this.array.length-1)return this}var a=Mt(this,e);return a.array.splice(i+1),n&&(a.array[i]=n),a};var gt,yt,bt={};function xt(e,t){var r=e._origin,n=e._capacity,i=Ct(n),o=e._tail;return a(e._root,e._level,0);function a(e,s,c){return 0===s?function(e,a){var s=a===i?o&&o.array:e&&e.array,c=a>r?0:r-a,u=n-a;return u>v&&(u=v),function(){if(c===u)return bt;var e=t?--u:c++;return s&&s[e]}}(e,c):function(e,i,o){var s,c=e&&e.array,u=o>r?0:r-o>>i,l=1+(n-o>>i);return l>v&&(l=v),function(){for(;;){if(s){var e=s();if(e!==bt)return e;s=null}if(u===l)return bt;var r=t?--l:u++;s=a(c&&c[r],i-m,o+(r<<i))}}}(e,s,c)}}function wt(e,t,r,n,i,o,a){var s=Object.create(mt);return s.size=t-e,s._origin=e,s._capacity=t,s._level=r,s._root=n,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function _t(){return gt||(gt=wt(0,0,m))}function St(e,t,r,n,i,o){var a,s=n>>>r&g,c=e&&s<e.array.length;if(!c&&void 0===i)return e;if(r>0){var u=e&&e.array[s],l=St(u,t,r-m,n,i,o);return l===u?e:((a=Mt(e,t)).array[s]=l,a)}return c&&e.array[s]===i?e:(_(o),a=Mt(e,t),void 0===i&&s===a.array.length-1?a.array.pop():a.array[s]=i,a)}function Mt(e,t){return t&&e&&t===e.ownerID?e:new vt(e?e.array.slice():[],t)}function Tt(e,t){if(t>=Ct(e._capacity))return e._tail;if(t<1<<e._level+m){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&g],n-=m;return r}}function At(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new S,i=e._origin,o=e._capacity,a=i+t,s=void 0===r?o:r<0?o+r:i+r;if(a===i&&s===o)return e;if(a>=s)return e.clear();for(var c=e._level,u=e._root,l=0;a+l<0;)u=new vt(u&&u.array.length?[void 0,u]:[],n),l+=1<<(c+=m);l&&(a+=l,i+=l,s+=l,o+=l);for(var h=Ct(o),d=Ct(s);d>=1<<c+m;)u=new vt(u&&u.array.length?[u]:[],n),c+=m;var f=e._tail,p=d<h?Tt(e,s-1):d>h?new vt([],n):f;if(f&&d>h&&a<o&&f.array.length){for(var v=u=Mt(u,n),y=c;y>m;y-=m){var b=h>>>y&g;v=v.array[b]=Mt(v.array[b],n)}v.array[h>>>m&g]=f}if(s<o&&(p=p&&p.removeAfter(n,0,s)),a>=d)a-=d,s-=d,c=m,u=null,p=p&&p.removeBefore(n,0,a);else if(a>i||d<h){for(l=0;u;){var x=a>>>c&g;if(x!==d>>>c&g)break;x&&(l+=(1<<c)*x),c-=m,u=u.array[x]}u&&a>i&&(u=u.removeBefore(n,c,a-l)),u&&d<h&&(u=u.removeAfter(n,c,d-l)),l&&(a-=l,s-=l)}return e.__ownerID?(e.size=s-a,e._origin=a,e._capacity=s,e._level=c,e._root=u,e._tail=p,e.__hash=void 0,e.__altered=!0,e):wt(a,s,c,u,p)}function Et(e,t,r){for(var n=[],o=0,s=0;s<r.length;s++){var c=r[s],u=i(c);u.size>o&&(o=u.size),a(c)||(u=u.map(function(e){return he(e)})),n.push(u)}return o>e.size&&(e=e.setSize(o)),at(e,t,n)}function Ct(e){return e<v?0:e-1>>>m<<m}function Lt(e){return null===e||void 0===e?Nt():Pt(e)?e:Nt().withMutations(function(t){var r=n(e);Ue(r.size),r.forEach(function(e,r){return t.set(r,e)})})}function Pt(e){return Be(e)&&l(e)}function Ot(e,t,r,n){var i=Object.create(Lt.prototype);return i.size=e?e.size:0,i._map=e,i._list=t,i.__ownerID=r,i.__hash=n,i}function Nt(){return yt||(yt=Ot(Ke(),_t()))}function Rt(e,t,r){var n,i,o=e._map,a=e._list,s=o.get(t),c=void 0!==s;if(r===y){if(!c)return e;a.size>=v&&a.size>=2*o.size?(i=a.filter(function(e,t){return void 0!==e&&s!==t}),n=i.toKeyedSeq().map(function(e){return e[0]}).flip().toMap(),e.__ownerID&&(n.__ownerID=i.__ownerID=e.__ownerID)):(n=o.remove(t),i=s===a.size-1?a.pop():a.set(s,void 0))}else if(c){if(r===a.get(s)[1])return e;n=o,i=a.set(s,[t,r])}else n=o.set(t,a.size),i=a.set(a.size,[t,r]);return e.__ownerID?(e.size=n.size,e._map=n,e._list=i,e.__hash=void 0,e):Ot(n,i)}function It(e,t){this._iter=e,this._useKeys=t,this.size=e.size}function Dt(e){this._iter=e,this.size=e.size}function Ft(e){this._iter=e,this.size=e.size}function Ut(e){this._iter=e,this.size=e.size}function kt(e){var t=$t(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=er,t.__iterateUncached=function(t,r){var n=this;return e.__iterate(function(e,r){return!1!==t(r,e,n)},r)},t.__iteratorUncached=function(t,r){if(t===I){var n=e.__iterator(t,r);return new k(function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e})}return e.__iterator(t===R?N:R,r)},t}function Bt(e,t,r){var n=$t(e);return n.size=e.size,n.has=function(t){return e.has(t)},n.get=function(n,i){var o=e.get(n,y);return o===y?i:t.call(r,o,n,e)},n.__iterateUncached=function(n,i){var o=this;return e.__iterate(function(e,i,a){return!1!==n(t.call(r,e,i,a),i,o)},i)},n.__iteratorUncached=function(n,i){var o=e.__iterator(I,i);return new k(function(){var i=o.next();if(i.done)return i;var a=i.value,s=a[0];return B(n,s,t.call(r,a[1],s,e),i)})},n}function zt(e,t){var r=$t(e);return r._iter=e,r.size=e.size,r.reverse=function(){return e},e.flip&&(r.flip=function(){var t=kt(e);return t.reverse=function(){return e.flip()},t}),r.get=function(r,n){return e.get(t?r:-1-r,n)},r.has=function(r){return e.has(t?r:-1-r)},r.includes=function(t){return e.includes(t)},r.cacheResult=er,r.__iterate=function(t,r){var n=this;return e.__iterate(function(e,r){return t(e,r,n)},!r)},r.__iterator=function(t,r){return e.__iterator(t,!r)},r}function jt(e,t,r,n){var i=$t(e);return n&&(i.has=function(n){var i=e.get(n,y);return i!==y&&!!t.call(r,i,n,e)},i.get=function(n,i){var o=e.get(n,y);return o!==y&&t.call(r,o,n,e)?o:i}),i.__iterateUncached=function(i,o){var a=this,s=0;return e.__iterate(function(e,o,c){if(t.call(r,e,o,c))return s++,i(e,n?o:s-1,a)},o),s},i.__iteratorUncached=function(i,o){var a=e.__iterator(I,o),s=0;return new k(function(){for(;;){var o=a.next();if(o.done)return o;var c=o.value,u=c[0],l=c[1];if(t.call(r,l,u,e))return B(i,n?u:s++,l,o)}})},i}function Vt(e,t,r,n){var i=e.size;if(void 0!==t&&(t|=0),void 0!==r&&(r===1/0?r=i:r|=0),C(t,r,i))return e;var o=L(t,i),a=P(r,i);if(o!=o||a!=a)return Vt(e.toSeq().cacheResult(),t,r,n);var s,c=a-o;c==c&&(s=c<0?0:c);var u=$t(e);return u.size=0===s?s:e.size&&s||void 0,!n&&ie(e)&&s>=0&&(u.get=function(t,r){return(t=A(this,t))>=0&&t<s?e.get(t+o,r):r}),u.__iterateUncached=function(t,r){var i=this;if(0===s)return 0;if(r)return this.cacheResult().__iterate(t,r);var a=0,c=!0,u=0;return e.__iterate(function(e,r){if(!c||!(c=a++<o))return u++,!1!==t(e,n?r:u-1,i)&&u!==s}),u},u.__iteratorUncached=function(t,r){if(0!==s&&r)return this.cacheResult().__iterator(t,r);var i=0!==s&&e.__iterator(t,r),a=0,c=0;return new k(function(){for(;a++<o;)i.next();if(++c>s)return{value:void 0,done:!0};var e=i.next();return n||t===R?e:B(t,c-1,t===N?void 0:e.value[1],e)})},u}function Gt(e,t,r,n){var i=$t(e);return i.__iterateUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterate(i,o);var s=!0,c=0;return e.__iterate(function(e,o,u){if(!s||!(s=t.call(r,e,o,u)))return c++,i(e,n?o:c-1,a)}),c},i.__iteratorUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterator(i,o);var s=e.__iterator(I,o),c=!0,u=0;return new k(function(){var e,o,l;do{if((e=s.next()).done)return n||i===R?e:B(i,u++,i===N?void 0:e.value[1],e);var h=e.value;o=h[0],l=h[1],c&&(c=t.call(r,l,o,a))}while(c);return i===I?e:B(i,o,l,e)})},i}function Wt(e,t,r){var n=$t(e);return n.__iterateUncached=function(n,i){var o=0,s=!1;return function e(c,u){var l=this;c.__iterate(function(i,c){return(!t||u<t)&&a(i)?e(i,u+1):!1===n(i,r?c:o++,l)&&(s=!0),!s},i)}(e,0),o},n.__iteratorUncached=function(n,i){var o=e.__iterator(n,i),s=[],c=0;return new k(function(){for(;o;){var e=o.next();if(!1===e.done){var u=e.value;if(n===I&&(u=u[1]),t&&!(s.length<t)||!a(u))return r?e:B(n,c++,u,e);s.push(o),o=u.__iterator(n,i)}else o=s.pop()}return{value:void 0,done:!0}})},n}function Ht(e,t,r){t||(t=tr);var n=s(e),i=0,o=e.toSeq().map(function(t,n){return[n,t,i++,r?r(t,n,e):t]}).toArray();return o.sort(function(e,r){return t(e[3],r[3])||e[2]-r[2]}).forEach(n?function(e,t){o[t].length=2}:function(e,t){o[t]=e[1]}),n?q(o):c(e)?Y(o):J(o)}function Xt(e,t,r){if(t||(t=tr),r){var n=e.toSeq().map(function(t,n){return[t,r(t,n,e)]}).reduce(function(e,r){return qt(t,e[1],r[1])?r:e});return n&&n[0]}return e.reduce(function(e,r){return qt(t,e,r)?r:e})}function qt(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(void 0===r||null===r||r!=r)||n>0}function Yt(e,t,n){var i=$t(e);return i.size=new ee(n).map(function(e){return e.size}).min(),i.__iterate=function(e,t){for(var r,n=this.__iterator(R,t),i=0;!(r=n.next()).done&&!1!==e(r.value,i++,this););return i},i.__iteratorUncached=function(e,i){var o=n.map(function(e){return e=r(e),G(i?e.reverse():e)}),a=0,s=!1;return new k(function(){var r;return s||(r=o.map(function(e){return e.next()}),s=r.some(function(e){return e.done})),s?{value:void 0,done:!0}:B(e,a++,t.apply(null,r.map(function(e){return e.value})))})},i}function Jt(e,t){return ie(e)?t:e.constructor(t)}function Qt(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function Zt(e){return Ue(e.size),T(e)}function Kt(e){return s(e)?n:c(e)?i:o}function $t(e){return Object.create((s(e)?q:c(e)?Y:J).prototype)}function er(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):X.prototype.cacheResult.call(this)}function tr(e,t){return e>t?1:e<t?-1:0}function rr(e){var t=G(e);if(!t){if(!H(e))throw new TypeError("Expected iterable or array-like: "+e);t=G(r(e))}return t}function nr(e,t){var r,n=function(o){if(o instanceof n)return o;if(!(this instanceof n))return new n(o);if(!r){r=!0;var a=Object.keys(e);!function(e,t){try{t.forEach(function(e,t){Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){ge(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}.bind(void 0,e))}catch(e){}}(i,a),i.size=a.length,i._name=t,i._keys=a,i._defaultValues=e}this._map=ke(o)},i=n.prototype=Object.create(ir);return i.constructor=n,n}t(Lt,ke),Lt.of=function(){return this(arguments)},Lt.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Lt.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},Lt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Nt()},Lt.prototype.set=function(e,t){return Rt(this,e,t)},Lt.prototype.remove=function(e){return Rt(this,e,y)},Lt.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Lt.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate(function(t){return t&&e(t[1],t[0],r)},t)},Lt.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},Lt.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?Ot(t,r,e,this.__hash):(this.__ownerID=e,this._map=t,this._list=r,this)},Lt.isOrderedMap=Pt,Lt.prototype[p]=!0,Lt.prototype.delete=Lt.prototype.remove,t(It,q),It.prototype.get=function(e,t){return this._iter.get(e,t)},It.prototype.has=function(e){return this._iter.has(e)},It.prototype.valueSeq=function(){return this._iter.valueSeq()},It.prototype.reverse=function(){var e=this,t=zt(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},It.prototype.map=function(e,t){var r=this,n=Bt(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},It.prototype.__iterate=function(e,t){var r,n=this;return this._iter.__iterate(this._useKeys?function(t,r){return e(t,r,n)}:(r=t?Zt(this):0,function(i){return e(i,t?--r:r++,n)}),t)},It.prototype.__iterator=function(e,t){if(this._useKeys)return this._iter.__iterator(e,t);var r=this._iter.__iterator(R,t),n=t?Zt(this):0;return new k(function(){var i=r.next();return i.done?i:B(e,t?--n:n++,i.value,i)})},It.prototype[p]=!0,t(Dt,Y),Dt.prototype.includes=function(e){return this._iter.includes(e)},Dt.prototype.__iterate=function(e,t){var r=this,n=0;return this._iter.__iterate(function(t){return e(t,n++,r)},t)},Dt.prototype.__iterator=function(e,t){var r=this._iter.__iterator(R,t),n=0;return new k(function(){var t=r.next();return t.done?t:B(e,n++,t.value,t)})},t(Ft,J),Ft.prototype.has=function(e){return this._iter.includes(e)},Ft.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){return e(t,t,r)},t)},Ft.prototype.__iterator=function(e,t){var r=this._iter.__iterator(R,t);return new k(function(){var t=r.next();return t.done?t:B(e,t.value,t.value,t)})},t(Ut,q),Ut.prototype.entrySeq=function(){return this._iter.toSeq()},Ut.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){if(t){Qt(t);var n=a(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}},t)},Ut.prototype.__iterator=function(e,t){var r=this._iter.__iterator(R,t);return new k(function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){Qt(n);var i=a(n);return B(e,i?n.get(0):n[0],i?n.get(1):n[1],t)}}})},Dt.prototype.cacheResult=It.prototype.cacheResult=Ft.prototype.cacheResult=Ut.prototype.cacheResult=er,t(nr,xe),nr.prototype.toString=function(){return this.__toString(ar(this)+" {","}")},nr.prototype.has=function(e){return this._defaultValues.hasOwnProperty(e)},nr.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._defaultValues[e];return this._map?this._map.get(e,r):r},nr.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var e=this.constructor;return e._empty||(e._empty=or(this,Ke()))},nr.prototype.set=function(e,t){if(!this.has(e))throw new Error('Cannot set unknown key "'+e+'" on '+ar(this));if(this._map&&!this._map.has(e)){var r=this._defaultValues[e];if(t===r)return this}var n=this._map&&this._map.set(e,t);return this.__ownerID||n===this._map?this:or(this,n)},nr.prototype.remove=function(e){if(!this.has(e))return this;var t=this._map&&this._map.remove(e);return this.__ownerID||t===this._map?this:or(this,t)},nr.prototype.wasAltered=function(){return this._map.wasAltered()},nr.prototype.__iterator=function(e,t){var r=this;return n(this._defaultValues).map(function(e,t){return r.get(t)}).__iterator(e,t)},nr.prototype.__iterate=function(e,t){var r=this;return n(this._defaultValues).map(function(e,t){return r.get(t)}).__iterate(e,t)},nr.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map&&this._map.__ensureOwner(e);return e?or(this,t,e):(this.__ownerID=e,this._map=t,this)};var ir=nr.prototype;function or(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._map=t,n.__ownerID=r,n}function ar(e){return e._name||e.constructor.name||"Record"}function sr(e){return null===e||void 0===e?pr():cr(e)&&!l(e)?e:pr().withMutations(function(t){var r=o(e);Ue(r.size),r.forEach(function(e){return t.add(e)})})}function cr(e){return!(!e||!e[lr])}ir.delete=ir.remove,ir.deleteIn=ir.removeIn=Ve.removeIn,ir.merge=Ve.merge,ir.mergeWith=Ve.mergeWith,ir.mergeIn=Ve.mergeIn,ir.mergeDeep=Ve.mergeDeep,ir.mergeDeepWith=Ve.mergeDeepWith,ir.mergeDeepIn=Ve.mergeDeepIn,ir.setIn=Ve.setIn,ir.update=Ve.update,ir.updateIn=Ve.updateIn,ir.withMutations=Ve.withMutations,ir.asMutable=Ve.asMutable,ir.asImmutable=Ve.asImmutable,t(sr,_e),sr.of=function(){return this(arguments)},sr.fromKeys=function(e){return this(n(e).keySeq())},sr.prototype.toString=function(){return this.__toString("Set {","}")},sr.prototype.has=function(e){return this._map.has(e)},sr.prototype.add=function(e){return dr(this,this._map.set(e,!0))},sr.prototype.remove=function(e){return dr(this,this._map.remove(e))},sr.prototype.clear=function(){return dr(this,this._map.clear())},sr.prototype.union=function(){var t=e.call(arguments,0);return 0===(t=t.filter(function(e){return 0!==e.size})).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(e){for(var r=0;r<t.length;r++)o(t[r]).forEach(function(t){return e.add(t)})}):this.constructor(t[0])},sr.prototype.intersect=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map(function(e){return o(e)});var r=this;return this.withMutations(function(e){r.forEach(function(r){t.every(function(e){return e.includes(r)})||e.remove(r)})})},sr.prototype.subtract=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map(function(e){return o(e)});var r=this;return this.withMutations(function(e){r.forEach(function(r){t.some(function(e){return e.includes(r)})&&e.remove(r)})})},sr.prototype.merge=function(){return this.union.apply(this,arguments)},sr.prototype.mergeWith=function(t){var r=e.call(arguments,1);return this.union.apply(this,r)},sr.prototype.sort=function(e){return mr(Ht(this,e))},sr.prototype.sortBy=function(e,t){return mr(Ht(this,t,e))},sr.prototype.wasAltered=function(){return this._map.wasAltered()},sr.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate(function(t,n){return e(n,n,r)},t)},sr.prototype.__iterator=function(e,t){return this._map.map(function(e,t){return t}).__iterator(e,t)},sr.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):(this.__ownerID=e,this._map=t,this)},sr.isSet=cr;var ur,lr="@@__IMMUTABLE_SET__@@",hr=sr.prototype;function dr(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function fr(e,t){var r=Object.create(hr);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function pr(){return ur||(ur=fr(Ke()))}function mr(e){return null===e||void 0===e?xr():vr(e)?e:xr().withMutations(function(t){var r=o(e);Ue(r.size),r.forEach(function(e){return t.add(e)})})}function vr(e){return cr(e)&&l(e)}hr[lr]=!0,hr.delete=hr.remove,hr.mergeDeep=hr.merge,hr.mergeDeepWith=hr.mergeWith,hr.withMutations=Ve.withMutations,hr.asMutable=Ve.asMutable,hr.asImmutable=Ve.asImmutable,hr.__empty=pr,hr.__make=fr,t(mr,sr),mr.of=function(){return this(arguments)},mr.fromKeys=function(e){return this(n(e).keySeq())},mr.prototype.toString=function(){return this.__toString("OrderedSet {","}")},mr.isOrderedSet=vr;var gr,yr=mr.prototype;function br(e,t){var r=Object.create(yr);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function xr(){return gr||(gr=br(Nt()))}function wr(e){return null===e||void 0===e?Er():_r(e)?e:Er().unshiftAll(e)}function _r(e){return!(!e||!e[Mr])}yr[p]=!0,yr.__empty=xr,yr.__make=br,t(wr,we),wr.of=function(){return this(arguments)},wr.prototype.toString=function(){return this.__toString("Stack [","]")},wr.prototype.get=function(e,t){var r=this._head;for(e=A(this,e);r&&e--;)r=r.next;return r?r.value:t},wr.prototype.peek=function(){return this._head&&this._head.value},wr.prototype.push=function(){if(0===arguments.length)return this;for(var e=this.size+arguments.length,t=this._head,r=arguments.length-1;r>=0;r--)t={value:arguments[r],next:t};return this.__ownerID?(this.size=e,this._head=t,this.__hash=void 0,this.__altered=!0,this):Ar(e,t)},wr.prototype.pushAll=function(e){if(0===(e=i(e)).size)return this;Ue(e.size);var t=this.size,r=this._head;return e.reverse().forEach(function(e){t++,r={value:e,next:r}}),this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):Ar(t,r)},wr.prototype.pop=function(){return this.slice(1)},wr.prototype.unshift=function(){return this.push.apply(this,arguments)},wr.prototype.unshiftAll=function(e){return this.pushAll(e)},wr.prototype.shift=function(){return this.pop.apply(this,arguments)},wr.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Er()},wr.prototype.slice=function(e,t){if(C(e,t,this.size))return this;var r=L(e,this.size),n=P(t,this.size);if(n!==this.size)return we.prototype.slice.call(this,e,t);for(var i=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Ar(i,o)},wr.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Ar(this.size,this._head,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},wr.prototype.__iterate=function(e,t){if(t)return this.reverse().__iterate(e);for(var r=0,n=this._head;n&&!1!==e(n.value,r++,this);)n=n.next;return r},wr.prototype.__iterator=function(e,t){if(t)return this.reverse().__iterator(e);var r=0,n=this._head;return new k(function(){if(n){var t=n.value;return n=n.next,B(e,r++,t)}return{value:void 0,done:!0}})},wr.isStack=_r;var Sr,Mr="@@__IMMUTABLE_STACK__@@",Tr=wr.prototype;function Ar(e,t,r,n){var i=Object.create(Tr);return i.size=e,i._head=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Er(){return Sr||(Sr=Ar(0))}function Cr(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}Tr[Mr]=!0,Tr.withMutations=Ve.withMutations,Tr.asMutable=Ve.asMutable,Tr.asImmutable=Ve.asImmutable,Tr.wasAltered=Ve.wasAltered,r.Iterator=k,Cr(r,{toArray:function(){Ue(this.size);var e=new Array(this.size||0);return this.valueSeq().__iterate(function(t,r){e[r]=t}),e},toIndexedSeq:function(){return new Dt(this)},toJS:function(){return this.toSeq().map(function(e){return e&&"function"==typeof e.toJS?e.toJS():e}).__toJS()},toJSON:function(){return this.toSeq().map(function(e){return e&&"function"==typeof e.toJSON?e.toJSON():e}).__toJS()},toKeyedSeq:function(){return new It(this,!0)},toMap:function(){return ke(this.toKeyedSeq())},toObject:function(){Ue(this.size);var e={};return this.__iterate(function(t,r){e[r]=t}),e},toOrderedMap:function(){return Lt(this.toKeyedSeq())},toOrderedSet:function(){return mr(s(this)?this.valueSeq():this)},toSet:function(){return sr(s(this)?this.valueSeq():this)},toSetSeq:function(){return new Ft(this)},toSeq:function(){return c(this)?this.toIndexedSeq():s(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return wr(s(this)?this.valueSeq():this)},toList:function(){return dt(s(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){var t=e.call(arguments,0);return Jt(this,function(e,t){var r=s(e),i=[e].concat(t).map(function(e){return a(e)?r&&(e=n(e)):e=r?ae(e):se(Array.isArray(e)?e:[e]),e}).filter(function(e){return 0!==e.size});if(0===i.length)return e;if(1===i.length){var o=i[0];if(o===e||r&&s(o)||c(e)&&c(o))return o}var u=new ee(i);return r?u=u.toKeyedSeq():c(e)||(u=u.toSetSeq()),(u=u.flatten(!0)).size=i.reduce(function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}},0),u}(this,t))},includes:function(e){return this.some(function(t){return pe(t,e)})},entries:function(){return this.__iterator(I)},every:function(e,t){Ue(this.size);var r=!0;return this.__iterate(function(n,i,o){if(!e.call(t,n,i,o))return r=!1,!1}),r},filter:function(e,t){return Jt(this,jt(this,e,t,!0))},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},forEach:function(e,t){return Ue(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){Ue(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate(function(n){r?r=!1:t+=e,t+=null!==n&&void 0!==n?n.toString():""}),t},keys:function(){return this.__iterator(N)},map:function(e,t){return Jt(this,Bt(this,e,t))},reduce:function(e,t,r){var n,i;return Ue(this.size),arguments.length<2?i=!0:n=t,this.__iterate(function(t,o,a){i?(i=!1,n=t):n=e.call(r,n,t,o,a)}),n},reduceRight:function(e,t,r){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return Jt(this,zt(this,!0))},slice:function(e,t){return Jt(this,Vt(this,e,t,!0))},some:function(e,t){return!this.every(Rr(e),t)},sort:function(e){return Jt(this,Ht(this,e))},values:function(){return this.__iterator(R)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(e,t){return T(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return function(e,t,r){var n=ke().asMutable();return e.__iterate(function(i,o){n.update(t.call(r,i,o,e),0,function(e){return e+1})}),n.asImmutable()}(this,e,t)},equals:function(e){return me(this,e)},entrySeq:function(){var e=this;if(e._cache)return new ee(e._cache);var t=e.toSeq().map(Nr).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(Rr(e),t)},findEntry:function(e,t,r){var n=r;return this.__iterate(function(r,i,o){if(e.call(t,r,i,o))return n=[i,r],!1}),n},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},findLastEntry:function(e,t,r){return this.toKeyedSeq().reverse().findEntry(e,t,r)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(){return this.find(E)},flatMap:function(e,t){return Jt(this,function(e,t,r){var n=Kt(e);return e.toSeq().map(function(i,o){return n(t.call(r,i,o,e))}).flatten(!0)}(this,e,t))},flatten:function(e){return Jt(this,Wt(this,e,!0))},fromEntrySeq:function(){return new Ut(this)},get:function(e,t){return this.find(function(t,r){return pe(r,e)},void 0,t)},getIn:function(e,t){for(var r,n=this,i=rr(e);!(r=i.next()).done;){var o=r.value;if((n=n&&n.get?n.get(o,y):y)===y)return t}return n},groupBy:function(e,t){return function(e,t,r){var n=s(e),i=(l(e)?Lt():ke()).asMutable();e.__iterate(function(o,a){i.update(t.call(r,o,a,e),function(e){return(e=e||[]).push(n?[a,o]:o),e})});var o=Kt(e);return i.map(function(t){return Jt(e,o(t))})}(this,e,t)},has:function(e){return this.get(e,y)!==y},hasIn:function(e){return this.getIn(e,y)!==y},isSubset:function(e){return e="function"==typeof e.includes?e:r(e),this.every(function(t){return e.includes(t)})},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:r(e)).isSubset(this)},keyOf:function(e){return this.findKey(function(t){return pe(t,e)})},keySeq:function(){return this.toSeq().map(Or).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return Xt(this,e)},maxBy:function(e,t){return Xt(this,t,e)},min:function(e){return Xt(this,e?Ir(e):Ur)},minBy:function(e,t){return Xt(this,t?Ir(t):Ur,e)},rest:function(){return this.slice(1)},skip:function(e){return this.slice(Math.max(0,e))},skipLast:function(e){return Jt(this,this.toSeq().reverse().skip(e).reverse())},skipWhile:function(e,t){return Jt(this,Gt(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(Rr(e),t)},sortBy:function(e,t){return Jt(this,Ht(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return Jt(this,this.toSeq().reverse().take(e).reverse())},takeWhile:function(e,t){return Jt(this,function(e,t,r){var n=$t(e);return n.__iterateUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterate(n,i);var a=0;return e.__iterate(function(e,i,s){return t.call(r,e,i,s)&&++a&&n(e,i,o)}),a},n.__iteratorUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterator(n,i);var a=e.__iterator(I,i),s=!0;return new k(function(){if(!s)return{value:void 0,done:!0};var e=a.next();if(e.done)return e;var i=e.value,c=i[0],u=i[1];return t.call(r,u,c,o)?n===I?e:B(n,c,u,e):(s=!1,{value:void 0,done:!0})})},n}(this,e,t))},takeUntil:function(e,t){return this.takeWhile(Rr(e),t)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t=l(e),r=s(e),n=t?1:0;return function(e,t){return t=Se(t,3432918353),t=Se(t<<15|t>>>-15,461845907),t=Se(t<<13|t>>>-13,5),t=Se((t=(t+3864292196|0)^e)^t>>>16,2246822507),t=Me((t=Se(t^t>>>13,3266489909))^t>>>16)}(e.__iterate(r?t?function(e,t){n=31*n+kr(Te(e),Te(t))|0}:function(e,t){n=n+kr(Te(e),Te(t))|0}:t?function(e){n=31*n+Te(e)|0}:function(e){n=n+Te(e)|0}),n)}(this))}});var Lr=r.prototype;Lr[h]=!0,Lr[U]=Lr.values,Lr.__toJS=Lr.toArray,Lr.__toStringMapper=Dr,Lr.inspect=Lr.toSource=function(){return this.toString()},Lr.chain=Lr.flatMap,Lr.contains=Lr.includes,Cr(n,{flip:function(){return Jt(this,kt(this))},mapEntries:function(e,t){var r=this,n=0;return Jt(this,this.toSeq().map(function(i,o){return e.call(t,[o,i],n++,r)}).fromEntrySeq())},mapKeys:function(e,t){var r=this;return Jt(this,this.toSeq().flip().map(function(n,i){return e.call(t,n,i,r)}).flip())}});var Pr=n.prototype;function Or(e,t){return t}function Nr(e,t){return[t,e]}function Rr(e){return function(){return!e.apply(this,arguments)}}function Ir(e){return function(){return-e.apply(this,arguments)}}function Dr(e){return"string"==typeof e?JSON.stringify(e):String(e)}function Fr(){return M(arguments)}function Ur(e,t){return e<t?1:e>t?-1:0}function kr(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}return Pr[d]=!0,Pr[U]=Lr.entries,Pr.__toJS=Lr.toObject,Pr.__toStringMapper=function(e,t){return JSON.stringify(t)+": "+Dr(e)},Cr(i,{toKeyedSeq:function(){return new It(this,!1)},filter:function(e,t){return Jt(this,jt(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return Jt(this,zt(this,!1))},slice:function(e,t){return Jt(this,Vt(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(0|t,0),0===r||2===r&&!t)return this;e=L(e,e<0?this.count():this.size);var n=this.slice(0,e);return Jt(this,1===r?n:n.concat(M(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.findLastEntry(e,t);return r?r[0]:-1},first:function(){return this.get(0)},flatten:function(e){return Jt(this,Wt(this,e,!1))},get:function(e,t){return(e=A(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find(function(t,r){return r===e},void 0,t)},has:function(e){return(e=A(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return Jt(this,function(e,t){var r=$t(e);return r.size=e.size&&2*e.size-1,r.__iterateUncached=function(r,n){var i=this,o=0;return e.__iterate(function(e,n){return(!o||!1!==r(t,o++,i))&&!1!==r(e,o++,i)},n),o},r.__iteratorUncached=function(r,n){var i,o=e.__iterator(R,n),a=0;return new k(function(){return(!i||a%2)&&(i=o.next()).done?i:a%2?B(r,a++,t):B(r,a++,i.value,i)})},r}(this,e))},interleave:function(){var e=[this].concat(M(arguments)),t=Yt(this.toSeq(),Y.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),Jt(this,r)},keySeq:function(){return ye(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(e,t){return Jt(this,Gt(this,e,t,!1))},zip:function(){return Jt(this,Yt(this,Fr,[this].concat(M(arguments))))},zipWith:function(e){var t=M(arguments);return t[0]=this,Jt(this,Yt(this,e,t))}}),i.prototype[f]=!0,i.prototype[p]=!0,Cr(o,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),o.prototype.has=Lr.includes,o.prototype.contains=o.prototype.includes,Cr(q,n.prototype),Cr(Y,i.prototype),Cr(J,o.prototype),Cr(xe,n.prototype),Cr(we,i.prototype),Cr(_e,o.prototype),{Iterable:r,Seq:X,Collection:be,Map:ke,OrderedMap:Lt,List:dt,Stack:wr,Set:sr,OrderedSet:mr,Record:nr,Range:ye,Repeat:ve,is:pe,fromJS:he}}()},"5692bffd717498245e82":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=l(r("49a47d064cfbf2949ee5")),o=l(r("6a4f9c383785f9168266")),a=l(r("8af190b70a6bc55c6f1b")),s=l(r("8a2d1b95e05b6a321e74")),c=r("12ba4fef039ee145f0aa"),u=l(r("07a2173bac8ab93c3080"));function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){return"/"===e.charAt(0)?e:"/"+e},f=function(e,t){return e?n({},t,{pathname:d(e)+t.pathname}):t},p=function(e){return"string"==typeof e?e:(0,c.createPath)(e)},m=function(e){return function(){(0,o.default)(!1,"You cannot %s with <StaticRouter>",e)}},v=function(){},g=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=h(this,e.call.apply(e,[this].concat(o))),n.createHref=function(e){return d(n.props.basename+p(e))},n.handlePush=function(e){var t=n.props,r=t.basename,i=t.context;i.action="PUSH",i.location=f(r,(0,c.createLocation)(e)),i.url=p(i.location)},n.handleReplace=function(e){var t=n.props,r=t.basename,i=t.context;i.action="REPLACE",i.location=f(r,(0,c.createLocation)(e)),i.url=p(i.location)},n.handleListen=function(){return v},n.handleBlock=function(){return v},h(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:{staticContext:this.props.context}}},t.prototype.componentWillMount=function(){(0,i.default)(!this.props.history,"<StaticRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { StaticRouter as Router }`.")},t.prototype.render=function(){var e=this.props,t=e.basename,r=(e.context,e.location),i=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["basename","context","location"]),o={createHref:this.createHref,action:"POP",location:function(e,t){if(!e)return t;var r=d(e);return 0!==t.pathname.indexOf(r)?t:n({},t,{pathname:t.pathname.substr(r.length)})}(t,(0,c.createLocation)(r)),push:this.handlePush,replace:this.handleReplace,go:m("go"),goBack:m("goBack"),goForward:m("goForward"),listen:this.handleListen,block:this.handleBlock};return a.default.createElement(u.default,n({},i,{history:o}))},t}(a.default.Component);g.propTypes={basename:s.default.string,context:s.default.object.isRequired,location:s.default.oneOfType([s.default.string,s.default.object])},g.defaultProps={basename:"",location:"/"},g.childContextTypes={router:s.default.object.isRequired},t.default=g},"56b82ba00e9aa7744555":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}})},"56ca38cb7a1b85e3b391":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7ae46632a49db7ab2ae0");n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},"56f612169e8c0cac4c0c":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("d7d78b23c2948e92a9a9"));var i={},o=0;t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];"string"==typeof t&&(t={path:t});var a=t,s=a.path,c=a.exact,u=void 0!==c&&c,l=a.strict,h=void 0!==l&&l,d=a.sensitive,f=void 0!==d&&d;if(null==s)return r;var p=function(e,t){var r=""+t.end+t.strict+t.sensitive,a=i[r]||(i[r]={});if(a[e])return a[e];var s=[],c={re:(0,n.default)(e,s,t),keys:s};return o<1e4&&(a[e]=c,o++),c}(s,{end:u,strict:h,sensitive:f}),m=p.re,v=p.keys,g=m.exec(e);if(!g)return null;var y=g[0],b=g.slice(1),x=e===y;return u&&!x?null:{path:s,url:"/"===s&&""===y?"/":y,isExact:x,params:v.reduce(function(e,t,r){return e[t.name]=b[r],e},{})}}},"5712f1b9446531a0f3b8":function(e,t,r){"use strict";
/** @license React v16.4.1
 * react-dom.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r("277cfc1331526160cbd4"),i=r("8af190b70a6bc55c6f1b"),o=r("7c757e9b280b4a302846"),a=r("83406643bfb209d249f4"),s=r("ec9de96ce27c00ac79c5"),c=r("f7ee588e96ed47a6425e"),u=r("57f97042002e57c90c3d"),l=r("5e294ff5186056b35d02"),h=r("bef911c5daed007bb174");function d(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=0;i<t;i++)r+="&args[]="+encodeURIComponent(arguments[i+1]);n(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}i||d("227");var f={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,invokeGuardedCallback:function(e,t,r,n,i,o,a,s,c){(function(e,t,r,n,i,o,a,s,c){this._hasCaughtError=!1,this._caughtError=null;var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(e){this._caughtError=e,this._hasCaughtError=!0}}).apply(f,arguments)},invokeGuardedCallbackAndCatchFirstError:function(e,t,r,n,i,o,a,s,c){if(f.invokeGuardedCallback.apply(this,arguments),f.hasCaughtError()){var u=f.clearCaughtError();f._hasRethrowError||(f._hasRethrowError=!0,f._rethrowError=u)}},rethrowCaughtError:function(){return function(){if(f._hasRethrowError){var e=f._rethrowError;throw f._rethrowError=null,f._hasRethrowError=!1,e}}.apply(f,arguments)},hasCaughtError:function(){return f._hasCaughtError},clearCaughtError:function(){if(f._hasCaughtError){var e=f._caughtError;return f._caughtError=null,f._hasCaughtError=!1,e}d("198")}};var p=null,m={};function v(){if(p)for(var e in m){var t=m[e],r=p.indexOf(e);if(-1<r||d("96",e),!y[r])for(var n in t.extractEvents||d("97",e),y[r]=t,r=t.eventTypes){var i=void 0,o=r[n],a=t,s=n;b.hasOwnProperty(s)&&d("99",s),b[s]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&g(c[i],a,s);i=!0}else o.registrationName?(g(o.registrationName,a,s),i=!0):i=!1;i||d("98",n,e)}}}function g(e,t,r){x[e]&&d("100",e),x[e]=t,w[e]=t.eventTypes[r].dependencies}var y=[],b={},x={},w={};function _(e){p&&d("101"),p=Array.prototype.slice.call(e),v()}function S(e){var t,r=!1;for(t in e)if(e.hasOwnProperty(t)){var n=e[t];m.hasOwnProperty(t)&&m[t]===n||(m[t]&&d("102",t),m[t]=n,r=!0)}r&&v()}var M={plugins:y,eventNameDispatchConfigs:b,registrationNameModules:x,registrationNameDependencies:w,possibleRegistrationNames:null,injectEventPluginOrder:_,injectEventPluginsByName:S},T=null,A=null,E=null;function C(e,t,r,n){t=e.type||"unknown-event",e.currentTarget=E(n),f.invokeGuardedCallbackAndCatchFirstError(t,r,void 0,e),e.currentTarget=null}function L(e,t){return null==t&&d("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function P(e,t,r){Array.isArray(e)?e.forEach(t,r):e&&t.call(r,e)}var O=null;function N(e,t){if(e){var r=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(r))for(var i=0;i<r.length&&!e.isPropagationStopped();i++)C(e,t,r[i],n[i]);else r&&C(e,t,r,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function R(e){return N(e,!0)}function I(e){return N(e,!1)}var D={injectEventPluginOrder:_,injectEventPluginsByName:S};function F(e,t){var r=e.stateNode;if(!r)return null;var n=T(r);if(!n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}return e?null:(r&&"function"!=typeof r&&d("231",t,typeof r),r)}function U(e,t){null!==e&&(O=L(O,e)),e=O,O=null,e&&(P(e,t?R:I),O&&d("95"),f.rethrowCaughtError())}function k(e,t,r,n){for(var i=null,o=0;o<y.length;o++){var a=y[o];a&&(a=a.extractEvents(e,t,r,n))&&(i=L(i,a))}U(i,!1)}var B={injection:D,getListener:F,runEventsInBatch:U,runExtractedEventsInBatch:k},z=Math.random().toString(36).slice(2),j="__reactInternalInstance$"+z,V="__reactEventHandlers$"+z;function G(e){if(e[j])return e[j];for(;!e[j];){if(!e.parentNode)return null;e=e.parentNode}return 5===(e=e[j]).tag||6===e.tag?e:null}function W(e){if(5===e.tag||6===e.tag)return e.stateNode;d("33")}function H(e){return e[V]||null}var X={precacheFiberNode:function(e,t){t[j]=e},getClosestInstanceFromNode:G,getInstanceFromNode:function(e){return!(e=e[j])||5!==e.tag&&6!==e.tag?null:e},getNodeFromInstance:W,getFiberCurrentPropsFromNode:H,updateFiberProps:function(e,t){e[V]=t}};function q(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Y(e,t,r){for(var n=[];e;)n.push(e),e=q(e);for(e=n.length;0<e--;)t(n[e],"captured",r);for(e=0;e<n.length;e++)t(n[e],"bubbled",r)}function J(e,t,r){(t=F(e,r.dispatchConfig.phasedRegistrationNames[t]))&&(r._dispatchListeners=L(r._dispatchListeners,t),r._dispatchInstances=L(r._dispatchInstances,e))}function Q(e){e&&e.dispatchConfig.phasedRegistrationNames&&Y(e._targetInst,J,e)}function Z(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst;Y(t=t?q(t):null,J,e)}}function K(e,t,r){e&&r&&r.dispatchConfig.registrationName&&(t=F(e,r.dispatchConfig.registrationName))&&(r._dispatchListeners=L(r._dispatchListeners,t),r._dispatchInstances=L(r._dispatchInstances,e))}function $(e){e&&e.dispatchConfig.registrationName&&K(e._targetInst,null,e)}function ee(e){P(e,Q)}function te(e,t,r,n){if(r&&n)e:{for(var i=r,o=n,a=0,s=i;s;s=q(s))a++;s=0;for(var c=o;c;c=q(c))s++;for(;0<a-s;)i=q(i),a--;for(;0<s-a;)o=q(o),s--;for(;a--;){if(i===o||i===o.alternate)break e;i=q(i),o=q(o)}i=null}else i=null;for(o=i,i=[];r&&r!==o&&(null===(a=r.alternate)||a!==o);)i.push(r),r=q(r);for(r=[];n&&n!==o&&(null===(a=n.alternate)||a!==o);)r.push(n),n=q(n);for(n=0;n<i.length;n++)K(i[n],"bubbled",e);for(e=r.length;0<e--;)K(r[e],"captured",t)}var re={accumulateTwoPhaseDispatches:ee,accumulateTwoPhaseDispatchesSkipTarget:function(e){P(e,Z)},accumulateEnterLeaveDispatches:te,accumulateDirectDispatches:function(e){P(e,$)}};function ne(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r["ms"+e]="MS"+t,r["O"+e]="o"+t.toLowerCase(),r}var ie={animationend:ne("Animation","AnimationEnd"),animationiteration:ne("Animation","AnimationIteration"),animationstart:ne("Animation","AnimationStart"),transitionend:ne("Transition","TransitionEnd")},oe={},ae={};function se(e){if(oe[e])return oe[e];if(!ie[e])return e;var t,r=ie[e];for(t in r)if(r.hasOwnProperty(t)&&t in ae)return oe[e]=r[t];return e}o.canUseDOM&&(ae=document.createElement("div").style,"AnimationEvent"in window||(delete ie.animationend.animation,delete ie.animationiteration.animation,delete ie.animationstart.animation),"TransitionEvent"in window||delete ie.transitionend.transition);var ce=se("animationend"),ue=se("animationiteration"),le=se("animationstart"),he=se("transitionend"),de="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fe=null;function pe(){return!fe&&o.canUseDOM&&(fe="textContent"in document.documentElement?"textContent":"innerText"),fe}var me={_root:null,_startText:null,_fallbackText:null};function ve(){if(me._fallbackText)return me._fallbackText;var e,t,r=me._startText,n=r.length,i=ge(),o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[o-t];t++);return me._fallbackText=i.slice(e,1<t?1-t:void 0),me._fallbackText}function ge(){return"value"in me._root?me._root.value:me._root[pe()]}var ye="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),be={type:null,target:null,currentTarget:s.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};function xe(e,t,r,n){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=r,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(r):"target"===i?this.target=n:this[i]=r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?s.thatReturnsTrue:s.thatReturnsFalse,this.isPropagationStopped=s.thatReturnsFalse,this}function we(e,t,r,n){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,r,n),i}return new this(e,t,r,n)}function _e(e){e instanceof this||d("223"),e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Se(e){e.eventPool=[],e.getPooled=we,e.release=_e}a(xe.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=s.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=s.thatReturnsTrue)},persist:function(){this.isPersistent=s.thatReturnsTrue},isPersistent:s.thatReturnsFalse,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;for(t=0;t<ye.length;t++)this[ye[t]]=null}}),xe.Interface=be,xe.extend=function(e){function t(){}function r(){return n.apply(this,arguments)}var n=this;t.prototype=n.prototype;var i=new t;return a(i,r.prototype),r.prototype=i,r.prototype.constructor=r,r.Interface=a({},n.Interface,e),r.extend=n.extend,Se(r),r},Se(xe);var Me=xe.extend({data:null}),Te=xe.extend({data:null}),Ae=[9,13,27,32],Ee=o.canUseDOM&&"CompositionEvent"in window,Ce=null;o.canUseDOM&&"documentMode"in document&&(Ce=document.documentMode);var Le=o.canUseDOM&&"TextEvent"in window&&!Ce,Pe=o.canUseDOM&&(!Ee||Ce&&8<Ce&&11>=Ce),Oe=String.fromCharCode(32),Ne={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Re=!1;function Ie(e,t){switch(e){case"keyup":return-1!==Ae.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function De(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Fe=!1;var Ue={eventTypes:Ne,extractEvents:function(e,t,r,n){var i=void 0,o=void 0;if(Ee)e:{switch(e){case"compositionstart":i=Ne.compositionStart;break e;case"compositionend":i=Ne.compositionEnd;break e;case"compositionupdate":i=Ne.compositionUpdate;break e}i=void 0}else Fe?Ie(e,r)&&(i=Ne.compositionEnd):"keydown"===e&&229===r.keyCode&&(i=Ne.compositionStart);return i?(Pe&&(Fe||i!==Ne.compositionStart?i===Ne.compositionEnd&&Fe&&(o=ve()):(me._root=n,me._startText=ge(),Fe=!0)),i=Me.getPooled(i,t,r,n),o?i.data=o:null!==(o=De(r))&&(i.data=o),ee(i),o=i):o=null,(e=Le?function(e,t){switch(e){case"compositionend":return De(t);case"keypress":return 32!==t.which?null:(Re=!0,Oe);case"textInput":return(e=t.data)===Oe&&Re?null:e;default:return null}}(e,r):function(e,t){if(Fe)return"compositionend"===e||!Ee&&Ie(e,t)?(e=ve(),me._root=null,me._startText=null,me._fallbackText=null,Fe=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pe?null:t.data;default:return null}}(e,r))?((t=Te.getPooled(Ne.beforeInput,t,r,n)).data=e,ee(t)):t=null,null===o?t:null===t?o:[o,t]}},ke=null,Be={injectFiberControlledHostComponent:function(e){ke=e}},ze=null,je=null;function Ve(e){if(e=A(e)){ke&&"function"==typeof ke.restoreControlledState||d("194");var t=T(e.stateNode);ke.restoreControlledState(e.stateNode,e.type,t)}}function Ge(e){ze?je?je.push(e):je=[e]:ze=e}function We(){return null!==ze||null!==je}function He(){if(ze){var e=ze,t=je;if(je=ze=null,Ve(e),t)for(e=0;e<t.length;e++)Ve(t[e])}}var Xe={injection:Be,enqueueStateRestore:Ge,needsStateRestore:We,restoreStateIfNeeded:He};function qe(e,t){return e(t)}function Ye(e,t,r){return e(t,r)}function Je(){}var Qe=!1;function Ze(e,t){if(Qe)return e(t);Qe=!0;try{return qe(e,t)}finally{Qe=!1,We()&&(Je(),He())}}var Ke={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $e(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ke[e.type]:"textarea"===t}function et(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function tt(e,t){return!(!o.canUseDOM||t&&!("addEventListener"in document))&&((t=(e="on"+e)in document)||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t)}function rt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function nt(e){e._valueTracker||(e._valueTracker=function(e){var t=rt(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function it(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=rt(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}var ot=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,at="function"==typeof Symbol&&Symbol.for,st=at?Symbol.for("react.element"):60103,ct=at?Symbol.for("react.portal"):60106,ut=at?Symbol.for("react.fragment"):60107,lt=at?Symbol.for("react.strict_mode"):60108,ht=at?Symbol.for("react.profiler"):60114,dt=at?Symbol.for("react.provider"):60109,ft=at?Symbol.for("react.context"):60110,pt=at?Symbol.for("react.async_mode"):60111,mt=at?Symbol.for("react.forward_ref"):60112,vt=at?Symbol.for("react.timeout"):60113,gt="function"==typeof Symbol&&Symbol.iterator;function yt(e){return null===e||void 0===e?null:"function"==typeof(e=gt&&e[gt]||e["@@iterator"])?e:null}function bt(e){var t=e.type;if("function"==typeof t)return t.displayName||t.name;if("string"==typeof t)return t;switch(t){case pt:return"AsyncMode";case ft:return"Context.Consumer";case ut:return"ReactFragment";case ct:return"ReactPortal";case ht:return"Profiler("+e.pendingProps.id+")";case dt:return"Context.Provider";case lt:return"StrictMode";case vt:return"Timeout"}if("object"==typeof t&&null!==t)switch(t.$$typeof){case mt:return""!==(e=t.render.displayName||t.render.name||"")?"ForwardRef("+e+")":"ForwardRef"}return null}function xt(e){var t="";do{e:switch(e.tag){case 0:case 1:case 2:case 5:var r=e._debugOwner,n=e._debugSource,i=bt(e),o=null;r&&(o=bt(r)),r=n,i="\n    in "+(i||"Unknown")+(r?" (at "+r.fileName.replace(/^.*[\\\/]/,"")+":"+r.lineNumber+")":o?" (created by "+o+")":"");break e;default:i=""}t+=i,e=e.return}while(e);return t}var wt=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_t={},St={};function Mt(e,t,r,n,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Tt[e]=new Mt(e,0,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Tt[t]=new Mt(t,1,!1,e[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Tt[e]=new Mt(e,2,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","preserveAlpha"].forEach(function(e){Tt[e]=new Mt(e,2,!1,e,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Tt[e]=new Mt(e,3,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){Tt[e]=new Mt(e,3,!0,e.toLowerCase(),null)}),["capture","download"].forEach(function(e){Tt[e]=new Mt(e,4,!1,e.toLowerCase(),null)}),["cols","rows","size","span"].forEach(function(e){Tt[e]=new Mt(e,6,!1,e.toLowerCase(),null)}),["rowSpan","start"].forEach(function(e){Tt[e]=new Mt(e,5,!1,e.toLowerCase(),null)});var At=/[\-:]([a-z])/g;function Et(e){return e[1].toUpperCase()}function Ct(e,t,r,n){var i=Tt.hasOwnProperty(t)?Tt[t]:null;(null!==i?0===i.type:!n&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,r,n){if(null===t||void 0===t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!St.hasOwnProperty(e)||!_t.hasOwnProperty(e)&&(wt.test(e)?St[e]=!0:(_t[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}function Lt(e,t){var r=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Pt(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Dt(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Ot(e,t){null!=(t=t.checked)&&Ct(e,"checked",t,!1)}function Nt(e,t){Ot(e,t);var r=Dt(t.value);null!=r&&("number"===t.type?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r)),t.hasOwnProperty("value")?It(e,t.type,r):t.hasOwnProperty("defaultValue")&&It(e,t.type,Dt(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Rt(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){t=""+e._wrapperState.initialValue;var n=e.value;r||t===n||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!e.defaultChecked,""!==r&&(e.name=r)}function It(e,t,r){"number"===t&&e.ownerDocument.activeElement===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}function Dt(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(At,Et);Tt[t]=new Mt(t,1,!1,e,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(At,Et);Tt[t]=new Mt(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(At,Et);Tt[t]=new Mt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),Tt.tabIndex=new Mt("tabIndex",1,!1,"tabindex",null);var Ft={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Ut(e,t,r){return(e=xe.getPooled(Ft.change,e,t,r)).type="change",Ge(r),ee(e),e}var kt=null,Bt=null;function zt(e){U(e,!1)}function jt(e){if(it(W(e)))return e}function Vt(e,t){if("change"===e)return t}var Gt=!1;function Wt(){kt&&(kt.detachEvent("onpropertychange",Ht),Bt=kt=null)}function Ht(e){"value"===e.propertyName&&jt(Bt)&&Ze(zt,e=Ut(Bt,e,et(e)))}function Xt(e,t,r){"focus"===e?(Wt(),Bt=r,(kt=t).attachEvent("onpropertychange",Ht)):"blur"===e&&Wt()}function qt(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return jt(Bt)}function Yt(e,t){if("click"===e)return jt(t)}function Jt(e,t){if("input"===e||"change"===e)return jt(t)}o.canUseDOM&&(Gt=tt("input")&&(!document.documentMode||9<document.documentMode));var Qt={eventTypes:Ft,_isInputEventSupported:Gt,extractEvents:function(e,t,r,n){var i=t?W(t):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=Vt:$e(i)?Gt?o=Jt:(o=qt,a=Xt):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Yt),o&&(o=o(e,t)))return Ut(o,r,n);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&It(i,"number",i.value)}},Zt=xe.extend({view:null,detail:null}),Kt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $t(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Kt[e])&&!!t[e]}function er(){return $t}var tr=Zt.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:er,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)}}),rr=tr.extend({pointerId:null,width:null,height:null,pressure:null,tiltX:null,tiltY:null,pointerType:null,isPrimary:null}),nr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},ir={eventTypes:nr,extractEvents:function(e,t,r,n){var i="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(i&&(r.relatedTarget||r.fromElement)||!o&&!i)return null;if(i=n.window===n?n:(i=n.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=t,t=(t=r.relatedTarget||r.toElement)?G(t):null):o=null,o===t)return null;var a=void 0,s=void 0,c=void 0,u=void 0;return"mouseout"===e||"mouseover"===e?(a=tr,s=nr.mouseLeave,c=nr.mouseEnter,u="mouse"):"pointerout"!==e&&"pointerover"!==e||(a=rr,s=nr.pointerLeave,c=nr.pointerEnter,u="pointer"),e=null==o?i:W(o),i=null==t?i:W(t),(s=a.getPooled(s,o,r,n)).type=u+"leave",s.target=e,s.relatedTarget=i,(r=a.getPooled(c,t,r,n)).type=u+"enter",r.target=i,r.relatedTarget=e,te(s,r,o,t),[s,r]}};function or(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!=(2&t.effectTag))return 1;for(;t.return;)if(0!=(2&(t=t.return).effectTag))return 1}return 3===t.tag?2:3}function ar(e){2!==or(e)&&d("188")}function sr(e){var t=e.alternate;if(!t)return 3===(t=or(e))&&d("188"),1===t?null:e;for(var r=e,n=t;;){var i=r.return,o=i?i.alternate:null;if(!i||!o)break;if(i.child===o.child){for(var a=i.child;a;){if(a===r)return ar(i),e;if(a===n)return ar(i),t;a=a.sibling}d("188")}if(r.return!==n.return)r=i,n=o;else{a=!1;for(var s=i.child;s;){if(s===r){a=!0,r=i,n=o;break}if(s===n){a=!0,n=i,r=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===r){a=!0,r=o,n=i;break}if(s===n){a=!0,n=o,r=i;break}s=s.sibling}a||d("189")}}r.alternate!==n&&d("190")}return 3!==r.tag&&d("188"),r.stateNode.current===r?e:t}function cr(e){if(!(e=sr(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var ur=xe.extend({animationName:null,elapsedTime:null,pseudoElement:null}),lr=xe.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hr=Zt.extend({relatedTarget:null});function dr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var fr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr=Zt.extend({key:function(e){if(e.key){var t=fr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=dr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pr[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:er,charCode:function(e){return"keypress"===e.type?dr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?dr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),vr=tr.extend({dataTransfer:null}),gr=Zt.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:er}),yr=xe.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),br=tr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),xr=[["abort","abort"],[ce,"animationEnd"],[ue,"animationIteration"],[le,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[he,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],wr={},_r={};function Sr(e,t){var r=e[0],n="on"+((e=e[1])[0].toUpperCase()+e.slice(1));t={phasedRegistrationNames:{bubbled:n,captured:n+"Capture"},dependencies:[r],isInteractive:t},wr[e]=t,_r[r]=t}[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(e){Sr(e,!0)}),xr.forEach(function(e){Sr(e,!1)});var Mr={eventTypes:wr,isInteractiveTopLevelEventType:function(e){return void 0!==(e=_r[e])&&!0===e.isInteractive},extractEvents:function(e,t,r,n){var i=_r[e];if(!i)return null;switch(e){case"keypress":if(0===dr(r))return null;case"keydown":case"keyup":e=mr;break;case"blur":case"focus":e=hr;break;case"click":if(2===r.button)return null;case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=tr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=vr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=gr;break;case ce:case ue:case le:e=ur;break;case he:e=yr;break;case"scroll":e=Zt;break;case"wheel":e=br;break;case"copy":case"cut":case"paste":e=lr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=rr;break;default:e=xe}return ee(t=e.getPooled(i,t,r,n)),t}},Tr=Mr.isInteractiveTopLevelEventType,Ar=[];function Er(e){var t=e.targetInst;do{if(!t){e.ancestors.push(t);break}var r;for(r=t;r.return;)r=r.return;if(!(r=3!==r.tag?null:r.stateNode.containerInfo))break;e.ancestors.push(t),t=G(r)}while(t);for(r=0;r<e.ancestors.length;r++)t=e.ancestors[r],k(e.topLevelType,t,e.nativeEvent,et(e.nativeEvent))}var Cr=!0;function Lr(e){Cr=!!e}function Pr(e,t){if(!t)return null;var r=(Tr(e)?Nr:Rr).bind(null,e);t.addEventListener(e,r,!1)}function Or(e,t){if(!t)return null;var r=(Tr(e)?Nr:Rr).bind(null,e);t.addEventListener(e,r,!0)}function Nr(e,t){Ye(Rr,e,t)}function Rr(e,t){if(Cr){var r=et(t);if(null===(r=G(r))||"number"!=typeof r.tag||2===or(r)||(r=null),Ar.length){var n=Ar.pop();n.topLevelType=e,n.nativeEvent=t,n.targetInst=r,e=n}else e={topLevelType:e,nativeEvent:t,targetInst:r,ancestors:[]};try{Ze(Er,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>Ar.length&&Ar.push(e)}}}var Ir={get _enabled(){return Cr},setEnabled:Lr,isEnabled:function(){return Cr},trapBubbledEvent:Pr,trapCapturedEvent:Or,dispatchEvent:Rr},Dr={},Fr=0,Ur="_reactListenersID"+(""+Math.random()).slice(2);function kr(e){return Object.prototype.hasOwnProperty.call(e,Ur)||(e[Ur]=Fr++,Dr[e[Ur]]={}),Dr[e[Ur]]}function Br(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zr(e,t){var r,n=Br(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Br(n)}}function jr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var Vr=o.canUseDOM&&"documentMode"in document&&11>=document.documentMode,Gr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Wr=null,Hr=null,Xr=null,qr=!1;function Yr(e,t){if(qr||null==Wr||Wr!==c())return null;var r=Wr;return"selectionStart"in r&&jr(r)?r={start:r.selectionStart,end:r.selectionEnd}:window.getSelection?r={anchorNode:(r=window.getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}:r=void 0,Xr&&u(Xr,r)?null:(Xr=r,(e=xe.getPooled(Gr.select,Hr,e,t)).type="select",e.target=Wr,ee(e),e)}var Jr={eventTypes:Gr,extractEvents:function(e,t,r,n){var i,o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;if(!(i=!o)){e:{o=kr(o),i=w.onSelect;for(var a=0;a<i.length;a++){var s=i[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break e}}o=!0}i=!o}if(i)return null;switch(o=t?W(t):window,e){case"focus":($e(o)||"true"===o.contentEditable)&&(Wr=o,Hr=t,Xr=null);break;case"blur":Xr=Hr=Wr=null;break;case"mousedown":qr=!0;break;case"contextmenu":case"mouseup":return qr=!1,Yr(r,n);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return Yr(r,n)}return null}};D.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),T=X.getFiberCurrentPropsFromNode,A=X.getInstanceFromNode,E=X.getNodeFromInstance,D.injectEventPluginsByName({SimpleEventPlugin:Mr,EnterLeaveEventPlugin:ir,ChangeEventPlugin:Qt,SelectEventPlugin:Jr,BeforeInputEventPlugin:Ue});var Qr="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,Zr=Date,Kr=setTimeout,$r=clearTimeout,en=void 0;if("object"==typeof performance&&"function"==typeof performance.now){var tn=performance;en=function(){return tn.now()}}else en=function(){return Zr.now()};var rn=void 0,nn=void 0;if(o.canUseDOM){var on="function"==typeof Qr?Qr:function(){d("276")},an=null,sn=null,cn=-1,un=!1,ln=!1,hn=0,dn=33,fn=33,pn={didTimeout:!1,timeRemaining:function(){var e=hn-en();return 0<e?e:0}},mn=function(e,t){var r=e.scheduledCallback,n=!1;try{r(t),n=!0}finally{nn(e),n||(un=!0,window.postMessage(vn,"*"))}},vn="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){if(e.source===window&&e.data===vn&&(un=!1,null!==an)){if(null!==an){var t=en();if(!(-1===cn||cn>t)){e=-1;for(var r=[],n=an;null!==n;){var i=n.timeoutTime;-1!==i&&i<=t?r.push(n):-1!==i&&(-1===e||i<e)&&(e=i),n=n.next}if(0<r.length)for(pn.didTimeout=!0,t=0,n=r.length;t<n;t++)mn(r[t],pn);cn=e}}for(e=en();0<hn-e&&null!==an;)e=an,pn.didTimeout=!1,mn(e,pn),e=en();null===an||ln||(ln=!0,on(gn))}},!1);var gn=function(e){ln=!1;var t=e-hn+fn;t<fn&&dn<fn?(8>t&&(t=8),fn=t<dn?dn:t):dn=t,hn=e+fn,un||(un=!0,window.postMessage(vn,"*"))};rn=function(e,t){var r=-1;return null!=t&&"number"==typeof t.timeout&&(r=en()+t.timeout),(-1===cn||-1!==r&&r<cn)&&(cn=r),e={scheduledCallback:e,timeoutTime:r,prev:null,next:null},null===an?an=e:null!==(t=e.prev=sn)&&(t.next=e),sn=e,ln||(ln=!0,on(gn)),e},nn=function(e){if(null!==e.prev||an===e){var t=e.next,r=e.prev;e.next=null,e.prev=null,null!==t?null!==r?(r.next=t,t.prev=r):(t.prev=null,an=t):null!==r?(r.next=null,sn=r):sn=an=null}}}else{var yn=new Map;rn=function(e){var t={scheduledCallback:e,timeoutTime:0,next:null,prev:null},r=Kr(function(){e({timeRemaining:function(){return 1/0},didTimeout:!1})});return yn.set(e,r),t},nn=function(e){var t=yn.get(e.scheduledCallback);yn.delete(e),$r(t)}}function bn(e,t){return e=a({children:void 0},t),(t=function(e){var t="";return i.Children.forEach(e,function(e){null==e||"string"!=typeof e&&"number"!=typeof e||(t+=e)}),t}(t.children))&&(e.children=t),e}function xn(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+r,t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function wn(e,t){var r=t.value;e._wrapperState={initialValue:null!=r?r:t.defaultValue,wasMultiple:!!t.multiple}}function _n(e,t){return null!=t.dangerouslySetInnerHTML&&d("91"),a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Sn(e,t){var r=t.value;null==r&&(r=t.defaultValue,null!=(t=t.children)&&(null!=r&&d("92"),Array.isArray(t)&&(1>=t.length||d("93"),t=t[0]),r=""+t),null==r&&(r="")),e._wrapperState={initialValue:""+r}}function Mn(e,t){var r=t.value;null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&(e.defaultValue=r)),null!=t.defaultValue&&(e.defaultValue=t.defaultValue)}function Tn(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}var An={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function En(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cn(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?En(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Ln=void 0,Pn=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r)})}:e}(function(e,t){if(e.namespaceURI!==An.svg||"innerHTML"in e)e.innerHTML=t;else{for((Ln=Ln||document.createElement("div")).innerHTML="<svg>"+t+"</svg>",t=Ln.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function On(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var Nn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rn=["Webkit","ms","Moz","O"];function In(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=r,o=t[r];i=null==o||"boolean"==typeof o||""===o?"":n||"number"!=typeof o||0===o||Nn.hasOwnProperty(i)&&Nn[i]?(""+o).trim():o+"px","float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(Nn).forEach(function(e){Rn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Nn[t]=Nn[e]})});var Dn=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fn(e,t,r){t&&(Dn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&d("137",e,r()),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&d("60"),"object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||d("61")),null!=t.style&&"object"!=typeof t.style&&d("62",r()))}function Un(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kn=s.thatReturns("");function Bn(e,t){var r=kr(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=w[t];for(var n=0;n<t.length;n++){var i=t[n];if(!r.hasOwnProperty(i)||!r[i]){switch(i){case"scroll":Or("scroll",e);break;case"focus":case"blur":Or("focus",e),Or("blur",e),r.blur=!0,r.focus=!0;break;case"cancel":case"close":tt(i,!0)&&Or(i,e);break;case"invalid":case"submit":case"reset":break;default:-1===de.indexOf(i)&&Pr(i,e)}r[i]=!0}}}function zn(e,t,r,n){return r=9===r.nodeType?r:r.ownerDocument,n===An.html&&(n=En(e)),n===An.html?"script"===e?((e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):e="string"==typeof t.is?r.createElement(e,{is:t.is}):r.createElement(e):e=r.createElementNS(n,e),e}function jn(e,t){return(9===t.nodeType?t:t.ownerDocument).createTextNode(e)}function Vn(e,t,r,n){var i=Un(t,r);switch(t){case"iframe":case"object":Pr("load",e);var o=r;break;case"video":case"audio":for(o=0;o<de.length;o++)Pr(de[o],e);o=r;break;case"source":Pr("error",e),o=r;break;case"img":case"image":case"link":Pr("error",e),Pr("load",e),o=r;break;case"form":Pr("reset",e),Pr("submit",e),o=r;break;case"details":Pr("toggle",e),o=r;break;case"input":Pt(e,r),o=Lt(e,r),Pr("invalid",e),Bn(n,"onChange");break;case"option":o=bn(e,r);break;case"select":wn(e,r),o=a({},r,{value:void 0}),Pr("invalid",e),Bn(n,"onChange");break;case"textarea":Sn(e,r),o=_n(e,r),Pr("invalid",e),Bn(n,"onChange");break;default:o=r}Fn(t,o,kn);var c,u=o;for(c in u)if(u.hasOwnProperty(c)){var l=u[c];"style"===c?In(e,l):"dangerouslySetInnerHTML"===c?null!=(l=l?l.__html:void 0)&&Pn(e,l):"children"===c?"string"==typeof l?("textarea"!==t||""!==l)&&On(e,l):"number"==typeof l&&On(e,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(x.hasOwnProperty(c)?null!=l&&Bn(n,c):null!=l&&Ct(e,c,l,i))}switch(t){case"input":nt(e),Rt(e,r,!1);break;case"textarea":nt(e),Tn(e);break;case"option":null!=r.value&&e.setAttribute("value",r.value);break;case"select":e.multiple=!!r.multiple,null!=(t=r.value)?xn(e,!!r.multiple,t,!1):null!=r.defaultValue&&xn(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=s)}}function Gn(e,t,r,n,i){var o=null;switch(t){case"input":r=Lt(e,r),n=Lt(e,n),o=[];break;case"option":r=bn(e,r),n=bn(e,n),o=[];break;case"select":r=a({},r,{value:void 0}),n=a({},n,{value:void 0}),o=[];break;case"textarea":r=_n(e,r),n=_n(e,n),o=[];break;default:"function"!=typeof r.onClick&&"function"==typeof n.onClick&&(e.onclick=s)}Fn(t,n,kn),t=e=void 0;var c=null;for(e in r)if(!n.hasOwnProperty(e)&&r.hasOwnProperty(e)&&null!=r[e])if("style"===e){var u=r[e];for(t in u)u.hasOwnProperty(t)&&(c||(c={}),c[t]="")}else"dangerouslySetInnerHTML"!==e&&"children"!==e&&"suppressContentEditableWarning"!==e&&"suppressHydrationWarning"!==e&&"autoFocus"!==e&&(x.hasOwnProperty(e)?o||(o=[]):(o=o||[]).push(e,null));for(e in n){var l=n[e];if(u=null!=r?r[e]:void 0,n.hasOwnProperty(e)&&l!==u&&(null!=l||null!=u))if("style"===e)if(u){for(t in u)!u.hasOwnProperty(t)||l&&l.hasOwnProperty(t)||(c||(c={}),c[t]="");for(t in l)l.hasOwnProperty(t)&&u[t]!==l[t]&&(c||(c={}),c[t]=l[t])}else c||(o||(o=[]),o.push(e,c)),c=l;else"dangerouslySetInnerHTML"===e?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(o=o||[]).push(e,""+l)):"children"===e?u===l||"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(e,""+l):"suppressContentEditableWarning"!==e&&"suppressHydrationWarning"!==e&&(x.hasOwnProperty(e)?(null!=l&&Bn(i,e),o||u===l||(o=[])):(o=o||[]).push(e,l))}return c&&(o=o||[]).push("style",c),o}function Wn(e,t,r,n,i){"input"===r&&"radio"===i.type&&null!=i.name&&Ot(e,i),Un(r,n),n=Un(r,i);for(var o=0;o<t.length;o+=2){var a=t[o],s=t[o+1];"style"===a?In(e,s):"dangerouslySetInnerHTML"===a?Pn(e,s):"children"===a?On(e,s):Ct(e,a,s,n)}switch(r){case"input":Nt(e,i);break;case"textarea":Mn(e,i);break;case"select":e._wrapperState.initialValue=void 0,t=e._wrapperState.wasMultiple,e._wrapperState.wasMultiple=!!i.multiple,null!=(r=i.value)?xn(e,!!i.multiple,r,!1):t!==!!i.multiple&&(null!=i.defaultValue?xn(e,!!i.multiple,i.defaultValue,!0):xn(e,!!i.multiple,i.multiple?[]:"",!1))}}function Hn(e,t,r,n,i){switch(t){case"iframe":case"object":Pr("load",e);break;case"video":case"audio":for(n=0;n<de.length;n++)Pr(de[n],e);break;case"source":Pr("error",e);break;case"img":case"image":case"link":Pr("error",e),Pr("load",e);break;case"form":Pr("reset",e),Pr("submit",e);break;case"details":Pr("toggle",e);break;case"input":Pt(e,r),Pr("invalid",e),Bn(i,"onChange");break;case"select":wn(e,r),Pr("invalid",e),Bn(i,"onChange");break;case"textarea":Sn(e,r),Pr("invalid",e),Bn(i,"onChange")}for(var o in Fn(t,r,kn),n=null,r)if(r.hasOwnProperty(o)){var a=r[o];"children"===o?"string"==typeof a?e.textContent!==a&&(n=["children",a]):"number"==typeof a&&e.textContent!==""+a&&(n=["children",""+a]):x.hasOwnProperty(o)&&null!=a&&Bn(i,o)}switch(t){case"input":nt(e),Rt(e,r,!0);break;case"textarea":nt(e),Tn(e);break;case"select":case"option":break;default:"function"==typeof r.onClick&&(e.onclick=s)}return n}function Xn(e,t){return e.nodeValue!==t}var qn={createElement:zn,createTextNode:jn,setInitialProperties:Vn,diffProperties:Gn,updateProperties:Wn,diffHydratedProperties:Hn,diffHydratedText:Xn,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(e,t,r){switch(t){case"input":if(Nt(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=H(n);i||d("90"),it(n),Nt(n,i)}}}break;case"textarea":Mn(e,r);break;case"select":null!=(t=r.value)&&xn(e,!!r.multiple,t,!1)}}},Yn=null,Jn=null;function Qn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Zn(e,t){return"textarea"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&"string"==typeof t.dangerouslySetInnerHTML.__html}var Kn=en,$n=rn,ei=nn;function ti(e){for(e=e.nextSibling;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}function ri(e){for(e=e.firstChild;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}new Set;var ni=[],ii=-1;function oi(e){return{current:e}}function ai(e){0>ii||(e.current=ni[ii],ni[ii]=null,ii--)}function si(e,t){ni[++ii]=e.current,e.current=t}var ci=oi(h),ui=oi(!1),li=h;function hi(e){return fi(e)?li:ci.current}function di(e,t){var r=e.type.contextTypes;if(!r)return h;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function fi(e){return 2===e.tag&&null!=e.type.childContextTypes}function pi(e){fi(e)&&(ai(ui),ai(ci))}function mi(e){ai(ui),ai(ci)}function vi(e,t,r){ci.current!==h&&d("168"),si(ci,t),si(ui,r)}function gi(e,t){var r=e.stateNode,n=e.type.childContextTypes;if("function"!=typeof r.getChildContext)return t;for(var i in r=r.getChildContext())i in n||d("108",bt(e)||"Unknown",i);return a({},t,r)}function yi(e){if(!fi(e))return!1;var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||h,li=ci.current,si(ci,t),si(ui,ui.current),!0}function bi(e,t){var r=e.stateNode;if(r||d("169"),t){var n=gi(e,li);r.__reactInternalMemoizedMergedChildContext=n,ai(ui),ai(ci),si(ci,n)}else ai(ui);si(ui,t)}function xi(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=null,this.index=0,this.ref=null,this.pendingProps=t,this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.expirationTime=0,this.alternate=null}function wi(e,t,r){var n=e.alternate;return null===n?((n=new xi(e.tag,t,e.key,e.mode)).type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.expirationTime=r,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function _i(e,t,r){var n=e.type,i=e.key;if(e=e.props,"function"==typeof n)var o=n.prototype&&n.prototype.isReactComponent?2:0;else if("string"==typeof n)o=5;else switch(n){case ut:return Si(e.children,t,r,i);case pt:o=11,t|=3;break;case lt:o=11,t|=2;break;case ht:return(n=new xi(15,e,i,4|t)).type=ht,n.expirationTime=r,n;case vt:o=16,t|=2;break;default:e:{switch("object"==typeof n&&null!==n?n.$$typeof:null){case dt:o=13;break e;case ft:o=12;break e;case mt:o=14;break e;default:d("130",null==n?n:typeof n,"")}o=void 0}}return(t=new xi(o,e,i,t)).type=n,t.expirationTime=r,t}function Si(e,t,r,n){return(e=new xi(10,e,n,t)).expirationTime=r,e}function Mi(e,t,r){return(e=new xi(6,e,null,t)).expirationTime=r,e}function Ti(e,t,r){return(t=new xi(4,null!==e.children?e.children:[],e.key,t)).expirationTime=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ai(e,t,r){return e={current:t=new xi(3,null,null,t?3:0),containerInfo:e,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,pendingCommitExpirationTime:0,finishedWork:null,context:null,pendingContext:null,hydrate:r,remainingExpirationTime:0,firstBatch:null,nextScheduledRoot:null},t.stateNode=e}var Ei=null,Ci=null;function Li(e){return function(t){try{return e(t)}catch(e){}}}function Pi(e){"function"==typeof Ei&&Ei(e)}function Oi(e){"function"==typeof Ci&&Ci(e)}var Ni=!1;function Ri(e){return{expirationTime:0,baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Ii(e){return{expirationTime:e.expirationTime,baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Di(e){return{expirationTime:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Fi(e,t,r){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t),(0===e.expirationTime||e.expirationTime>r)&&(e.expirationTime=r)}function Ui(e,t,r){var n=e.alternate;if(null===n){var i=e.updateQueue,o=null;null===i&&(i=e.updateQueue=Ri(e.memoizedState))}else i=e.updateQueue,o=n.updateQueue,null===i?null===o?(i=e.updateQueue=Ri(e.memoizedState),o=n.updateQueue=Ri(n.memoizedState)):i=e.updateQueue=Ii(o):null===o&&(o=n.updateQueue=Ii(i));null===o||i===o?Fi(i,t,r):null===i.lastUpdate||null===o.lastUpdate?(Fi(i,t,r),Fi(o,t,r)):(Fi(i,t,r),o.lastUpdate=t)}function ki(e,t,r){var n=e.updateQueue;null===(n=null===n?e.updateQueue=Ri(e.memoizedState):Bi(e,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=t:(n.lastCapturedUpdate.next=t,n.lastCapturedUpdate=t),(0===n.expirationTime||n.expirationTime>r)&&(n.expirationTime=r)}function Bi(e,t){var r=e.alternate;return null!==r&&t===r.updateQueue&&(t=e.updateQueue=Ii(t)),t}function zi(e,t,r,n,i,o){switch(r.tag){case 1:return"function"==typeof(e=r.payload)?e.call(o,n,i):e;case 3:e.effectTag=-1025&e.effectTag|64;case 0:if(null===(i="function"==typeof(e=r.payload)?e.call(o,n,i):e)||void 0===i)break;return a({},n,i);case 2:Ni=!0}return n}function ji(e,t,r,n,i){if(Ni=!1,!(0===t.expirationTime||t.expirationTime>i)){for(var o=(t=Bi(e,t)).baseState,a=null,s=0,c=t.firstUpdate,u=o;null!==c;){var l=c.expirationTime;l>i?(null===a&&(a=c,o=u),(0===s||s>l)&&(s=l)):(u=zi(e,0,c,u,r,n),null!==c.callback&&(e.effectTag|=32,c.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=c:(t.lastEffect.nextEffect=c,t.lastEffect=c))),c=c.next}for(l=null,c=t.firstCapturedUpdate;null!==c;){var h=c.expirationTime;h>i?(null===l&&(l=c,null===a&&(o=u)),(0===s||s>h)&&(s=h)):(u=zi(e,0,c,u,r,n),null!==c.callback&&(e.effectTag|=32,c.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=c:(t.lastCapturedEffect.nextEffect=c,t.lastCapturedEffect=c))),c=c.next}null===a&&(t.lastUpdate=null),null===l?t.lastCapturedUpdate=null:e.effectTag|=32,null===a&&null===l&&(o=u),t.baseState=o,t.firstUpdate=a,t.firstCapturedUpdate=l,t.expirationTime=s,e.memoizedState=u}}function Vi(e,t){"function"!=typeof e&&d("191",e),e.call(t)}function Gi(e,t,r){for(null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),e=t.firstEffect,t.firstEffect=t.lastEffect=null;null!==e;){var n=e.callback;null!==n&&(e.callback=null,Vi(n,r)),e=e.nextEffect}for(e=t.firstCapturedEffect,t.firstCapturedEffect=t.lastCapturedEffect=null;null!==e;)null!==(t=e.callback)&&(e.callback=null,Vi(t,r)),e=e.nextEffect}function Wi(e,t){return{value:e,source:t,stack:xt(t)}}var Hi=oi(null),Xi=oi(null),qi=oi(0);function Yi(e){var t=e.type._context;si(qi,t._changedBits),si(Xi,t._currentValue),si(Hi,e),t._currentValue=e.pendingProps.value,t._changedBits=e.stateNode}function Ji(e){var t=qi.current,r=Xi.current;ai(Hi),ai(Xi),ai(qi),(e=e.type._context)._currentValue=r,e._changedBits=t}var Qi={},Zi=oi(Qi),Ki=oi(Qi),$i=oi(Qi);function eo(e){return e===Qi&&d("174"),e}function to(e,t){si($i,t),si(Ki,e),si(Zi,Qi);var r=t.nodeType;switch(r){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Cn(null,"");break;default:t=Cn(t=(r=8===r?t.parentNode:t).namespaceURI||null,r=r.tagName)}ai(Zi),si(Zi,t)}function ro(e){ai(Zi),ai(Ki),ai($i)}function no(e){Ki.current===e&&(ai(Zi),ai(Ki))}function io(e,t,r){var n=e.memoizedState;n=null===(t=t(r,n))||void 0===t?n:a({},n,t),e.memoizedState=n,null!==(e=e.updateQueue)&&0===e.expirationTime&&(e.baseState=n)}var oo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===or(e)},enqueueSetState:function(e,t,r){e=e._reactInternalFiber;var n=ya(),i=Di(n=va(n,e));i.payload=t,void 0!==r&&null!==r&&(i.callback=r),Ui(e,i,n),ga(e,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternalFiber;var n=ya(),i=Di(n=va(n,e));i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),Ui(e,i,n),ga(e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var r=ya(),n=Di(r=va(r,e));n.tag=2,void 0!==t&&null!==t&&(n.callback=t),Ui(e,n,r),ga(e,r)}};function ao(e,t,r,n,i,o){var a=e.stateNode;return e=e.type,"function"==typeof a.shouldComponentUpdate?a.shouldComponentUpdate(r,i,o):!e.prototype||!e.prototype.isPureReactComponent||(!u(t,r)||!u(n,i))}function so(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&oo.enqueueReplaceState(t,t.state,null)}function co(e,t){var r=e.type,n=e.stateNode,i=e.pendingProps,o=hi(e);n.props=i,n.state=e.memoizedState,n.refs=h,n.context=di(e,o),null!==(o=e.updateQueue)&&(ji(e,o,i,n,t),n.state=e.memoizedState),"function"==typeof(o=e.type.getDerivedStateFromProps)&&(io(e,o,i),n.state=e.memoizedState),"function"==typeof r.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(r=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),r!==n.state&&oo.enqueueReplaceState(n,n.state,null),null!==(o=e.updateQueue)&&(ji(e,o,i,n,t),n.state=e.memoizedState)),"function"==typeof n.componentDidMount&&(e.effectTag|=4)}var uo=Array.isArray;function lo(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){var n=void 0;(r=r._owner)&&(2!==r.tag&&d("110"),n=r.stateNode),n||d("147",e);var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=n.refs===h?n.refs={}:n.refs;null===e?delete t[i]:t[i]=e})._stringRef=i,t)}"string"!=typeof e&&d("148"),r._owner||d("254",e)}return e}function ho(e,t){"textarea"!==e.type&&d("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function fo(e){function t(t,r){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r,r.nextEffect=null,r.effectTag=8}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t,r){return(e=wi(e,t,r)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.effectTag=2,r):n:(t.effectTag=2,r):r}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function s(e,t,r,n){return null===t||6!==t.tag?((t=Mi(r,e.mode,n)).return=e,t):((t=i(t,r,n)).return=e,t)}function c(e,t,r,n){return null!==t&&t.type===r.type?((n=i(t,r.props,n)).ref=lo(e,t,r),n.return=e,n):((n=_i(r,e.mode,n)).ref=lo(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Ti(r,e.mode,n)).return=e,t):((t=i(t,r.children||[],n)).return=e,t)}function l(e,t,r,n,o){return null===t||10!==t.tag?((t=Si(r,e.mode,n,o)).return=e,t):((t=i(t,r,n)).return=e,t)}function h(e,t,r){if("string"==typeof t||"number"==typeof t)return(t=Mi(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case st:return(r=_i(t,e.mode,r)).ref=lo(e,null,t),r.return=e,r;case ct:return(t=Ti(t,e.mode,r)).return=e,t}if(uo(t)||yt(t))return(t=Si(t,e.mode,r,null)).return=e,t;ho(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r||"number"==typeof r)return null!==i?null:s(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case st:return r.key===i?r.type===ut?l(e,t,r.props.children,n,i):c(e,t,r,n):null;case ct:return r.key===i?u(e,t,r,n):null}if(uo(r)||yt(r))return null!==i?null:l(e,t,r,n,null);ho(e,r)}return null}function p(e,t,r,n,i){if("string"==typeof n||"number"==typeof n)return s(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case st:return e=e.get(null===n.key?r:n.key)||null,n.type===ut?l(t,e,n.props.children,i,n.key):c(t,e,n,i);case ct:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i)}if(uo(n)||yt(n))return l(t,e=e.get(r)||null,n,i,null);ho(t,n)}return null}function m(i,a,s,c){for(var u=null,l=null,d=a,m=a=0,v=null;null!==d&&m<s.length;m++){d.index>m?(v=d,d=null):v=d.sibling;var g=f(i,d,s[m],c);if(null===g){null===d&&(d=v);break}e&&d&&null===g.alternate&&t(i,d),a=o(g,a,m),null===l?u=g:l.sibling=g,l=g,d=v}if(m===s.length)return r(i,d),u;if(null===d){for(;m<s.length;m++)(d=h(i,s[m],c))&&(a=o(d,a,m),null===l?u=d:l.sibling=d,l=d);return u}for(d=n(i,d);m<s.length;m++)(v=p(d,i,m,s[m],c))&&(e&&null!==v.alternate&&d.delete(null===v.key?m:v.key),a=o(v,a,m),null===l?u=v:l.sibling=v,l=v);return e&&d.forEach(function(e){return t(i,e)}),u}function v(i,a,s,c){var u=yt(s);"function"!=typeof u&&d("150"),null==(s=u.call(s))&&d("151");for(var l=u=null,m=a,v=a=0,g=null,y=s.next();null!==m&&!y.done;v++,y=s.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=f(i,m,y.value,c);if(null===b){m||(m=g);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,v),null===l?u=b:l.sibling=b,l=b,m=g}if(y.done)return r(i,m),u;if(null===m){for(;!y.done;v++,y=s.next())null!==(y=h(i,y.value,c))&&(a=o(y,a,v),null===l?u=y:l.sibling=y,l=y);return u}for(m=n(i,m);!y.done;v++,y=s.next())null!==(y=p(m,i,v,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?v:y.key),a=o(y,a,v),null===l?u=y:l.sibling=y,l=y);return e&&m.forEach(function(e){return t(i,e)}),u}return function(e,n,o,s){var c="object"==typeof o&&null!==o&&o.type===ut&&null===o.key;c&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case st:e:{for(u=o.key,c=n;null!==c;){if(c.key===u){if(10===c.tag?o.type===ut:c.type===o.type){r(e,c.sibling),(n=i(c,o.type===ut?o.props.children:o.props,s)).ref=lo(e,c,o),n.return=e,e=n;break e}r(e,c);break}t(e,c),c=c.sibling}o.type===ut?((n=Si(o.props.children,e.mode,s,o.key)).return=e,e=n):((s=_i(o,e.mode,s)).ref=lo(e,n,o),s.return=e,e=s)}return a(e);case ct:e:{for(c=o.key;null!==n;){if(n.key===c){if(4===n.tag&&n.stateNode.containerInfo===o.containerInfo&&n.stateNode.implementation===o.implementation){r(e,n.sibling),(n=i(n,o.children||[],s)).return=e,e=n;break e}r(e,n);break}t(e,n),n=n.sibling}(n=Ti(o,e.mode,s)).return=e,e=n}return a(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==n&&6===n.tag?(r(e,n.sibling),(n=i(n,o,s)).return=e,e=n):(r(e,n),(n=Mi(o,e.mode,s)).return=e,e=n),a(e);if(uo(o))return m(e,n,o,s);if(yt(o))return v(e,n,o,s);if(u&&ho(e,o),void 0===o&&!c)switch(e.tag){case 2:case 1:d("152",(s=e.type).displayName||s.name||"Component")}return r(e,n)}}var po=fo(!0),mo=fo(!1),vo=null,go=null,yo=!1;function bo(e,t){var r=new xi(5,null,null,0);r.type="DELETED",r.stateNode=t,r.return=e,r.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r}function xo(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function wo(e){if(yo){var t=go;if(t){var r=t;if(!xo(e,t)){if(!(t=ti(r))||!xo(e,t))return e.effectTag|=2,yo=!1,void(vo=e);bo(vo,r)}vo=e,go=ri(t)}else e.effectTag|=2,yo=!1,vo=e}}function _o(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag;)e=e.return;vo=e}function So(e){if(e!==vo)return!1;if(!yo)return _o(e),yo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Zn(t,e.memoizedProps))for(t=go;t;)bo(e,t),t=ti(t);return _o(e),go=vo?ti(e.stateNode):null,!0}function Mo(){go=vo=null,yo=!1}function To(e,t,r){Ao(e,t,r,t.expirationTime)}function Ao(e,t,r,n){t.child=null===e?mo(t,null,r,n):po(t,e.child,r,n)}function Eo(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.effectTag|=128)}function Co(e,t,r,n,i){Eo(e,t);var o=0!=(64&t.effectTag);if(!r&&!o)return n&&bi(t,!1),Oo(e,t);r=t.stateNode,ot.current=t;var a=o?null:r.render();return t.effectTag|=1,o&&(Ao(e,t,null,i),t.child=null),Ao(e,t,a,i),t.memoizedState=r.state,t.memoizedProps=r.props,n&&bi(t,!0),t.child}function Lo(e){var t=e.stateNode;t.pendingContext?vi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vi(0,t.context,!1),to(e,t.containerInfo)}function Po(e,t,r,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){switch(i.tag){case 12:var o=0|i.stateNode;if(i.type===t&&0!=(o&r)){for(o=i;null!==o;){var a=o.alternate;if(0===o.expirationTime||o.expirationTime>n)o.expirationTime=n,null!==a&&(0===a.expirationTime||a.expirationTime>n)&&(a.expirationTime=n);else{if(null===a||!(0===a.expirationTime||a.expirationTime>n))break;a.expirationTime=n}o=o.return}o=null}else o=i.child;break;case 13:o=i.type===e.type?null:i.child;break;default:o=i.child}if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function Oo(e,t){if(null!==e&&t.child!==e.child&&d("153"),null!==t.child){var r=wi(e=t.child,e.pendingProps,e.expirationTime);for(t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=wi(e,e.pendingProps,e.expirationTime)).return=t;r.sibling=null}return t.child}function No(e,t,r){if(0===t.expirationTime||t.expirationTime>r){switch(t.tag){case 3:Lo(t);break;case 2:yi(t);break;case 4:to(t,t.stateNode.containerInfo);break;case 13:Yi(t)}return null}switch(t.tag){case 0:null!==e&&d("155");var n=t.type,i=t.pendingProps,o=hi(t);return n=n(i,o=di(t,o)),t.effectTag|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof?(o=t.type,t.tag=2,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,"function"==typeof(o=o.getDerivedStateFromProps)&&io(t,o,i),i=yi(t),n.updater=oo,t.stateNode=n,n._reactInternalFiber=t,co(t,r),e=Co(e,t,!0,i,r)):(t.tag=1,To(e,t,n),t.memoizedProps=i,e=t.child),e;case 1:return i=t.type,r=t.pendingProps,ui.current||t.memoizedProps!==r?(i=i(r,n=di(t,n=hi(t))),t.effectTag|=1,To(e,t,i),t.memoizedProps=r,e=t.child):e=Oo(e,t),e;case 2:if(i=yi(t),null===e)if(null===t.stateNode){var a=t.pendingProps,s=t.type;n=hi(t);var c=2===t.tag&&null!=t.type.contextTypes;a=new s(a,o=c?di(t,n):h),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=oo,t.stateNode=a,a._reactInternalFiber=t,c&&((c=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,c.__reactInternalMemoizedMaskedChildContext=o),co(t,r),n=!0}else{s=t.type,n=t.stateNode,c=t.memoizedProps,o=t.pendingProps,n.props=c;var u=n.context;a=di(t,a=hi(t));var l=s.getDerivedStateFromProps;(s="function"==typeof l||"function"==typeof n.getSnapshotBeforeUpdate)||"function"!=typeof n.UNSAFE_componentWillReceiveProps&&"function"!=typeof n.componentWillReceiveProps||(c!==o||u!==a)&&so(t,n,o,a),Ni=!1;var f=t.memoizedState;u=n.state=f;var p=t.updateQueue;null!==p&&(ji(t,p,o,n,r),u=t.memoizedState),c!==o||f!==u||ui.current||Ni?("function"==typeof l&&(io(t,l,o),u=t.memoizedState),(c=Ni||ao(t,c,o,f,u,a))?(s||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||("function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),"function"==typeof n.componentDidMount&&(t.effectTag|=4)):("function"==typeof n.componentDidMount&&(t.effectTag|=4),t.memoizedProps=o,t.memoizedState=u),n.props=o,n.state=u,n.context=a,n=c):("function"==typeof n.componentDidMount&&(t.effectTag|=4),n=!1)}else s=t.type,n=t.stateNode,o=t.memoizedProps,c=t.pendingProps,n.props=o,u=n.context,a=di(t,a=hi(t)),(s="function"==typeof(l=s.getDerivedStateFromProps)||"function"==typeof n.getSnapshotBeforeUpdate)||"function"!=typeof n.UNSAFE_componentWillReceiveProps&&"function"!=typeof n.componentWillReceiveProps||(o!==c||u!==a)&&so(t,n,c,a),Ni=!1,u=t.memoizedState,f=n.state=u,null!==(p=t.updateQueue)&&(ji(t,p,c,n,r),f=t.memoizedState),o!==c||u!==f||ui.current||Ni?("function"==typeof l&&(io(t,l,c),f=t.memoizedState),(l=Ni||ao(t,o,c,u,f,a))?(s||"function"!=typeof n.UNSAFE_componentWillUpdate&&"function"!=typeof n.componentWillUpdate||("function"==typeof n.componentWillUpdate&&n.componentWillUpdate(c,f,a),"function"==typeof n.UNSAFE_componentWillUpdate&&n.UNSAFE_componentWillUpdate(c,f,a)),"function"==typeof n.componentDidUpdate&&(t.effectTag|=4),"function"==typeof n.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof n.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=4),"function"!=typeof n.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=256),t.memoizedProps=c,t.memoizedState=f),n.props=c,n.state=f,n.context=a,n=l):("function"!=typeof n.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=4),"function"!=typeof n.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=256),n=!1);return Co(e,t,n,i,r);case 3:return Lo(t),null!==(i=t.updateQueue)?(n=null!==(n=t.memoizedState)?n.element:null,ji(t,i,t.pendingProps,null,r),(i=t.memoizedState.element)===n?(Mo(),e=Oo(e,t)):(n=t.stateNode,(n=(null===e||null===e.child)&&n.hydrate)&&(go=ri(t.stateNode.containerInfo),vo=t,n=yo=!0),n?(t.effectTag|=2,t.child=mo(t,null,i,r)):(Mo(),To(e,t,i)),e=t.child)):(Mo(),e=Oo(e,t)),e;case 5:return eo($i.current),(i=eo(Zi.current))!==(n=Cn(i,t.type))&&(si(Ki,t),si(Zi,n)),null===e&&wo(t),i=t.type,c=t.memoizedProps,n=t.pendingProps,o=null!==e?e.memoizedProps:null,ui.current||c!==n||((c=1&t.mode&&!!n.hidden)&&(t.expirationTime=1073741823),c&&1073741823===r)?(c=n.children,Zn(i,n)?c=null:o&&Zn(i,o)&&(t.effectTag|=16),Eo(e,t),1073741823!==r&&1&t.mode&&n.hidden?(t.expirationTime=1073741823,t.memoizedProps=n,e=null):(To(e,t,c),t.memoizedProps=n,e=t.child)):e=Oo(e,t),e;case 6:return null===e&&wo(t),t.memoizedProps=t.pendingProps,null;case 16:return null;case 4:return to(t,t.stateNode.containerInfo),i=t.pendingProps,ui.current||t.memoizedProps!==i?(null===e?t.child=po(t,null,i,r):To(e,t,i),t.memoizedProps=i,e=t.child):e=Oo(e,t),e;case 14:return i=t.type.render,r=t.pendingProps,n=t.ref,ui.current||t.memoizedProps!==r||n!==(null!==e?e.ref:null)?(To(e,t,i=i(r,n)),t.memoizedProps=r,e=t.child):e=Oo(e,t),e;case 10:return r=t.pendingProps,ui.current||t.memoizedProps!==r?(To(e,t,r),t.memoizedProps=r,e=t.child):e=Oo(e,t),e;case 11:return r=t.pendingProps.children,ui.current||null!==r&&t.memoizedProps!==r?(To(e,t,r),t.memoizedProps=r,e=t.child):e=Oo(e,t),e;case 15:return r=t.pendingProps,t.memoizedProps===r?e=Oo(e,t):(To(e,t,r.children),t.memoizedProps=r,e=t.child),e;case 13:return function(e,t,r){var n=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=!0;if(ui.current)a=!1;else if(o===i)return t.stateNode=0,Yi(t),Oo(e,t);var s=i.value;if(t.memoizedProps=i,null===o)s=1073741823;else if(o.value===i.value){if(o.children===i.children&&a)return t.stateNode=0,Yi(t),Oo(e,t);s=0}else{var c=o.value;if(c===s&&(0!==c||1/c==1/s)||c!=c&&s!=s){if(o.children===i.children&&a)return t.stateNode=0,Yi(t),Oo(e,t);s=0}else if(s="function"==typeof n._calculateChangedBits?n._calculateChangedBits(c,s):1073741823,0==(s|=0)){if(o.children===i.children&&a)return t.stateNode=0,Yi(t),Oo(e,t)}else Po(t,n,s,r)}return t.stateNode=s,Yi(t),To(e,t,i.children),t.child}(e,t,r);case 12:e:if(n=t.type,o=t.pendingProps,c=t.memoizedProps,i=n._currentValue,a=n._changedBits,ui.current||0!==a||c!==o){if(t.memoizedProps=o,void 0!==(s=o.unstable_observedBits)&&null!==s||(s=1073741823),t.stateNode=s,0!=(a&s))Po(t,n,a,r);else if(c===o){e=Oo(e,t);break e}r=(r=o.children)(i),t.effectTag|=1,To(e,t,r),e=t.child}else e=Oo(e,t);return e;default:d("156")}}function Ro(e){e.effectTag|=4}var Io=void 0,Do=void 0,Fo=void 0;function Uo(e,t){var r=t.pendingProps;switch(t.tag){case 1:return null;case 2:return pi(t),null;case 3:ro(),mi();var n=t.stateNode;return n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(So(t),t.effectTag&=-3),Io(t),null;case 5:no(t),n=eo($i.current);var i=t.type;if(null!==e&&null!=t.stateNode){var o=e.memoizedProps,a=t.stateNode,s=eo(Zi.current);a=Gn(a,i,o,r,n),Do(e,t,a,i,o,r,n,s),e.ref!==t.ref&&(t.effectTag|=128)}else{if(!r)return null===t.stateNode&&d("166"),null;if(e=eo(Zi.current),So(t))r=t.stateNode,i=t.type,o=t.memoizedProps,r[j]=t,r[V]=o,n=Hn(r,i,o,e,n),t.updateQueue=n,null!==n&&Ro(t);else{(e=zn(i,r,n,e))[j]=t,e[V]=r;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)e.appendChild(o.stateNode);else if(4!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}Vn(e,i,r,n),Qn(i,r)&&Ro(t),t.stateNode=e}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Fo(e,t,e.memoizedProps,r);else{if("string"!=typeof r)return null===t.stateNode&&d("166"),null;n=eo($i.current),eo(Zi.current),So(t)?(n=t.stateNode,r=t.memoizedProps,n[j]=t,Xn(n,r)&&Ro(t)):((n=jn(r,n))[j]=t,t.stateNode=n)}return null;case 14:case 16:case 10:case 11:case 15:return null;case 4:return ro(),Io(t),null;case 13:return Ji(t),null;case 12:return null;case 0:d("167");default:d("156")}}function ko(e,t){var r=t.source;null===t.stack&&null!==r&&xt(r),null!==r&&bt(r),t=t.value,null!==e&&2===e.tag&&bt(e);try{t&&t.suppressReactErrorLogging||console.error(t)}catch(e){e&&e.suppressReactErrorLogging||console.error(e)}}function Bo(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){pa(e,t)}else t.current=null}function zo(e){switch(Oi(e),e.tag){case 2:Bo(e);var t=e.stateNode;if("function"==typeof t.componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){pa(e,t)}break;case 5:Bo(e);break;case 4:Go(e)}}function jo(e){return 5===e.tag||3===e.tag||4===e.tag}function Vo(e){e:{for(var t=e.return;null!==t;){if(jo(t)){var r=t;break e}t=t.return}d("160"),r=void 0}var n=t=void 0;switch(r.tag){case 5:t=r.stateNode,n=!1;break;case 3:case 4:t=r.stateNode.containerInfo,n=!0;break;default:d("161")}16&r.effectTag&&(On(t,""),r.effectTag&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||jo(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag;){if(2&r.effectTag)continue t;if(null===r.child||4===r.tag)continue t;r.child.return=r,r=r.child}if(!(2&r.effectTag)){r=r.stateNode;break e}}for(var i=e;;){if(5===i.tag||6===i.tag)if(r)if(n){var o=t,a=i.stateNode,s=r;8===o.nodeType?o.parentNode.insertBefore(a,s):o.insertBefore(a,s)}else t.insertBefore(i.stateNode,r);else n?(o=t,a=i.stateNode,8===o.nodeType?o.parentNode.insertBefore(a,o):o.appendChild(a)):t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Go(e){for(var t=e,r=!1,n=void 0,i=void 0;;){if(!r){r=t.return;e:for(;;){switch(null===r&&d("160"),r.tag){case 5:n=r.stateNode,i=!1;break e;case 3:case 4:n=r.stateNode.containerInfo,i=!0;break e}r=r.return}r=!0}if(5===t.tag||6===t.tag){e:for(var o=t,a=o;;)if(zo(a),null!==a.child&&4!==a.tag)a.child.return=a,a=a.child;else{if(a===o)break;for(;null===a.sibling;){if(null===a.return||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}i?(o=n,a=t.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):n.removeChild(t.stateNode)}else if(4===t.tag?n=t.stateNode.containerInfo:zo(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;4===(t=t.return).tag&&(r=!1)}t.sibling.return=t.return,t=t.sibling}}function Wo(e,t){switch(t.tag){case 2:break;case 5:var r=t.stateNode;if(null!=r){var n=t.memoizedProps;e=null!==e?e.memoizedProps:n;var i=t.type,o=t.updateQueue;t.updateQueue=null,null!==o&&(r[V]=n,Wn(r,o,i,e,n))}break;case 6:null===t.stateNode&&d("162"),t.stateNode.nodeValue=t.memoizedProps;break;case 3:case 15:case 16:break;default:d("163")}}function Ho(e,t,r){(r=Di(r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Za(n),ko(e,t)},r}function Xo(e,t,r){(r=Di(r)).tag=3;var n=e.stateNode;return null!==n&&"function"==typeof n.componentDidCatch&&(r.callback=function(){null===ua?ua=new Set([this]):ua.add(this);var r=t.value,n=t.stack;ko(e,t),this.componentDidCatch(r,{componentStack:null!==n?n:""})}),r}function qo(e,t,r,n,i,o){r.effectTag|=512,r.firstEffect=r.lastEffect=null,n=Wi(n,r),e=t;do{switch(e.tag){case 3:return e.effectTag|=1024,void ki(e,n=Ho(e,n,o),o);case 2:if(t=n,r=e.stateNode,0==(64&e.effectTag)&&null!==r&&"function"==typeof r.componentDidCatch&&(null===ua||!ua.has(r)))return e.effectTag|=1024,void ki(e,n=Xo(e,t,o),o)}e=e.return}while(null!==e)}function Yo(e){switch(e.tag){case 2:pi(e);var t=e.effectTag;return 1024&t?(e.effectTag=-1025&t|64,e):null;case 3:return ro(),mi(),1024&(t=e.effectTag)?(e.effectTag=-1025&t|64,e):null;case 5:return no(e),null;case 16:return 1024&(t=e.effectTag)?(e.effectTag=-1025&t|64,e):null;case 4:return ro(),null;case 13:return Ji(e),null;default:return null}}Io=function(){},Do=function(e,t,r){(t.updateQueue=r)&&Ro(t)},Fo=function(e,t,r,n){r!==n&&Ro(t)};var Jo=Kn(),Qo=2,Zo=Jo,Ko=0,$o=0,ea=!1,ta=null,ra=null,na=0,ia=-1,oa=!1,aa=null,sa=!1,ca=!1,ua=null;function la(){if(null!==ta)for(var e=ta.return;null!==e;){var t=e;switch(t.tag){case 2:pi(t);break;case 3:ro(),mi();break;case 5:no(t);break;case 4:ro();break;case 13:Ji(t)}e=e.return}ra=null,na=0,ia=-1,oa=!1,ta=null,ca=!1}function ha(e){for(;;){var t=e.alternate,r=e.return,n=e.sibling;if(0==(512&e.effectTag)){t=Uo(t,e);var i=e;if(1073741823===na||1073741823!==i.expirationTime){var o=0;switch(i.tag){case 3:case 2:var a=i.updateQueue;null!==a&&(o=a.expirationTime)}for(a=i.child;null!==a;)0!==a.expirationTime&&(0===o||o>a.expirationTime)&&(o=a.expirationTime),a=a.sibling;i.expirationTime=o}if(null!==t)return t;if(null!==r&&0==(512&r.effectTag)&&(null===r.firstEffect&&(r.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==r.lastEffect&&(r.lastEffect.nextEffect=e.firstEffect),r.lastEffect=e.lastEffect),1<e.effectTag&&(null!==r.lastEffect?r.lastEffect.nextEffect=e:r.firstEffect=e,r.lastEffect=e)),null!==n)return n;if(null===r){ca=!0;break}e=r}else{if(null!==(e=Yo(e)))return e.effectTag&=511,e;if(null!==r&&(r.firstEffect=r.lastEffect=null,r.effectTag|=512),null!==n)return n;if(null===r)break;e=r}}return null}function da(e){var t=No(e.alternate,e,na);return null===t&&(t=ha(e)),ot.current=null,t}function fa(e,t,r){ea&&d("243"),ea=!0,t===na&&e===ra&&null!==ta||(la(),na=t,ia=-1,ta=wi((ra=e).current,null,na),e.pendingCommitExpirationTime=0);var n=!1;for(oa=!r||na<=Qo;;){try{if(r)for(;null!==ta&&!Qa();)ta=da(ta);else for(;null!==ta;)ta=da(ta)}catch(t){if(null===ta)n=!0,Za(t);else{null===ta&&d("271");var i=(r=ta).return;if(null===i){n=!0,Za(t);break}qo(e,i,r,t,0,na),ta=ha(r)}}break}if(ea=!1,n)return null;if(null===ta){if(ca)return e.pendingCommitExpirationTime=t,e.current.alternate;oa&&d("262"),0<=ia&&setTimeout(function(){var t=e.current.expirationTime;0!==t&&(0===e.remainingExpirationTime||e.remainingExpirationTime<t)&&ja(e,t)},ia),function(e){null===Aa&&d("246"),Aa.remainingExpirationTime=e}(e.current.expirationTime)}return null}function pa(e,t){var r;e:{for(ea&&!sa&&d("263"),r=e.return;null!==r;){switch(r.tag){case 2:var n=r.stateNode;if("function"==typeof r.type.getDerivedStateFromCatch||"function"==typeof n.componentDidCatch&&(null===ua||!ua.has(n))){Ui(r,e=Xo(r,e=Wi(t,e),1),1),ga(r,1),r=void 0;break e}break;case 3:Ui(r,e=Ho(r,e=Wi(t,e),1),1),ga(r,1),r=void 0;break e}r=r.return}3===e.tag&&(Ui(e,r=Ho(e,r=Wi(t,e),1),1),ga(e,1)),r=void 0}return r}function ma(){var e=2+25*(1+((ya()-2+500)/25|0));return e<=Ko&&(e=Ko+1),Ko=e}function va(e,t){return e=0!==$o?$o:ea?sa?1:na:1&t.mode?Da?2+10*(1+((e-2+15)/10|0)):2+25*(1+((e-2+500)/25|0)):1,Da&&(0===Ca||e>Ca)&&(Ca=e),e}function ga(e,t){for(;null!==e;){if((0===e.expirationTime||e.expirationTime>t)&&(e.expirationTime=t),null!==e.alternate&&(0===e.alternate.expirationTime||e.alternate.expirationTime>t)&&(e.alternate.expirationTime=t),null===e.return){if(3!==e.tag)break;var r=e.stateNode;!ea&&0!==na&&t<na&&la();var n=r.current.expirationTime;ea&&!sa&&ra===r||ja(r,n),ka>Ua&&d("185")}e=e.return}}function ya(){return Zo=Kn()-Jo,Qo=2+(Zo/10|0)}function ba(e){var t=$o;$o=2+25*(1+((ya()-2+500)/25|0));try{return e()}finally{$o=t}}function xa(e,t,r,n,i){var o=$o;$o=1;try{return e(t,r,n,i)}finally{$o=o}}var wa=null,_a=null,Sa=0,Ma=void 0,Ta=!1,Aa=null,Ea=0,Ca=0,La=!1,Pa=!1,Oa=null,Na=null,Ra=!1,Ia=!1,Da=!1,Fa=null,Ua=1e3,ka=0,Ba=1;function za(e){if(0!==Sa){if(e>Sa)return;null!==Ma&&ei(Ma)}var t=Kn()-Jo;Sa=e,Ma=$n(Ga,{timeout:10*(e-2)-t})}function ja(e,t){if(null===e.nextScheduledRoot)e.remainingExpirationTime=t,null===_a?(wa=_a=e,e.nextScheduledRoot=e):(_a=_a.nextScheduledRoot=e).nextScheduledRoot=wa;else{var r=e.remainingExpirationTime;(0===r||t<r)&&(e.remainingExpirationTime=t)}Ta||(Ra?Ia&&(Aa=e,Ea=1,Ya(e,1,!1)):1===t?Wa():za(t))}function Va(){var e=0,t=null;if(null!==_a)for(var r=_a,n=wa;null!==n;){var i=n.remainingExpirationTime;if(0===i){if((null===r||null===_a)&&d("244"),n===n.nextScheduledRoot){wa=_a=n.nextScheduledRoot=null;break}if(n===wa)wa=i=n.nextScheduledRoot,_a.nextScheduledRoot=i,n.nextScheduledRoot=null;else{if(n===_a){(_a=r).nextScheduledRoot=wa,n.nextScheduledRoot=null;break}r.nextScheduledRoot=n.nextScheduledRoot,n.nextScheduledRoot=null}n=r.nextScheduledRoot}else{if((0===e||i<e)&&(e=i,t=n),n===_a)break;r=n,n=n.nextScheduledRoot}}null!==(r=Aa)&&r===t&&1===e?ka++:ka=0,Aa=t,Ea=e}function Ga(e){Ha(0,!0,e)}function Wa(){Ha(1,!1,null)}function Ha(e,t,r){if(Na=r,Va(),t)for(;null!==Aa&&0!==Ea&&(0===e||e>=Ea)&&(!La||ya()>=Ea);)ya(),Ya(Aa,Ea,!La),Va();else for(;null!==Aa&&0!==Ea&&(0===e||e>=Ea);)Ya(Aa,Ea,!1),Va();null!==Na&&(Sa=0,Ma=null),0!==Ea&&za(Ea),Na=null,La=!1,qa()}function Xa(e,t){Ta&&d("253"),Aa=e,Ea=t,Ya(e,t,!1),Wa(),qa()}function qa(){if(ka=0,null!==Fa){var e=Fa;Fa=null;for(var t=0;t<e.length;t++){var r=e[t];try{r._onComplete()}catch(e){Pa||(Pa=!0,Oa=e)}}}if(Pa)throw e=Oa,Oa=null,Pa=!1,e}function Ya(e,t,r){Ta&&d("245"),Ta=!0,r?null!==(r=e.finishedWork)?Ja(e,r,t):null!==(r=fa(e,t,!0))&&(Qa()?e.finishedWork=r:Ja(e,r,t)):null!==(r=e.finishedWork)?Ja(e,r,t):null!==(r=fa(e,t,!1))&&Ja(e,r,t),Ta=!1}function Ja(e,t,r){var n=e.firstBatch;if(null!==n&&n._expirationTime<=r&&(null===Fa?Fa=[n]:Fa.push(n),n._defer))return e.finishedWork=t,void(e.remainingExpirationTime=0);if(e.finishedWork=null,sa=ea=!0,(r=t.stateNode).current===t&&d("177"),0===(n=r.pendingCommitExpirationTime)&&d("261"),r.pendingCommitExpirationTime=0,ya(),ot.current=null,1<t.effectTag)if(null!==t.lastEffect){t.lastEffect.nextEffect=t;var i=t.firstEffect}else i=t;else i=t.firstEffect;Yn=Cr;var o=c();if(jr(o)){if("selectionStart"in o)var a={start:o.selectionStart,end:o.selectionEnd};else e:{var s=window.getSelection&&window.getSelection();if(s&&0!==s.rangeCount){a=s.anchorNode;var u=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{a.nodeType,h.nodeType}catch(e){a=null;break e}var f=0,p=-1,m=-1,v=0,g=0,y=o,b=null;t:for(;;){for(var x;y!==a||0!==u&&3!==y.nodeType||(p=f+u),y!==h||0!==s&&3!==y.nodeType||(m=f+s),3===y.nodeType&&(f+=y.nodeValue.length),null!==(x=y.firstChild);)b=y,y=x;for(;;){if(y===o)break t;if(b===a&&++v===u&&(p=f),b===h&&++g===s&&(m=f),null!==(x=y.nextSibling))break;b=(y=b).parentNode}y=x}a=-1===p||-1===m?null:{start:p,end:m}}else a=null}a=a||{start:0,end:0}}else a=null;for(Jn={focusedElem:o,selectionRange:a},Lr(!1),aa=i;null!==aa;){o=!1,a=void 0;try{for(;null!==aa;){if(256&aa.effectTag){var w=aa.alternate;switch((u=aa).tag){case 2:if(256&u.effectTag&&null!==w){var _=w.memoizedProps,S=w.memoizedState,M=u.stateNode;M.props=u.memoizedProps,M.state=u.memoizedState;var T=M.getSnapshotBeforeUpdate(_,S);M.__reactInternalSnapshotBeforeUpdate=T}break;case 3:case 5:case 6:case 4:break;default:d("163")}}aa=aa.nextEffect}}catch(e){o=!0,a=e}o&&(null===aa&&d("178"),pa(aa,a),null!==aa&&(aa=aa.nextEffect))}for(aa=i;null!==aa;){w=!1,_=void 0;try{for(;null!==aa;){var A=aa.effectTag;if(16&A&&On(aa.stateNode,""),128&A){var E=aa.alternate;if(null!==E){var C=E.ref;null!==C&&("function"==typeof C?C(null):C.current=null)}}switch(14&A){case 2:Vo(aa),aa.effectTag&=-3;break;case 6:Vo(aa),aa.effectTag&=-3,Wo(aa.alternate,aa);break;case 4:Wo(aa.alternate,aa);break;case 8:Go(S=aa),S.return=null,S.child=null,S.alternate&&(S.alternate.child=null,S.alternate.return=null)}aa=aa.nextEffect}}catch(e){w=!0,_=e}w&&(null===aa&&d("178"),pa(aa,_),null!==aa&&(aa=aa.nextEffect))}if(C=Jn,E=c(),A=C.focusedElem,w=C.selectionRange,E!==A&&l(document.documentElement,A)){null!==w&&jr(A)&&(E=w.start,void 0===(C=w.end)&&(C=E),"selectionStart"in A?(A.selectionStart=E,A.selectionEnd=Math.min(C,A.value.length)):window.getSelection&&(E=window.getSelection(),_=A[pe()].length,C=Math.min(w.start,_),w=void 0===w.end?C:Math.min(w.end,_),!E.extend&&C>w&&(_=w,w=C,C=_),_=zr(A,C),S=zr(A,w),_&&S&&(1!==E.rangeCount||E.anchorNode!==_.node||E.anchorOffset!==_.offset||E.focusNode!==S.node||E.focusOffset!==S.offset)&&((M=document.createRange()).setStart(_.node,_.offset),E.removeAllRanges(),C>w?(E.addRange(M),E.extend(S.node,S.offset)):(M.setEnd(S.node,S.offset),E.addRange(M))))),E=[];for(C=A;C=C.parentNode;)1===C.nodeType&&E.push({element:C,left:C.scrollLeft,top:C.scrollTop});for("function"==typeof A.focus&&A.focus(),A=0;A<E.length;A++)(C=E[A]).element.scrollLeft=C.left,C.element.scrollTop=C.top}for(Jn=null,Lr(Yn),Yn=null,r.current=t,aa=i;null!==aa;){i=!1,A=void 0;try{for(E=n;null!==aa;){var L=aa.effectTag;if(36&L){var P=aa.alternate;switch(w=E,(C=aa).tag){case 2:var O=C.stateNode;if(4&C.effectTag)if(null===P)O.props=C.memoizedProps,O.state=C.memoizedState,O.componentDidMount();else{var N=P.memoizedProps,R=P.memoizedState;O.props=C.memoizedProps,O.state=C.memoizedState,O.componentDidUpdate(N,R,O.__reactInternalSnapshotBeforeUpdate)}var I=C.updateQueue;null!==I&&(O.props=C.memoizedProps,O.state=C.memoizedState,Gi(C,I,O));break;case 3:var D=C.updateQueue;if(null!==D){if(_=null,null!==C.child)switch(C.child.tag){case 5:_=C.child.stateNode;break;case 2:_=C.child.stateNode}Gi(C,D,_)}break;case 5:var F=C.stateNode;null===P&&4&C.effectTag&&Qn(C.type,C.memoizedProps)&&F.focus();break;case 6:case 4:case 15:case 16:break;default:d("163")}}if(128&L){C=void 0;var U=aa.ref;if(null!==U){var k=aa.stateNode;switch(aa.tag){case 5:C=k;break;default:C=k}"function"==typeof U?U(C):U.current=C}}var B=aa.nextEffect;aa.nextEffect=null,aa=B}}catch(e){i=!0,A=e}i&&(null===aa&&d("178"),pa(aa,A),null!==aa&&(aa=aa.nextEffect))}ea=sa=!1,Pi(t.stateNode),0===(t=r.current.expirationTime)&&(ua=null),e.remainingExpirationTime=t}function Qa(){return!(null===Na||Na.timeRemaining()>Ba)&&(La=!0)}function Za(e){null===Aa&&d("246"),Aa.remainingExpirationTime=0,Pa||(Pa=!0,Oa=e)}function Ka(e,t){var r=Ra;Ra=!0;try{return e(t)}finally{(Ra=r)||Ta||Wa()}}function $a(e,t){if(Ra&&!Ia){Ia=!0;try{return e(t)}finally{Ia=!1}}return e(t)}function es(e,t){Ta&&d("187");var r=Ra;Ra=!0;try{return xa(e,t)}finally{Ra=r,Wa()}}function ts(e,t,r){if(Da)return e(t,r);Ra||Ta||0===Ca||(Ha(Ca,!1,null),Ca=0);var n=Da,i=Ra;Ra=Da=!0;try{return e(t,r)}finally{Da=n,(Ra=i)||Ta||Wa()}}function rs(e){var t=Ra;Ra=!0;try{xa(e)}finally{(Ra=t)||Ta||Ha(1,!1,null)}}function ns(e,t,r,n,i){var o=t.current;if(r){var a;r=r._reactInternalFiber;e:{for(2===or(r)&&2===r.tag||d("170"),a=r;3!==a.tag;){if(fi(a)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}(a=a.return)||d("171")}a=a.stateNode.context}r=fi(r)?gi(r,a):a}else r=h;return null===t.context?t.context=r:t.pendingContext=r,t=i,(i=Di(n)).payload={element:e},null!==(t=void 0===t?null:t)&&(i.callback=t),Ui(o,i,n),ga(o,n),n}function is(e){var t=e._reactInternalFiber;return void 0===t&&("function"==typeof e.render?d("188"):d("268",Object.keys(e))),null===(e=cr(t))?null:e.stateNode}function os(e,t,r,n){var i=t.current;return ns(e,t,r,i=va(ya(),i),n)}function as(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function ss(e){var t=e.findFiberByHostInstance;return function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var r=t.inject(e);Ei=Li(function(e){return t.onCommitFiberRoot(r,e)}),Ci=Li(function(e){return t.onCommitFiberUnmount(r,e)})}catch(e){}return!0}(a({},e,{findHostInstanceByFiber:function(e){return null===(e=cr(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null}}))}var cs=Ka,us=ts,ls=function(){Ta||0===Ca||(Ha(Ca,!1,null),Ca=0)};function hs(e){this._expirationTime=ma(),this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function ds(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function fs(e,t,r){this._internalRoot=Ai(e,t,r)}function ps(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ms(e,t,r,n,i){ps(r)||d("200");var o=r._reactRootContainer;if(o){if("function"==typeof i){var a=i;i=function(){var e=as(o._internalRoot);a.call(e)}}null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)}else{if(o=r._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var r;r=e.lastChild;)e.removeChild(r);return new fs(e,!1,t)}(r,n),"function"==typeof i){var s=i;i=function(){var e=as(o._internalRoot);s.call(e)}}$a(function(){null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)})}return as(o._internalRoot)}function vs(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return ps(t)||d("200"),function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ct,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)}Be.injectFiberControlledHostComponent(qn),hs.prototype.render=function(e){this._defer||d("250"),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,r=this._expirationTime,n=new ds;return ns(e,t,null,r,n._onCommit),n},hs.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},hs.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||d("251"),this._hasChildren){var r=this._expirationTime;if(t!==this){this._hasChildren&&(r=this._expirationTime=t._expirationTime,this.render(this._children));for(var n=null,i=t;i!==this;)n=i,i=i._next;null===n&&d("251"),n._next=i._next,this._next=t,e.firstBatch=this}this._defer=!1,Xa(e,r),t=this._next,this._next=null,null!==(t=e.firstBatch=t)&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},hs.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},ds.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},ds.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var r=e[t];"function"!=typeof r&&d("191",r),r()}}},fs.prototype.render=function(e,t){var r=this._internalRoot,n=new ds;return null!==(t=void 0===t?null:t)&&n.then(t),os(e,r,null,n._onCommit),n},fs.prototype.unmount=function(e){var t=this._internalRoot,r=new ds;return null!==(e=void 0===e?null:e)&&r.then(e),os(null,t,null,r._onCommit),r},fs.prototype.legacy_renderSubtreeIntoContainer=function(e,t,r){var n=this._internalRoot,i=new ds;return null!==(r=void 0===r?null:r)&&i.then(r),os(t,n,e,i._onCommit),i},fs.prototype.createBatch=function(){var e=new hs(this),t=e._expirationTime,r=this._internalRoot,n=r.firstBatch;if(null===n)r.firstBatch=e,e._next=null;else{for(r=null;null!==n&&n._expirationTime<=t;)r=n,n=n._next;e._next=n,null!==r&&(r._next=e)}return e},qe=cs,Ye=us,Je=ls;var gs={createPortal:vs,findDOMNode:function(e){return null==e?null:1===e.nodeType?e:is(e)},hydrate:function(e,t,r){return ms(null,e,t,!0,r)},render:function(e,t,r){return ms(null,e,t,!1,r)},unstable_renderSubtreeIntoContainer:function(e,t,r,n){return(null==e||void 0===e._reactInternalFiber)&&d("38"),ms(e,t,r,!1,n)},unmountComponentAtNode:function(e){return ps(e)||d("40"),!!e._reactRootContainer&&($a(function(){ms(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return vs.apply(void 0,arguments)},unstable_batchedUpdates:Ka,unstable_deferredUpdates:ba,unstable_interactiveUpdates:ts,flushSync:es,unstable_flushControlled:rs,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:B,EventPluginRegistry:M,EventPropagators:re,ReactControlledComponent:Xe,ReactDOMComponentTree:X,ReactDOMEventListener:Ir},unstable_createRoot:function(e,t){return new fs(e,!0,null!=t&&!0===t.hydrate)}};ss({findFiberByHostInstance:G,bundleType:0,version:"16.4.1",rendererPackageName:"react-dom"});var ys={default:gs},bs=ys&&gs||ys;e.exports=bs.default?bs.default:bs},"574ea81f94fc0b2f332a":function(e,t,r){var n=r("621a65702ee1a566fd32")("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},"578d8dc958c3920ef454":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("link",function(e){return function(t){return e(this,"a","href",t)}})},"57e7a4ee5fd1ce9280ef":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7ad2c0eb9a8edcc472a4"),o=r("7a7739dd8a198a2cfcb5"),a=r("f3bd18506acf22d8f1d4"),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,t,r){var i={},s=o(function(){return!!a[e]()||""!=""[e]()}),c=i[e]=s?t(h):a[e];r&&(i[r]=c),n(n.P+n.F*s,"String",i)},h=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},"57f97042002e57c90c3d":function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;function i(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}e.exports=function(e,t){if(i(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(var a=0;a<r.length;a++)if(!n.call(t,r[a])||!i(e[r[a]],t[r[a]]))return!1;return!0}},"58a497e2c18ee06b3067":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},"58a762c5dd9e5f9d6ad3":function(e,t,r){"use strict";t.__esModule=!0;var n=c(r("8af190b70a6bc55c6f1b")),i=c(r("8a2d1b95e05b6a321e74")),o=c(r("49a47d064cfbf2949ee5")),a=c(r("6a4f9c383785f9168266")),s=c(r("56f612169e8c0cac4c0c"));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){(0,a.default)(this.context.router,"You should not use <Switch> outside a <Router>")},t.prototype.componentWillReceiveProps=function(e){(0,o.default)(!(e.location&&!this.props.location),'<Switch> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),(0,o.default)(!(!e.location&&this.props.location),'<Switch> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.')},t.prototype.render=function(){var e=this.context.router.route,t=this.props.children,r=this.props.location||e.location,i=void 0,o=void 0;return n.default.Children.forEach(t,function(t){if(null==i&&n.default.isValidElement(t)){var a=t.props,c=a.path,u=a.exact,l=a.strict,h=a.sensitive,d=a.from,f=c||d;o=t,i=(0,s.default)(r.pathname,{path:f,exact:u,strict:l,sensitive:h},e.match)}}),i?n.default.cloneElement(o,{location:r,computedMatch:i}):null},t}(n.default.Component);u.contextTypes={router:i.default.shape({route:i.default.object.isRequired}).isRequired},u.propTypes={children:i.default.node,location:i.default.object},t.default=u},"58d82b287428be065a42":function(e,t,r){e.exports=function(){"use strict";return[{locale:"en",pluralRuleFunction:function(e,t){var r=String(e).split("."),n=!r[1],i=Number(r[0])==e,o=i&&r[0].slice(-1),a=i&&r[0].slice(-2);return t?1==o&&11!=a?"one":2==o&&12!=a?"two":3==o&&13!=a?"few":"other":1==e&&n?"one":"other"},fields:{year:{displayName:"year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{one:"in {0} year",other:"in {0} years"},past:{one:"{0} year ago",other:"{0} years ago"}}},month:{displayName:"month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{one:"in {0} month",other:"in {0} months"},past:{one:"{0} month ago",other:"{0} months ago"}}},day:{displayName:"day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},hour:{displayName:"hour",relative:{0:"this hour"},relativeTime:{future:{one:"in {0} hour",other:"in {0} hours"},past:{one:"{0} hour ago",other:"{0} hours ago"}}},minute:{displayName:"minute",relative:{0:"this minute"},relativeTime:{future:{one:"in {0} minute",other:"in {0} minutes"},past:{one:"{0} minute ago",other:"{0} minutes ago"}}},second:{displayName:"second",relative:{0:"now"},relativeTime:{future:{one:"in {0} second",other:"in {0} seconds"},past:{one:"{0} second ago",other:"{0} seconds ago"}}}}},{locale:"en-001",parentLocale:"en"},{locale:"en-150",parentLocale:"en-001"},{locale:"en-AG",parentLocale:"en-001"},{locale:"en-AI",parentLocale:"en-001"},{locale:"en-AS",parentLocale:"en"},{locale:"en-AT",parentLocale:"en-150"},{locale:"en-AU",parentLocale:"en-001"},{locale:"en-BB",parentLocale:"en-001"},{locale:"en-BE",parentLocale:"en-001"},{locale:"en-BI",parentLocale:"en"},{locale:"en-BM",parentLocale:"en-001"},{locale:"en-BS",parentLocale:"en-001"},{locale:"en-BW",parentLocale:"en-001"},{locale:"en-BZ",parentLocale:"en-001"},{locale:"en-CA",parentLocale:"en-001"},{locale:"en-CC",parentLocale:"en-001"},{locale:"en-CH",parentLocale:"en-150"},{locale:"en-CK",parentLocale:"en-001"},{locale:"en-CM",parentLocale:"en-001"},{locale:"en-CX",parentLocale:"en-001"},{locale:"en-CY",parentLocale:"en-001"},{locale:"en-DE",parentLocale:"en-150"},{locale:"en-DG",parentLocale:"en-001"},{locale:"en-DK",parentLocale:"en-150"},{locale:"en-DM",parentLocale:"en-001"},{locale:"en-Dsrt",pluralRuleFunction:function(e,t){return"other"},fields:{year:{displayName:"Year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{other:"+{0} y"},past:{other:"-{0} y"}}},month:{displayName:"Month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{other:"+{0} m"},past:{other:"-{0} m"}}},day:{displayName:"Day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{other:"+{0} d"},past:{other:"-{0} d"}}},hour:{displayName:"Hour",relative:{0:"this hour"},relativeTime:{future:{other:"+{0} h"},past:{other:"-{0} h"}}},minute:{displayName:"Minute",relative:{0:"this minute"},relativeTime:{future:{other:"+{0} min"},past:{other:"-{0} min"}}},second:{displayName:"Second",relative:{0:"now"},relativeTime:{future:{other:"+{0} s"},past:{other:"-{0} s"}}}}},{locale:"en-ER",parentLocale:"en-001"},{locale:"en-FI",parentLocale:"en-150"},{locale:"en-FJ",parentLocale:"en-001"},{locale:"en-FK",parentLocale:"en-001"},{locale:"en-FM",parentLocale:"en-001"},{locale:"en-GB",parentLocale:"en-001"},{locale:"en-GD",parentLocale:"en-001"},{locale:"en-GG",parentLocale:"en-001"},{locale:"en-GH",parentLocale:"en-001"},{locale:"en-GI",parentLocale:"en-001"},{locale:"en-GM",parentLocale:"en-001"},{locale:"en-GU",parentLocale:"en"},{locale:"en-GY",parentLocale:"en-001"},{locale:"en-HK",parentLocale:"en-001"},{locale:"en-IE",parentLocale:"en-001"},{locale:"en-IL",parentLocale:"en-001"},{locale:"en-IM",parentLocale:"en-001"},{locale:"en-IN",parentLocale:"en-001"},{locale:"en-IO",parentLocale:"en-001"},{locale:"en-JE",parentLocale:"en-001"},{locale:"en-JM",parentLocale:"en-001"},{locale:"en-KE",parentLocale:"en-001"},{locale:"en-KI",parentLocale:"en-001"},{locale:"en-KN",parentLocale:"en-001"},{locale:"en-KY",parentLocale:"en-001"},{locale:"en-LC",parentLocale:"en-001"},{locale:"en-LR",parentLocale:"en-001"},{locale:"en-LS",parentLocale:"en-001"},{locale:"en-MG",parentLocale:"en-001"},{locale:"en-MH",parentLocale:"en"},{locale:"en-MO",parentLocale:"en-001"},{locale:"en-MP",parentLocale:"en"},{locale:"en-MS",parentLocale:"en-001"},{locale:"en-MT",parentLocale:"en-001"},{locale:"en-MU",parentLocale:"en-001"},{locale:"en-MW",parentLocale:"en-001"},{locale:"en-MY",parentLocale:"en-001"},{locale:"en-NA",parentLocale:"en-001"},{locale:"en-NF",parentLocale:"en-001"},{locale:"en-NG",parentLocale:"en-001"},{locale:"en-NL",parentLocale:"en-150"},{locale:"en-NR",parentLocale:"en-001"},{locale:"en-NU",parentLocale:"en-001"},{locale:"en-NZ",parentLocale:"en-001"},{locale:"en-PG",parentLocale:"en-001"},{locale:"en-PH",parentLocale:"en-001"},{locale:"en-PK",parentLocale:"en-001"},{locale:"en-PN",parentLocale:"en-001"},{locale:"en-PR",parentLocale:"en"},{locale:"en-PW",parentLocale:"en-001"},{locale:"en-RW",parentLocale:"en-001"},{locale:"en-SB",parentLocale:"en-001"},{locale:"en-SC",parentLocale:"en-001"},{locale:"en-SD",parentLocale:"en-001"},{locale:"en-SE",parentLocale:"en-150"},{locale:"en-SG",parentLocale:"en-001"},{locale:"en-SH",parentLocale:"en-001"},{locale:"en-SI",parentLocale:"en-150"},{locale:"en-SL",parentLocale:"en-001"},{locale:"en-SS",parentLocale:"en-001"},{locale:"en-SX",parentLocale:"en-001"},{locale:"en-SZ",parentLocale:"en-001"},{locale:"en-Shaw",pluralRuleFunction:function(e,t){return"other"},fields:{year:{displayName:"Year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{other:"+{0} y"},past:{other:"-{0} y"}}},month:{displayName:"Month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{other:"+{0} m"},past:{other:"-{0} m"}}},day:{displayName:"Day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{other:"+{0} d"},past:{other:"-{0} d"}}},hour:{displayName:"Hour",relative:{0:"this hour"},relativeTime:{future:{other:"+{0} h"},past:{other:"-{0} h"}}},minute:{displayName:"Minute",relative:{0:"this minute"},relativeTime:{future:{other:"+{0} min"},past:{other:"-{0} min"}}},second:{displayName:"Second",relative:{0:"now"},relativeTime:{future:{other:"+{0} s"},past:{other:"-{0} s"}}}}},{locale:"en-TC",parentLocale:"en-001"},{locale:"en-TK",parentLocale:"en-001"},{locale:"en-TO",parentLocale:"en-001"},{locale:"en-TT",parentLocale:"en-001"},{locale:"en-TV",parentLocale:"en-001"},{locale:"en-TZ",parentLocale:"en-001"},{locale:"en-UG",parentLocale:"en-001"},{locale:"en-UM",parentLocale:"en"},{locale:"en-US",parentLocale:"en"},{locale:"en-VC",parentLocale:"en-001"},{locale:"en-VG",parentLocale:"en-001"},{locale:"en-VI",parentLocale:"en"},{locale:"en-VU",parentLocale:"en-001"},{locale:"en-WS",parentLocale:"en-001"},{locale:"en-ZA",parentLocale:"en-001"},{locale:"en-ZM",parentLocale:"en-001"},{locale:"en-ZW",parentLocale:"en-001"}]}()},"5925dad3c5243ffee3db":function(e,t){var r=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},"5975c7ea3ecd56e534e3":function(e,t,r){e.exports=!r("7a7739dd8a198a2cfcb5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"5a3b914e449c6d95aadc":function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},"5abe37fc05566b7b9eff":function(e,t,r){var n=r("1139de1233fd67f45bd7").navigator;e.exports=n&&n.userAgent||""},"5b56f889e8364e6f86ab":function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},"5b9dc0e027f5c68eff1a":function(e,t,r){var n=r("1139de1233fd67f45bd7").document;e.exports=n&&n.documentElement},"5baa1143f58e62614ca0":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("4d073e2fededcdd3f3d3"),o=r("d394d0a4c1838202489d"),a=r("7a7739dd8a198a2cfcb5"),s=[].sort,c=[1,2,3];n(n.P+n.F*(a(function(){c.sort(void 0)})||!a(function(){c.sort(null)})||!r("40b064d4eb439c0c1c2b")(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},"5c5d334c57135891e397":function(e,t,r){"use strict";var n=r("ef09ce044ac3210bc947"),i=r("9d5592e83ab7f3d08974"),o=r("62828dc3ffa96c06b7c9"),a={};r("5f25c015bbbf9d42c661")(a,r("621a65702ee1a566fd32")("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},"5d829f854abca808c16c":function(e,t,r){r("9f769c6d0e4c9e82ba05")("WeakSet")},"5dd61c3148e8f3bbc5d7":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("2076e982c14c41925fb4")(!0);n(n.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("a5e6f0092ff0290e0bcf")("includes")},"5de5c65c2c431f821291":function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r("698d75b157f24ae829cc"))},"5e08439cbfed19129a22":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("ef09ce044ac3210bc947"),o=r("4d073e2fededcdd3f3d3"),a=r("79c91dcd8cd554c59c7b"),s=r("a459ab805827640a27e8"),c=r("7a7739dd8a198a2cfcb5"),u=r("d7134433f426bbf0c311"),l=(r("1139de1233fd67f45bd7").Reflect||{}).construct,h=c(function(){function e(){}return!(l(function(){},[],e)instanceof e)}),d=!c(function(){l(function(){})});n(n.S+n.F*(h||d),"Reflect",{construct:function(e,t){o(e),a(t);var r=arguments.length<3?e:o(arguments[2]);if(d&&!h)return l(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var c=r.prototype,f=i(s(c)?c:Object.prototype),p=Function.apply.call(e,f,t);return s(p)?p:f}})},"5e294ff5186056b35d02":function(e,t,r){"use strict";var n=r("ea43fcdd13c8985f076e");e.exports=function e(t,r){return!(!t||!r)&&(t===r||!n(t)&&(n(r)?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}},"5e511fa944f88972e69c":function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=s(e),t=c(t);var r=this.map[e];this.map[e]=r?r+","+t:t},l.prototype.delete=function(e){delete this.map[s(e)]},l.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},l.prototype.set=function(e,t){this.map[s(e)]=c(t)},l.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),u(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),u(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},m.call(v.prototype),m.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];y.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=l,e.Request=v,e.Response=y,e.fetch=function(e,r){return new Promise(function(n,i){var o=new v(e,r),a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new l;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new y(t,e))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&t.blob&&(a.responseType="blob"),o.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(r[Symbol.iterator]=function(){return r}),r}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function f(e){var t=new FileReader,r=d(t);return t.readAsArrayBuffer(e),r}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&n(e))this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=p(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=d(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(e,t){var r=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=function(e){var t=e.toUpperCase();return o.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function g(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function y(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this),e.exports=self.fetch},"5ef9de3df8d92ea0e41c":function(e,t,r){"use strict";var n={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,a=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,u=Object.getPrototypeOf,l=u&&u(Object);e.exports=function e(t,r,h){if("string"!=typeof r){if(l){var d=u(r);d&&d!==l&&e(t,d,h)}var f=a(r);s&&(f=f.concat(s(r)));for(var p=0;p<f.length;++p){var m=f[p];if(!(n[m]||i[m]||h&&h[m])){var v=c(r,m);try{o(t,m,v)}catch(e){}}}return t}return t}},"5f25c015bbbf9d42c661":function(e,t,r){var n=r("1b01d0e59d3af79760a0"),i=r("9d5592e83ab7f3d08974");e.exports=r("5975c7ea3ecd56e534e3")?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},"5f604e5c8e15a9c73536":function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=r("12323e1413cbffdabe02"),a=n.has,s=n.key,c=function(e,t,r){if(a(e,t,r))return!0;var n=o(t);return null!==n&&c(e,n,r)};n.exp({hasMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},"5f6eded14a8ed86276fc":function(e,t,r){var n=r("43a62b7f9a94dda95bf8")("keys"),i=r("273d2eedcd369c189e70");e.exports=function(e){return n[e]||(n[e]=i(e))}},"5fa3f8487e09c6182715":function(e,t,r){var n=r("67042e57ad02a5947bc9"),i=r("f2ef6f6e544aad97aa22"),o=r("4b93c5a7bb60dd6ab0f4"),a="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&n(e)==a}},"5fd4d3d5ac2fe9bfd20e":function(e,t,r){var n=r("4133d6461867e9751fc3");e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},"61597e5c866e9f95c20b":function(e,t,r){"use strict";t.__esModule=!0;var n=r("8af190b70a6bc55c6f1b"),i=c(n),o=c(r("8a2d1b95e05b6a321e74")),a=r("999b8422c18ed8d20c8d"),s=r("2e20dfefd16154e6ed7b");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.handleLocationChange=function(e){n.store.dispatch({type:s.LOCATION_CHANGE,payload:e})},u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){var e=this.props,t=e.store,r=e.history,n=e.isSSR;this.store=t||this.context.store,this.handleLocationChange(r.location),n||(this.unsubscribeFromHistory=r.listen(this.handleLocationChange))},t.prototype.componentWillUnmount=function(){this.unsubscribeFromHistory&&this.unsubscribeFromHistory()},t.prototype.render=function(){return i.default.createElement(a.Router,this.props)},t}(n.Component);l.propTypes={store:o.default.object,history:o.default.object.isRequired,children:o.default.node,isSSR:o.default.bool},l.contextTypes={store:o.default.object},t.default=l},"615b8c1bc8c3f66221bc":function(e,t,r){"use strict";e.exports=r("46a1a30d151cac60057c")||!r("7a7739dd8a198a2cfcb5")(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete r("1139de1233fd67f45bd7")[e]})},"61fcea04092a9580d371":function(e,t,r){var n=r("0091fa8d74c45e0dd589"),i=r("9d5592e83ab7f3d08974"),o=r("efae14a3f8cd9a616256"),a=r("4ef7a75a1d1957a7c5c0"),s=r("d34390b928ecadc11dc8"),c=r("bc1a333d2b6eceac22e3"),u=Object.getOwnPropertyDescriptor;t.f=r("5975c7ea3ecd56e534e3")?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},"621a65702ee1a566fd32":function(e,t,r){var n=r("43a62b7f9a94dda95bf8")("wks"),i=r("273d2eedcd369c189e70"),o=r("1139de1233fd67f45bd7").Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},"622bea1a0aa515bde59f":function(e,t,r){for(var n,i=r("1139de1233fd67f45bd7"),o=r("5f25c015bbbf9d42c661"),a=r("273d2eedcd369c189e70"),s=a("typed_array"),c=a("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=i[d[h++]])?(o(n.prototype,s,!0),o(n.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},"6251dc1015f605aa27c7":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{fround:r("3cf3ac9966b923e35829")})},"62828dc3ffa96c06b7c9":function(e,t,r){var n=r("1b01d0e59d3af79760a0").f,i=r("d34390b928ecadc11dc8"),o=r("621a65702ee1a566fd32")("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},"637643d0c0e16de3ee55":function(e,t,r){"use strict";t.__esModule=!0,t.createMatchSelector=t.getLocation=void 0;var n=r("999b8422c18ed8d20c8d"),i=t.getLocation=function(e){return e.router.location};t.createMatchSelector=function(e){var t=null,r=null;return function(o){var a=(i(o)||{}).pathname;if(a===t)return r;t=a;var s=(0,n.matchPath)(a,e);return s&&r&&s.url===r.url||(r=s),r}}},"63f14ac74ce296f77f4d":function(e,t,r){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r("5712f1b9446531a0f3b8")},"64c9c4b07fb151f67f60":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=u(r("8af190b70a6bc55c6f1b")),a=u(r("8a2d1b95e05b6a321e74")),s=u(r("f4443236244759f9cc1d")),c=u(r("c5dd00b0f3b91ce870bd"));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.to,r=e.exact,a=e.strict,u=e.location,l=e.activeClassName,h=e.className,d=e.activeStyle,f=e.style,p=e.isActive,m=e["aria-current"],v=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["to","exact","strict","location","activeClassName","className","activeStyle","style","isActive","aria-current"]),g="object"===(void 0===t?"undefined":i(t))?t.pathname:t,y=g&&g.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1");return o.default.createElement(s.default,{path:y,exact:r,strict:a,location:u,children:function(e){var r=e.location,i=e.match,a=!!(p?p(i,r):i);return o.default.createElement(c.default,n({to:t,className:a?[h,l].filter(function(e){return e}).join(" "):h,style:a?n({},f,d):f,"aria-current":a&&m||null},v))}})};l.propTypes={to:c.default.propTypes.to,exact:a.default.bool,strict:a.default.bool,location:a.default.object,activeClassName:a.default.string,className:a.default.string,activeStyle:a.default.object,style:a.default.object,isActive:a.default.func,"aria-current":a.default.oneOf(["page","step","location","date","time","true"])},l.defaultProps={activeClassName:"active","aria-current":"page"},t.default=l},"654ecb2e7a4241ef8f08":function(e,t,r){"use strict";r("941df1c42d2f478ed942");var n=r("79c91dcd8cd554c59c7b"),i=r("f936413e306f54e59a2a"),o=r("5975c7ea3ecd56e534e3"),a=/./.toString,s=function(e){r("88db22626e6c88b175cf")(RegExp.prototype,"toString",e,!0)};r("7a7739dd8a198a2cfcb5")(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},"65955717fc58c97d7378":function(e,t,r){var n=r("f3b0ff1628e56352bcbf"),i=r("f883c6a0eaee60a48ea0"),o=r("d3a850c4000d77bccc89"),a=r("cef4e105446199aaf71e"),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,h=u.hasOwnProperty,d=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(n(e)?d:s).test(a(e))}},"65bf45411dca6e57791d":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S+n.F*!r("5975c7ea3ecd56e534e3"),"Object",{defineProperty:r("1b01d0e59d3af79760a0").f})},"66914ad4ab026b9ba2e8":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("39dac2a92593ee9501cd");n(n.P+n.F*r("e5c4ff14bae25ddfa508")("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},"669a82d2d2cdff2f9f35":function(e,t,r){var n,i,o;i=[t,r("8af190b70a6bc55c6f1b"),r("8a2d1b95e05b6a321e74")],void 0===(o="function"==typeof(n=function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setHasSupportToCaptureOption=c;var n=o(t),i=o(r);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=!1;function c(e){s=e}try{addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){c(!0)}}))}catch(e){}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{capture:!0};return s?e:e.capture}function l(e){if("touches"in e){var t=e.touches[0],r=t.pageX,n=t.pageY;return{x:r,y:n}}var i=e.screenX,o=e.screenY;return{x:i,y:o}}var h=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));return o._handleSwipeStart=o._handleSwipeStart.bind(o),o._handleSwipeMove=o._handleSwipeMove.bind(o),o._handleSwipeEnd=o._handleSwipeEnd.bind(o),o._onMouseDown=o._onMouseDown.bind(o),o._onMouseMove=o._onMouseMove.bind(o),o._onMouseUp=o._onMouseUp.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.swiper&&this.swiper.addEventListener("touchmove",this._handleSwipeMove,u({capture:!0,passive:!1}))}},{key:"componentWillUnmount",value:function(){this.swiper&&this.swiper.removeEventListener("touchmove",this._handleSwipeMove,u({capture:!0,passive:!1}))}},{key:"_onMouseDown",value:function(e){this.props.allowMouseEvents&&(this.mouseDown=!0,document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mousemove",this._onMouseMove),this._handleSwipeStart(e))}},{key:"_onMouseMove",value:function(e){this.mouseDown&&this._handleSwipeMove(e)}},{key:"_onMouseUp",value:function(e){this.mouseDown=!1,document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousemove",this._onMouseMove),this._handleSwipeEnd(e)}},{key:"_handleSwipeStart",value:function(e){var t=l(e),r=t.x,n=t.y;this.moveStart={x:r,y:n},this.props.onSwipeStart(e)}},{key:"_handleSwipeMove",value:function(e){if(this.moveStart){var t=l(e),r=t.x,n=t.y,i=r-this.moveStart.x,o=n-this.moveStart.y;this.moving=!0;var a=this.props.onSwipeMove({x:i,y:o},e);a&&e.preventDefault(),this.movePosition={deltaX:i,deltaY:o}}}},{key:"_handleSwipeEnd",value:function(e){this.props.onSwipeEnd(e);var t=this.props.tolerance;this.moving&&this.movePosition&&(this.movePosition.deltaX<-t?this.props.onSwipeLeft(1,e):this.movePosition.deltaX>t&&this.props.onSwipeRight(1,e),this.movePosition.deltaY<-t?this.props.onSwipeUp(1,e):this.movePosition.deltaY>t&&this.props.onSwipeDown(1,e)),this.moveStart=null,this.moving=!1,this.movePosition=null}},{key:"render",value:function(){var e=this;return n.default.createElement(this.props.tagName,{ref:function(t){return e.swiper=t},onMouseDown:this._onMouseDown,onTouchStart:this._handleSwipeStart,onTouchEnd:this._handleSwipeEnd,className:this.props.className,style:this.props.style},this.props.children)}}]),t}(t.Component);h.displayName="ReactSwipe",h.propTypes={tagName:i.default.string,className:i.default.string,style:i.default.object,children:i.default.node,allowMouseEvents:i.default.bool,onSwipeUp:i.default.func,onSwipeDown:i.default.func,onSwipeLeft:i.default.func,onSwipeRight:i.default.func,onSwipeStart:i.default.func,onSwipeMove:i.default.func,onSwipeEnd:i.default.func,tolerance:i.default.number.isRequired},h.defaultProps={tagName:"div",allowMouseEvents:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},onSwipeStart:function(){},onSwipeMove:function(){},onSwipeEnd:function(){},tolerance:0},e.default=h})?n.apply(t,i):n)||(e.exports=o)},"67042e57ad02a5947bc9":function(e,t,r){var n=r("80e6088e4899523ce7ea"),i=r("83306aed22ee07ce18aa"),o=r("089f6438d068e21c2e37"),a="[object Null]",s="[object Undefined]",c=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?s:a:c&&c in Object(e)?i(e):o(e)}},"6735bdf1a3a541ab43fd":function(e,t,r){var n=r("01a9501d9e4a26a76a44");"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r("1e4534d1d62a11482e97")(n,i);n.locals&&(e.exports=n.locals)},"6857028c584e68dfacd6":function(e,t,r){r("ccf79254fef1a499b486")("WeakMap")},"68a989d6f90923909f2a":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("1139de1233fd67f45bd7").document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},"693c9c0dfc6db2b00620":function(e,t,r){var n=r("0116c75136b233002fb9");e.exports=function(e,t){if("number"!=typeof e&&"Number"!=n(e))throw TypeError(t);return+e}},"698d75b157f24ae829cc":function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"6a4f9c383785f9168266":function(e,t,r){"use strict";e.exports=function(e,t,r,n,i,o,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,i,o,a,s],l=0;(c=new Error(t.replace(/%s/g,function(){return u[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},"6ad07de816cfee1e2bda":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},"6ae198bd7922e25e2128":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("770f76c876afc046e4e0")(!0);n(n.P,"String",{at:function(e){return i(this,e)}})},"6ae9955278ddcf01bbfd":function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("8f648b1026e01323935b"),o=r("621a65702ee1a566fd32")("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},"6c07e9b5d58510c21784":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("1ae513448994dc2a1e86");n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},"6d6f766831bb1cf8facf":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},"6d7c634dd1858355953f":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},"6d8be12a50447a7c97b1":function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"6d98b32f91eb8777ca21":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P,"Function",{bind:r("d7134433f426bbf0c311")})},"71d3ec5bd65418e28ebc":function(e,t,r){var n=r("224ae09e536c09e69a0a"),i=r("621a65702ee1a566fd32")("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},"72301e3cc725dd502232":function(e,t,r){(function(e){var n=r("18caba858d9ea0f67284"),i=r("bc20db01ebac581e43a6"),o="object"==typeof t&&t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o?n.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;e.exports=c}).call(this,r("f586cf5b9f4b7719b2c1")(e))},"72ac5893bfc7ed50a09c":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ca19e32ab6ee3b3692aa"),o=r("39dac2a92593ee9501cd"),a="".endsWith;n(n.P+n.F*r("e5c4ff14bae25ddfa508")("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=i(t.length),s=void 0===r?n:Math.min(i(r),n),c=String(e);return a?a.call(t,c,s):t.slice(s-c.length,s)===c}})},"7336e9dece9add80afce":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("5692bffd717498245e82"));t.default=n.default},"74431d47afb6248fcb69":function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"take",function(){return Fe}),r.d(n,"takem",function(){return Ue}),r.d(n,"put",function(){return ke}),r.d(n,"all",function(){return Be}),r.d(n,"race",function(){return ze}),r.d(n,"call",function(){return Ve}),r.d(n,"apply",function(){return Ge}),r.d(n,"cps",function(){return We}),r.d(n,"fork",function(){return He}),r.d(n,"spawn",function(){return Xe}),r.d(n,"join",function(){return qe}),r.d(n,"cancel",function(){return Ye}),r.d(n,"select",function(){return Je}),r.d(n,"actionChannel",function(){return Qe}),r.d(n,"cancelled",function(){return Ze}),r.d(n,"flush",function(){return Ke}),r.d(n,"getContext",function(){return $e}),r.d(n,"setContext",function(){return et}),r.d(n,"takeEvery",function(){return tt}),r.d(n,"takeLatest",function(){return rt}),r.d(n,"throttle",function(){return nt});var i={};r.r(i),r.d(i,"TASK",function(){return c}),r.d(i,"SAGA_ACTION",function(){return d}),r.d(i,"noop",function(){return v}),r.d(i,"is",function(){return w}),r.d(i,"deferred",function(){return T}),r.d(i,"arrayOfDeffered",function(){return A}),r.d(i,"createMockTask",function(){return C}),r.d(i,"cloneableGenerator",function(){return B}),r.d(i,"asEffect",function(){return ot}),r.d(i,"CHANNEL_END",function(){return ut});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e){return"@@redux-saga/"+e},c=s("TASK"),u=s("HELPER"),l=s("MATCH"),h=s("CANCEL_PROMISE"),d=s("SAGA_ACTION"),f=s("SELF_CANCELLATION"),p=function(e){return function(){return e}},m=p(!0),v=function(){},g=function(e){return e};function y(e,t,r){if(!t(e))throw R("error","uncaught at check",r),new Error(r)}var b=Object.prototype.hasOwnProperty;function x(e,t){return w.notUndef(e)&&b.call(e,t)}var w={undef:function(e){return null===e||void 0===e},notUndef:function(e){return null!==e&&void 0!==e},func:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},array:Array.isArray,object:function(e){return e&&!w.array(e)&&"object"===(void 0===e?"undefined":a(e))},promise:function(e){return e&&w.func(e.then)},iterator:function(e){return e&&w.func(e.next)&&w.func(e.throw)},iterable:function(e){return e&&w.func(Symbol)?w.func(e[Symbol.iterator]):w.array(e)},task:function(e){return e&&e[c]},observable:function(e){return e&&w.func(e.subscribe)},buffer:function(e){return e&&w.func(e.isEmpty)&&w.func(e.take)&&w.func(e.put)},pattern:function(e){return e&&(w.string(e)||"symbol"===(void 0===e?"undefined":a(e))||w.func(e)||w.array(e))},channel:function(e){return e&&w.func(e.take)&&w.func(e.close)},helper:function(e){return e&&e[u]},stringableFunc:function(e){return w.func(e)&&x(e,"toString")}},_={assign:function(e,t){for(var r in t)x(t,r)&&(e[r]=t[r])}};function S(e,t){var r=e.indexOf(t);r>=0&&e.splice(r,1)}var M={from:function(e){var t=Array(e.length);for(var r in e)x(e,r)&&(t[r]=e[r]);return t}};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o({},e),r=new Promise(function(e,r){t.resolve=e,t.reject=r});return t.promise=r,t}function A(e){for(var t=[],r=0;r<e;r++)t.push(T());return t}function E(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=void 0,n=new Promise(function(n){r=setTimeout(function(){return n(t)},e)});return n[h]=function(){return clearTimeout(r)},n}function C(){var e,t=!0,r=void 0,n=void 0;return(e={})[c]=!0,e.isRunning=function(){return t},e.result=function(){return r},e.error=function(){return n},e.setRunning=function(e){return t=e},e.setResult=function(e){return r=e},e.setError=function(e){return n=e},e}var L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(){return++e}}(),P=function(e){throw e},O=function(e){return{value:e,done:!0}};function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],i={name:r,next:e,throw:t,return:O};return n&&(i[u]=!0),"undefined"!=typeof Symbol&&(i[Symbol.iterator]=function(){return i}),i}function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"undefined"==typeof window?console.log("redux-saga "+e+": "+t+"\n"+(r&&r.stack||r)):console[e](t,r)}function I(e,t){return function(){return e.apply(void 0,arguments)}}var D=function(e,t){return e+" has been deprecated in favor of "+t+", please update your code"},F=function(e){return new Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},U=function(e,t){return(e?e+".":"")+"setContext(props): argument "+t+" is not a plain object"},k=function(e){return function(t){return e(Object.defineProperty(t,d,{value:!0}))}},B=function e(t){return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=[],a=t.apply(void 0,n);return{next:function(e){return o.push(e),a.next(e)},clone:function(){var r=e(t).apply(void 0,n);return o.forEach(function(e){return r.next(e)}),r},return:function(e){return a.return(e)},throw:function(e){return a.throw(e)}}}},z="Channel's Buffer overflow!",j=1,V=3,G=4,W={isEmpty:m,put:v,take:v};function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments[1],r=new Array(e),n=0,i=0,o=0,a=function(t){r[i]=t,i=(i+1)%e,n++},s=function(){if(0!=n){var t=r[o];return r[o]=null,n--,o=(o+1)%e,t}},c=function(){for(var e=[];n;)e.push(s());return e};return{isEmpty:function(){return 0==n},put:function(s){if(n<e)a(s);else{var u=void 0;switch(t){case j:throw new Error(z);case V:r[i]=s,o=i=(i+1)%e;break;case G:u=2*e,r=c(),n=r.length,i=r.length,o=0,r.length=u,e=u,a(s)}}},take:s,flush:c}}var X={none:function(){return W},fixed:function(e){return H(e,j)},dropping:function(e){return H(e,2)},sliding:function(e){return H(e,V)},expanding:function(e){return H(e,G)}},q=[],Y=0;function J(e){try{Z(),e()}finally{K()}}function Q(e){q.push(e),Y||(Z(),$())}function Z(){Y++}function K(){Y--}function $(){K();for(var e=void 0;!Y&&void 0!==(e=q.shift());)J(e)}var ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},te={type:"@@redux-saga/CHANNEL_END"},re=function(e){return e&&"@@redux-saga/CHANNEL_END"===e.type};var ne="invalid buffer passed to channel factory function",ie="Saga was provided with an undefined action";function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X.fixed(),t=!1,r=[];function n(){if(t&&r.length)throw F("Cannot have a closed channel with pending takers");if(r.length&&!e.isEmpty())throw F("Cannot have pending takers with non empty buffer")}return y(e,w.buffer,ne),{take:function(i){n(),y(i,w.func,"channel.take's callback must be a function"),t&&e.isEmpty()?i(te):e.isEmpty()?(r.push(i),i.cancel=function(){return S(r,i)}):i(e.take())},put:function(i){if(n(),y(i,w.notUndef,ie),!t){if(!r.length)return e.put(i);for(var o=0;o<r.length;o++){var a=r[o];if(!a[l]||a[l](i))return r.splice(o,1),a(i)}}},flush:function(r){n(),y(r,w.func,"channel.flush' callback must be a function"),t&&e.isEmpty()?r(te):r(e.flush())},close:function(){if(n(),!t&&(t=!0,r.length)){var e=r;r=[];for(var i=0,o=e.length;i<o;i++)e[i](te)}},get __takers__(){return r},get __closed__(){return t}}}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.none(),r=arguments[2];arguments.length>2&&y(r,w.func,"Invalid match function passed to eventChannel");var n=oe(t),i=function(){n.__closed__||(o&&o(),n.close())},o=e(function(e){re(e)?i():r&&!r(e)||n.put(e)});if(n.__closed__&&o(),!w.func(o))throw new Error("in eventChannel: subscribe should return a function to unsubscribe");return{take:n.take,flush:n.flush,close:i}}var se={done:!0,value:void 0},ce={};function ue(e){return w.channel(e)?"channel":Array.isArray(e)?String(e.map(function(e){return String(e)})):String(e)}function le(e,t){var r=void 0,n=t;function i(t,i){if(n===ce)return se;if(i)throw n=ce,i;r&&r(t);var o=e[n](),a=o[0],s=o[1],c=o[2];return r=c,(n=a)===ce?se:s}return N(i,function(e){return i(null,e)},arguments.length>2&&void 0!==arguments[2]?arguments[2]:"iterator",!0)}function he(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o={done:!1,value:Fe(e)},a=void 0,s=function(e){return a=e};return le({q1:function(){return["q2",o,s]},q2:function(){return a===te?[ce]:["q1",function(e){return{done:!1,value:He.apply(void 0,[t].concat(n,[e]))}}(a)]}},"q1","takeEvery("+ue(e)+", "+t.name+")")}function de(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o={done:!1,value:Fe(e)},a=function(e){return{done:!1,value:He.apply(void 0,[t].concat(n,[e]))}},s=void 0,c=void 0,u=function(e){return s=e},l=function(e){return c=e};return le({q1:function(){return["q2",o,l]},q2:function(){return c===te?[ce]:s?["q3",function(e){return{done:!1,value:Ye(e)}}(s)]:["q1",a(c),u]},q3:function(){return["q1",a(c),u]}},"q1","takeLatest("+ue(e)+", "+t.name+")")}function fe(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var a=void 0,s=void 0,c={done:!1,value:Qe(t,X.sliding(1))},u={done:!1,value:Ve(E,e)},l=function(e){return a=e},h=function(e){return s=e};return le({q1:function(){return["q2",c,h]},q2:function(){return["q3",{done:!1,value:Fe(s)},l]},q3:function(){return a===te?[ce]:["q4",function(e){return{done:!1,value:He.apply(void 0,[r].concat(i,[e]))}}(a)]},q4:function(){return["q2",u]}},"q1","throttle("+ue(t)+", "+r.name+")")}var pe=I(he),me=I(de),ve=I(fe),ge=s("IO"),ye="TAKE",be="PUT",xe="ALL",we="RACE",_e="CALL",Se="CPS",Me="FORK",Te="JOIN",Ae="CANCEL",Ee="SELECT",Ce="ACTION_CHANNEL",Le="CANCELLED",Pe="FLUSH",Oe="GET_CONTEXT",Ne="SET_CONTEXT",Re="\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)",Ie=function(e,t){var r;return(r={})[ge]=!0,r[e]=t,r},De=function(e){return y(ot.fork(e),w.object,"detach(eff): argument must be a fork effect"),e[Me].detached=!0,e};function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";if(arguments.length&&y(arguments[0],w.notUndef,"take(patternOrChannel): patternOrChannel is undefined"),w.pattern(e))return Ie(ye,{pattern:e});if(w.channel(e))return Ie(ye,{channel:e});throw new Error("take(patternOrChannel): argument "+String(e)+" is not valid channel or a valid pattern")}Fe.maybe=function(){var e=Fe.apply(void 0,arguments);return e[ye].maybe=!0,e};var Ue=I(Fe.maybe);function ke(e,t){return arguments.length>1?(y(e,w.notUndef,"put(channel, action): argument channel is undefined"),y(e,w.channel,"put(channel, action): argument "+e+" is not a valid channel"),y(t,w.notUndef,"put(channel, action): argument action is undefined")):(y(e,w.notUndef,"put(action): argument action is undefined"),t=e,e=null),Ie(be,{channel:e,action:t})}function Be(e){return Ie(xe,e)}function ze(e){return Ie(we,e)}function je(e,t,r){y(t,w.notUndef,e+": argument fn is undefined");var n=null;if(w.array(t)){var i=t;n=i[0],t=i[1]}else if(t.fn){var o=t;n=o.context,t=o.fn}return n&&w.string(t)&&w.func(n[t])&&(t=n[t]),y(t,w.func,e+": argument "+t+" is not a function"),{context:n,fn:t,args:r}}function Ve(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Ie(_e,je("call",e,r))}function Ge(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Ie(_e,je("apply",{context:e,fn:t},r))}function We(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Ie(Se,je("cps",e,r))}function He(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Ie(Me,je("fork",e,r))}function Xe(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return De(He.apply(void 0,[e].concat(r)))}function qe(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1)return Be(t.map(function(e){return qe(e)}));var n=t[0];return y(n,w.notUndef,"join(task): argument task is undefined"),y(n,w.task,"join(task): argument "+n+" is not a valid Task object "+Re),Ie(Te,n)}function Ye(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1)return Be(t.map(function(e){return Ye(e)}));var n=t[0];return 1===t.length&&(y(n,w.notUndef,"cancel(task): argument task is undefined"),y(n,w.task,"cancel(task): argument "+n+" is not a valid Task object "+Re)),Ie(Ae,n||f)}function Je(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return 0===arguments.length?e=g:(y(e,w.notUndef,"select(selector,[...]): argument selector is undefined"),y(e,w.func,"select(selector,[...]): argument "+e+" is not a function")),Ie(Ee,{selector:e,args:r})}function Qe(e,t){return y(e,w.notUndef,"actionChannel(pattern,...): argument pattern is undefined"),arguments.length>1&&(y(t,w.notUndef,"actionChannel(pattern, buffer): argument buffer is undefined"),y(t,w.buffer,"actionChannel(pattern, buffer): argument "+t+" is not a valid buffer")),Ie(Ce,{pattern:e,buffer:t})}function Ze(){return Ie(Le,{})}function Ke(e){return y(e,w.channel,"flush(channel): argument "+e+" is not valid channel"),Ie(Pe,e)}function $e(e){return y(e,w.string,"getContext(prop): argument "+e+" is not a string"),Ie(Oe,e)}function et(e){return y(e,w.object,U(null,e)),Ie(Ne,e)}function tt(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return He.apply(void 0,[he,e,t].concat(n))}function rt(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return He.apply(void 0,[de,e,t].concat(n))}function nt(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return He.apply(void 0,[fe,e,t,r].concat(i))}ke.resolve=function(){var e=ke.apply(void 0,arguments);return e[be].resolve=!0,e},ke.sync=I(ke.resolve);var it=function(e){return function(t){return t&&t[ge]&&t[e]}},ot={take:it(ye),put:it(be),all:it(xe),race:it(we),call:it(_e),cps:it(Se),fork:it(Me),join:it(Te),cancel:it(Ae),select:it(Ee),actionChannel:it(Ce),cancelled:it(Le),flush:it(Pe),getContext:it(Oe),setContext:it(Ne)},at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var ct="proc first argument (Saga function result) must be an iterator",ut={toString:function(){return"@@redux-saga/CHANNEL_END"}},lt={toString:function(){return"@@redux-saga/TASK_CANCEL"}},ht={wildcard:function(){return m},default:function(e){return"symbol"===(void 0===e?"undefined":st(e))?function(t){return t.type===e}:function(t){return t.type===String(e)}},array:function(e){return function(t){return e.some(function(e){return dt(e)(t)})}},predicate:function(e){return function(t){return e(t)}}};function dt(e){return("*"===e?ht.wildcard:w.array(e)?ht.array:w.stringableFunc(e)?ht.default:w.func(e)?ht.predicate:ht.default)(e)}var ft=function(e){return{fn:e}};function pt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return v},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"anonymous",u=arguments[8];y(e,w.iterator,ct);var p=I(H,D("[...effects]","all([...effects])")),m=o.sagaMonitor,g=o.logger,b=o.onError,x=g||R,A=function(e){var t=e.sagaStack;!t&&e.stack&&(t=-1!==e.stack.split("\n")[0].indexOf(e.message)?e.stack:"Error: "+e.message+"\n"+e.stack),x("error","uncaught at "+s,t||e.message||e)},E=function(e){var t=ae(function(t){return e(function(e){e[d]?t(e):Q(function(){return t(e)})})});return ee({},t,{take:function(e,r){arguments.length>1&&(y(r,w.func,"channel.take's matcher argument must be a function"),e[l]=r),t.take(e)}})}(t),C=Object.create(i);B.cancel=v;var P=function(e,t,r,n){var i,o;return r._deferredEnd=null,(i={})[c]=!0,i.id=e,i.name=t,"done",(o={}).done=o.done||{},o.done.get=function(){if(r._deferredEnd)return r._deferredEnd.promise;var e=T();return r._deferredEnd=e,r._isRunning||(r._error?e.reject(r._error):e.resolve(r._result)),e.promise},i.cont=n,i.joiners=[],i.cancel=k,i.isRunning=function(){return r._isRunning},i.isCancelled=function(){return r._isCancelled},i.isAborted=function(){return r._isAborted},i.result=function(){return r._result},i.error=function(){return r._error},i.setContext=function(e){y(e,w.object,U("task",e)),_.assign(C,e)},function(e,t){for(var r in t){var n=t[r];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r,n)}}(i,o),i}(a,s,e,u),O={name:s,cancel:function(){O.isRunning&&!O.isCancelled&&(O.isCancelled=!0,B(lt))},isRunning:!0},F=function(e,t,r){var n=[],i=void 0,o=!1;function a(e){c(),r(e,!0)}function s(e){n.push(e),e.cont=function(s,c){o||(S(n,e),e.cont=v,c?a(s):(e===t&&(i=s),n.length||(o=!0,r(i))))}}function c(){o||(o=!0,n.forEach(function(e){e.cont=v,e.cancel()}),n=[])}return s(t),{addTask:s,cancelAll:c,abort:a,getTasks:function(){return n},taskNames:function(){return n.map(function(e){return e.name})}}}(0,O,z);function k(){e._isRunning&&!e._isCancelled&&(e._isCancelled=!0,F.cancelAll(),z(lt))}return u&&(u.cancel=k),e._isRunning=!0,B(),P;function B(t,r){if(!O.isRunning)throw new Error("Trying to resume an already finished generator");try{var n=void 0;r?n=e.throw(t):t===lt?(O.isCancelled=!0,B.cancel(),n=w.func(e.return)?e.return(lt):{done:!0,value:lt}):n=t===ut?w.func(e.return)?e.return():{done:!0}:e.next(t),n.done?(O.isMainRunning=!1,O.cont&&O.cont(n.value)):j(n.value,a,"",B)}catch(e){O.isCancelled&&A(e),O.isMainRunning=!1,O.cont(e,!0)}}function z(t,r){e._isRunning=!1,E.close(),r?(t instanceof Error&&Object.defineProperty(t,"sagaStack",{value:"at "+s+" \n "+(t.sagaStack||t.stack),configurable:!0}),P.cont||(t instanceof Error&&b?b(t):A(t)),e._error=t,e._isAborted=!0,e._deferredEnd&&e._deferredEnd.reject(t)):(e._result=t,e._deferredEnd&&e._deferredEnd.resolve(t)),P.cont&&P.cont(t,r),P.joiners.forEach(function(e){return e.cb(t,r)}),P.joiners=null}function j(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments[3],c=L();m&&m.effectTriggered({effectId:c,parentEffectId:i,label:o,effect:e});var u=void 0;function l(e,t){u||(u=!0,a.cancel=v,m&&(t?m.effectRejected(c,e):m.effectResolved(c,e)),a(e,t))}l.cancel=v,a.cancel=function(){if(!u){u=!0;try{l.cancel()}catch(e){A(e)}l.cancel=v,m&&m.effectCancelled(c)}};var h=void 0;return w.promise(e)?V(e,l):w.helper(e)?W(ft(e),c,l):w.iterator(e)?G(e,c,s,l):w.array(e)?p(e,c,l):(h=ot.take(e))?function(e,t){var r=e.channel,n=e.pattern,i=e.maybe;r=r||E;var o=function(e){return e instanceof Error?t(e,!0):re(e)&&!i?t(ut):t(e)};try{r.take(o,dt(n))}catch(e){return t(e,!0)}t.cancel=o.cancel}(h,l):(h=ot.put(e))?function(e,t){var n=e.channel,i=e.action,o=e.resolve;Q(function(){var e=void 0;try{e=(n?n.put:r)(i)}catch(e){if(n||o)return t(e,!0);A(e)}if(!o||!w.promise(e))return t(e);V(e,t)})}(h,l):(h=ot.all(e))?H(h,c,l):(h=ot.race(e))?function(e,t,r){var n=void 0,i=Object.keys(e),o={};i.forEach(function(t){var a=function(o,a){if(!n)if(a)r.cancel(),r(o,!0);else if(!re(o)&&o!==ut&&o!==lt){var s;r.cancel(),n=!0;var c=((s={})[t]=o,s);r(w.array(e)?[].slice.call(at({},c,{length:i.length})):c)}};a.cancel=v,o[t]=a}),r.cancel=function(){n||(n=!0,i.forEach(function(e){return o[e].cancel()}))},i.forEach(function(r){n||j(e[r],t,r,o[r])})}(h,c,l):(h=ot.call(e))?function(e,t,r){var n=e.context,i=e.fn,o=e.args,a=void 0;try{a=i.apply(n,o)}catch(e){return r(e,!0)}return w.promise(a)?V(a,r):w.iterator(a)?G(a,t,i.name,r):r(a)}(h,c,l):(h=ot.cps(e))?function(e,t){var r=e.context,n=e.fn,i=e.args;try{var o=function(e,r){return w.undef(e)?t(r):t(e,!0)};n.apply(r,i.concat(o)),o.cancel&&(t.cancel=function(){return o.cancel()})}catch(e){return t(e,!0)}}(h,l):(h=ot.fork(e))?W(h,c,l):(h=ot.join(e))?function(e,t){if(e.isRunning()){var r={task:P,cb:t};t.cancel=function(){return S(e.joiners,r)},e.joiners.push(r)}else e.isAborted()?t(e.error(),!0):t(e.result())}(h,l):(h=ot.cancel(e))?function(e,t){e===f&&(e=P);e.isRunning()&&e.cancel();t()}(h,l):(h=ot.select(e))?function(e,t){var r=e.selector,i=e.args;try{var o=r.apply(void 0,[n()].concat(i));t(o)}catch(e){t(e,!0)}}(h,l):(h=ot.actionChannel(e))?function(e,r){var n=e.pattern,i=e.buffer,o=dt(n);o.pattern=n,r(ae(t,i||X.fixed(),o))}(h,l):(h=ot.flush(e))?function(e,t){e.flush(t)}(h,l):(h=ot.cancelled(e))?function(e,t){t(!!O.isCancelled)}(0,l):(h=ot.getContext(e))?function(e,t){t(C[e])}(h,l):(h=ot.setContext(e))?function(e,t){_.assign(C,e),t()}(h,l):l(e)}function V(e,t){var r=e[h];w.func(r)?t.cancel=r:w.func(e.abort)&&(t.cancel=function(){return e.abort()}),e.then(t,function(e){return t(e,!0)})}function G(e,i,a,s){pt(e,t,r,n,C,o,i,a,s)}function W(e,i,a){var s=e.context,c=e.fn,u=e.args,l=e.detached,h=function(e){var t=e.context,r=e.fn,n=e.args;if(w.iterator(r))return r;var i=void 0,o=void 0;try{i=r.apply(t,n)}catch(e){o=e}return w.iterator(i)?i:N(o?function(){throw o}:function(){var e=void 0,t={done:!1,value:i};return function(r){return e?function(e){return{done:!0,value:e}}(r):(e=!0,t)}}())}({context:s,fn:c,args:u});try{Z();var d=pt(h,t,r,n,C,o,i,c.name,l?null:v);l?a(d):h._isRunning?(F.addTask(d),a(d)):h._error?F.abort(h._error):a(d)}finally{$()}}function H(e,t,r){var n=Object.keys(e);if(!n.length)return r(w.array(e)?[]:{});var i=0,o=void 0,a={},s={};n.forEach(function(t){var c=function(s,c){o||(c||re(s)||s===ut||s===lt?(r.cancel(),r(s,c)):(a[t]=s,++i===n.length&&(o=!0,r(w.array(e)?M.from(at({},a,{length:n.length})):a))))};c.cancel=v,s[t]=c}),r.cancel=function(){o||(o=!0,n.forEach(function(e){return s[e].cancel()}))},n.forEach(function(r){return j(e[r],t,r,s[r])})}}var mt="runSaga(storeInterface, saga, ...args): saga argument must be a Generator function!";function vt(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o=void 0;w.iterator(e)?(o=e,e=t):(y(t,w.func,mt),y(o=t.apply(void 0,n),w.iterator,mt));var a=e,s=a.subscribe,c=a.dispatch,u=a.getState,l=a.context,h=a.sagaMonitor,d=a.logger,f=a.onError,p=L();h&&(h.effectTriggered=h.effectTriggered||v,h.effectResolved=h.effectResolved||v,h.effectRejected=h.effectRejected||v,h.effectCancelled=h.effectCancelled||v,h.actionDispatched=h.actionDispatched||v,h.effectTriggered({effectId:p,root:!0,parentEffectId:0,effect:{root:!0,saga:t,args:n}}));var m=pt(o,s,k(c),u,l,{sagaMonitor:h,logger:d,onError:f},p,t.name);return h&&h.effectResolved(p,m),m}r.d(t,!1,function(){return vt}),r.d(t,!1,function(){return te}),r.d(t,!1,function(){return ae}),r.d(t,!1,function(){return oe}),r.d(t,!1,function(){return X}),r.d(t,!1,function(){return pe}),r.d(t,!1,function(){return me}),r.d(t,!1,function(){return ve}),r.d(t,!1,function(){return E}),r.d(t,!1,function(){return h}),r.d(t,!1,function(){return De}),r.d(t,!1,function(){return n}),r.d(t,!1,function(){return i});t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,r=void 0===t?{}:t,n=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["context"]),i=n.sagaMonitor,o=n.logger,a=n.onError;if(w.func(n))throw new Error("Saga middleware no longer accept Generator functions. Use sagaMiddleware.run instead");if(o&&!w.func(o))throw new Error("`options.logger` passed to the Saga middleware is not a function!");if(a&&!w.func(a))throw new Error("`options.onError` passed to the Saga middleware is not a function!");if(n.emitter&&!w.func(n.emitter))throw new Error("`options.emitter` passed to the Saga middleware is not a function!");function s(e){var t=e.getState,c=e.dispatch,u=function(){var e=[];return{subscribe:function(t){return e.push(t),function(){return S(e,t)}},emit:function(t){for(var r=e.slice(),n=0,i=r.length;n<i;n++)r[n](t)}}}();return u.emit=(n.emitter||g)(u.emit),s.run=vt.bind(null,{context:r,subscribe:u.subscribe,dispatch:c,getState:t,sagaMonitor:i,logger:o,onError:a}),function(e){return function(t){i&&i.actionDispatched&&i.actionDispatched(t);var r=e(t);return u.emit(t),r}}}return s.run=function(){throw new Error("Before running a Saga, you must mount the Saga middleware on the Store using applyMiddleware")},s.setContext=function(e){y(e,w.object,U("sagaMiddleware",e)),_.assign(r,e)},s}},"74988f1178e5f1cc2f7a":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},"74be682203e7c82cb4c9":function(e,t,r){r("89a21af31babcdc56725")("Array")},"7519864545a89c83682d":function(e,t,r){"use strict";var n=r("5f25c015bbbf9d42c661"),i=r("88db22626e6c88b175cf"),o=r("7a7739dd8a198a2cfcb5"),a=r("7ad2c0eb9a8edcc472a4"),s=r("621a65702ee1a566fd32");e.exports=function(e,t,r){var c=s(e),u=r(a,c,""[e]),l=u[0],h=u[1];o(function(){var t={};return t[c]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,l),n(RegExp.prototype,c,2==t?function(e,t){return h.call(e,this,t)}:function(e){return h.call(e,this)}))}},"759097197b97ddad17eb":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("1f3157d073736826d4fa"),o=r("693c9c0dfc6db2b00620"),a=r("945a806e4f4787a7905b"),s=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*u[r],u[r]=n%1e7,n=c(n/1e7)},d=function(e){for(var t=6,r=0;--t>=0;)r+=u[t],u[t]=c(r/e),r=r%e*1e7},f=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var r=String(u[e]);t=""===t?r:t+a.call("0",7-r.length)+r}return t},p=function(e,t,r){return 0===t?r:t%2==1?p(e,t-1,r*e):p(e*e,t/2,r)};n(n.P+n.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r("7a7739dd8a198a2cfcb5")(function(){s.call({})})),"Number",{toFixed:function(e){var t,r,n,s,c=o(this,l),u=i(e),m="",v="0";if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(c*p(2,69,1))-69)<0?c*p(2,-t,1):c/p(2,t,1),r*=4503599627370496,(t=52-t)>0){for(h(0,r),n=u;n>=7;)h(1e7,0),n-=7;for(h(p(10,n,1),0),n=t-1;n>=23;)d(1<<23),n-=23;d(1<<n),h(1,1),d(2),v=f()}else h(0,r),h(1<<-t,0),v=f()+a.call("0",u);return v=u>0?m+((s=v.length)<=u?"0."+a.call("0",u-s)+v:v.slice(0,s-u)+"."+v.slice(s-u)):m+v}})},"759a6902720117087dd3":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("79c91dcd8cd554c59c7b"),o=function(e){this._t=i(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r("5c5d334c57135891e397")(o,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),n(n.S,"Reflect",{enumerate:function(e){return new o(e)}})},"770f76c876afc046e4e0":function(e,t,r){var n=r("1f3157d073736826d4fa"),i=r("7ad2c0eb9a8edcc472a4");e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),c=n(r),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},"77bfc0a151efbe7efe2d":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P+n.R,"Map",{toJSON:r("b319470fdda47fb5d046")("Map")})},"7830fb198d99e49e14ff":function(e,t,r){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var i=r("8af190b70a6bc55c6f1b"),o=n(i),a=n(r("f66a9a2f451f5f6cfabf")),s=n(r("a88d2aa2cbd689d523e2"));e.exports=function(e,t,r){if("function"!=typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof t)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==r&&"function"!=typeof r)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(n){if("function"!=typeof n)throw new Error("Expected WrappedComponent to be a React component.");var c=[],u=void 0;function l(){u=e(c.map(function(e){return e.props})),h.canUseDOM?t(u):r&&(u=r(u))}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.peek=function(){return u},t.rewind=function(){if(t.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=u;return u=void 0,c=[],e},t.prototype.shouldComponentUpdate=function(e){return!s(e,this.props)},t.prototype.componentWillMount=function(){c.push(this),l()},t.prototype.componentDidUpdate=function(){l()},t.prototype.componentWillUnmount=function(){var e=c.indexOf(this);c.splice(e,1),l()},t.prototype.render=function(){return o.createElement(n,this.props)},t}(i.Component);return h.displayName="SideEffect("+function(e){return e.displayName||e.name||"Component"}(n)+")",h.canUseDOM=a.canUseDOM,h}}},"7874b6e955f7d90ad7ec":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("1139de1233fd67f45bd7").isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},"79c91dcd8cd554c59c7b":function(e,t,r){var n=r("a459ab805827640a27e8");e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},"7a7739dd8a198a2cfcb5":function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},"7a8c0ef4f45a56962a18":function(e,t,r){"use strict";var n=r("1a5381b6e12121a4e33d"),i=r("2c407c4438ef2794ef23");e.exports=r("0633550d227682cecd10")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},"7ad2ae5e9bfa67dff4eb":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.createConnect=f;var i=l(r("8de1be082e521bbaabf2")),o=l(r("4b80994996621a6e63f3")),a=l(r("b6fe868af5705c1105ee")),s=l(r("bd5434bb096a0db94771")),c=l(r("3d514c6d979a6ce94521")),u=l(r("b76ef4afb4fcdfa26ddc"));function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t,r){for(var n=t.length-1;n>=0;n--){var i=t[n](e);if(i)return i}return function(t,n){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function d(e,t){return e===t}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connectHOC,r=void 0===t?i.default:t,l=e.mapStateToPropsFactories,f=void 0===l?s.default:l,p=e.mapDispatchToPropsFactories,m=void 0===p?a.default:p,v=e.mergePropsFactories,g=void 0===v?c.default:v,y=e.selectorFactory,b=void 0===y?u.default:y;return function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.pure,c=void 0===s||s,u=a.areStatesEqual,l=void 0===u?d:u,p=a.areOwnPropsEqual,v=void 0===p?o.default:p,y=a.areStatePropsEqual,x=void 0===y?o.default:y,w=a.areMergedPropsEqual,_=void 0===w?o.default:w,S=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),M=h(e,f,"mapStateToProps"),T=h(t,m,"mapDispatchToProps"),A=h(i,g,"mergeProps");return r(b,n({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:M,initMapDispatchToProps:T,initMergeProps:A,pure:c,areStatesEqual:l,areOwnPropsEqual:v,areStatePropsEqual:x,areMergedPropsEqual:_},S))}}t.default=f()},"7ad2c0eb9a8edcc472a4":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},"7ae46632a49db7ab2ae0":function(e,t,r){var n=r("1139de1233fd67f45bd7").parseFloat,i=r("57e7a4ee5fd1ce9280ef").trim;e.exports=1/n(r("f3bd18506acf22d8f1d4")+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},"7c3eb54bc7a7e3451a7e":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},"7c757e9b280b4a302846":function(e,t,r){"use strict";var n=!("undefined"==typeof window||!window.document||!window.document.createElement),i={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};e.exports=i},"7caa05c4b9a2c1771918":function(e,t){e.exports=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n}},"7e56d82a60dcbc0a4c8d":function(e,t,r){var n=r("104a011c3c0c4bae71c3")(Object.keys,Object);e.exports=n},"7f74493c48ab576afbd4":function(e,t,r){"use strict";t.__esModule=!0;var n=t.CALL_HISTORY_METHOD="@@router/CALL_HISTORY_METHOD";function i(e){return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return{type:n,payload:{method:e,args:r}}}}var o=t.push=i("push"),a=t.replace=i("replace"),s=t.go=i("go"),c=t.goBack=i("goBack"),u=t.goForward=i("goForward");t.routerActions={push:o,replace:a,go:s,goBack:c,goForward:u}},"7fc706acfdba9b87047f":function(e,t,r){var n=r("a9e0e4b5ca884ed0dd59"),i=r("f71a7c9d37f996326dd6"),o=r("79c91dcd8cd554c59c7b"),a=r("1139de1233fd67f45bd7").Reflect;e.exports=a&&a.ownKeys||function(e){var t=n.f(o(e)),r=i.f;return r?t.concat(r(e)):t}},"7fd90dee1f5cbd901d1c":function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},"801f84267d5c09c3892e":function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("4245b1933f7026101770"));t.default=n.default},"80e6088e4899523ce7ea":function(e,t,r){var n=r("18caba858d9ea0f67284").Symbol;e.exports=n},"825e103ed4a71fb91e11":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("770f76c876afc046e4e0")(!1);n(n.P,"String",{codePointAt:function(e){return i(this,e)}})},"8282da6ea45ca23bdd3c":function(e,t,r){r("02fcd2201285b358795d")("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}})},"82c3e6e6e3fe41af700d":function(e,t,r){"use strict";
/** @license React v16.5.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,h=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.placeholder"):60113;function p(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case h:case a:case c:case s:return e;default:switch(e=e&&e.$$typeof){case l:case d:case u:return e;default:return t}}case o:return t}}}t.typeOf=p,t.AsyncMode=h,t.ContextConsumer=l,t.ContextProvider=u,t.Element=i,t.ForwardRef=d,t.Fragment=a,t.Profiler=c,t.Portal=o,t.StrictMode=s,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===h||e===c||e===s||e===f||"object"==typeof e&&null!==e&&("function"==typeof e.then||e.$$typeof===u||e.$$typeof===l||e.$$typeof===d)},t.isAsyncMode=function(e){return p(e)===h},t.isContextConsumer=function(e){return p(e)===l},t.isContextProvider=function(e){return p(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return p(e)===d},t.isFragment=function(e){return p(e)===a},t.isProfiler=function(e){return p(e)===c},t.isPortal=function(e){return p(e)===o},t.isStrictMode=function(e){return p(e)===s}},"83306aed22ee07ce18aa":function(e,t,r){var n=r("80e6088e4899523ce7ea"),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=a.call(e);return n&&(t?e[s]=r:delete e[s]),i}},"83406643bfb209d249f4":function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in r=Object(arguments[c]))i.call(r,u)&&(s[u]=r[u]);if(n){a=n(r);for(var l=0;l<a.length;l++)o.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},"84696c4e387dcb8648dc":function(e,t){var r=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},"848061d2617404d8a848":function(e,t,r){var n=r("4be2c15021f717a728f0")(r("18caba858d9ea0f67284"),"Promise");e.exports=n},"848c17107e77a319b83b":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("0116c75136b233002fb9");n(n.S,"Error",{isError:function(e){return"Error"===i(e)}})},"852099b0cfb6ec8571a2":function(e,t,r){var n=r("1b01d0e59d3af79760a0"),i=r("2d13d93c336705cd8ff9"),o=r("79c91dcd8cd554c59c7b"),a=r("4ef7a75a1d1957a7c5c0");i(i.S+i.F*r("7a7739dd8a198a2cfcb5")(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){o(e),t=a(t,!0),o(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},"8626e2682ea1d2ef4882":function(e,t,r){var n,i,o;i=[t,r("669a82d2d2cdff2f9f35")],void 0===(o="function"==typeof(n=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(t);e.default=r.default})?n.apply(t,i):n)||(e.exports=o)},"862d27e3ce53aadb9a46":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},"87972ac436f8a43eea81":function(e,t){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function i(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=r?n:i).supported=n,t.unsupported=i},"87df535ec0c75eb666f4":function(e,t,r){"use strict";r("57e7a4ee5fd1ce9280ef")("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},"87f7b2a2f3e179b5c40a":function(e,t,r){var n=r("273d2eedcd369c189e70")("meta"),i=r("a459ab805827640a27e8"),o=r("d34390b928ecadc11dc8"),a=r("1b01d0e59d3af79760a0").f,s=0,c=Object.isExtensible||function(){return!0},u=!r("7a7739dd8a198a2cfcb5")(function(){return c(Object.preventExtensions({}))}),l=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&h.NEED&&c(e)&&!o(e,n)&&l(e),e}}},"88baaa5583416ec0cb42":function(e,t,r){r("7519864545a89c83682d")("match",1,function(e,t,r){return[function(r){"use strict";var n=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]})},"88db22626e6c88b175cf":function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("5f25c015bbbf9d42c661"),o=r("d34390b928ecadc11dc8"),a=r("273d2eedcd369c189e70")("src"),s=Function.toString,c=(""+s).split("toString");r("5925dad3c5243ffee3db").inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var u="function"==typeof r;u&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(u&&(o(r,a)||i(r,a,e[t]?""+e[t]:c.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},"896f33738142bf70015e":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("1e0f00d296712713afe6");n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},"89701ced11312fc14f3d":function(e,t,r){"use strict";var n,i,o,a,s=r("46a1a30d151cac60057c"),c=r("1139de1233fd67f45bd7"),u=r("0e717e1f47872428608d"),l=r("32b716d95af2fd3c5c23"),h=r("2d13d93c336705cd8ff9"),d=r("a459ab805827640a27e8"),f=r("4d073e2fededcdd3f3d3"),p=r("fd8b6034a9a06242cc87"),m=r("4133d6461867e9751fc3"),v=r("8b246eab22bc34690d38"),g=r("1ae513448994dc2a1e86").set,y=r("00c22f5845a5f3d8fe8c")(),b=r("0fcd62dab3511fe4dbf9"),x=r("b784fa01fa41fb2906a0"),w=r("5abe37fc05566b7b9eff"),_=r("8cea4f2c5f75a90121e7"),S=c.TypeError,M=c.process,T=M&&M.versions,A=T&&T.v8||"",E=c.Promise,C="process"==l(M),L=function(){},P=i=b.f,O=!!function(){try{var e=E.resolve(1),t=(e.constructor={})[r("621a65702ee1a566fd32")("species")]=function(e){e(L,L)};return(C||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==A.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),N=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},R=function(e,t){if(!e._n){e._n=!0;var r=e._c;y(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&F(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?u(S("Promise-chain cycle")):(o=N(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!a&&l.exit(),u(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&I(e)})}},I=function(e){g.call(c,function(){var t,r,n,i=e._v,o=D(e);if(o&&(t=x(function(){C?M.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=C||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){g.call(c,function(){var t;C?M.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},U=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),R(t,!0))},k=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw S("Promise can't be resolved itself");(t=N(e))?y(function(){var n={_w:r,_d:!1};try{t.call(e,u(k,n,1),u(U,n,1))}catch(e){U.call(n,e)}}):(r._v=e,r._s=1,R(r,!1))}catch(e){U.call({_w:r,_d:!1},e)}}};O||(E=function(e){p(this,E,"Promise","_h"),f(e),n.call(this);try{e(u(k,this,1),u(U,this,1))}catch(e){U.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r("503a0df91bcab33c39b8")(E.prototype,{then:function(e,t){var r=P(v(this,E));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=C?M.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(k,e,1),this.reject=u(U,e,1)},b.f=P=function(e){return e===E||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!O,{Promise:E}),r("62828dc3ffa96c06b7c9")(E,"Promise"),r("89a21af31babcdc56725")("Promise"),a=r("5925dad3c5243ffee3db").Promise,h(h.S+h.F*!O,"Promise",{reject:function(e){var t=P(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!O),"Promise",{resolve:function(e){return _(s&&this===a?E:this,e)}}),h(h.S+h.F*!(O&&r("574ea81f94fc0b2f332a")(function(e){E.all(e).catch(L)})),"Promise",{all:function(e){var t=this,r=P(t),n=r.resolve,i=r.reject,o=x(function(){var r=[],o=0,a=1;m(e,!1,function(e){var s=o++,c=!1;r.push(void 0),a++,t.resolve(e).then(function(e){c||(c=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=P(t),n=r.reject,i=x(function(){m(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},"89a21af31babcdc56725":function(e,t,r){"use strict";var n=r("1139de1233fd67f45bd7"),i=r("1b01d0e59d3af79760a0"),o=r("5975c7ea3ecd56e534e3"),a=r("621a65702ee1a566fd32")("species");e.exports=function(e){var t=n[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},"89fa59dfd48f288c4600":function(e,t,r){"use strict";t.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=h(r("412479c5138fb85aa19f")),a=h(r("6a4f9c383785f9168266")),s=r("92274ddfec80152892bc"),c=r("33ac025fdf0477f401a7"),u=h(r("ab8261c9b33ea00e4f82")),l=r("4a0368fb5bf578c56890");function h(e){return e&&e.__esModule?e:{default:e}}var d=function(){try{return window.history.state||{}}catch(e){return{}}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(l.canUseDOM,"Browser history needs a DOM");var t=window.history,r=(0,l.supportsHistory)(),h=!(0,l.supportsPopStateOnHashChange)(),f=e.forceRefresh,p=void 0!==f&&f,m=e.getUserConfirmation,v=void 0===m?l.getConfirmation:m,g=e.keyLength,y=void 0===g?6:g,b=e.basename?(0,c.stripTrailingSlash)((0,c.addLeadingSlash)(e.basename)):"",x=function(e){var t=e||{},r=t.key,n=t.state,i=window.location,a=i.pathname+i.search+i.hash;return(0,o.default)(!b||(0,c.hasBasename)(a,b),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+a+'" to begin with "'+b+'".'),b&&(a=(0,c.stripBasename)(a,b)),(0,s.createLocation)(a,n,r)},w=function(){return Math.random().toString(36).substr(2,y)},_=(0,u.default)(),S=function(e){i(F,e),F.length=t.length,_.notifyListeners(F.location,F.action)},M=function(e){(0,l.isExtraneousPopstateEvent)(e)||E(x(e.state))},T=function(){E(x(d()))},A=!1,E=function(e){A?(A=!1,S()):_.confirmTransitionTo(e,"POP",v,function(t){t?S({action:"POP",location:e}):C(e)})},C=function(e){var t=F.location,r=P.indexOf(t.key);-1===r&&(r=0);var n=P.indexOf(e.key);-1===n&&(n=0);var i=r-n;i&&(A=!0,N(i))},L=x(d()),P=[L.key],O=function(e){return b+(0,c.createPath)(e)},N=function(e){t.go(e)},R=0,I=function(e){1===(R+=e)?((0,l.addEventListener)(window,"popstate",M),h&&(0,l.addEventListener)(window,"hashchange",T)):0===R&&((0,l.removeEventListener)(window,"popstate",M),h&&(0,l.removeEventListener)(window,"hashchange",T))},D=!1,F={length:t.length,action:"POP",location:L,createHref:O,push:function(e,i){(0,o.default)(!("object"===(void 0===e?"undefined":n(e))&&void 0!==e.state&&void 0!==i),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var a=(0,s.createLocation)(e,i,w(),F.location);_.confirmTransitionTo(a,"PUSH",v,function(e){if(e){var n=O(a),i=a.key,s=a.state;if(r)if(t.pushState({key:i,state:s},null,n),p)window.location.href=n;else{var c=P.indexOf(F.location.key),u=P.slice(0,-1===c?0:c+1);u.push(a.key),P=u,S({action:"PUSH",location:a})}else(0,o.default)(void 0===s,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=n}})},replace:function(e,i){(0,o.default)(!("object"===(void 0===e?"undefined":n(e))&&void 0!==e.state&&void 0!==i),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var a=(0,s.createLocation)(e,i,w(),F.location);_.confirmTransitionTo(a,"REPLACE",v,function(e){if(e){var n=O(a),i=a.key,s=a.state;if(r)if(t.replaceState({key:i,state:s},null,n),p)window.location.replace(n);else{var c=P.indexOf(F.location.key);-1!==c&&(P[c]=a.key),S({action:"REPLACE",location:a})}else(0,o.default)(void 0===s,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(n)}})},go:N,goBack:function(){return N(-1)},goForward:function(){return N(1)},block:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_.setPrompt(e);return D||(I(1),D=!0),function(){return D&&(D=!1,I(-1)),t()}},listen:function(e){var t=_.appendListener(e);return I(1),function(){I(-1),t()}}};return F}},"8a0cb697d98576e60b9d":function(e,t,r){r("02fcd2201285b358795d")("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0)},"8a2d1b95e05b6a321e74":function(e,t,r){e.exports=r("a48408c9c405e4fca6d9")()},"8af190b70a6bc55c6f1b":function(e,t,r){"use strict";e.exports=r("d576fdbd1b2940cea26e")},"8b246eab22bc34690d38":function(e,t,r){var n=r("79c91dcd8cd554c59c7b"),i=r("4d073e2fededcdd3f3d3"),o=r("621a65702ee1a566fd32")("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[o])?t:i(r)}},"8c15b7ae3d0b33173ad3":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("7caa05c4b9a2c1771918"),o=r("3cf3ac9966b923e35829");n(n.S,"Math",{fscale:function(e,t,r,n,a){return o(i(e,t,r,n,a))}})},"8ce22de999557008faac":function(e,t){e.exports=function(e,t,r){var n=r.length;if(null==e)return!n;for(e=Object(e);n--;){var i=r[n],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}},"8cea4f2c5f75a90121e7":function(e,t,r){var n=r("79c91dcd8cd554c59c7b"),i=r("a459ab805827640a27e8"),o=r("0fcd62dab3511fe4dbf9");e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},"8cf67abed7f2159af642":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Object",{is:r("34c27cd73a2e6a6b0450")})},"8dc3899bd56512a6de6d":function(e,t,r){var n=r("a459ab805827640a27e8");r("f34797c0b42452934317")("isSealed",function(e){return function(t){return!n(t)||!!e&&e(t)}})},"8dde765ba393a8f99a70":function(e,t,r){var n=r("a459ab805827640a27e8");r("f34797c0b42452934317")("isExtensible",function(e){return function(t){return!!n(t)&&(!e||e(t))}})},"8de1be082e521bbaabf2":function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e){var t,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=u.getDisplayName,p=void 0===f?function(e){return"ConnectAdvanced("+e+")"}:f,m=u.methodName,v=void 0===m?"connectAdvanced":m,g=u.renderCountProp,y=void 0===g?void 0:g,b=u.shouldHandleStateChanges,x=void 0===b||b,w=u.storeKey,_=void 0===w?"store":w,S=u.withRef,M=void 0!==S&&S,T=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(u,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),A=_+"Subscription",E=l++,C=((t={})[_]=c.storeShape,t[A]=c.subscriptionShape,t),L=((r={})[A]=c.subscriptionShape,r);return function(t){(0,o.default)("function"==typeof t,"You must pass a component to the function returned by "+v+". Instead received "+JSON.stringify(t));var r=t.displayName||t.name||"Component",c=p(r),u=n({},T,{getDisplayName:p,methodName:v,renderCountProp:y,shouldHandleStateChanges:x,storeKey:_,withRef:M,displayName:c,wrappedComponentName:r,WrappedComponent:t}),l=function(r){function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,r.call(this,e,t));return n.version=E,n.state={},n.renderCount=0,n.store=e[_]||t[_],n.propsMode=Boolean(e[_]),n.setWrappedInstance=n.setWrappedInstance.bind(n),(0,o.default)(n.store,'Could not find "'+_+'" in either the context or props of "'+c+'". Either wrap the root component in a <Provider>, or explicitly pass "'+_+'" as a prop to "'+c+'".'),n.initSelector(),n.initSubscription(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,r),i.prototype.getChildContext=function(){var e,t=this.propsMode?null:this.subscription;return(e={})[A]=t||this.context[A],e},i.prototype.componentDidMount=function(){x&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},i.prototype.componentWillReceiveProps=function(e){this.selector.run(e)},i.prototype.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},i.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=d,this.store=null,this.selector.run=d,this.selector.shouldComponentUpdate=!1},i.prototype.getWrappedInstance=function(){return(0,o.default)(M,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+v+"() call."),this.wrappedInstance},i.prototype.setWrappedInstance=function(e){this.wrappedInstance=e},i.prototype.initSelector=function(){var t=e(this.store.dispatch,u);this.selector=function(e,t){var r={run:function(n){try{var i=e(t.getState(),n);(i!==r.props||r.error)&&(r.shouldComponentUpdate=!0,r.props=i,r.error=null)}catch(e){r.shouldComponentUpdate=!0,r.error=e}}};return r}(t,this.store),this.selector.run(this.props)},i.prototype.initSubscription=function(){if(x){var e=(this.propsMode?this.props:this.context)[A];this.subscription=new s.default(this.store,e,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},i.prototype.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(h)):this.notifyNestedSubs()},i.prototype.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},i.prototype.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},i.prototype.addExtraProps=function(e){if(!(M||y||this.propsMode&&this.subscription))return e;var t=n({},e);return M&&(t.ref=this.setWrappedInstance),y&&(t[y]=this.renderCount++),this.propsMode&&this.subscription&&(t[A]=this.subscription),t},i.prototype.render=function(){var e=this.selector;if(e.shouldComponentUpdate=!1,e.error)throw e.error;return(0,a.createElement)(t,this.addExtraProps(e.props))},i}(a.Component);return l.WrappedComponent=t,l.displayName=c,l.childContextTypes=L,l.contextTypes=C,l.propTypes=C,(0,i.default)(l,t)}};var i=u(r("5ef9de3df8d92ea0e41c")),o=u(r("6a4f9c383785f9168266")),a=r("8af190b70a6bc55c6f1b"),s=u(r("b7326326d1b249adb7bc")),c=r("1bd0e64edcedab820751");function u(e){return e&&e.__esModule?e:{default:e}}var l=0,h={};function d(){}},"8de492c765fbfb624515":function(e,t,r){"use strict";var n=r("1b01d0e59d3af79760a0"),i=r("9d5592e83ab7f3d08974");e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},"8e0402aa1481a930c9c3":function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("small",function(e){return function(){return e(this,"small","","")}})},"8f648b1026e01323935b":function(e,t,r){var n=r("0116c75136b233002fb9");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"9125d51ebaa93f49cfd5":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(3);n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},"9130a6b385cb6030d86a":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){if(void 0===e)throw new Error('Reducer "'+t+'" returned undefined when handling "'+r.type+'" action. To ignore an action, you must explicitly return the previous state.')},e.exports=t.default},"92274ddfec80152892bc":function(e,t,r){"use strict";t.__esModule=!0,t.locationsAreEqual=t.createLocation=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=s(r("49555589e35fce2252cc")),o=s(r("c08c9d9f47b3a7dc389f")),a=r("33ac025fdf0477f401a7");function s(e){return e&&e.__esModule?e:{default:e}}t.createLocation=function(e,t,r,o){var s=void 0;"string"==typeof e?(s=(0,a.parsePath)(e)).state=t:(void 0===(s=n({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return r&&(s.key=r),o?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=(0,i.default)(s.pathname,o.pathname)):s.pathname=o.pathname:s.pathname||(s.pathname="/"),s},t.locationsAreEqual=function(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&(0,o.default)(e.state,t.state)}},"92af855fdee54bacfa47":function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},"92efe77f5aacb0dee3db":function(e,t,r){var n=r("efae14a3f8cd9a616256"),i=r("a9e0e4b5ca884ed0dd59").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(n(e))}},"9344d77decda1f9977b7":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("dae53c7f1be5fcfdbe4b"),o=Math.exp;n(n.S,"Math",{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},"93608b8fd0e135fbe5e6":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var r,n,o=0,a=0,s=arguments.length,c=0;a<s;)c<(r=i(arguments[a++]))?(o=o*(n=c/r)*n+1,c=r):o+=r>0?(n=r/c)*n:r;return c===1/0?1/0:c*Math.sqrt(o)}})},"93aa2354fc0594ea6148":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("d394d0a4c1838202489d"),o=r("4ef7a75a1d1957a7c5c0");n(n.P+n.F*r("7a7739dd8a198a2cfcb5")(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),r=o(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},"941df1c42d2f478ed942":function(e,t,r){r("5975c7ea3ecd56e534e3")&&"g"!=/./g.flags&&r("1b01d0e59d3af79760a0").f(RegExp.prototype,"flags",{configurable:!0,get:r("f936413e306f54e59a2a")})},"945a806e4f4787a7905b":function(e,t,r){"use strict";var n=r("1f3157d073736826d4fa"),i=r("7ad2c0eb9a8edcc472a4");e.exports=function(e){var t=String(i(this)),r="",o=n(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(r+=t);return r}},"94f99fc446430aabde47":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("7a7739dd8a198a2cfcb5"),o=r("693c9c0dfc6db2b00620"),a=1..toPrecision;n(n.P+n.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},"94fb07840c0fda6ca6a4":function(e,t,r){"use strict";var n=r("145c4f2bdc487b2578df"),i=r("f71a7c9d37f996326dd6"),o=r("0091fa8d74c45e0dd589"),a=r("d394d0a4c1838202489d"),s=r("a537d0accb907bf9d41f"),c=Object.assign;e.exports=!c||r("7a7739dd8a198a2cfcb5")(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=a(e),c=arguments.length,u=1,l=i.f,h=o.f;c>u;)for(var d,f=s(arguments[u++]),p=l?n(f).concat(l(f)):n(f),m=p.length,v=0;m>v;)h.call(f,d=p[v++])&&(r[d]=f[d]);return r}:c},"96006d3b208a72eaa49c":function(e,t,r){r("9f769c6d0e4c9e82ba05")("WeakMap")},"96903bd4a4f0ab20afc4":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.PI/180;n(n.S,"Math",{radians:function(e){return e*i}})},"98e5f258a85d7fd22ef8":function(e,t,r){var n=r("b8bc1433202509fac65f"),i=r("e99524bb668f88c6c42e"),o=r("f2ef6f6e544aad97aa22"),a=r("72301e3cc725dd502232"),s=r("f72c7c366a646d5e453e"),c=r("1ef5eae0d45731e89b6f"),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),l=!r&&i(e),h=!r&&!l&&a(e),d=!r&&!l&&!h&&c(e),f=r||l||h||d,p=f?n(e.length,String):[],m=p.length;for(var v in e)!t&&!u.call(e,v)||f&&("length"==v||h&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,m))||p.push(v);return p}},"98e9f3c3a8d686f8cc0f":function(e,t,r){var n=r("ca19e32ab6ee3b3692aa"),i=r("945a806e4f4787a7905b"),o=r("7ad2c0eb9a8edcc472a4");e.exports=function(e,t,r,a){var s=String(o(e)),c=s.length,u=void 0===r?" ":String(r),l=n(t);if(l<=c||""==u)return s;var h=l-c,d=i.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},"9941d65ede78b70dbd5a":function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=Math.exp;n(n.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},"99611036d7ebe5f0cac9":function(e,t,r){var n=r("61fcea04092a9580d371"),i=r("2d13d93c336705cd8ff9"),o=r("79c91dcd8cd554c59c7b");i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(o(e),t)}})},"999b8422c18ed8d20c8d":function(e,t,r){"use strict";t.__esModule=!0,t.withRouter=t.matchPath=t.generatePath=t.Switch=t.StaticRouter=t.Router=t.Route=t.Redirect=t.Prompt=t.MemoryRouter=void 0;var n=f(r("de6553e2eed497bebede")),i=f(r("cae0f026dfe4729a216f")),o=f(r("4245b1933f7026101770")),a=f(r("35440e3d539ea8d61c51")),s=f(r("07a2173bac8ab93c3080")),c=f(r("5692bffd717498245e82")),u=f(r("58a762c5dd9e5f9d6ad3")),l=f(r("d14c3129375a94963214")),h=f(r("56f612169e8c0cac4c0c")),d=f(r("2d8c8264a871cfe44bc2"));function f(e){return e&&e.__esModule?e:{default:e}}t.MemoryRouter=n.default,t.Prompt=i.default,t.Redirect=o.default,t.Route=a.default,t.Router=s.default,t.StaticRouter=c.default,t.Switch=u.default,t.generatePath=l.default,t.matchPath=h.default,t.withRouter=d.default},"9c0601b67ba572e10d92":function(e,t,r){"use strict";t.__esModule=!0,t.wrapMapToPropsConstant=function(e){return function(t,r){var n=e(t,r);function i(){return n}return i.dependsOnOwnProps=!1,i}},t.getDependsOnOwnProps=n,t.wrapMapToPropsFunc=function(e,t){return function(t,r){r.displayName;var i=function(e,t){return i.dependsOnOwnProps?i.mapToProps(e,t):i.mapToProps(e)};return i.dependsOnOwnProps=!0,i.mapToProps=function(t,r){i.mapToProps=e,i.dependsOnOwnProps=n(e);var o=i(t,r);return"function"==typeof o&&(i.mapToProps=o,i.dependsOnOwnProps=n(o),o=i(t,r)),o},i}};!function(e){e&&e.__esModule}(r("b452ab1ee9229ca9f134"));function n(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}},"9d5592e83ab7f3d08974":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"9e0bbfb109257d4426cd":function(e,t){function r(e){var t=[];for(var r in e)t.push(r);return t}(e.exports="function"==typeof Object.keys?Object.keys:r).shim=r},"9e57e2b1bf9af3290fa7":function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("2d13d93c336705cd8ff9"),o=r("5abe37fc05566b7b9eff"),a=[].slice,s=/MSIE .\./.test(o),c=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&a.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*s,{setTimeout:c(n.setTimeout),setInterval:c(n.setInterval)})},"9f769c6d0e4c9e82ba05":function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9");e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},a1cf5d6fa4ed65a6ddd5:function(e,t,r){var n=r("ab33744f6df37edcb9b2"),i=r("16a2663068191a21c134"),o=r("e99524bb668f88c6c42e"),a=r("f2ef6f6e544aad97aa22"),s=r("c9327538105d995811b8"),c=r("72301e3cc725dd502232"),u=r("47e9e16a3e339321eec5"),l=r("1ef5eae0d45731e89b6f"),h="[object Map]",d="[object Set]",f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||l(e)||o(e)))return!e.length;var t=i(e);if(t==h||t==d)return!e.size;if(u(e))return!n(e).length;for(var r in e)if(f.call(e,r))return!1;return!0}},a26e52c4218006ed1d2f:function(e,t,r){"use strict";(function(e){if(r("bfea3a646c640826923d"),r("2c09af3fb5c4ba3698b3"),r("a87c75cb4bbbfc3ee4d7"),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var t="defineProperty";function n(e,r,n){e[r]||Object[t](e,r,{writable:!0,configurable:!0,value:n})}n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&n(Array,e,Function.call.bind([][e]))})}).call(this,r("698d75b157f24ae829cc"))},a28fc3c963a1d4d1a2e5:function(e,t,r){"use strict";function n(e,t){return e===t}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,i=null;return function(){return function(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],r[i]))return!1;return!0}(t,r,arguments)||(i=e.apply(null,arguments)),r=arguments,i}}r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a});var o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];var a=0,s=n.pop(),c=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var r=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}(n),u=e.apply(void 0,[function(){return a++,s.apply(null,arguments)}].concat(r)),l=i(function(){for(var e=[],t=c.length,r=0;r<t;r++)e.push(c[r].apply(null,arguments));return u.apply(null,e)});return l.resultFunc=s,l.recomputations=function(){return a},l.resetRecomputations=function(){return a=0},l}}(i);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var r=Object.keys(e);return t(r.map(function(t){return e[t]}),function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t,n){return e[r[n]]=t,e},{})})}},a312a83ea9b9e61f1871:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("f5ddf41194f6969220b2"),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},a36c797149bbcb96646f:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&"@@redux/INIT"===e.type?"initialState argument passed to createStore":"previous state received by the reducer"},e.exports=t.default},a37430c2bf749b8b8f88:function(e,t,r){var n=r("145c4f2bdc487b2578df"),i=r("f71a7c9d37f996326dd6"),o=r("0091fa8d74c45e0dd589");e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},a459ab805827640a27e8:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},a48408c9c405e4fca6d9:function(e,t,r){"use strict";var n=r("ec9de96ce27c00ac79c5"),i=r("277cfc1331526160cbd4"),o=r("6d8be12a50447a7c97b1");e.exports=function(){function e(e,t,r,n,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=n,r.PropTypes=r,r}},a485a45ff240f20fb978:function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=n.key,a=n.set;n.exp({defineMetadata:function(e,t,r,n){a(e,t,i(r),o(n))}})},a537d0accb907bf9d41f:function(e,t,r){var n=r("0116c75136b233002fb9");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},a5e6f0092ff0290e0bcf:function(e,t,r){var n=r("621a65702ee1a566fd32")("unscopables"),i=Array.prototype;void 0==i[n]&&r("5f25c015bbbf9d42c661")(i,n,{}),e.exports=function(e){i[n][e]=!0}},a607943c6ce671e7106b:function(e,t,r){var n=r("104a011c3c0c4bae71c3")(Object.getPrototypeOf,Object);e.exports=n},a6d645856102faf17328:function(e,t,r){var n=r("1b01d0e59d3af79760a0"),i=r("79c91dcd8cd554c59c7b"),o=r("145c4f2bdc487b2578df");e.exports=r("5975c7ea3ecd56e534e3")?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,c=0;s>c;)n.f(e,r=a[c++],t[r]);return e}},a76f7d57f23e05fc0ac3:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("dae53c7f1be5fcfdbe4b");n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},a7e3807798c0b990af09:function(e,t,r){"use strict";t.__esModule=!0,t.routerMiddleware=t.routerActions=t.goForward=t.goBack=t.go=t.replace=t.push=t.CALL_HISTORY_METHOD=t.routerReducer=t.LOCATION_CHANGE=t.createMatchSelector=t.getLocation=t.ConnectedRouter=void 0;var n=r("637643d0c0e16de3ee55");Object.defineProperty(t,"getLocation",{enumerable:!0,get:function(){return n.getLocation}}),Object.defineProperty(t,"createMatchSelector",{enumerable:!0,get:function(){return n.createMatchSelector}});var i=r("2e20dfefd16154e6ed7b");Object.defineProperty(t,"LOCATION_CHANGE",{enumerable:!0,get:function(){return i.LOCATION_CHANGE}}),Object.defineProperty(t,"routerReducer",{enumerable:!0,get:function(){return i.routerReducer}});var o=r("7f74493c48ab576afbd4");Object.defineProperty(t,"CALL_HISTORY_METHOD",{enumerable:!0,get:function(){return o.CALL_HISTORY_METHOD}}),Object.defineProperty(t,"push",{enumerable:!0,get:function(){return o.push}}),Object.defineProperty(t,"replace",{enumerable:!0,get:function(){return o.replace}}),Object.defineProperty(t,"go",{enumerable:!0,get:function(){return o.go}}),Object.defineProperty(t,"goBack",{enumerable:!0,get:function(){return o.goBack}}),Object.defineProperty(t,"goForward",{enumerable:!0,get:function(){return o.goForward}}),Object.defineProperty(t,"routerActions",{enumerable:!0,get:function(){return o.routerActions}});var a=c(r("61597e5c866e9f95c20b")),s=c(r("ce67b7d2fd06d83e5334"));function c(e){return e&&e.__esModule?e:{default:e}}t.ConnectedRouter=a.default,t.routerMiddleware=s.default},a87c75cb4bbbfc3ee4d7:function(e,t,r){r("24c5bf497be6b8e1330e"),e.exports=r("5925dad3c5243ffee3db").RegExp.escape},a88d2aa2cbd689d523e2:function(e,t){e.exports=function(e,t,r,n){var i=r?r.call(n,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),c=0;c<o.length;c++){var u=o[c];if(!s(u))return!1;var l=e[u],h=t[u];if(!1===(i=r?r.call(n,l,h,u):void 0)||void 0===i&&l!==h)return!1}return!0}},a9e0e4b5ca884ed0dd59:function(e,t,r){var n=r("e3136eea77d23f8d97ec"),i=r("380c0734c088ca78ccda").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},aaa8ac4298b679dfe295:function(e,t,r){"use strict";t.__esModule=!0,t.createProvider=s;var n=r("8af190b70a6bc55c6f1b"),i=a(r("8a2d1b95e05b6a321e74")),o=r("1bd0e64edcedab820751");a(r("c0fa96a4e042118a422d"));function a(e){return e&&e.__esModule?e:{default:e}}function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"store",r=arguments[1]||t+"Subscription",a=function(e){function i(r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r,n));return o[t]=r.store,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e),i.prototype.getChildContext=function(){var e;return(e={})[t]=this[t],e[r]=null,e},i.prototype.render=function(){return n.Children.only(this.props.children)},i}(n.Component);return a.propTypes={store:o.storeShape.isRequired,children:i.default.element.isRequired},a.childContextTypes=((e={})[t]=o.storeShape.isRequired,e[r]=o.subscriptionShape,e),a}t.default=s()},aae15840322550f153dc:function(e,t,r){"use strict";var n=r("32b716d95af2fd3c5c23"),i={};i[r("621a65702ee1a566fd32")("toStringTag")]="z",i+""!="[object z]"&&r("88db22626e6c88b175cf")(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},ab039aecd4a1d4fedc0e:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),o=Object.prototype.hasOwnProperty;function a(e){var t,r,n,i,a=Array.prototype.slice.call(arguments,1);for(t=0,r=a.length;t<r;t+=1)if(n=a[t])for(i in n)o.call(n,i)&&(e[i]=n[i]);return e}var s=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),c=(!s&&Object.prototype.__defineGetter__,s?Object.defineProperty:function(e,t,r){"get"in r&&e.__defineGetter__?e.__defineGetter__(t,r.get):(!o.call(e,t)||"value"in r)&&(e[t]=r.value)}),u=Object.create||function(e,t){var r,n;function i(){}for(n in i.prototype=e,r=new i,t)o.call(t,n)&&c(r,n,t[n]);return r},l=h;function h(e,t,r){this.locales=e,this.formats=t,this.pluralFn=r}function d(e){this.id=e}function f(e,t,r,n,i){this.id=e,this.useOrdinal=t,this.offset=r,this.options=n,this.pluralFn=i}function p(e,t,r,n){this.id=e,this.offset=t,this.numberFormat=r,this.string=n}function m(e,t){this.id=e,this.options=t}h.prototype.compile=function(e){return this.pluralStack=[],this.currentPlural=null,this.pluralNumberFormat=null,this.compileMessage(e)},h.prototype.compileMessage=function(e){if(!e||"messageFormatPattern"!==e.type)throw new Error('Message AST is not of type: "messageFormatPattern"');var t,r,n,i=e.elements,o=[];for(t=0,r=i.length;t<r;t+=1)switch((n=i[t]).type){case"messageTextElement":o.push(this.compileMessageText(n));break;case"argumentElement":o.push(this.compileArgument(n));break;default:throw new Error("Message element does not have a valid type")}return o},h.prototype.compileMessageText=function(e){return this.currentPlural&&/(^|[^\\])#/g.test(e.value)?(this.pluralNumberFormat||(this.pluralNumberFormat=new Intl.NumberFormat(this.locales)),new p(this.currentPlural.id,this.currentPlural.format.offset,this.pluralNumberFormat,e.value)):e.value.replace(/\\#/g,"#")},h.prototype.compileArgument=function(e){var t=e.format;if(!t)return new d(e.id);var r,n=this.formats,i=this.locales,o=this.pluralFn;switch(t.type){case"numberFormat":return r=n.number[t.style],{id:e.id,format:new Intl.NumberFormat(i,r).format};case"dateFormat":return r=n.date[t.style],{id:e.id,format:new Intl.DateTimeFormat(i,r).format};case"timeFormat":return r=n.time[t.style],{id:e.id,format:new Intl.DateTimeFormat(i,r).format};case"pluralFormat":return r=this.compileOptions(e),new f(e.id,t.ordinal,t.offset,r,o);case"selectFormat":return r=this.compileOptions(e),new m(e.id,r);default:throw new Error("Message element does not have a valid format type")}},h.prototype.compileOptions=function(e){var t,r,n,i=e.format,o=i.options,a={};for(this.pluralStack.push(this.currentPlural),this.currentPlural="pluralFormat"===i.type?e:null,t=0,r=o.length;t<r;t+=1)a[(n=o[t]).selector]=this.compileMessage(n.value);return this.currentPlural=this.pluralStack.pop(),a},d.prototype.format=function(e){return e||"number"==typeof e?"string"==typeof e?e:String(e):""},f.prototype.getOption=function(e){var t=this.options;return t["="+e]||t[this.pluralFn(e-this.offset,this.useOrdinal)]||t.other},p.prototype.format=function(e){var t=this.numberFormat.format(e-this.offset);return this.string.replace(/(^|[^\\])#/g,"$1"+t).replace(/\\#/g,"#")},m.prototype.getOption=function(e){var t=this.options;return t[e]||t.other};var v=function(){function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),{SyntaxError:e,parse:function(t){var r,n=arguments.length>1?arguments[1]:{},i={},o={start:Pe},a=Pe,s=function(e){return{type:"messageFormatPattern",elements:e,location:Te()}},c=function(e){var t,r,n,i,o,a="";for(t=0,n=e.length;t<n;t+=1)for(r=0,o=(i=e[t]).length;r<o;r+=1)a+=i[r];return a},u=function(e){return{type:"messageTextElement",value:e,location:Te()}},l=/^[^ \t\n\r,.+={}#]/,h={type:"class",value:"[^ \\t\\n\\r,.+={}#]",description:"[^ \\t\\n\\r,.+={}#]"},d="{",f={type:"literal",value:"{",description:'"{"'},p=",",m={type:"literal",value:",",description:'","'},v="}",g={type:"literal",value:"}",description:'"}"'},y=function(e,t){return{type:"argumentElement",id:e,format:t&&t[2],location:Te()}},b="number",x={type:"literal",value:"number",description:'"number"'},w="date",_={type:"literal",value:"date",description:'"date"'},S="time",M={type:"literal",value:"time",description:'"time"'},T=function(e,t){return{type:e+"Format",style:t&&t[2],location:Te()}},A="plural",E={type:"literal",value:"plural",description:'"plural"'},C=function(e){return{type:e.type,ordinal:!1,offset:e.offset||0,options:e.options,location:Te()}},L="selectordinal",P={type:"literal",value:"selectordinal",description:'"selectordinal"'},O=function(e){return{type:e.type,ordinal:!0,offset:e.offset||0,options:e.options,location:Te()}},N="select",R={type:"literal",value:"select",description:'"select"'},I=function(e){return{type:"selectFormat",options:e,location:Te()}},D="=",F={type:"literal",value:"=",description:'"="'},U=function(e,t){return{type:"optionalFormatPattern",selector:e,value:t,location:Te()}},k="offset:",B={type:"literal",value:"offset:",description:'"offset:"'},z=function(e){return e},j=function(e,t){return{type:"pluralFormat",offset:e,options:t,location:Te()}},V={type:"other",description:"whitespace"},G=/^[ \t\n\r]/,W={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},H={type:"other",description:"optionalWhitespace"},X=/^[0-9]/,q={type:"class",value:"[0-9]",description:"[0-9]"},Y=/^[0-9a-f]/i,J={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},Q="0",Z={type:"literal",value:"0",description:'"0"'},K=/^[1-9]/,$={type:"class",value:"[1-9]",description:"[1-9]"},ee=function(e){return parseInt(e,10)},te=/^[^{}\\\0-\x1F \t\n\r]/,re={type:"class",value:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]"},ne="\\\\",ie={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},oe=function(){return"\\"},ae="\\#",se={type:"literal",value:"\\#",description:'"\\\\#"'},ce=function(){return"\\#"},ue="\\{",le={type:"literal",value:"\\{",description:'"\\\\{"'},he=function(){return"{"},de="\\}",fe={type:"literal",value:"\\}",description:'"\\\\}"'},pe=function(){return"}"},me="\\u",ve={type:"literal",value:"\\u",description:'"\\\\u"'},ge=function(e){return String.fromCharCode(parseInt(e,16))},ye=function(e){return e.join("")},be=0,xe=0,we=[{line:1,column:1,seenCR:!1}],_e=0,Se=[],Me=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=o[n.startRule]}function Te(){return Ee(xe,be)}function Ae(e){var r,n,i=we[e];if(i)return i;for(r=e-1;!we[r];)r--;for(i={line:(i=we[r]).line,column:i.column,seenCR:i.seenCR};r<e;)"\n"===(n=t.charAt(r))?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),r++;return we[e]=i,i}function Ee(e,t){var r=Ae(e),n=Ae(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Ce(e){be<_e||(be>_e&&(_e=be,Se=[]),Se.push(e))}function Le(t,r,n,i){return null!==r&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(r),new e(null!==t?t:function(e,t){var r,n=new Array(e.length);for(r=0;r<e.length;r++)n[r]=e[r].description;return"Expected "+(e.length>1?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+'"':"end of input")+" found."}(r,n),r,n,i)}function Pe(){return Oe()}function Oe(){var e,t,r;for(e=be,t=[],r=Ne();r!==i;)t.push(r),r=Ne();return t!==i&&(xe=e,t=s(t)),e=t}function Ne(){var e;return(e=function(){var e,r;return e=be,(r=function(){var e,r,n,o,a,s;if(e=be,r=[],n=be,(o=Fe())!==i&&(a=je())!==i&&(s=Fe())!==i?n=o=[o,a,s]:(be=n,n=i),n!==i)for(;n!==i;)r.push(n),n=be,(o=Fe())!==i&&(a=je())!==i&&(s=Fe())!==i?n=o=[o,a,s]:(be=n,n=i);else r=i;return r!==i&&(xe=e,r=c(r)),(e=r)===i&&(e=be,r=De(),e=r!==i?t.substring(e,be):r),e}())!==i&&(xe=e,r=u(r)),e=r}())===i&&(e=function(){var e,r,n,o,a,s,c;return e=be,123===t.charCodeAt(be)?(r=d,be++):(r=i,0===Me&&Ce(f)),r!==i&&Fe()!==i&&(n=function(){var e,r,n;if((e=Be())===i){if(e=be,r=[],l.test(t.charAt(be))?(n=t.charAt(be),be++):(n=i,0===Me&&Ce(h)),n!==i)for(;n!==i;)r.push(n),l.test(t.charAt(be))?(n=t.charAt(be),be++):(n=i,0===Me&&Ce(h));else r=i;e=r!==i?t.substring(e,be):r}return e}())!==i&&Fe()!==i?(o=be,44===t.charCodeAt(be)?(a=p,be++):(a=i,0===Me&&Ce(m)),a!==i&&(s=Fe())!==i&&(c=function(){var e;return(e=function(){var e,r,n,o,a,s;return e=be,t.substr(be,6)===b?(r=b,be+=6):(r=i,0===Me&&Ce(x)),r===i&&(t.substr(be,4)===w?(r=w,be+=4):(r=i,0===Me&&Ce(_)),r===i&&(t.substr(be,4)===S?(r=S,be+=4):(r=i,0===Me&&Ce(M)))),r!==i&&Fe()!==i?(n=be,44===t.charCodeAt(be)?(o=p,be++):(o=i,0===Me&&Ce(m)),o!==i&&(a=Fe())!==i&&(s=je())!==i?n=o=[o,a,s]:(be=n,n=i),n===i&&(n=null),n!==i?(xe=e,r=T(r,n),e=r):(be=e,e=i)):(be=e,e=i),e}())===i&&(e=function(){var e,r,n,o;return e=be,t.substr(be,6)===A?(r=A,be+=6):(r=i,0===Me&&Ce(E)),r!==i&&Fe()!==i?(44===t.charCodeAt(be)?(n=p,be++):(n=i,0===Me&&Ce(m)),n!==i&&Fe()!==i&&(o=Ie())!==i?(xe=e,r=C(o),e=r):(be=e,e=i)):(be=e,e=i),e}())===i&&(e=function(){var e,r,n,o;return e=be,t.substr(be,13)===L?(r=L,be+=13):(r=i,0===Me&&Ce(P)),r!==i&&Fe()!==i?(44===t.charCodeAt(be)?(n=p,be++):(n=i,0===Me&&Ce(m)),n!==i&&Fe()!==i&&(o=Ie())!==i?(xe=e,r=O(o),e=r):(be=e,e=i)):(be=e,e=i),e}())===i&&(e=function(){var e,r,n,o,a;if(e=be,t.substr(be,6)===N?(r=N,be+=6):(r=i,0===Me&&Ce(R)),r!==i)if(Fe()!==i)if(44===t.charCodeAt(be)?(n=p,be++):(n=i,0===Me&&Ce(m)),n!==i)if(Fe()!==i){if(o=[],(a=Re())!==i)for(;a!==i;)o.push(a),a=Re();else o=i;o!==i?(xe=e,r=I(o),e=r):(be=e,e=i)}else be=e,e=i;else be=e,e=i;else be=e,e=i;else be=e,e=i;return e}()),e}())!==i?o=a=[a,s,c]:(be=o,o=i),o===i&&(o=null),o!==i&&(a=Fe())!==i?(125===t.charCodeAt(be)?(s=v,be++):(s=i,0===Me&&Ce(g)),s!==i?(xe=e,r=y(n,o),e=r):(be=e,e=i)):(be=e,e=i)):(be=e,e=i),e}()),e}function Re(){var e,r,n,o,a;return e=be,Fe()!==i&&(r=function(){var e,r,n,o;return e=be,r=be,61===t.charCodeAt(be)?(n=D,be++):(n=i,0===Me&&Ce(F)),n!==i&&(o=Be())!==i?r=n=[n,o]:(be=r,r=i),(e=r!==i?t.substring(e,be):r)===i&&(e=je()),e}())!==i&&Fe()!==i?(123===t.charCodeAt(be)?(n=d,be++):(n=i,0===Me&&Ce(f)),n!==i&&Fe()!==i&&(o=Oe())!==i&&Fe()!==i?(125===t.charCodeAt(be)?(a=v,be++):(a=i,0===Me&&Ce(g)),a!==i?(xe=e,e=U(r,o)):(be=e,e=i)):(be=e,e=i)):(be=e,e=i),e}function Ie(){var e,r,n,o;if(e=be,(r=function(){var e,r,n;return e=be,t.substr(be,7)===k?(r=k,be+=7):(r=i,0===Me&&Ce(B)),r!==i&&Fe()!==i&&(n=Be())!==i?(xe=e,e=r=z(n)):(be=e,e=i),e}())===i&&(r=null),r!==i)if(Fe()!==i){if(n=[],(o=Re())!==i)for(;o!==i;)n.push(o),o=Re();else n=i;n!==i?(xe=e,e=r=j(r,n)):(be=e,e=i)}else be=e,e=i;else be=e,e=i;return e}function De(){var e,r;if(Me++,e=[],G.test(t.charAt(be))?(r=t.charAt(be),be++):(r=i,0===Me&&Ce(W)),r!==i)for(;r!==i;)e.push(r),G.test(t.charAt(be))?(r=t.charAt(be),be++):(r=i,0===Me&&Ce(W));else e=i;return Me--,e===i&&(r=i,0===Me&&Ce(V)),e}function Fe(){var e,r,n;for(Me++,e=be,r=[],n=De();n!==i;)r.push(n),n=De();return e=r!==i?t.substring(e,be):r,Me--,e===i&&(r=i,0===Me&&Ce(H)),e}function Ue(){var e;return X.test(t.charAt(be))?(e=t.charAt(be),be++):(e=i,0===Me&&Ce(q)),e}function ke(){var e;return Y.test(t.charAt(be))?(e=t.charAt(be),be++):(e=i,0===Me&&Ce(J)),e}function Be(){var e,r,n,o,a,s;if(e=be,48===t.charCodeAt(be)?(r=Q,be++):(r=i,0===Me&&Ce(Z)),r===i){if(r=be,n=be,K.test(t.charAt(be))?(o=t.charAt(be),be++):(o=i,0===Me&&Ce($)),o!==i){for(a=[],s=Ue();s!==i;)a.push(s),s=Ue();a!==i?n=o=[o,a]:(be=n,n=i)}else be=n,n=i;r=n!==i?t.substring(r,be):n}return r!==i&&(xe=e,r=ee(r)),e=r}function ze(){var e,r,n,o,a,s,c,u;return te.test(t.charAt(be))?(e=t.charAt(be),be++):(e=i,0===Me&&Ce(re)),e===i&&(e=be,t.substr(be,2)===ne?(r=ne,be+=2):(r=i,0===Me&&Ce(ie)),r!==i&&(xe=e,r=oe()),(e=r)===i&&(e=be,t.substr(be,2)===ae?(r=ae,be+=2):(r=i,0===Me&&Ce(se)),r!==i&&(xe=e,r=ce()),(e=r)===i&&(e=be,t.substr(be,2)===ue?(r=ue,be+=2):(r=i,0===Me&&Ce(le)),r!==i&&(xe=e,r=he()),(e=r)===i&&(e=be,t.substr(be,2)===de?(r=de,be+=2):(r=i,0===Me&&Ce(fe)),r!==i&&(xe=e,r=pe()),(e=r)===i&&(e=be,t.substr(be,2)===me?(r=me,be+=2):(r=i,0===Me&&Ce(ve)),r!==i?(n=be,o=be,(a=ke())!==i&&(s=ke())!==i&&(c=ke())!==i&&(u=ke())!==i?o=a=[a,s,c,u]:(be=o,o=i),(n=o!==i?t.substring(n,be):o)!==i?(xe=e,e=r=ge(n)):(be=e,e=i)):(be=e,e=i)))))),e}function je(){var e,t,r;if(e=be,t=[],(r=ze())!==i)for(;r!==i;)t.push(r),r=ze();else t=i;return t!==i&&(xe=e,t=ye(t)),e=t}if((r=a())!==i&&be===t.length)return r;throw r!==i&&be<t.length&&Ce({type:"end",description:"end of input"}),Le(null,Se,_e<t.length?t.charAt(_e):null,_e<t.length?Ee(_e,_e+1):Ee(_e,_e))}}}(),g=y;function y(e,t,r){var n="string"==typeof e?y.__parse(e):e;if(!n||"messageFormatPattern"!==n.type)throw new TypeError("A message must be provided as a String or AST.");r=this._mergeFormats(y.formats,r),c(this,"_locale",{value:this._resolveLocale(t)});var i=this._findPluralRuleFunction(this._locale),o=this._compilePattern(n,t,r,i),a=this;this.format=function(t){try{return a._format(o,t)}catch(t){throw t.variableId?new Error("The intl string context variable '"+t.variableId+"' was not provided to the string '"+e+"'"):t}}}c(y,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),c(y,"__localeData__",{value:u(null)}),c(y,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");y.__localeData__[e.locale.toLowerCase()]=e}}),c(y,"__parse",{value:v.parse}),c(y,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),y.prototype.resolvedOptions=function(){return{locale:this._locale}},y.prototype._compilePattern=function(e,t,r,n){return new l(t,r,n).compile(e)},y.prototype._findPluralRuleFunction=function(e){for(var t=y.__localeData__,r=t[e.toLowerCase()];r;){if(r.pluralRuleFunction)return r.pluralRuleFunction;r=r.parentLocale&&t[r.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+e)},y.prototype._format=function(e,t){var r,n,i,a,s,c,u="";for(r=0,n=e.length;r<n;r+=1)if("string"!=typeof(i=e[r])){if(a=i.id,!t||!o.call(t,a))throw(c=new Error("A value must be provided for: "+a)).variableId=a,c;s=t[a],i.options?u+=this._format(i.getOption(s),t):u+=i.format(s)}else u+=i;return u},y.prototype._mergeFormats=function(e,t){var r,n,i={};for(r in e)o.call(e,r)&&(i[r]=n=u(e[r]),t&&o.call(t,r)&&a(n,t[r]));return i},y.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(y.defaultLocale);var t,r,n,i,o=y.__localeData__;for(t=0,r=e.length;t<r;t+=1)for(n=e[t].toLowerCase().split("-");n.length;){if(i=o[n.join("-")])return i.locale;n.pop()}var a=e.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+e.join(", ")+", or the default locale: "+a)};var b={locale:"en",pluralRuleFunction:function(e,t){var r=String(e).split("."),n=!r[1],i=Number(r[0])==e,o=i&&r[0].slice(-1),a=i&&r[0].slice(-2);return t?1==o&&11!=a?"one":2==o&&12!=a?"two":3==o&&13!=a?"few":"other":1==e&&n?"one":"other"}};g.__addLocaleData(b),g.defaultLocale="en";var x=g,w=Math.round;var _=Object.prototype.hasOwnProperty,S=Object.prototype.toString,M=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),T=(!M&&Object.prototype.__defineGetter__,M?Object.defineProperty:function(e,t,r){"get"in r&&e.__defineGetter__?e.__defineGetter__(t,r.get):(!_.call(e,t)||"value"in r)&&(e[t]=r.value)}),A=Object.create||function(e,t){var r,n;function i(){}for(n in i.prototype=e,r=new i,t)_.call(t,n)&&T(r,n,t[n]);return r},E=Array.prototype.indexOf||function(e,t){if(!this.length)return-1;for(var r=t||0,n=this.length;r<n;r++)if(this[r]===e)return r;return-1},C=Array.isArray||function(e){return"[object Array]"===S.call(e)},L=Date.now||function(){return(new Date).getTime()},P=R,O=["second","second-short","minute","minute-short","hour","hour-short","day","day-short","month","month-short","year","year-short"],N=["best fit","numeric"];function R(e,t){t=t||{},C(e)&&(e=e.concat()),T(this,"_locale",{value:this._resolveLocale(e)}),T(this,"_options",{value:{style:this._resolveStyle(t.style),units:this._isValidUnits(t.units)&&t.units}}),T(this,"_locales",{value:e}),T(this,"_fields",{value:this._findFields(this._locale)}),T(this,"_messages",{value:A(null)});var r=this;this.format=function(e,t){return r._format(e,t)}}T(R,"__localeData__",{value:A(null)}),T(R,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlRelativeFormat is missing a `locale` property value");R.__localeData__[e.locale.toLowerCase()]=e,x.__addLocaleData(e)}}),T(R,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),T(R,"thresholds",{enumerable:!0,value:{second:45,"second-short":45,minute:45,"minute-short":45,hour:22,"hour-short":22,day:26,"day-short":26,month:11,"month-short":11}}),R.prototype.resolvedOptions=function(){return{locale:this._locale,style:this._options.style,units:this._options.units}},R.prototype._compileMessage=function(e){var t,r=this._locales,n=(this._locale,this._fields[e].relativeTime),i="",o="";for(t in n.future)n.future.hasOwnProperty(t)&&(i+=" "+t+" {"+n.future[t].replace("{0}","#")+"}");for(t in n.past)n.past.hasOwnProperty(t)&&(o+=" "+t+" {"+n.past[t].replace("{0}","#")+"}");return new x("{when, select, future {{0, plural, "+i+"}}past {{0, plural, "+o+"}}}",r)},R.prototype._getMessage=function(e){var t=this._messages;return t[e]||(t[e]=this._compileMessage(e)),t[e]},R.prototype._getRelativeUnits=function(e,t){var r=this._fields[t];if(r.relative)return r.relative[e]},R.prototype._findFields=function(e){for(var t=R.__localeData__,r=t[e.toLowerCase()];r;){if(r.fields)return r.fields;r=r.parentLocale&&t[r.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlRelativeFormat is missing `fields` for :"+e)},R.prototype._format=function(e,t){var r=t&&void 0!==t.now?t.now:L();if(void 0===e&&(e=r),!isFinite(r))throw new RangeError("The `now` option provided to IntlRelativeFormat#format() is not in valid range.");if(!isFinite(e))throw new RangeError("The date value provided to IntlRelativeFormat#format() is not in valid range.");var n=function(e,t){var r=w((t=+t)-(e=+e)),n=w(r/1e3),i=w(n/60),o=w(i/60),a=w(o/24),s=w(a/7),c=function(e){return 400*e/146097}(a),u=w(12*c),l=w(c);return{millisecond:r,second:n,"second-short":n,minute:i,"minute-short":i,hour:o,"hour-short":o,day:a,"day-short":a,week:s,"week-short":s,month:u,"month-short":u,year:l,"year-short":l}}(r,e),i=this._options.units||this._selectUnits(n),o=n[i];if("numeric"!==this._options.style){var a=this._getRelativeUnits(o,i);if(a)return a}return this._getMessage(i).format({0:Math.abs(o),when:o<0?"past":"future"})},R.prototype._isValidUnits=function(e){if(!e||E.call(O,e)>=0)return!0;if("string"==typeof e){var t=/s$/.test(e)&&e.substr(0,e.length-1);if(t&&E.call(O,t)>=0)throw new Error('"'+e+'" is not a valid IntlRelativeFormat `units` value, did you mean: '+t)}throw new Error('"'+e+'" is not a valid IntlRelativeFormat `units` value, it must be one of: "'+O.join('", "')+'"')},R.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(R.defaultLocale);var t,r,n,i,o=R.__localeData__;for(t=0,r=e.length;t<r;t+=1)for(n=e[t].toLowerCase().split("-");n.length;){if(i=o[n.join("-")])return i.locale;n.pop()}var a=e.pop();throw new Error("No locale data has been added to IntlRelativeFormat for: "+e.join(", ")+", or the default locale: "+a)},R.prototype._resolveStyle=function(e){if(!e)return N[0];if(E.call(N,e)>=0)return e;throw new Error('"'+e+'" is not a valid IntlRelativeFormat `style` value, it must be one of: "'+N.join('", "')+'"')},R.prototype._selectUnits=function(e){var t,r,n,i=O.filter(function(e){return e.indexOf("-short")<1});for(t=0,r=i.length;t<r&&(n=i[t],!(Math.abs(e[n])<R.thresholds[n]));t+=1);return n};var I={locale:"en",pluralRuleFunction:function(e,t){var r=String(e).split("."),n=!r[1],i=Number(r[0])==e,o=i&&r[0].slice(-1),a=i&&r[0].slice(-2);return t?1==o&&11!=a?"one":2==o&&12!=a?"two":3==o&&13!=a?"few":"other":1==e&&n?"one":"other"},fields:{year:{displayName:"year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{one:"in {0} year",other:"in {0} years"},past:{one:"{0} year ago",other:"{0} years ago"}}},"year-short":{displayName:"yr.",relative:{0:"this yr.",1:"next yr.","-1":"last yr."},relativeTime:{future:{one:"in {0} yr.",other:"in {0} yr."},past:{one:"{0} yr. ago",other:"{0} yr. ago"}}},month:{displayName:"month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{one:"in {0} month",other:"in {0} months"},past:{one:"{0} month ago",other:"{0} months ago"}}},"month-short":{displayName:"mo.",relative:{0:"this mo.",1:"next mo.","-1":"last mo."},relativeTime:{future:{one:"in {0} mo.",other:"in {0} mo."},past:{one:"{0} mo. ago",other:"{0} mo. ago"}}},day:{displayName:"day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},"day-short":{displayName:"day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},hour:{displayName:"hour",relative:{0:"this hour"},relativeTime:{future:{one:"in {0} hour",other:"in {0} hours"},past:{one:"{0} hour ago",other:"{0} hours ago"}}},"hour-short":{displayName:"hr.",relative:{0:"this hour"},relativeTime:{future:{one:"in {0} hr.",other:"in {0} hr."},past:{one:"{0} hr. ago",other:"{0} hr. ago"}}},minute:{displayName:"minute",relative:{0:"this minute"},relativeTime:{future:{one:"in {0} minute",other:"in {0} minutes"},past:{one:"{0} minute ago",other:"{0} minutes ago"}}},"minute-short":{displayName:"min.",relative:{0:"this minute"},relativeTime:{future:{one:"in {0} min.",other:"in {0} min."},past:{one:"{0} min. ago",other:"{0} min. ago"}}},second:{displayName:"second",relative:{0:"now"},relativeTime:{future:{one:"in {0} second",other:"in {0} seconds"},past:{one:"{0} second ago",other:"{0} seconds ago"}}},"second-short":{displayName:"sec.",relative:{0:"now"},relativeTime:{future:{one:"in {0} sec.",other:"in {0} sec."},past:{one:"{0} sec. ago",other:"{0} sec. ago"}}}}};P.__addLocaleData(I),P.defaultLocale="en";var D=P,F=r("8a2d1b95e05b6a321e74"),U=r.n(F),k=r("8af190b70a6bc55c6f1b"),B=r.n(k),z=r("6a4f9c383785f9168266"),j=r.n(z),V=Function.prototype.bind||function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),r=this,n=function(){},i=function(){return r.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),i.prototype=new n,i},G=Object.prototype.hasOwnProperty,W=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),H=(!W&&Object.prototype.__defineGetter__,W?Object.defineProperty:function(e,t,r){"get"in r&&e.__defineGetter__?e.__defineGetter__(t,r.get):(!G.call(e,t)||"value"in r)&&(e[t]=r.value)}),X=Object.create||function(e,t){var r,n;function i(){}for(n in i.prototype=e,r=new i,t)G.call(t,n)&&H(r,n,t[n]);return r},q=function(e){var t=X(null);return function(){var r=Array.prototype.slice.call(arguments),n=function(e){if("undefined"==typeof JSON)return;var t,r,n,i=[];for(t=0,r=e.length;t<r;t+=1)(n=e[t])&&"object"==typeof n?i.push(Y(n)):i.push(n);return JSON.stringify(i)}(r),i=n&&t[n];return i||(i=new(V.apply(e,[null].concat(r))),n&&(t[n]=i)),i}};function Y(e){var t,r,n,i,o=[],a=[];for(t in e)e.hasOwnProperty(t)&&a.push(t);var s=a.sort();for(r=0,n=s.length;r<n;r+=1)(i={})[t=s[r]]=e[t],o[r]=i;return o}r.d(t,"addLocaleData",function(){return Q}),r.d(t,"intlShape",function(){return we}),r.d(t,"injectIntl",function(){return Re}),r.d(t,"defineMessages",function(){return Ie}),r.d(t,"IntlProvider",function(){return Ye}),r.d(t,"FormattedDate",function(){return Je}),r.d(t,"FormattedTime",function(){return Qe}),r.d(t,"FormattedRelative",function(){return rt}),r.d(t,"FormattedNumber",function(){return nt}),r.d(t,"FormattedPlural",function(){return it}),r.d(t,"FormattedMessage",function(){return ot}),r.d(t,"FormattedHTMLMessage",function(){return at});var J={locale:"en",pluralRuleFunction:function(e,t){var r=String(e).split("."),n=!r[1],i=Number(r[0])==e,o=i&&r[0].slice(-1),a=i&&r[0].slice(-2);return t?1==o&&11!=a?"one":2==o&&12!=a?"two":3==o&&13!=a?"few":"other":1==e&&n?"one":"other"},fields:{year:{displayName:"year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{one:"in {0} year",other:"in {0} years"},past:{one:"{0} year ago",other:"{0} years ago"}}},month:{displayName:"month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{one:"in {0} month",other:"in {0} months"},past:{one:"{0} month ago",other:"{0} months ago"}}},day:{displayName:"day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},hour:{displayName:"hour",relative:{0:"this hour"},relativeTime:{future:{one:"in {0} hour",other:"in {0} hours"},past:{one:"{0} hour ago",other:"{0} hours ago"}}},minute:{displayName:"minute",relative:{0:"this minute"},relativeTime:{future:{one:"in {0} minute",other:"in {0} minutes"},past:{one:"{0} minute ago",other:"{0} minutes ago"}}},second:{displayName:"second",relative:{0:"now"},relativeTime:{future:{one:"in {0} second",other:"in {0} seconds"},past:{one:"{0} second ago",other:"{0} seconds ago"}}}}};function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(Array.isArray(e)?e:[e]).forEach(function(e){e&&e.locale&&(x.__addLocaleData(e),D.__addLocaleData(e))})}function Z(e){var t=e&&e.toLowerCase();return!(!x.__localeData__[t]||!D.__localeData__[t])}var K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ee=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),te=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ne=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ie=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},oe=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},ae=U.a.bool,se=U.a.number,ce=U.a.string,ue=U.a.func,le=U.a.object,he=U.a.oneOf,de=U.a.shape,fe=U.a.any,pe=U.a.oneOfType,me=he(["best fit","lookup"]),ve=he(["narrow","short","long"]),ge=he(["numeric","2-digit"]),ye=ue.isRequired,be={locale:ce,formats:le,messages:le,textComponent:fe,defaultLocale:ce,defaultFormats:le},xe={formatDate:ye,formatTime:ye,formatRelative:ye,formatNumber:ye,formatPlural:ye,formatMessage:ye,formatHTMLMessage:ye},we=de(re({},be,xe,{formatters:le,now:ye})),_e=(ce.isRequired,pe([ce,le]),{localeMatcher:me,formatMatcher:he(["basic","best fit"]),timeZone:ce,hour12:ae,weekday:ve,era:ve,year:ge,month:he(["numeric","2-digit","narrow","short","long"]),day:ge,hour:ge,minute:ge,second:ge,timeZoneName:he(["short","long"])}),Se={localeMatcher:me,style:he(["decimal","currency","percent"]),currency:ce,currencyDisplay:he(["symbol","code","name"]),useGrouping:ae,minimumIntegerDigits:se,minimumFractionDigits:se,maximumFractionDigits:se,minimumSignificantDigits:se,maximumSignificantDigits:se},Me={style:he(["best fit","numeric"]),units:he(["second","minute","hour","day","month","year"])},Te={style:he(["cardinal","ordinal"])},Ae=Object.keys(be),Ee={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},Ce=/[&><"']/g;function Le(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.reduce(function(t,n){return e.hasOwnProperty(n)?t[n]=e[n]:r.hasOwnProperty(n)&&(t[n]=r[n]),t},{})}function Pe(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).intl;j()(e,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}function Oe(e,t){if(e===t)return!0;if("object"!==(void 0===e?"undefined":K(e))||null===e||"object"!==(void 0===t?"undefined":K(t))||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=Object.prototype.hasOwnProperty.bind(t),o=0;o<r.length;o++)if(!i(r[o])||e[r[o]]!==t[r[o]])return!1;return!0}function Ne(e,t,r){var n=e.props,i=e.state,o=e.context,a=void 0===o?{}:o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a.intl,u=void 0===c?{}:c,l=s.intl,h=void 0===l?{}:l;return!Oe(t,n)||!Oe(r,i)||!(h===u||Oe(Le(h,Ae),Le(u,Ae)))}function Re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.intlPropName,n=void 0===r?"intl":r,i=t.withRef,o=void 0!==i&&i,a=function(t){function r(e,t){$(this,r);var n=ie(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return Pe(t),n}return ne(r,t),ee(r,[{key:"getWrappedInstance",value:function(){return j()(o,"[React Intl] To access the wrapped instance, the `{withRef: true}` option must be set when calling: `injectIntl()`"),this.refs.wrappedInstance}},{key:"render",value:function(){return B.a.createElement(e,re({},this.props,te({},n,this.context.intl),{ref:o?"wrappedInstance":null}))}}]),r}(k.Component);return a.displayName="InjectIntl("+function(e){return e.displayName||e.name||"Component"}(e)+")",a.contextTypes={intl:we},a.WrappedComponent=e,a}function Ie(e){return e}var De=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$(this,e);var n="ordinal"===r.style,i=function(e){return x.prototype._findPluralRuleFunction(e)}(function(e){return x.prototype._resolveLocale(e)}(t));this.format=function(e){return i(e,n)}},Fe=Object.keys(_e),Ue=Object.keys(Se),ke=Object.keys(Me),Be=Object.keys(Te),ze={second:60,minute:60,hour:24,day:30,month:12};function je(e){var t=D.thresholds;t.second=e.second,t.minute=e.minute,t.hour=e.hour,t.day=e.day,t.month=e.month}function Ve(e,t,r){var n=e&&e[t]&&e[t][r];if(n)return n}function Ge(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=e.formats,a=e.messages,s=e.defaultLocale,c=e.defaultFormats,u=r.id,l=r.defaultMessage;j()(u,"[React Intl] An `id` must be provided to format a message.");var h=a&&a[u];if(!(Object.keys(n).length>0))return h||l||u;var d=void 0;if(h)try{d=t.getMessageFormat(h,i,o).format(n)}catch(e){0}else 0;if(!d&&l)try{d=t.getMessageFormat(l,s,c).format(n)}catch(e){0}return d||h||l||u}var We=Object.freeze({formatDate:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=e.formats,a=n.format,s=new Date(r),c=a&&Ve(o,"date",a),u=Le(n,Fe,c);try{return t.getDateTimeFormat(i,u).format(s)}catch(e){}return String(s)},formatTime:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=e.formats,a=n.format,s=new Date(r),c=a&&Ve(o,"time",a),u=Le(n,Fe,c);u.hour||u.minute||u.second||(u=re({},u,{hour:"numeric",minute:"numeric"}));try{return t.getDateTimeFormat(i,u).format(s)}catch(e){}return String(s)},formatRelative:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=e.formats,a=n.format,s=new Date(r),c=new Date(n.now),u=a&&Ve(o,"relative",a),l=Le(n,ke,u),h=re({},D.thresholds);je(ze);try{return t.getRelativeFormat(i,l).format(s,{now:isFinite(c)?c:t.now()})}catch(e){}finally{je(h)}return String(s)},formatNumber:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=e.formats,a=n.format,s=a&&Ve(o,"number",a),c=Le(n,Ue,s);try{return t.getNumberFormat(i,c).format(r)}catch(e){}return String(r)},formatPlural:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.locale,o=Le(n,Be);try{return t.getPluralFormat(i,o).format(r)}catch(e){}return"other"},formatMessage:Ge,formatHTMLMessage:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ge(e,t,r,Object.keys(n).reduce(function(e,t){var r=n[t];return e[t]="string"==typeof r?function(e){return(""+e).replace(Ce,function(e){return Ee[e]})}(r):r,e},{}))}}),He=Object.keys(be),Xe=Object.keys(xe),qe={formats:{},messages:{},textComponent:"span",defaultLocale:"en",defaultFormats:{}},Ye=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));j()("undefined"!=typeof Intl,"[React Intl] The `Intl` APIs must be available in the runtime, and do not appear to be built-in. An `Intl` polyfill should be loaded.\nSee: http://formatjs.io/guides/runtime-environments/");var i=r.intl,o=void 0;o=isFinite(e.initialNow)?Number(e.initialNow):i?i.now():Date.now();var a=(i||{}).formatters,s=void 0===a?{getDateTimeFormat:q(Intl.DateTimeFormat),getNumberFormat:q(Intl.NumberFormat),getMessageFormat:q(x),getRelativeFormat:q(D),getPluralFormat:q(De)}:a;return n.state=re({},s,{now:function(){return n._didDisplay?Date.now():o}}),n}return ne(t,e),ee(t,[{key:"getConfig",value:function(){var e=this.context.intl,t=Le(this.props,He,e);for(var r in qe)void 0===t[r]&&(t[r]=qe[r]);if(!function(e){for(var t=(e||"").split("-");t.length>0;){if(Z(t.join("-")))return!0;t.pop()}return!1}(t.locale)){var n=t,i=(n.locale,n.defaultLocale),o=n.defaultFormats;0,t=re({},t,{locale:i,formats:o,messages:qe.messages})}return t}},{key:"getBoundFormatFns",value:function(e,t){return Xe.reduce(function(r,n){return r[n]=We[n].bind(null,e,t),r},{})}},{key:"getChildContext",value:function(){var e=this.getConfig(),t=this.getBoundFormatFns(e,this.state),r=this.state,n=r.now,i=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(r,["now"]);return{intl:re({},e,t,{formatters:i,now:n})}}},{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"componentDidMount",value:function(){this._didDisplay=!0}},{key:"render",value:function(){return k.Children.only(this.props.children)}}]),t}(k.Component);Ye.displayName="IntlProvider",Ye.contextTypes={intl:we},Ye.childContextTypes={intl:we.isRequired};var Je=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatDate,r=e.textComponent,n=this.props,i=n.value,o=n.children,a=t(i,this.props);return"function"==typeof o?o(a):B.a.createElement(r,null,a)}}]),t}(k.Component);Je.displayName="FormattedDate",Je.contextTypes={intl:we};var Qe=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatTime,r=e.textComponent,n=this.props,i=n.value,o=n.children,a=t(i,this.props);return"function"==typeof o?o(a):B.a.createElement(r,null,a)}}]),t}(k.Component);Qe.displayName="FormattedTime",Qe.contextTypes={intl:we};var Ze=1e3,Ke=6e4,$e=36e5,et=864e5,tt=2147483647;var rt=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));Pe(r);var i=isFinite(e.initialNow)?Number(e.initialNow):r.intl.now();return n.state={now:i},n}return ne(t,e),ee(t,[{key:"scheduleNextUpdate",value:function(e,t){var r=this;clearTimeout(this._timer);var n=e.value,i=e.units,o=e.updateInterval,a=new Date(n).getTime();if(o&&isFinite(a)){var s=a-t.now,c=function(e){switch(e){case"second":return Ze;case"minute":return Ke;case"hour":return $e;case"day":return et;default:return tt}}(i||function(e){var t=Math.abs(e);return t<Ke?"second":t<$e?"minute":t<et?"hour":"day"}(s)),u=Math.abs(s%c),l=s<0?Math.max(o,c-u):Math.max(o,u);this._timer=setTimeout(function(){r.setState({now:r.context.intl.now()})},l)}}},{key:"componentDidMount",value:function(){this.scheduleNextUpdate(this.props,this.state)}},{key:"componentWillReceiveProps",value:function(e){(function(e,t){if(e===t)return!0;var r=new Date(e).getTime(),n=new Date(t).getTime();return isFinite(r)&&isFinite(n)&&r===n})(e.value,this.props.value)||this.setState({now:this.context.intl.now()})}},{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"componentWillUpdate",value:function(e,t){this.scheduleNextUpdate(e,t)}},{key:"componentWillUnmount",value:function(){clearTimeout(this._timer)}},{key:"render",value:function(){var e=this.context.intl,t=e.formatRelative,r=e.textComponent,n=this.props,i=n.value,o=n.children,a=t(i,re({},this.props,this.state));return"function"==typeof o?o(a):B.a.createElement(r,null,a)}}]),t}(k.Component);rt.displayName="FormattedRelative",rt.contextTypes={intl:we},rt.defaultProps={updateInterval:1e4};var nt=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatNumber,r=e.textComponent,n=this.props,i=n.value,o=n.children,a=t(i,this.props);return"function"==typeof o?o(a):B.a.createElement(r,null,a)}}]),t}(k.Component);nt.displayName="FormattedNumber",nt.contextTypes={intl:we};var it=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ne.apply(void 0,[this].concat(t))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatPlural,r=e.textComponent,n=this.props,i=n.value,o=n.other,a=n.children,s=t(i,this.props),c=this.props[s]||o;return"function"==typeof a?a(c):B.a.createElement(r,null,c)}}]),t}(k.Component);it.displayName="FormattedPlural",it.contextTypes={intl:we},it.defaultProps={style:"cardinal"};var ot=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.values;if(!Oe(e.values,t))return!0;for(var r=re({},e,{values:t}),n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return Ne.apply(void 0,[this,r].concat(i))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatMessage,r=e.textComponent,n=this.props,i=n.id,o=n.description,a=n.defaultMessage,s=n.values,c=n.tagName,u=void 0===c?r:c,l=n.children,h=void 0,d=void 0,f=void 0;if(s&&Object.keys(s).length>0){var p=Math.floor(1099511627776*Math.random()).toString(16),m=function(){var e=0;return function(){return"ELEMENT-"+p+"-"+(e+=1)}}();h="@__"+p+"__@",d={},f={},Object.keys(s).forEach(function(e){var t=s[e];if(Object(k.isValidElement)(t)){var r=m();d[e]=h+r+h,f[r]=t}else d[e]=t})}var v=t({id:i,description:o,defaultMessage:a},d||s),g=void 0;return g=f&&Object.keys(f).length>0?v.split(h).filter(function(e){return!!e}).map(function(e){return f[e]||e}):[v],"function"==typeof l?l.apply(void 0,oe(g)):k.createElement.apply(void 0,[u,null].concat(oe(g)))}}]),t}(k.Component);ot.displayName="FormattedMessage",ot.contextTypes={intl:we},ot.defaultProps={values:{}};var at=function(e){function t(e,r){$(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return Pe(r),n}return ne(t,e),ee(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.values;if(!Oe(e.values,t))return!0;for(var r=re({},e,{values:t}),n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return Ne.apply(void 0,[this,r].concat(i))}},{key:"render",value:function(){var e=this.context.intl,t=e.formatHTMLMessage,r=e.textComponent,n=this.props,i=n.id,o=n.description,a=n.defaultMessage,s=n.values,c=n.tagName,u=void 0===c?r:c,l=n.children,h=t({id:i,description:o,defaultMessage:a},s);if("function"==typeof l)return l(h);var d={__html:h};return B.a.createElement(u,{dangerouslySetInnerHTML:d})}}]),t}(k.Component);at.displayName="FormattedHTMLMessage",at.contextTypes={intl:we},at.defaultProps={values:{}},Q(J),Q(i.a)},ab33744f6df37edcb9b2:function(e,t,r){var n=r("47e9e16a3e339321eec5"),i=r("7e56d82a60dcbc0a4c8d"),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},ab4cb61bcb2dc161defb:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(r("acbc0369147222889acb")),i={INIT:"@@redux/INIT"+Math.random().toString(36).substring(7).split("").join("."),REPLACE:"@@redux/REPLACE"+Math.random().toString(36).substring(7).split("").join(".")},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function s(e){if("object"!==(void 0===e?"undefined":o(e))||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function c(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e,t){return function(){return t(e.apply(this,arguments))}}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}t.createStore=function e(t,r,a){var c;if("function"==typeof r&&void 0===a&&(a=r,r=void 0),void 0!==a){if("function"!=typeof a)throw new Error("Expected the enhancer to be a function.");return a(e)(t,r)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var u=t,l=r,h=[],d=h,f=!1;function p(){d===h&&(d=h.slice())}function m(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return l}function v(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),d.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var r=d.indexOf(e);d.splice(r,1)}}}function g(e){if(!s(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,l=u(l,e)}finally{f=!1}for(var t=h=d,r=0;r<t.length;r++)(0,t[r])();return e}return g({type:i.INIT}),(c={dispatch:g,subscribe:v,getState:m,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");u=e,g({type:i.REPLACE})}})[n]=function(){var e,t=v;return(e={subscribe:function(e){if("object"!==(void 0===e?"undefined":o(e))||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(m())}return r(),{unsubscribe:t(r)}}})[n]=function(){return this},e},c},t.combineReducers=function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];"function"==typeof e[o]&&(r[o]=e[o])}var a=Object.keys(r),s=void 0;try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(e){s=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(s)throw s;for(var n=!1,i={},o=0;o<a.length;o++){var u=a[o],l=r[u],h=e[u],d=l(h,t);if(void 0===d){var f=c(u,t);throw new Error(f)}i[u]=d,n=n||d!==h}return n?i:e}},t.bindActionCreators=function(e,t){if("function"==typeof e)return u(e,t);if("object"!==(void 0===e?"undefined":o(e))||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":void 0===e?"undefined":o(e))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var a=r[i],s=e[a];"function"==typeof s&&(n[a]=u(s,t))}return n},t.applyMiddleware=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=e.apply(void 0,n),s=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},c={getState:o.getState,dispatch:function(){return s.apply(void 0,arguments)}},u=t.map(function(e){return e(c)});return s=l.apply(void 0,u)(o.dispatch),a({},o,{dispatch:s})}}},t.compose=l,t.__DO_NOT_USE__ActionTypes=i},ab8261c9b33ea00e4f82:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("412479c5138fb85aa19f"));t.default=function(){var e=null,t=[];return{setPrompt:function(t){return(0,n.default)(null==e,"A history supports only one prompt at a time"),e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,r,i,o){if(null!=e){var a="function"==typeof e?e(t,r):e;"string"==typeof a?"function"==typeof i?i(a,o):((0,n.default)(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),o(!0)):o(!1!==a)}else o(!0)},appendListener:function(e){var r=!0,n=function(){r&&e.apply(void 0,arguments)};return t.push(n),function(){r=!1,t=t.filter(function(e){return e!==n})}},notifyListeners:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];t.forEach(function(e){return e.apply(void 0,r)})}}}},abdf39fa8a53fa100ee1:function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("blink",function(e){return function(){return e(this,"blink","","")}})},ac053bf94afc297b1d6f:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("98e9f3c3a8d686f8cc0f"),o=r("5abe37fc05566b7b9eff");n(n.P+n.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},ac4169b12b8023e0bb82:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("06d4481d8fe57248a157");n(n.G+n.F*(parseInt!=i),{parseInt:i})},acb079530cb9191542a7:function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",function(){return n})},acbc0369147222889acb:function(e,t,r){"use strict";r.r(t),function(e,n){var i,o=r("acb079530cb9191542a7");i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(o.a)(i);t.default=a}.call(this,r("698d75b157f24ae829cc"),r("044f282f6141fc605782")(e))},ad0c5026cb53565a281d:function(e,t,r){r("ccf79254fef1a499b486")("WeakSet")},ad8470b596eb2ec5826f:function(e,t,r){var n=r("4be2c15021f717a728f0")(r("18caba858d9ea0f67284"),"Set");e.exports=n},aef563822bc761fec37d:function(e,t,r){r("7519864545a89c83682d")("search",1,function(e,t,r){return[function(r){"use strict";var n=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]})},af481eff47a873748208:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},afced8ddd725b0895412:function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("87f7b2a2f3e179b5c40a").onFreeze;r("f34797c0b42452934317")("freeze",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},b04dcea169e01651bec4:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("3dd7e3cb81b24cbd63d6"),o=r("d394d0a4c1838202489d"),a=r("ca19e32ab6ee3b3692aa"),s=r("4d073e2fededcdd3f3d3"),c=r("0594430ce9777a0767aa");n(n.P,"Array",{flatMap:function(e){var t,r,n=o(this);return s(e),t=a(n.length),r=c(n,0),i(r,n,n,t,0,1,e,arguments[1]),r}}),r("a5e6f0092ff0290e0bcf")("flatMap")},b05c6f46a9990189714c:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("de6553e2eed497bebede"));t.default=n.default},b0b0e0fb335805985891:function(e,t,r){"use strict";var n=r("7a7739dd8a198a2cfcb5"),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!n(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(r>99?r:"0"+a(r))+"Z"}:o},b1d62e5029a9e6ba3c32:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"System",{global:r("1139de1233fd67f45bd7")})},b319470fdda47fb5d046:function(e,t,r){var n=r("32b716d95af2fd3c5c23"),i=r("5fd4d3d5ac2fe9bfd20e");e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},b3b01db6127592dc78f8:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("cae0f026dfe4729a216f"));t.default=n.default},b452ab1ee9229ca9f134:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t,r){(0,n.default)(e)||(0,i.default)(r+"() in "+t+" must return a plain object. Instead received "+e+".")};var n=o(r("259390904b4b47fe24f8")),i=o(r("c0fa96a4e042118a422d"));function o(e){return e&&e.__esModule?e:{default:e}}},b49a2b6a876439c25655:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,s=n>>16,c=(a*o>>>0)+(i*o>>>16);return a*s+(c>>16)+((i*s>>>0)+(65535&c)>>16)}})},b69691de767a1b43d058:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("0fcd62dab3511fe4dbf9"),o=r("b784fa01fa41fb2906a0");n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},b6fe868af5705c1105ee:function(e,t,r){"use strict";t.__esModule=!0,t.whenMapDispatchToPropsIsFunction=o,t.whenMapDispatchToPropsIsMissing=a,t.whenMapDispatchToPropsIsObject=s;var n=r("ab4cb61bcb2dc161defb"),i=r("9c0601b67ba572e10d92");function o(e){return"function"==typeof e?(0,i.wrapMapToPropsFunc)(e,"mapDispatchToProps"):void 0}function a(e){return e?void 0:(0,i.wrapMapToPropsConstant)(function(e){return{dispatch:e}})}function s(e){return e&&"object"==typeof e?(0,i.wrapMapToPropsConstant)(function(t){return(0,n.bindActionCreators)(e,t)}):void 0}t.default=[o,a,s]},b7326326d1b249adb7bc:function(e,t,r){"use strict";t.__esModule=!0;var n=null,i={notify:function(){}};var o=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.parentSub=r,this.onStateChange=n,this.unsubscribe=null,this.listeners=i}return e.prototype.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},e.prototype.notifyNestedSubs=function(){this.listeners.notify()},e.prototype.isSubscribed=function(){return Boolean(this.unsubscribe)},e.prototype.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=function(){var e=[],t=[];return{clear:function(){t=n,e=n},notify:function(){for(var r=e=t,n=0;n<r.length;n++)r[n]()},get:function(){return t},subscribe:function(r){var i=!0;return t===e&&(t=e.slice()),t.push(r),function(){i&&e!==n&&(i=!1,t===e&&(t=e.slice()),t.splice(t.indexOf(r),1))}}}}())},e.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=i)},e}();t.default=o},b76ef4afb4fcdfa26ddc:function(e,t,r){"use strict";t.__esModule=!0,t.impureFinalPropsSelectorFactory=n,t.pureFinalPropsSelectorFactory=i,t.default=function(e,t){var r=t.initMapStateToProps,o=t.initMapDispatchToProps,a=t.initMergeProps,s=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),c=r(e,s),u=o(e,s),l=a(e,s);0;return(s.pure?i:n)(c,u,l,e,s)};!function(e){e&&e.__esModule}(r("d701338e3c92ad7598cc"));function n(e,t,r,n){return function(i,o){return r(e(i,o),t(n,o),o)}}function i(e,t,r,n,i){var o=i.areStatesEqual,a=i.areOwnPropsEqual,s=i.areStatePropsEqual,c=!1,u=void 0,l=void 0,h=void 0,d=void 0,f=void 0;function p(i,c){var p=!a(c,l),m=!o(i,u);return u=i,l=c,p&&m?(h=e(u,l),t.dependsOnOwnProps&&(d=t(n,l)),f=r(h,d,l)):p?(e.dependsOnOwnProps&&(h=e(u,l)),t.dependsOnOwnProps&&(d=t(n,l)),f=r(h,d,l)):m?function(){var t=e(u,l),n=!s(t,h);return h=t,n&&(f=r(h,d,l)),f}():f}return function(i,o){return c?p(i,o):function(i,o){return h=e(u=i,l=o),d=t(n,l),f=r(h,d,l),c=!0,f}(i,o)}}},b784fa01fa41fb2906a0:function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},b7e0f648845bad52222c:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("00c22f5845a5f3d8fe8c")(),o=r("1139de1233fd67f45bd7").process,a="process"==r("0116c75136b233002fb9")(o);n(n.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},b82e15db0761df603831:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("336cae077811264f3d1e")(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},b8bc1433202509fac65f:function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},b93293c8278c29a2c7c2:function(e,t){t.__esModule=!0;t.ATTRIBUTE_NAMES={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"};var r=t.TAG_NAMES={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},n=(t.VALID_TAG_NAMES=Object.keys(r).map(function(e){return r[e]}),t.TAG_PROPERTIES={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src"},t.REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"});t.HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},t.HTML_TAG_MAP=Object.keys(n).reduce(function(e,t){return e[n[t]]=t,e},{}),t.SELF_CLOSING_TAGS=[r.NOSCRIPT,r.SCRIPT,r.STYLE],t.HELMET_ATTRIBUTE="data-react-helmet"},b93ad0c707f45271bd41:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Date",{now:function(){return(new Date).getTime()}})},b9bd1a2a618fdda58e33:function(e,t,r){"use strict";r("57e7a4ee5fd1ce9280ef")("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},bc0f72eb2321587e4779:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P,"Array",{copyWithin:r("06b2b473e53cc019ca74")}),r("a5e6f0092ff0290e0bcf")("copyWithin")},bc1a333d2b6eceac22e3:function(e,t,r){e.exports=!r("5975c7ea3ecd56e534e3")&&!r("7a7739dd8a198a2cfcb5")(function(){return 7!=Object.defineProperty(r("68a989d6f90923909f2a")("div"),"a",{get:function(){return 7}}).a})},bc20db01ebac581e43a6:function(e,t){e.exports=function(){return!1}},bd5434bb096a0db94771:function(e,t,r){"use strict";t.__esModule=!0,t.whenMapStateToPropsIsFunction=i,t.whenMapStateToPropsIsMissing=o;var n=r("9c0601b67ba572e10d92");function i(e){return"function"==typeof e?(0,n.wrapMapToPropsFunc)(e,"mapStateToProps"):void 0}function o(e){return e?void 0:(0,n.wrapMapToPropsConstant)(function(){return{}})}t.default=[i,o]},bdd7ec7e25634c0bd1d9:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},bdd7fd0a625fdc88e057:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("4d073e2fededcdd3f3d3"),o=r("79c91dcd8cd554c59c7b"),a=(r("1139de1233fd67f45bd7").Reflect||{}).apply,s=Function.apply;n(n.S+n.F*!r("7a7739dd8a198a2cfcb5")(function(){a(function(){})}),"Reflect",{apply:function(e,t,r){var n=i(e),c=o(r);return a?a(n,t,c):s.call(n,t,c)}})},bef911c5daed007bb174:function(e,t,r){"use strict";e.exports={}},bf663dc27714ab10d46b:function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=n.key,a=n.map,s=n.store;n.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:o(arguments[2]),n=a(i(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var c=s.get(t);return c.delete(r),!!c.size||s.delete(t)}})},bf822756ee9f31cbbb10:function(e,t,r){r("ccf79254fef1a499b486")("Map")},bfea3a646c640826923d:function(e,t,r){r("41d819f9275ef20244e7"),r("112d1eecaede6e2dcf09"),r("65bf45411dca6e57791d"),r("ea45ad43eef3e386e18c"),r("23339791c405611c831e"),r("e92b89da57efd8b02487"),r("12a106a843fda580d627"),r("0f3e6bbfb9058f37cb22"),r("afced8ddd725b0895412"),r("0bd0985e8178c4e69b67"),r("39e786b6f73d0c2dc9e4"),r("4eb232e665ed4f2fa5b1"),r("8dc3899bd56512a6de6d"),r("8dde765ba393a8f99a70"),r("32c85c5c621c55a6b3ab"),r("8cf67abed7f2159af642"),r("531aa4a3a0a8a597b4b4"),r("aae15840322550f153dc"),r("6d98b32f91eb8777ca21"),r("e28425bb72f854691929"),r("d491591ee60d9ef0aa9d"),r("ac4169b12b8023e0bb82"),r("56ca38cb7a1b85e3b391"),r("49737199b59f0ac62d15"),r("759097197b97ddad17eb"),r("94f99fc446430aabde47"),r("d8fab3fc72ca23b52ae2"),r("7874b6e955f7d90ad7ec"),r("3bd50fa414ae910eb455"),r("d2fa9663cd158bd36d69"),r("a312a83ea9b9e61f1871"),r("af481eff47a873748208"),r("6ad07de816cfee1e2bda"),r("2499ce6d7ea1e9ca2579"),r("298b5be4dd10a9a11c49"),r("1792bb2ef9fe352edb1e"),r("39dc0152a90b3f79e9c4"),r("0b3f87eafc807ad7f3a2"),r("1655a801151bdc7ee673"),r("2d6ca68360dece574932"),r("9941d65ede78b70dbd5a"),r("a76f7d57f23e05fc0ac3"),r("6251dc1015f605aa27c7"),r("93608b8fd0e135fbe5e6"),r("494d4966d2dbdf891514"),r("2ecd99f9ea85b44ffe1d"),r("454dda5a76e3e8fad966"),r("7c3eb54bc7a7e3451a7e"),r("318358f29560c8862a62"),r("1bfd0b712b958ac38a24"),r("9344d77decda1f9977b7"),r("862d27e3ce53aadb9a46"),r("444c26bc43eec64c837a"),r("07f8363c924f4e12fef3"),r("d2e36888d16fa092915c"),r("340dbda6fe6f17098a91"),r("825e103ed4a71fb91e11"),r("72ac5893bfc7ed50a09c"),r("66914ad4ab026b9ba2e8"),r("15ad6b6c880d51697e5b"),r("29141de3bd8fb20e5e9a"),r("2fea013a9d0e76560f8b"),r("e6a347faa9f19b1ed599"),r("abdf39fa8a53fa100ee1"),r("1451c76b1b1b5a5ba260"),r("f519451816147948df30"),r("58a497e2c18ee06b3067"),r("6d7c634dd1858355953f"),r("e1840f007f040a84a1ab"),r("578d8dc958c3920ef454"),r("8e0402aa1481a930c9c3"),r("1627ebf46087710a4703"),r("d1a436d21f0debb638f5"),r("1860f64667ad8a670ab7"),r("b93ad0c707f45271bd41"),r("93aa2354fc0594ea6148"),r("d0990b8256a5f38a05aa"),r("dc5bd15c664880964ee5"),r("d5e0d50957e1364b4d8b"),r("cff317ca62d09454b2d3"),r("0a5193b0534d54dbcda1"),r("3f2012daa60f226e86ec"),r("4cc77e026250beeef142"),r("1b71f5e96f29a92413b6"),r("5baa1143f58e62614ca0"),r("0f025c284bc567debf3d"),r("1591b90b4327c94245ad"),r("0565be87d109f51269ca"),r("9125d51ebaa93f49cfd5"),r("cf802dc5a6982c8247e6"),r("481c1f0e850b0c8d0f7d"),r("896f33738142bf70015e"),r("c9be824f185f52a1979a"),r("1468f5d37f30f63d76ea"),r("bc0f72eb2321587e4779"),r("fa5cd10f53a62f249502"),r("3932316ffef991f5d157"),r("3fc8b4ca32b0aebd9ff3"),r("74be682203e7c82cb4c9"),r("307014e72ed12da69e15"),r("51a5b67212dfc6f7022a"),r("654ecb2e7a4241ef8f08"),r("941df1c42d2f478ed942"),r("88baaa5583416ec0cb42"),r("cb1771a9eba49d3e1de6"),r("aef563822bc761fec37d"),r("42f5768b7d8d9a994222"),r("89701ced11312fc14f3d"),r("413112319aa96af919d4"),r("7a8c0ef4f45a56962a18"),r("4b6c3e2b96a7fdc95a33"),r("e57aad3e28ab6bac0380"),r("45c7f885186b325fe183"),r("4824055ce03b0869d111"),r("2b4a4ef7612f955b8d3d"),r("cf50f2ac57a34b8deade"),r("8a0cb697d98576e60b9d"),r("c8a0e6ae37bbd5012724"),r("c42b35b1ec34a3818888"),r("0cfe2a6849380b697b26"),r("36fb70620452ffd2d407"),r("0f2d451cc44dcac3d457"),r("8282da6ea45ca23bdd3c"),r("bdd7fd0a625fdc88e057"),r("5e08439cbfed19129a22"),r("852099b0cfb6ec8571a2"),r("3430f3e283af0cf06931"),r("759a6902720117087dd3"),r("e72f1581ae3b588359b2"),r("99611036d7ebe5f0cac9"),r("e7474db296820464a2ff"),r("dbb8045293c85083c922"),r("07de7eab7d9aab23fb86"),r("cc1aef3f71c33f94b57e"),r("2598229f45b3da87877e"),r("f309c35c0ec3caac8c45"),r("4cd9a60f042223c9ba2c"),r("5dd61c3148e8f3bbc5d7"),r("b04dcea169e01651bec4"),r("22c4655df043ec6a4af2"),r("6ae198bd7922e25e2128"),r("ac053bf94afc297b1d6f"),r("2c54555c94aa6b1cce4a"),r("87df535ec0c75eb666f4"),r("b9bd1a2a618fdda58e33"),r("ebc27012af6f56e487f3"),r("f8695b95b3c9135976f0"),r("113c58cbe121d529688c"),r("1c750e24757a7c0c1e31"),r("fcdb9f352e4ad889e33f"),r("b82e15db0761df603831"),r("cfe37f364cc81a6415bd"),r("0ce98ded3187eccaf15a"),r("3a6600337fc4dae8f6f1"),r("1dddc8b9f5f30599741a"),r("77bfc0a151efbe7efe2d"),r("392615e2ae5e100214bd"),r("dae1b939e898dc140c93"),r("fb18731b3c51330e7b11"),r("96006d3b208a72eaa49c"),r("5d829f854abca808c16c"),r("bf822756ee9f31cbbb10"),r("cb2f5c21ba0f661fdebb"),r("6857028c584e68dfacd6"),r("ad0c5026cb53565a281d"),r("db019a029d69500cb816"),r("b1d62e5029a9e6ba3c32"),r("848c17107e77a319b83b"),r("56b82ba00e9aa7744555"),r("92af855fdee54bacfa47"),r("4faad91abd2171602dcc"),r("8c15b7ae3d0b33173ad3"),r("14aa1c87589cec105b74"),r("74988f1178e5f1cc2f7a"),r("b49a2b6a876439c25655"),r("6d6f766831bb1cf8facf"),r("96903bd4a4f0ab20afc4"),r("19a014a8d7781dbba23a"),r("3009383f3d0ad6342c19"),r("bdd7ec7e25634c0bd1d9"),r("da8dbcc3b692fc0676cc"),r("b69691de767a1b43d058"),r("a485a45ff240f20fb978"),r("bf663dc27714ab10d46b"),r("dc76537051b58b7ecd44"),r("1a29b1a839ce123011e8"),r("0b69aae3945a07e52c9a"),r("da57ca5397b5779e093d"),r("5f604e5c8e15a9c73536"),r("19289c2680cbdec14eed"),r("ff48eaa47603dbd72464"),r("b7e0f648845bad52222c"),r("3179bff1ebe47c49d3eb"),r("9e57e2b1bf9af3290fa7"),r("6c07e9b5d58510c21784"),r("c08bb95a2a1e7d3a36d4"),e.exports=r("5925dad3c5243ffee3db")},c08bb95a2a1e7d3a36d4:function(e,t,r){for(var n=r("307014e72ed12da69e15"),i=r("145c4f2bdc487b2578df"),o=r("88db22626e6c88b175cf"),a=r("1139de1233fd67f45bd7"),s=r("5f25c015bbbf9d42c661"),c=r("224ae09e536c09e69a0a"),u=r("621a65702ee1a566fd32"),l=u("iterator"),h=u("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(f),m=0;m<p.length;m++){var v,g=p[m],y=f[g],b=a[g],x=b&&b.prototype;if(x&&(x[l]||s(x,l,d),x[h]||s(x,h,g),c[g]=d,y))for(v in n)x[v]||o(x,v,n[v],!0)}},c08c9d9f47b3a7dc389f:function(e,t,r){"use strict";t.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function e(t,r){if(t===r)return!0;if(null==t||null==r)return!1;if(Array.isArray(t))return Array.isArray(r)&&t.length===r.length&&t.every(function(t,n){return e(t,r[n])});var i=void 0===t?"undefined":n(t);if(i!==(void 0===r?"undefined":n(r)))return!1;if("object"===i){var o=t.valueOf(),a=r.valueOf();if(o!==t||a!==r)return e(o,a);var s=Object.keys(t),c=Object.keys(r);return s.length===c.length&&s.every(function(n){return e(t[n],r[n])})}return!1},e.exports=t.default},c0fa96a4e042118a422d:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}},c138e55a31f3f8960e99:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var i=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(n),o=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[r].concat(o).concat([i]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},c42b35b1ec34a3818888:function(e,t,r){r("02fcd2201285b358795d")("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},c563599eb9734b6ef1c0:function(e,t,r){var n=r("4be2c15021f717a728f0")(r("18caba858d9ea0f67284"),"DataView");e.exports=n},c5dd00b0f3b91ce870bd:function(e,t,r){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=c(r("8af190b70a6bc55c6f1b")),o=c(r("8a2d1b95e05b6a321e74")),a=c(r("6a4f9c383785f9168266")),s=r("12ba4fef039ee145f0aa");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)},h=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.handleClick=function(e){if(n.props.onClick&&n.props.onClick(e),!e.defaultPrevented&&0===e.button&&!n.props.target&&!l(e)){e.preventDefault();var t=n.context.router.history,r=n.props,i=r.replace,o=r.to;i?t.replace(o):t.push(o)}},u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=(e.replace,e.to),r=e.innerRef,o=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["replace","to","innerRef"]);(0,a.default)(this.context.router,"You should not use <Link> outside a <Router>"),(0,a.default)(void 0!==t,'You must specify the "to" property');var c=this.context.router.history,u="string"==typeof t?(0,s.createLocation)(t,null,null,c.location):t,l=c.createHref(u);return i.default.createElement("a",n({},o,{onClick:this.handleClick,href:l,ref:r}))},t}(i.default.Component);h.propTypes={onClick:o.default.func,target:o.default.string,replace:o.default.bool,to:o.default.oneOfType([o.default.string,o.default.object]).isRequired,innerRef:o.default.oneOfType([o.default.string,o.default.func])},h.defaultProps={replace:!1},h.contextTypes={router:o.default.shape({history:o.default.shape({push:o.default.func.isRequired,replace:o.default.func.isRequired,createHref:o.default.func.isRequired}).isRequired}).isRequired},t.default=h},c68991e63a6e99ff2511:function(e,t,r){var n=r("1139de1233fd67f45bd7"),i=r("5925dad3c5243ffee3db"),o=r("46a1a30d151cac60057c"),a=r("42d2ac6d92467eceff72"),s=r("1b01d0e59d3af79760a0").f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},c8a0e6ae37bbd5012724:function(e,t,r){r("02fcd2201285b358795d")("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}})},c8f33559dbc0657cda35:function(e,t,r){(function(e){t.__esModule=!0,t.warn=t.requestAnimationFrame=t.reducePropsToState=t.mapStateOnServer=t.handleClientStateChange=t.convertReactPropstoHtmlAttributes=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=c(r("8af190b70a6bc55c6f1b")),a=c(r("83406643bfb209d249f4")),s=r("b93293c8278c29a2c7c2");function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},l=function(e,t){return t.filter(function(t){return void 0!==t[e]}).map(function(t){return t[e]}).reduce(function(e,t){return i({},e,t)},{})},h=function(e,t,r){var i={};return r.filter(function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&g("Helmet: "+e+' should be of type "Array". Instead found type "'+n(t[e])+'"'),!1)}).map(function(t){return t[e]}).reverse().reduce(function(e,r){var n={};r.filter(function(e){for(var r=void 0,o=Object.keys(e),a=0;a<o.length;a++){var c=o[a],u=c.toLowerCase();-1===t.indexOf(u)||r===s.TAG_PROPERTIES.REL&&"canonical"===e[r].toLowerCase()||u===s.TAG_PROPERTIES.REL&&"stylesheet"===e[u].toLowerCase()||(r=u),-1===t.indexOf(c)||c!==s.TAG_PROPERTIES.INNER_HTML&&c!==s.TAG_PROPERTIES.CSS_TEXT&&c!==s.TAG_PROPERTIES.ITEM_PROP||(r=c)}if(!r||!e[r])return!1;var l=e[r].toLowerCase();return i[r]||(i[r]={}),n[r]||(n[r]={}),!i[r][l]&&(n[r][l]=!0,!0)}).reverse().forEach(function(t){return e.push(t)});for(var o=Object.keys(n),c=0;c<o.length;c++){var u=o[c],l=(0,a.default)({},i[u],n[u]);i[u]=l}return e},[]).reverse()},d=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n.hasOwnProperty(t))return n[t]}return null},f=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){f(t)},0)}}(),p=function(e){return clearTimeout(e)},m="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||f:e.requestAnimationFrame||f,v="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||p:e.cancelAnimationFrame||p,g=function(e){return console&&"function"==typeof console.warn&&console.warn(e)},y=null,b=function(e,t){var r=e.baseTag,n=e.bodyAttributes,i=e.htmlAttributes,o=e.linkTags,a=e.metaTags,c=e.noscriptTags,u=e.onChangeClientState,l=e.scriptTags,h=e.styleTags,d=e.title,f=e.titleAttributes;_(s.TAG_NAMES.BODY,n),_(s.TAG_NAMES.HTML,i),w(d,f);var p={baseTag:S(s.TAG_NAMES.BASE,r),linkTags:S(s.TAG_NAMES.LINK,o),metaTags:S(s.TAG_NAMES.META,a),noscriptTags:S(s.TAG_NAMES.NOSCRIPT,c),scriptTags:S(s.TAG_NAMES.SCRIPT,l),styleTags:S(s.TAG_NAMES.STYLE,h)},m={},v={};Object.keys(p).forEach(function(e){var t=p[e],r=t.newTags,n=t.oldTags;r.length&&(m[e]=r),n.length&&(v[e]=p[e].oldTags)}),t&&t(),u(e,m,v)},x=function(e){return Array.isArray(e)?e.join(""):e},w=function(e,t){void 0!==e&&document.title!==e&&(document.title=x(e)),_(s.TAG_NAMES.TITLE,t)},_=function(e,t){var r=document.getElementsByTagName(e)[0];if(r){for(var n=r.getAttribute(s.HELMET_ATTRIBUTE),i=n?n.split(","):[],o=[].concat(i),a=Object.keys(t),c=0;c<a.length;c++){var u=a[c],l=t[u]||"";r.getAttribute(u)!==l&&r.setAttribute(u,l),-1===i.indexOf(u)&&i.push(u);var h=o.indexOf(u);-1!==h&&o.splice(h,1)}for(var d=o.length-1;d>=0;d--)r.removeAttribute(o[d]);i.length===o.length?r.removeAttribute(s.HELMET_ATTRIBUTE):r.getAttribute(s.HELMET_ATTRIBUTE)!==a.join(",")&&r.setAttribute(s.HELMET_ATTRIBUTE,a.join(","))}},S=function(e,t){var r=document.head||document.querySelector(s.TAG_NAMES.HEAD),n=r.querySelectorAll(e+"["+s.HELMET_ATTRIBUTE+"]"),i=Array.prototype.slice.call(n),o=[],a=void 0;return t&&t.length&&t.forEach(function(t){var r=document.createElement(e);for(var n in t)if(t.hasOwnProperty(n))if(n===s.TAG_PROPERTIES.INNER_HTML)r.innerHTML=t.innerHTML;else if(n===s.TAG_PROPERTIES.CSS_TEXT)r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText));else{var c=void 0===t[n]?"":t[n];r.setAttribute(n,c)}r.setAttribute(s.HELMET_ATTRIBUTE,"true"),i.some(function(e,t){return a=t,r.isEqualNode(e)})?i.splice(a,1):o.push(r)}),i.forEach(function(e){return e.parentNode.removeChild(e)}),o.forEach(function(e){return r.appendChild(e)}),{oldTags:i,newTags:o}},M=function(e){return Object.keys(e).reduce(function(t,r){var n=void 0!==e[r]?r+'="'+e[r]+'"':""+r;return t?t+" "+n:n},"")},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[s.REACT_TAG_MAP[r]||r]=e[r],t},t)},A=function(e,t,r){switch(e){case s.TAG_NAMES.TITLE:return{toComponent:function(){return function(e,t,r){var n,i=((n={key:t})[s.HELMET_ATTRIBUTE]=!0,n),a=T(r,i);return[o.default.createElement(s.TAG_NAMES.TITLE,a,t)]}(0,t.title,t.titleAttributes)},toString:function(){return function(e,t,r,n){var i=M(r),o=x(t);return i?"<"+e+" "+s.HELMET_ATTRIBUTE+'="true" '+i+">"+u(o,n)+"</"+e+">":"<"+e+" "+s.HELMET_ATTRIBUTE+'="true">'+u(o,n)+"</"+e+">"}(e,t.title,t.titleAttributes,r)}};case s.ATTRIBUTE_NAMES.BODY:case s.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return T(t)},toString:function(){return M(t)}};default:return{toComponent:function(){return function(e,t){return t.map(function(t,r){var n,i=((n={key:r})[s.HELMET_ATTRIBUTE]=!0,n);return Object.keys(t).forEach(function(e){var r=s.REACT_TAG_MAP[e]||e;if(r===s.TAG_PROPERTIES.INNER_HTML||r===s.TAG_PROPERTIES.CSS_TEXT){var n=t.innerHTML||t.cssText;i.dangerouslySetInnerHTML={__html:n}}else i[r]=t[e]}),o.default.createElement(e,i)})}(e,t)},toString:function(){return function(e,t,r){return t.reduce(function(t,n){var i=Object.keys(n).filter(function(e){return!(e===s.TAG_PROPERTIES.INNER_HTML||e===s.TAG_PROPERTIES.CSS_TEXT)}).reduce(function(e,t){var i=void 0===n[t]?t:t+'="'+u(n[t],r)+'"';return e?e+" "+i:i},""),o=n.innerHTML||n.cssText||"",a=-1===s.SELF_CLOSING_TAGS.indexOf(e);return t+"<"+e+" "+s.HELMET_ATTRIBUTE+'="true" '+i+(a?"/>":">"+o+"</"+e+">")},"")}(e,t,r)}}}};t.convertReactPropstoHtmlAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[s.HTML_TAG_MAP[r]||r]=e[r],t},t)},t.handleClientStateChange=function(e){y&&v(y),e.defer?y=m(function(){b(e,function(){y=null})}):(b(e),y=null)},t.mapStateOnServer=function(e){var t=e.baseTag,r=e.bodyAttributes,n=e.encode,i=e.htmlAttributes,o=e.linkTags,a=e.metaTags,c=e.noscriptTags,u=e.scriptTags,l=e.styleTags,h=e.title,d=void 0===h?"":h,f=e.titleAttributes;return{base:A(s.TAG_NAMES.BASE,t,n),bodyAttributes:A(s.ATTRIBUTE_NAMES.BODY,r,n),htmlAttributes:A(s.ATTRIBUTE_NAMES.HTML,i,n),link:A(s.TAG_NAMES.LINK,o,n),meta:A(s.TAG_NAMES.META,a,n),noscript:A(s.TAG_NAMES.NOSCRIPT,c,n),script:A(s.TAG_NAMES.SCRIPT,u,n),style:A(s.TAG_NAMES.STYLE,l,n),title:A(s.TAG_NAMES.TITLE,{title:d,titleAttributes:f},n)}},t.reducePropsToState=function(e){return{baseTag:function(e,t){return t.filter(function(e){return void 0!==e[s.TAG_NAMES.BASE]}).map(function(e){return e[s.TAG_NAMES.BASE]}).reverse().reduce(function(t,r){if(!t.length)for(var n=Object.keys(r),i=0;i<n.length;i++){var o=n[i].toLowerCase();if(-1!==e.indexOf(o)&&r[o])return t.concat(r)}return t},[])}([s.TAG_PROPERTIES.HREF],e),bodyAttributes:l(s.ATTRIBUTE_NAMES.BODY,e),defer:d(e,s.HELMET_PROPS.DEFER),encode:d(e,s.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:l(s.ATTRIBUTE_NAMES.HTML,e),linkTags:h(s.TAG_NAMES.LINK,[s.TAG_PROPERTIES.REL,s.TAG_PROPERTIES.HREF],e),metaTags:h(s.TAG_NAMES.META,[s.TAG_PROPERTIES.NAME,s.TAG_PROPERTIES.CHARSET,s.TAG_PROPERTIES.HTTPEQUIV,s.TAG_PROPERTIES.PROPERTY,s.TAG_PROPERTIES.ITEM_PROP],e),noscriptTags:h(s.TAG_NAMES.NOSCRIPT,[s.TAG_PROPERTIES.INNER_HTML],e),onChangeClientState:function(e){return d(e,s.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}}(e),scriptTags:h(s.TAG_NAMES.SCRIPT,[s.TAG_PROPERTIES.SRC,s.TAG_PROPERTIES.INNER_HTML],e),styleTags:h(s.TAG_NAMES.STYLE,[s.TAG_PROPERTIES.CSS_TEXT],e),title:function(e){var t=d(e,s.TAG_NAMES.TITLE),r=d(e,s.HELMET_PROPS.TITLE_TEMPLATE);if(r&&t)return r.replace(/%s/g,function(){return t});var n=d(e,s.HELMET_PROPS.DEFAULT_TITLE);return t||n||void 0}(e),titleAttributes:l(s.ATTRIBUTE_NAMES.TITLE,e)}},t.requestAnimationFrame=m,t.warn=g}).call(this,r("698d75b157f24ae829cc"))},c9327538105d995811b8:function(e,t,r){var n=r("f3b0ff1628e56352bcbf"),i=r("84696c4e387dcb8648dc");e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},c9be824f185f52a1979a:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("2076e982c14c41925fb4")(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(a||!r("40b064d4eb439c0c1c2b")(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},ca19e32ab6ee3b3692aa:function(e,t,r){var n=r("1f3157d073736826d4fa"),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},cae0f026dfe4729a216f:function(e,t,r){"use strict";t.__esModule=!0;var n=a(r("8af190b70a6bc55c6f1b")),i=a(r("8a2d1b95e05b6a321e74")),o=a(r("6a4f9c383785f9168266"));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.enable=function(e){this.unblock&&this.unblock(),this.unblock=this.context.router.history.block(e)},t.prototype.disable=function(){this.unblock&&(this.unblock(),this.unblock=null)},t.prototype.componentWillMount=function(){(0,o.default)(this.context.router,"You should not use <Prompt> outside a <Router>"),this.props.when&&this.enable(this.props.message)},t.prototype.componentWillReceiveProps=function(e){e.when?this.props.when&&this.props.message===e.message||this.enable(e.message):this.disable()},t.prototype.componentWillUnmount=function(){this.disable()},t.prototype.render=function(){return null},t}(n.default.Component);s.propTypes={when:i.default.bool,message:i.default.oneOfType([i.default.func,i.default.string]).isRequired},s.defaultProps={when:!0},s.contextTypes={router:i.default.shape({history:i.default.shape({block:i.default.func.isRequired}).isRequired}).isRequired},t.default=s},cb1771a9eba49d3e1de6:function(e,t,r){r("7519864545a89c83682d")("replace",2,function(e,t,r){return[function(n,i){"use strict";var o=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},cb2f5c21ba0f661fdebb:function(e,t,r){r("ccf79254fef1a499b486")("Set")},cc1aef3f71c33f94b57e:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Reflect",{ownKeys:r("7fc706acfdba9b87047f")})},ccf730c83e7100f675a4:function(e,t,r){"use strict";var n=r("503a0df91bcab33c39b8"),i=r("87f7b2a2f3e179b5c40a").getWeak,o=r("79c91dcd8cd554c59c7b"),a=r("a459ab805827640a27e8"),s=r("fd8b6034a9a06242cc87"),c=r("4133d6461867e9751fc3"),u=r("ecd0e0fb36455021f082"),l=r("d34390b928ecadc11dc8"),h=r("2c407c4438ef2794ef23"),d=u(5),f=u(6),p=0,m=function(e){return e._l||(e._l=new v)},v=function(){this.a=[]},g=function(e,t){return d(e.a,function(e){return e[0]===t})};v.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var r=g(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var u=e(function(e,n){s(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,void 0!=n&&c(n,r,e[o],e)});return n(u.prototype,{delete:function(e){if(!a(e))return!1;var r=i(e);return!0===r?m(h(this,t)).delete(e):r&&l(r,this._i)&&delete r[this._i]},has:function(e){if(!a(e))return!1;var r=i(e);return!0===r?m(h(this,t)).has(e):r&&l(r,this._i)}}),u},def:function(e,t,r){var n=i(o(t),!0);return!0===n?m(e).set(t,r):n[e._i]=r,e},ufstore:m}},ccf79254fef1a499b486:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("4d073e2fededcdd3f3d3"),o=r("0e717e1f47872428608d"),a=r("4133d6461867e9751fc3");e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),void 0==e?new this:(r=[],t?(n=0,s=o(c,arguments[2],2),a(e,!1,function(e){r.push(s(e,n++))})):a(e,!1,r.push,r),new this(r))}})}},ce67b7d2fd06d83e5334:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){return function(){return function(t){return function(r){if(r.type!==n.CALL_HISTORY_METHOD)return t(r);var i=r.payload,o=i.method,a=i.args;e[o].apply(e,a)}}}};var n=r("7f74493c48ab576afbd4")},cef4e105446199aaf71e:function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},cf50f2ac57a34b8deade:function(e,t,r){r("02fcd2201285b358795d")("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}})},cf802dc5a6982c8247e6:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("ecd0e0fb36455021f082")(4);n(n.P+n.F*!r("40b064d4eb439c0c1c2b")([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},cf8d6afd09746a2b5bc3:function(e,t,r){var n=r("a459ab805827640a27e8"),i=r("0d694d86343010af9d4f").set;e.exports=function(e,t,r){var o,a=t.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&n(o)&&i&&i(e,o),e}},cfe37f364cc81a6415bd:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("d394d0a4c1838202489d"),o=r("4d073e2fededcdd3f3d3"),a=r("1b01d0e59d3af79760a0");r("5975c7ea3ecd56e534e3")&&n(n.P+r("615b8c1bc8c3f66221bc"),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},cff317ca62d09454b2d3:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Array",{isArray:r("8f648b1026e01323935b")})},d0990b8256a5f38a05aa:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("b0b0e0fb335805985891");n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},d14c3129375a94963214:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("d7d78b23c2948e92a9a9"));var i={},o=0;t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"/"===e?e:function(e){var t=e,r=i[t]||(i[t]={});if(r[e])return r[e];var a=n.default.compile(e);return o<1e4&&(r[e]=a,o++),a}(e)(t,{pretty:!0})}},d1a436d21f0debb638f5:function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("sub",function(e){return function(){return e(this,"sub","","")}})},d2e36888d16fa092915c:function(e,t,r){"use strict";r("57e7a4ee5fd1ce9280ef")("trim",function(e){return function(){return e(this,3)}})},d2fa9663cd158bd36d69:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Number",{isNaN:function(e){return e!=e}})},d34390b928ecadc11dc8:function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},d394d0a4c1838202489d:function(e,t,r){var n=r("7ad2c0eb9a8edcc472a4");e.exports=function(e){return Object(n(e))}},d3a850c4000d77bccc89:function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},d491591ee60d9ef0aa9d:function(e,t,r){"use strict";var n=r("a459ab805827640a27e8"),i=r("12323e1413cbffdabe02"),o=r("621a65702ee1a566fd32")("hasInstance"),a=Function.prototype;o in a||r("1b01d0e59d3af79760a0").f(a,o,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},d576fdbd1b2940cea26e:function(e,t,r){"use strict";
/** @license React v16.4.1
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r("83406643bfb209d249f4"),i=r("277cfc1331526160cbd4"),o=r("bef911c5daed007bb174"),a=r("ec9de96ce27c00ac79c5"),s="function"==typeof Symbol&&Symbol.for,c=s?Symbol.for("react.element"):60103,u=s?Symbol.for("react.portal"):60106,l=s?Symbol.for("react.fragment"):60107,h=s?Symbol.for("react.strict_mode"):60108,d=s?Symbol.for("react.profiler"):60114,f=s?Symbol.for("react.provider"):60109,p=s?Symbol.for("react.context"):60110,m=s?Symbol.for("react.async_mode"):60111,v=s?Symbol.for("react.forward_ref"):60112;s&&Symbol.for("react.timeout");var g="function"==typeof Symbol&&Symbol.iterator;function y(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);i(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function x(e,t,r){this.props=e,this.context=t,this.refs=o,this.updater=r||b}function w(){}function _(e,t,r){this.props=e,this.context=t,this.refs=o,this.updater=r||b}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&y("85"),this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=x.prototype;var S=_.prototype=new w;S.constructor=_,n(S,x.prototype),S.isPureReactComponent=!0;var M={current:null},T=Object.prototype.hasOwnProperty,A={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var n=void 0,i={},o=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)T.call(t,n)&&!A.hasOwnProperty(n)&&(i[n]=t[n]);var s=arguments.length-2;if(1===s)i.children=r;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===i[n]&&(i[n]=s[n]);return{$$typeof:c,type:e,key:o,ref:a,props:i,_owner:M.current}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===c}var L=/\/+/g,P=[];function O(e,t,r,n){if(P.length){var i=P.pop();return i.result=e,i.keyPrefix=t,i.func=r,i.context=n,i.count=0,i}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function N(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>P.length&&P.push(e)}function R(e,t,r,n){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var o=!1;if(null===e)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case c:case u:o=!0}}if(o)return r(n,e,""===t?"."+I(e,0):t),1;if(o=0,t=""===t?".":t+":",Array.isArray(e))for(var a=0;a<e.length;a++){var s=t+I(i=e[a],a);o+=R(i,s,r,n)}else if(null===e||void 0===e?s=null:s="function"==typeof(s=g&&e[g]||e["@@iterator"])?s:null,"function"==typeof s)for(e=s.call(e),a=0;!(i=e.next()).done;)o+=R(i=i.value,s=t+I(i,a++),r,n);else"object"===i&&y("31","[object Object]"===(r=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":r,"");return o}function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}(e.key):t.toString(36)}function D(e,t){e.func.call(e.context,t,e.count++)}function F(e,t,r){var n=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,n,r,a.thatReturnsArgument):null!=e&&(C(e)&&(t=i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(L,"$&/")+"/")+r,e={$$typeof:c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}),n.push(e))}function U(e,t,r,n,i){var o="";null!=r&&(o=(""+r).replace(L,"$&/")+"/"),t=O(t,o,n,i),null==e||R(e,"",F,t),N(t)}var k={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return U(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;t=O(null,null,t,r),null==e||R(e,"",D,t),N(t)},count:function(e){return null==e?0:R(e,"",a.thatReturnsNull,null)},toArray:function(e){var t=[];return U(e,t,null,a.thatReturnsArgument),t},only:function(e){return C(e)||y("143"),e}},createRef:function(){return{current:null}},Component:x,PureComponent:_,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:p,_calculateChangedBits:t,_defaultValue:e,_currentValue:e,_currentValue2:e,_changedBits:0,_changedBits2:0,Provider:null,Consumer:null}).Provider={$$typeof:f,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:v,render:e}},Fragment:l,StrictMode:h,unstable_AsyncMode:m,unstable_Profiler:d,createElement:E,cloneElement:function(e,t,r){(null===e||void 0===e)&&y("267",e);var i=void 0,o=n({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){void 0!==t.ref&&(s=t.ref,u=M.current),void 0!==t.key&&(a=""+t.key);var l=void 0;for(i in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),t)T.call(t,i)&&!A.hasOwnProperty(i)&&(o[i]=void 0===t[i]&&void 0!==l?l[i]:t[i])}if(1===(i=arguments.length-2))o.children=r;else if(1<i){l=Array(i);for(var h=0;h<i;h++)l[h]=arguments[h+2];o.children=l}return{$$typeof:c,type:e.type,key:a,ref:s,props:o,_owner:u}},createFactory:function(e){var t=E.bind(null,e);return t.type=e,t},isValidElement:C,version:"16.4.1",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:M,assign:n}},B={default:k},z=B&&k||B;e.exports=z.default?z.default:z},d5e0d50957e1364b4d8b:function(e,t,r){var n=r("621a65702ee1a566fd32")("toPrimitive"),i=Date.prototype;n in i||r("5f25c015bbbf9d42c661")(i,n,r("31acd5ae212d901071a3"))},d701338e3c92ad7598cc:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t,r,n){i(e,"mapStateToProps",n),i(t,"mapDispatchToProps",n),i(r,"mergeProps",n)};var n=function(e){return e&&e.__esModule?e:{default:e}}(r("c0fa96a4e042118a422d"));function i(e,t,r){if(!e)throw new Error("Unexpected value for "+t+" in "+r+".");"mapStateToProps"!==t&&"mapDispatchToProps"!==t||e.hasOwnProperty("dependsOnOwnProps")||(0,n.default)("The selector for "+t+" of "+r+" did not specify a value for dependsOnOwnProps.")}},d7134433f426bbf0c311:function(e,t,r){"use strict";var n=r("4d073e2fededcdd3f3d3"),i=r("a459ab805827640a27e8"),o=r("5a3b914e449c6d95aadc"),a=[].slice,s={};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),c=function(){var n=r.concat(a.call(arguments));return this instanceof c?function(e,t,r){if(!(t in s)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,r)}(t,n.length,n):o(t,n,e)};return i(t.prototype)&&(c.prototype=t.prototype),c}},d7d78b23c2948e92a9a9:function(e,t,r){var n=r("5b56f889e8364e6f86ab");e.exports=p,e.exports.parse=o,e.exports.compile=function(e,t){return c(o(e,t))},e.exports.tokensToFunction=c,e.exports.tokensToRegExp=f;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e,t){for(var r,n=[],o=0,a=0,s="",c=t&&t.delimiter||"/";null!=(r=i.exec(e));){var h=r[0],d=r[1],f=r.index;if(s+=e.slice(a,f),a=f+h.length,d)s+=d[1];else{var p=e[a],m=r[2],v=r[3],g=r[4],y=r[5],b=r[6],x=r[7];s&&(n.push(s),s="");var w=null!=m&&null!=p&&p!==m,_="+"===b||"*"===b,S="?"===b||"*"===b,M=r[2]||c,T=g||y;n.push({name:v||o++,prefix:m||"",delimiter:M,optional:S,repeat:_,partial:w,asterisk:!!x,pattern:T?l(T):x?".*":"[^"+u(M)+"]+?"})}}return a<e.length&&(s+=e.substr(a)),s&&n.push(s),n}function a(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function s(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function c(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,i){for(var o="",c=r||{},u=(i||{}).pretty?a:encodeURIComponent,l=0;l<e.length;l++){var h=e[l];if("string"!=typeof h){var d,f=c[h.name];if(null==f){if(h.optional){h.partial&&(o+=h.prefix);continue}throw new TypeError('Expected "'+h.name+'" to be defined')}if(n(f)){if(!h.repeat)throw new TypeError('Expected "'+h.name+'" to not repeat, but received `'+JSON.stringify(f)+"`");if(0===f.length){if(h.optional)continue;throw new TypeError('Expected "'+h.name+'" to not be empty')}for(var p=0;p<f.length;p++){if(d=u(f[p]),!t[l].test(d))throw new TypeError('Expected all "'+h.name+'" to match "'+h.pattern+'", but received `'+JSON.stringify(d)+"`");o+=(0===p?h.prefix:h.delimiter)+d}}else{if(d=h.asterisk?s(f):u(f),!t[l].test(d))throw new TypeError('Expected "'+h.name+'" to match "'+h.pattern+'", but received "'+d+'"');o+=h.prefix+d}}else o+=h}return o}}function u(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function l(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function h(e,t){return e.keys=t,e}function d(e){return e.sensitive?"":"i"}function f(e,t,r){n(t)||(r=t||r,t=[]);for(var i=(r=r||{}).strict,o=!1!==r.end,a="",s=0;s<e.length;s++){var c=e[s];if("string"==typeof c)a+=u(c);else{var l=u(c.prefix),f="(?:"+c.pattern+")";t.push(c),c.repeat&&(f+="(?:"+l+f+")*"),a+=f=c.optional?c.partial?l+"("+f+")?":"(?:"+l+"("+f+"))?":l+"("+f+")"}}var p=u(r.delimiter||"/"),m=a.slice(-p.length)===p;return i||(a=(m?a.slice(0,-p.length):a)+"(?:"+p+"(?=$))?"),a+=o?"$":i&&m?"":"(?="+p+"|$)",h(new RegExp("^"+a,d(r)),t)}function p(e,t,r){return n(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?function(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return h(e,t)}(e,t):n(e)?function(e,t,r){for(var n=[],i=0;i<e.length;i++)n.push(p(e[i],t,r).source);return h(new RegExp("(?:"+n.join("|")+")",d(r)),t)}(e,t,r):function(e,t,r){return f(o(e,r),t,r)}(e,t,r)}},d7dd51e1bf6bfc2c9c3d:function(e,t,r){"use strict";t.__esModule=!0,t.connect=t.connectAdvanced=t.createProvider=t.Provider=void 0;var n=r("aaa8ac4298b679dfe295"),i=s(n),o=s(r("8de1be082e521bbaabf2")),a=s(r("7ad2ae5e9bfa67dff4eb"));function s(e){return e&&e.__esModule?e:{default:e}}t.Provider=i.default,t.createProvider=n.createProvider,t.connectAdvanced=o.default,t.connect=a.default},d8fab3fc72ca23b52ae2:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},da57ca5397b5779e093d:function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=n.keys,a=n.key;n.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},da8dbcc3b692fc0676cc:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("5925dad3c5243ffee3db"),o=r("1139de1233fd67f45bd7"),a=r("8b246eab22bc34690d38"),s=r("8cea4f2c5f75a90121e7");n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},dabaabbe8ba08d59975f:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},dae1b939e898dc140c93:function(e,t,r){r("9f769c6d0e4c9e82ba05")("Map")},dae53c7f1be5fcfdbe4b:function(e,t){var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},db019a029d69500cb816:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.G,{global:r("1139de1233fd67f45bd7")})},dba25a6f599687a5b44e:function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},dbb8045293c85083c922:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S,"Reflect",{has:function(e,t){return t in e}})},dbcdca8da350cc1706f8:function(e,t,r){e.exports=function e(t){"use strict";var r=/^\0+/g,n=/[\0\r\f]/g,i=/: */g,o=/zoo|gra/,a=/([,: ])(transform)/g,s=/,+\s*(?![^(]*[)])/g,c=/ +\s*(?![^(]*[)])/g,u=/ *[\0] */g,l=/,\r+?/g,h=/([\t\r\n ])*\f?&/g,d=/:global\(((?:[^\(\)\[\]]*|\[.*\]|\([^\(\)]*\))*)\)/g,f=/\W+/g,p=/@(k\w+)\s*(\S*)\s*/,m=/::(place)/g,v=/:(read-only)/g,g=/\s+(?=[{\];=:>])/g,y=/([[}=:>])\s+/g,b=/(\{[^{]+?);(?=\})/g,x=/\s{2,}/g,w=/([^\(])(:+) */g,_=/[svh]\w+-[tblr]{2}/,S=/\(\s*(.*)\s*\)/g,M=/([\s\S]*?);/g,T=/-self|flex-/g,A=/[^]*?(:[rp][el]a[\w-]+)[^]*/,E=/stretch|:\s*\w+\-(?:conte|avail)/,C=/([^-])(image-set\()/,L="-webkit-",P="-moz-",O="-ms-",N=59,R=125,I=123,D=40,F=41,U=91,k=93,B=10,z=13,j=9,V=64,G=32,W=38,H=45,X=95,q=42,Y=44,J=58,Q=39,Z=34,K=47,$=62,ee=43,te=126,re=0,ne=12,ie=11,oe=107,ae=109,se=115,ce=112,ue=111,le=105,he=99,de=100,fe=112,pe=1,me=1,ve=0,ge=1,ye=1,be=1,xe=0,we=0,_e=0,Se=[],Me=[],Te=0,Ae=null,Ee=-2,Ce=-1,Le=0,Pe=1,Oe=2,Ne=3,Re=0,Ie=1,De="",Fe="",Ue="";function ke(e,t,i,o,a){for(var s,c,l=0,h=0,d=0,f=0,g=0,y=0,b=0,x=0,_=0,M=0,T=0,A=0,E=0,C=0,X=0,xe=0,Me=0,Ae=0,Ee=0,Ce=i.length,ze=Ce-1,Xe="",qe="",Ye="",Je="",Qe="",Ze="";X<Ce;){if(b=i.charCodeAt(X),X===ze&&h+f+d+l!==0&&(0!==h&&(b=h===K?B:K),f=d=l=0,Ce++,ze++),h+f+d+l===0){if(X===ze&&(xe>0&&(qe=qe.replace(n,"")),qe.trim().length>0)){switch(b){case G:case j:case N:case z:case B:break;default:qe+=i.charAt(X)}b=N}if(1===Me)switch(b){case I:case R:case N:case Z:case Q:case D:case F:case Y:Me=0;case j:case z:case B:case G:break;default:for(Me=0,Ee=X,g=b,X--,b=N;Ee<Ce;)switch(i.charCodeAt(Ee++)){case B:case z:case N:++X,b=g,Ee=Ce;break;case J:xe>0&&(++X,b=g);case I:Ee=Ce}}switch(b){case I:for(qe=qe.trim(),g=qe.charCodeAt(0),T=1,Ee=++X;X<Ce;){switch(b=i.charCodeAt(X)){case I:T++;break;case R:T--;break;case K:switch(y=i.charCodeAt(X+1)){case q:case K:X=He(y,X,ze,i)}break;case U:b++;case D:b++;case Z:case Q:for(;X++<ze&&i.charCodeAt(X)!==b;);}if(0===T)break;X++}switch(Ye=i.substring(Ee,X),g===re&&(g=(qe=qe.replace(r,"").trim()).charCodeAt(0)),g){case V:switch(xe>0&&(qe=qe.replace(n,"")),y=qe.charCodeAt(1)){case de:case ae:case se:case H:s=t;break;default:s=Se}if(Ye=ke(t,s,Ye,y,a+1),Ee=Ye.length,_e>0&&0===Ee&&(Ee=qe.length),Te>0&&(s=Be(Se,qe,Ae),c=We(Ne,Ye,s,t,me,pe,Ee,y,a,o),qe=s.join(""),void 0!==c&&0===(Ee=(Ye=c.trim()).length)&&(y=0,Ye="")),Ee>0)switch(y){case se:qe=qe.replace(S,Ge);case de:case ae:case H:Ye=qe+"{"+Ye+"}";break;case oe:qe=qe.replace(p,"$1 $2"+(Ie>0?De:"")),Ye=qe+"{"+Ye+"}",Ye=1===ye||2===ye&&Ve("@"+Ye,3)?"@"+L+Ye+"@"+Ye:"@"+Ye;break;default:Ye=qe+Ye,o===fe&&(Je+=Ye,Ye="")}else Ye="";break;default:Ye=ke(t,Be(t,qe,Ae),Ye,o,a+1)}Qe+=Ye,A=0,Me=0,C=0,xe=0,Ae=0,E=0,qe="",Ye="",b=i.charCodeAt(++X);break;case R:case N:if(qe=(xe>0?qe.replace(n,""):qe).trim(),(Ee=qe.length)>1)switch(0===C&&((g=qe.charCodeAt(0))===H||g>96&&g<123)&&(Ee=(qe=qe.replace(" ",":")).length),Te>0&&void 0!==(c=We(Pe,qe,t,e,me,pe,Je.length,o,a,o))&&0===(Ee=(qe=c.trim()).length)&&(qe="\0\0"),g=qe.charCodeAt(0),y=qe.charCodeAt(1),g){case re:break;case V:if(y===le||y===he){Ze+=qe+i.charAt(X);break}default:if(qe.charCodeAt(Ee-1)===J)break;Je+=je(qe,g,y,qe.charCodeAt(2))}A=0,Me=0,C=0,xe=0,Ae=0,qe="",b=i.charCodeAt(++X)}}switch(b){case z:case B:if(h+f+d+l+we===0)switch(M){case F:case Q:case Z:case V:case te:case $:case q:case ee:case K:case H:case J:case Y:case N:case I:case R:break;default:C>0&&(Me=1)}h===K?h=0:ge+A===0&&o!==oe&&qe.length>0&&(xe=1,qe+="\0"),Te*Re>0&&We(Le,qe,t,e,me,pe,Je.length,o,a,o),pe=1,me++;break;case N:case R:if(h+f+d+l===0){pe++;break}default:switch(pe++,Xe=i.charAt(X),b){case j:case G:if(f+l+h===0)switch(x){case Y:case J:case j:case G:Xe="";break;default:b!==G&&(Xe=" ")}break;case re:Xe="\\0";break;case ne:Xe="\\f";break;case ie:Xe="\\v";break;case W:f+h+l===0&&ge>0&&(Ae=1,xe=1,Xe="\f"+Xe);break;case 108:if(f+h+l+ve===0&&C>0)switch(X-C){case 2:x===ce&&i.charCodeAt(X-3)===J&&(ve=x);case 8:_===ue&&(ve=_)}break;case J:f+h+l===0&&(C=X);break;case Y:h+d+f+l===0&&(xe=1,Xe+="\r");break;case Z:case Q:0===h&&(f=f===b?0:0===f?b:f);break;case U:f+h+d===0&&l++;break;case k:f+h+d===0&&l--;break;case F:f+h+l===0&&d--;break;case D:if(f+h+l===0){if(0===A)switch(2*x+3*_){case 533:break;default:T=0,A=1}d++}break;case V:h+d+f+l+C+E===0&&(E=1);break;case q:case K:if(f+l+d>0)break;switch(h){case 0:switch(2*b+3*i.charCodeAt(X+1)){case 235:h=K;break;case 220:Ee=X,h=q}break;case q:b===K&&x===q&&Ee+2!==X&&(33===i.charCodeAt(Ee+2)&&(Je+=i.substring(Ee,X+1)),Xe="",h=0)}}if(0===h){if(ge+f+l+E===0&&o!==oe&&b!==N)switch(b){case Y:case te:case $:case ee:case F:case D:if(0===A){switch(x){case j:case G:case B:case z:Xe+="\0";break;default:Xe="\0"+Xe+(b===Y?"":"\0")}xe=1}else switch(b){case D:C+7===X&&108===x&&(C=0),A=++T;break;case F:0==(A=--T)&&(xe=1,Xe+="\0")}break;case j:case G:switch(x){case re:case I:case R:case N:case Y:case ne:case j:case G:case B:case z:break;default:0===A&&(xe=1,Xe+="\0")}}qe+=Xe,b!==G&&b!==j&&(M=b)}}_=x,x=b,X++}if(Ee=Je.length,_e>0&&0===Ee&&0===Qe.length&&0===t[0].length==0&&(o!==ae||1===t.length&&(ge>0?Fe:Ue)===t[0])&&(Ee=t.join(",").length+2),Ee>0){if(s=0===ge&&o!==oe?function(e){for(var t,r,i=0,o=e.length,a=Array(o);i<o;++i){for(var s=e[i].split(u),c="",l=0,h=0,d=0,f=0,p=s.length;l<p;++l)if(!(0===(h=(r=s[l]).length)&&p>1)){if(d=c.charCodeAt(c.length-1),f=r.charCodeAt(0),t="",0!==l)switch(d){case q:case te:case $:case ee:case G:case D:break;default:t=" "}switch(f){case W:r=t+Fe;case te:case $:case ee:case G:case F:case D:break;case U:r=t+r+Fe;break;case J:switch(2*r.charCodeAt(1)+3*r.charCodeAt(2)){case 530:if(be>0){r=t+r.substring(8,h-1);break}default:(l<1||s[l-1].length<1)&&(r=t+Fe+r)}break;case Y:t="";default:r=h>1&&r.indexOf(":")>0?t+r.replace(w,"$1"+Fe+"$2"):t+r+Fe}c+=r}a[i]=c.replace(n,"").trim()}return a}(t):t,Te>0&&void 0!==(c=We(Oe,Je,s,e,me,pe,Ee,o,a,o))&&0===(Je=c).length)return Ze+Je+Qe;if(Je=s.join(",")+"{"+Je+"}",ye*ve!=0){switch(2!==ye||Ve(Je,2)||(ve=0),ve){case ue:Je=Je.replace(v,":"+P+"$1")+Je;break;case ce:Je=Je.replace(m,"::"+L+"input-$1")+Je.replace(m,"::"+P+"$1")+Je.replace(m,":"+O+"input-$1")+Je}ve=0}}return Ze+Je+Qe}function Be(e,t,r){var n=t.trim().split(l),i=n,o=n.length,a=e.length;switch(a){case 0:case 1:for(var s=0,c=0===a?"":e[0]+" ";s<o;++s)i[s]=ze(c,i[s],r,a).trim();break;default:for(var s=0,u=0,i=[];s<o;++s)for(var h=0;h<a;++h)i[u++]=ze(e[h]+" ",n[s],r,a).trim()}return i}function ze(e,t,r,n){var i=t,o=i.charCodeAt(0);switch(o<33&&(o=(i=i.trim()).charCodeAt(0)),o){case W:switch(ge+n){case 0:case 1:if(0===e.trim().length)break;default:return i.replace(h,"$1"+e.trim())}break;case J:switch(i.charCodeAt(1)){case 103:if(be>0&&ge>0)return i.replace(d,"$1").replace(h,"$1"+Ue);break;default:return e.trim()+i.replace(h,"$1"+e.trim())}default:if(r*ge>0&&i.indexOf("\f")>0)return i.replace(h,(e.charCodeAt(0)===J?"":"$1")+e.trim())}return e+i}function je(e,t,r,n){var u,l=0,h=e+";",d=2*t+3*r+4*n;if(944===d)return function(e){var t=e.length,r=e.indexOf(":",9)+1,n=e.substring(0,r).trim(),i=e.substring(r,t-1).trim();switch(e.charCodeAt(9)*Ie){case 0:break;case H:if(110!==e.charCodeAt(10))break;default:for(var o=i.split((i="",s)),a=0,r=0,t=o.length;a<t;r=0,++a){for(var u=o[a],l=u.split(c);u=l[r];){var h=u.charCodeAt(0);if(1===Ie&&(h>V&&h<90||h>96&&h<123||h===X||h===H&&u.charCodeAt(1)!==H))switch(isNaN(parseFloat(u))+(-1!==u.indexOf("("))){case 1:switch(u){case"infinite":case"alternate":case"backwards":case"running":case"normal":case"forwards":case"both":case"none":case"linear":case"ease":case"ease-in":case"ease-out":case"ease-in-out":case"paused":case"reverse":case"alternate-reverse":case"inherit":case"initial":case"unset":case"step-start":case"step-end":break;default:u+=De}}l[r++]=u}i+=(0===a?"":",")+l.join(" ")}}return i=n+i+";",1===ye||2===ye&&Ve(i,1)?L+i+i:i}(h);if(0===ye||2===ye&&!Ve(h,1))return h;switch(d){case 1015:return 97===h.charCodeAt(10)?L+h+h:h;case 951:return 116===h.charCodeAt(3)?L+h+h:h;case 963:return 110===h.charCodeAt(5)?L+h+h:h;case 1009:if(100!==h.charCodeAt(4))break;case 969:case 942:return L+h+h;case 978:return L+h+P+h+h;case 1019:case 983:return L+h+P+h+O+h+h;case 883:return h.charCodeAt(8)===H?L+h+h:h.indexOf("image-set(",11)>0?h.replace(C,"$1"+L+"$2")+h:h;case 932:if(h.charCodeAt(4)===H)switch(h.charCodeAt(5)){case 103:return L+"box-"+h.replace("-grow","")+L+h+O+h.replace("grow","positive")+h;case 115:return L+h+O+h.replace("shrink","negative")+h;case 98:return L+h+O+h.replace("basis","preferred-size")+h}return L+h+O+h+h;case 964:return L+h+O+"flex-"+h+h;case 1023:if(99!==h.charCodeAt(8))break;return u=h.substring(h.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),L+"box-pack"+u+L+h+O+"flex-pack"+u+h;case 1005:return o.test(h)?h.replace(i,":"+L)+h.replace(i,":"+P)+h:h;case 1e3:switch(u=h.substring(13).trim(),l=u.indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(l)){case 226:u=h.replace(_,"tb");break;case 232:u=h.replace(_,"tb-rl");break;case 220:u=h.replace(_,"lr");break;default:return h}return L+h+O+u+h;case 1017:if(-1===h.indexOf("sticky",9))return h;case 975:switch(l=(h=e).length-10,u=(33===h.charCodeAt(l)?h.substring(0,l):h).substring(e.indexOf(":",7)+1).trim(),d=u.charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(u.charCodeAt(8)<111)break;case 115:h=h.replace(u,L+u)+";"+h;break;case 207:case 102:h=h.replace(u,L+(d>102?"inline-":"")+"box")+";"+h.replace(u,L+u)+";"+h.replace(u,O+u+"box")+";"+h}return h+";";case 938:if(h.charCodeAt(5)===H)switch(h.charCodeAt(6)){case 105:return u=h.replace("-items",""),L+h+L+"box-"+u+O+"flex-"+u+h;case 115:return L+h+O+"flex-item-"+h.replace(T,"")+h;default:return L+h+O+"flex-line-pack"+h.replace("align-content","").replace(T,"")+h}break;case 973:case 989:if(h.charCodeAt(3)!==H||122===h.charCodeAt(4))break;case 931:case 953:if(!0===E.test(e))return 115===(u=e.substring(e.indexOf(":")+1)).charCodeAt(0)?je(e.replace("stretch","fill-available"),t,r,n).replace(":fill-available",":stretch"):h.replace(u,L+u)+h.replace(u,P+u.replace("fill-",""))+h;break;case 962:if(h=L+h+(102===h.charCodeAt(5)?O+h:"")+h,r+n===211&&105===h.charCodeAt(13)&&h.indexOf("transform",10)>0)return h.substring(0,h.indexOf(";",27)+1).replace(a,"$1"+L+"$2")+h}return h}function Ve(e,t){var r=e.indexOf(1===t?":":"{"),n=e.substring(0,3!==t?r:10),i=e.substring(r+1,e.length-1);return Ae(2!==t?n:n.replace(A,"$1"),i,t)}function Ge(e,t){var r=je(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return r!==t+";"?r.replace(M," or ($1)").substring(4):"("+t+")"}function We(e,t,r,n,i,o,a,s,c,u){for(var l,h=0,d=t;h<Te;++h)switch(l=Me[h].call(qe,e,d,r,n,i,o,a,s,c,u)){case void 0:case!1:case!0:case null:break;default:d=l}switch(d){case void 0:case!1:case!0:case null:case t:break;default:return d}}function He(e,t,r,n){for(var i=t+1;i<r;++i)switch(n.charCodeAt(i)){case K:if(e===q&&n.charCodeAt(i-1)===q&&t+2!==i)return i+1;break;case B:if(e===K)return i+1}return i}function Xe(e){for(var t in e){var r=e[t];switch(t){case"keyframe":Ie=0|r;break;case"global":be=0|r;break;case"cascade":ge=0|r;break;case"compress":xe=0|r;break;case"semicolon":we=0|r;break;case"preserve":_e=0|r;break;case"prefix":Ae=null,r?"function"!=typeof r?ye=1:(ye=2,Ae=r):ye=0}}return Xe}function qe(t,r){if(void 0!==this&&this.constructor===qe)return e(t);var i=t,o=i.charCodeAt(0);o<33&&(o=(i=i.trim()).charCodeAt(0)),Ie>0&&(De=i.replace(f,o===U?"":"-")),o=1,1===ge?Ue=i:Fe=i;var a,s=[Ue];Te>0&&void 0!==(a=We(Ce,r,s,s,me,pe,0,0,0,0))&&"string"==typeof a&&(r=a);var c=ke(Se,s,r,0,0);return Te>0&&void 0!==(a=We(Ee,c,s,s,me,pe,c.length,0,0,0))&&"string"!=typeof(c=a)&&(o=0),De="",Ue="",Fe="",ve=0,me=1,pe=1,xe*o==0?c:function(e){return e.replace(n,"").replace(g,"").replace(y,"$1").replace(b,"$1").replace(x," ")}(c)}return qe.use=function e(t){switch(t){case void 0:case null:Te=Me.length=0;break;default:switch(t.constructor){case Array:for(var r=0,n=t.length;r<n;++r)e(t[r]);break;case Function:Me[Te++]=t;break;case Boolean:Re=0|!!t}}return e},qe.set=Xe,void 0!==t&&Xe(t),qe}(null)},dc5bd15c664880964ee5:function(e,t,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r("88db22626e6c88b175cf")(n,"toString",function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"})},dc76537051b58b7ecd44:function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=r("12323e1413cbffdabe02"),a=n.has,s=n.get,c=n.key,u=function(e,t,r){if(a(e,t,r))return s(e,t,r);var n=o(t);return null!==n?u(e,n,r):void 0};n.exp({getMetadata:function(e,t){return u(e,i(t),arguments.length<3?void 0:c(arguments[2]))}})},de6553e2eed497bebede:function(e,t,r){"use strict";t.__esModule=!0;var n=c(r("49a47d064cfbf2949ee5")),i=c(r("8af190b70a6bc55c6f1b")),o=c(r("8a2d1b95e05b6a321e74")),a=r("12ba4fef039ee145f0aa"),s=c(r("07a2173bac8ab93c3080"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=n=u(this,e.call.apply(e,[this].concat(o))),n.history=(0,a.createMemoryHistory)(n.props),u(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){(0,n.default)(!this.props.history,"<MemoryRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { MemoryRouter as Router }`.")},t.prototype.render=function(){return i.default.createElement(s.default,{history:this.history,children:this.props.children})},t}(i.default.Component);l.propTypes={initialEntries:o.default.array,initialIndex:o.default.number,getUserConfirmation:o.default.func,keyLength:o.default.number,children:o.default.node},t.default=l},deb1edf8e03fc2092ec7:function(e,t,r){"use strict";(function(e,n){r.d(t,"b",function(){return Ue});var i=r("1f928caa5aa7943b8c1b"),o=r.n(i),a=r("dbcdca8da350cc1706f8"),s=r.n(a),c=r("2aec7b6edb2a47e3521f"),u=r.n(c),l=r("8af190b70a6bc55c6f1b"),h=r.n(l),d=r("8a2d1b95e05b6a321e74"),f=r.n(d),p=r("5ef9de3df8d92ea0e41c"),m=r.n(p),v=r("0efece4c8cb91e128a85"),g=/([A-Z])/g;var y=function(e){return e.replace(g,"-$1").toLowerCase()},b=/^ms-/;var x=function(e){return y(e).replace(b,"-ms-")},w=function e(t,r){return t.reduce(function(t,n){return void 0===n||null===n||!1===n||""===n?t:Array.isArray(n)?[].concat(t,e(n,r)):n.hasOwnProperty("styledComponentId")?[].concat(t,["."+n.styledComponentId]):"function"==typeof n?r?t.concat.apply(t,e([n(r)],r)):t.concat(n):t.concat(o()(n)?function e(t,r){var n=Object.keys(t).filter(function(e){var r=t[e];return void 0!==r&&null!==r&&!1!==r&&""!==r}).map(function(r){return o()(t[r])?e(t[r],r):x(r)+": "+t[r]+";"}).join(" ");return r?r+" {\n  "+n+"\n}":n}(n):n.toString())},[])},_=new s.a({global:!1,cascade:!0,keyframe:!1,prefix:!1,compress:!1,semicolon:!0}),S=new s.a({global:!1,cascade:!0,keyframe:!1,prefix:!0,compress:!1,semicolon:!1}),M=[],T=function(e){if(-2===e){var t=M;return M=[],t}},A=u()(function(e){M.push(e)});S.use([A,T]),_.use([A,T]);var E=function(e,t,r){var n=e.join("").replace(/^\s*\/\/.*$/gm,"");return S(r||!t?"":t,t&&r?r+" "+t+" { "+n+" }":n)},C=function(e){return _("",e)};function L(e){return"function"==typeof e&&"string"==typeof e.styledComponentId}var P=function(e){return String.fromCharCode(e+(e>25?39:97))},O=function(e){var t="",r=void 0;for(r=e;r>52;r=Math.floor(r/52))t=P(r%52)+t;return P(r%52)+t},N=function(e,t){return t.reduce(function(t,r,n){return t.concat(r,e[n+1])},[e[0]])},R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},D=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},k=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},B=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},z=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Array.isArray(e)||"object"!==(void 0===e?"undefined":R(e))?w(N(e,r)):w(N([],[e].concat(r)))},j=void 0!==e&&Object({NODE_ENV:"production"}).SC_ATTR||"data-styled-components",V="__styled-components-stylesheet__",G="undefined"!=typeof window&&"HTMLElement"in window,W=/^[^\S\n]*?\/\* sc-component-id:\s*(\S+)\s+\*\//gm,H=function(e){var t=""+(e||""),r=[];return t.replace(W,function(e,t,n){return r.push({componentId:t,matchIndex:n}),e}),r.map(function(e,n){var i=e.componentId,o=e.matchIndex,a=r[n+1];return{componentId:i,cssFromDOM:a?t.slice(o,a.matchIndex):t.slice(o)}})},X=function(){return r.nc},q=function(e,t,r){r&&((e[t]||(e[t]=Object.create(null)))[r]=!0)},Y=function(e,t){e[t]=Object.create(null)},J=function(e){return function(t,r){return void 0!==e[t]&&e[t][r]}},Q=function(e){var t="";for(var r in e)t+=Object.keys(e[r]).join(" ")+" ";return t.trim()},Z=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets.length,r=0;r<t;r+=1){var n=document.styleSheets[r];if(n.ownerNode===e)return n}throw new Error},K=function(e,t,r){if(!t)return!1;var n=e.cssRules.length;try{e.insertRule(t,r<=n?r:n)}catch(e){return!1}return!0},$=function(){throw new Error("")},ee=function(e){return"\n/* sc-component-id: "+e+" */\n"},te=function(e,t){for(var r=0,n=0;n<=t;n+=1)r+=e[n];return r},re=function(e,t){return function(r){var n=X();return"<style "+[n&&'nonce="'+n+'"',j+'="'+Q(t)+'"',r].filter(Boolean).join(" ")+">"+e()+"</style>"}},ne=function(e,t){return function(){var r,n=((r={})[j]=Q(t),r),i=X();return i&&(n.nonce=i),h.a.createElement("style",F({},n,{dangerouslySetInnerHTML:{__html:e()}}))}},ie=function(e){return function(){return Object.keys(e)}},oe=function e(t,r){var n=void 0===t?Object.create(null):t,i=void 0===r?Object.create(null):r,o=function(e){var t=i[e];return void 0!==t?t:i[e]=[""]},a=function(){var e="";for(var t in i){var r=i[t][0];r&&(e+=ee(t)+r)}return e};return{styleTag:null,getIds:ie(i),hasNameForId:J(n),insertMarker:o,insertRules:function(e,t,r){o(e)[0]+=t.join(" "),q(n,e,r)},removeRules:function(e){var t=i[e];void 0!==t&&(t[0]="",Y(n,e))},css:a,toHTML:re(a,n),toElement:ne(a,n),clone:function(){var t=function(e){var t=Object.create(null);for(var r in e)t[r]=F({},e[r]);return t}(n),r=Object.create(null);for(var o in i)r[o]=[i[o][0]];return e(t,r)}}},ae=function(e,t,r,n,i){if(G&&!r){var o=function(e,t,r){var n=document.createElement("style");n.setAttribute(j,"");var i=X();if(i&&n.setAttribute("nonce",i),n.appendChild(document.createTextNode("")),e&&!t)e.appendChild(n);else{if(!t||!e||!t.parentNode)throw new Error("");t.parentNode.insertBefore(n,r?t:t.nextSibling)}return n}(e,t,n);return function(e,t){var r=Object.create(null),n=Object.create(null),i=[],o=void 0!==t,a=!1,s=function(e){var t=n[e];return void 0!==t?t:(n[e]=i.length,i.push(0),Y(r,e),n[e])},c=function(){var t=Z(e).cssRules,r="";for(var o in n){r+=ee(o);for(var a=n[o],s=te(i,a),c=s-i[a];c<s;c+=1){var u=t[c];void 0!==u&&(r+=u.cssText)}}return r};return{styleTag:e,getIds:ie(n),hasNameForId:J(r),insertMarker:s,insertRules:function(n,c,u){for(var l=s(n),h=Z(e),d=te(i,l),f=0,p=[],m=c.length,v=0;v<m;v+=1){var g=c[v],y=o;y&&-1!==g.indexOf("@import")?p.push(g):K(h,g,d+f)&&(y=!1,f+=1)}o&&p.length>0&&(a=!0,t().insertRules(n+"-import",p)),i[l]+=f,q(r,n,u)},removeRules:function(s){var c=n[s];if(void 0!==c){var u=i[c];!function(e,t,r){for(var n=t-r,i=t;i>n;i-=1)e.deleteRule(i)}(Z(e),te(i,c),u),i[c]=0,Y(r,s),o&&a&&t().removeRules(s+"-import")}},css:c,toHTML:re(c,r),toElement:ne(c,r),clone:$}}(o,i)}return oe()},se=void 0;se=G?1e3:-1;var ce,ue=0,le=void 0,he=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G?document.head:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];I(this,e),this.getImportRuleTag=function(){var e=t.importRuleTag;if(void 0!==e)return e;var r=t.tags[0];return t.importRuleTag=ae(t.target,r?r.styleTag:null,t.forceServer,!0)},ue+=1,this.id=ue,this.sealed=!1,this.forceServer=n,this.target=n?null:r,this.tagMap={},this.deferred={},this.rehydratedNames={},this.ignoreRehydratedNames={},this.tags=[],this.capacity=1,this.clones=[]}return e.prototype.rehydrate=function(){if(!G||this.forceServer)return this;var e=[],t=[],r=[],n=!1,i=document.querySelectorAll("style["+j+"]"),o=i.length;if(0===o)return this;for(var a=0;a<o;a+=1){var s=i[a];n=!!s.getAttribute("data-styled-streamed")||n;for(var c=(s.getAttribute(j)||"").trim().split(/\s+/),u=c.length,l=0;l<u;l+=1){var h=c[l];this.rehydratedNames[h]=!0,t.push(h)}r=r.concat(H(s.textContent)),e.push(s)}var d=r.length;if(0===d)return this;var f=function(e,t,r,n,i){var o=function(e){var t=!1;return function(){t||(t=!0,e())}}(function(){for(var n=0;n<r.length;n+=1){var i=r[n],o=i.componentId,a=i.cssFromDOM,s=C(a);e.insertRules(o,s)}for(var c=0;c<t.length;c+=1){var u=t[c];u.parentNode&&u.parentNode.removeChild(u)}});return i&&o(),F({},e,{insertMarker:function(t){return o(),e.insertMarker(t)},insertRules:function(t,r,n){return o(),e.insertRules(t,r,n)}})}(this.makeTag(null),e,r,0,n);this.capacity=Math.max(1,se-d),this.tags.push(f);for(var p=0;p<d;p+=1)this.tagMap[r[p].componentId]=f;return this},e.reset=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];le=new e(void 0,t).rehydrate()},e.prototype.clone=function(){var t=new e(this.target,this.forceServer);return this.clones.push(t),t.tags=this.tags.map(function(e){for(var r=e.getIds(),n=e.clone(),i=0;i<r.length;i+=1)t.tagMap[r[i]]=n;return n}),t.rehydratedNames=F({},this.rehydratedNames),t.deferred=F({},this.deferred),t},e.prototype.sealAllTags=function(){this.capacity=1,this.sealed=!0},e.prototype.makeTag=function(e){var t=e?e.styleTag:null;return ae(this.target,t,this.forceServer,!1,this.getImportRuleTag)},e.prototype.getTagForId=function(e){var t=this.tagMap[e];if(void 0!==t&&!this.sealed)return t;var r=this.tags[this.tags.length-1];return this.capacity-=1,0===this.capacity&&(this.capacity=se,this.sealed=!1,r=this.makeTag(r),this.tags.push(r)),this.tagMap[e]=r},e.prototype.hasId=function(e){return void 0!==this.tagMap[e]},e.prototype.hasNameForId=function(e,t){if(void 0===this.ignoreRehydratedNames[e]&&this.rehydratedNames[t])return!0;var r=this.tagMap[e];return void 0!==r&&r.hasNameForId(e,t)},e.prototype.deferredInject=function(e,t){if(void 0===this.tagMap[e]){for(var r=this.clones,n=0;n<r.length;n+=1)r[n].deferredInject(e,t);this.getTagForId(e).insertMarker(e),this.deferred[e]=t}},e.prototype.inject=function(e,t,r){for(var n=this.clones,i=0;i<n.length;i+=1)n[i].inject(e,t,r);var o=t,a=this.deferred[e];void 0!==a&&(o=a.concat(o),delete this.deferred[e]),this.getTagForId(e).insertRules(e,o,r)},e.prototype.remove=function(e){var t=this.tagMap[e];if(void 0!==t){for(var r=this.clones,n=0;n<r.length;n+=1)r[n].remove(e);t.removeRules(e),this.ignoreRehydratedNames[e]=!0,delete this.deferred[e]}},e.prototype.toHTML=function(){return this.tags.map(function(e){return e.toHTML()}).join("")},e.prototype.toReactElements=function(){var e=this.id;return this.tags.map(function(t,r){var n="sc-"+e+"-"+r;return Object(l.cloneElement)(t.toElement(),{key:n})})},D(e,null,[{key:"master",get:function(){return le||(le=(new e).rehydrate())}},{key:"instance",get:function(){return e.master}}]),e}(),de=function(e){function t(){return I(this,t),B(this,e.apply(this,arguments))}return U(t,e),t.prototype.getChildContext=function(){var e;return(e={})[V]=this.sheetInstance,e},t.prototype.componentWillMount=function(){if(this.props.sheet)this.sheetInstance=this.props.sheet;else{if(!this.props.target)throw new Error("");this.sheetInstance=new he(this.props.target)}},t.prototype.render=function(){return h.a.Children.only(this.props.children)},t}(l.Component);de.childContextTypes=((ce={})[V]=f.a.oneOfType([f.a.instanceOf(he),f.a.instanceOf(fe)]).isRequired,ce);var fe=function(){function e(){I(this,e),this.masterSheet=he.master,this.instance=this.masterSheet.clone(),this.closed=!1}return e.prototype.complete=function(){if(!this.closed){var e=this.masterSheet.clones.indexOf(this.instance);this.masterSheet.clones.splice(e,1),this.closed=!0}},e.prototype.collectStyles=function(e){if(this.closed)throw new Error("");return h.a.createElement(de,{sheet:this.instance},e)},e.prototype.getStyleTags=function(){return this.complete(),this.instance.toHTML()},e.prototype.getStyleElement=function(){return this.complete(),this.instance.toReactElements()},e.prototype.interleaveWithNodeStream=function(e){throw new Error("")},e}(),pe=function(e,t,r){var n=r&&e.theme===r.theme;return e.theme&&!n?e.theme:t},me=/[[\].#*$><+~=|^:(),"'`-]+/g,ve=/(^-|-$)/g;function ge(e){return e.replace(me,"-").replace(ve,"")}function ye(e){return e.displayName||e.name||"Component"}function be(e){return"string"==typeof e}var xe=/^((?:s(?:uppressContentEditableWarn|croll|pac)|(?:shape|image|text)Render|(?:letter|word)Spac|vHang|hang)ing|(?:on(?:AnimationIteration|C(?:o(?:mposition(?:Update|Start|End)|ntextMenu|py)|anPlayThrough|anPlay|hange|lick|ut)|(?:Animation|Touch|Load|Drag)Start|(?:(?:Duration|Volume|Rate)Chang|(?:MouseLea|(?:Touch|Mouse)Mo|DragLea)v|Paus)e|Loaded(?:Metad|D)ata|(?:(?:T(?:ransition|ouch)|Animation)E|Suspe)nd|DoubleClick|(?:TouchCanc|Whe)el|Lo(?:stPointer|ad)|TimeUpdate|(?:Mouse(?:Ent|Ov)e|Drag(?:Ent|Ov)e|Erro)r|GotPointer|MouseDown|(?:E(?:n(?:crypt|d)|mpti)|S(?:tall|eek))ed|KeyPress|(?:MouseOu|DragExi|S(?:elec|ubmi)|Rese|Inpu)t|P(?:rogress|laying)|DragEnd|Key(?:Down|Up)|(?:MouseU|Dro)p|(?:Wait|Seek)ing|Scroll|Focus|Paste|Abort|Drag|Play|Blur)Captur|alignmentBaselin|(?:limitingConeAng|xlink(?:(?:Arcr|R)o|Tit)|s(?:urfaceSca|ty|ca)|unselectab|baseProfi|fontSty|(?:focus|dragg)ab|multip|profi|tit)l|d(?:ominantBaselin|efaultValu)|onPointerLeav|a(?:uto(?:Capitaliz|Revers|Sav)|dditiv)|(?:(?:formNoValid|xlinkActu|noValid|accumul|rot)a|autoComple|decelera)t|(?:(?:attribute|item)T|datat)yp|onPointerMov|(?:attribute|glyph)Nam|playsInlin|(?:writing|input|edge)Mod|(?:formE|e)ncTyp|(?:amplitu|mo)d|(?:xlinkTy|itemSco|keyTy|slo)p|(?:xmlSpa|non)c|fillRul|(?:dateTi|na)m|r(?:esourc|ol)|xmlBas|wmod)e|(?:glyphOrientationHorizont|loc)al|(?:externalResourcesRequir|select|revers|mut)ed|c(?:o(?:lorInterpolationFilter|ord)s|o(?:lor(?:Interpolation)?|nt(?:rols|ent))|(?:ontentS(?:cript|tyle)Typ|o(?:ntentEditab|lorProfi)l|l(?:assNam|ipRul)|a(?:lcMod|ptur)|it)e|olorRendering|l(?:ipPathUnits|assID)|(?:ontrolsLis|apHeigh)t|h(?:eckedLink|a(?:llenge|rSet)|ildren|ecked)|ell(?:Spac|Padd)ing|o(?:ntextMenu|ls)|(?:rossOrigi|olSpa)n|lip(?:Path)?|ursor|[xy])|glyphOrientationVertical|d(?:angerouslySetInnerHTML|efaultChecked|ownload|isabled|isplay|[xy])|(?:s(?:trikethroughThickn|eaml)es|(?:und|ov)erlineThicknes|r(?:equiredExtension|adiu)|(?:requiredFeatur|tableValu|stitchTil|numOctav|filterR)e|key(?:(?:Splin|Tim)e|Param)|autoFocu|header|bia)s|(?:(?:st(?:rikethroughPosi|dDevia)|(?:und|ov)erlinePosi|(?:textDecor|elev)a|orienta)tio|(?:strokeLinejo|orig)i|on(?:PointerDow|FocusI)|formActio|zoomAndPa|directio|(?:vers|act)io|rowSpa|begi|ico)n|o(?:n(?:AnimationIteration|C(?:o(?:mposition(?:Update|Start|End)|ntextMenu|py)|anPlayThrough|anPlay|hange|lick|ut)|(?:(?:Duration|Volume|Rate)Chang|(?:MouseLea|(?:Touch|Mouse)Mo|DragLea)v|Paus)e|Loaded(?:Metad|D)ata|(?:Animation|Touch|Load|Drag)Start|(?:(?:T(?:ransition|ouch)|Animation)E|Suspe)nd|DoubleClick|(?:TouchCanc|Whe)el|(?:Mouse(?:Ent|Ov)e|Drag(?:Ent|Ov)e|Erro)r|TimeUpdate|(?:E(?:n(?:crypt|d)|mpti)|S(?:tall|eek))ed|MouseDown|P(?:rogress|laying)|(?:MouseOu|DragExi|S(?:elec|ubmi)|Rese|Inpu)t|KeyPress|DragEnd|Key(?:Down|Up)|(?:Wait|Seek)ing|(?:MouseU|Dro)p|Scroll|Paste|Focus|Abort|Drag|Play|Load|Blur)|rient)|p(?:reserveA(?:spectRatio|lpha)|ointsAt[X-Z]|anose1)|(?:patternContent|ma(?:sk(?:Content)?|rker)|primitive|gradient|pattern|filter)Units|(?:(?:allowTranspar|baseFrequ)enc|re(?:ferrerPolic|adOnl)|(?:(?:st(?:roke|op)O|floodO|fillO|o)pac|integr|secur)it|visibilit|fontFamil|accessKe|propert|summar)y|(?:gradientT|patternT|t)ransform|(?:[xy]ChannelSelect|lightingCol|textAnch|floodCol|stopCol|operat|htmlF)or|(?:strokeMiterlimi|(?:specularConsta|repeatCou|fontVaria)n|(?:(?:specularE|e)xpon|renderingInt|asc)en|d(?:iffuseConsta|esce)n|(?:fontSizeAdju|lengthAdju|manife)s|baselineShif|onPointerOu|vectorEffec|(?:(?:mar(?:ker|gin)|x)H|accentH|fontW)eigh|markerStar|a(?:utoCorrec|bou)|onFocusOu|intercep|restar|forma|inlis|heigh|lis)t|(?:(?:st(?:rokeDasho|artO)|o)ffs|acceptChars|formTarg|viewTarg|srcS)et|k(?:ernel(?:UnitLength|Matrix)|[1-4])|(?:(?:enableBackgrou|markerE)n|s(?:p(?:readMetho|ee)|ee)|formMetho|(?:markerM|onInval)i|preloa|metho|kin)d|strokeDasharray|(?:onPointerCanc|lab)el|(?:allowFullScre|hidd)en|systemLanguage|(?:(?:o(?:nPointer(?:Ent|Ov)|rd)|allowReord|placehold|frameBord|paintOrd|post)e|repeatDu|d(?:efe|u))r|v(?:Mathematical|ert(?:Origin[XY]|AdvY)|alues|ocab)|(?:pointerEve|keyPoi)nts|(?:strokeLineca|onPointerU|itemPro|useMa|wra|loo)p|h(?:oriz(?:Origin|Adv)X|ttpEquiv)|(?:vI|i)deographic|unicodeRange|mathematical|vAlphabetic|u(?:nicodeBidi|[12])|(?:fontStretc|hig)h|(?:(?:mar(?:ker|gin)W|strokeW)id|azimu)th|(?:xmlnsXl|valueL)ink|mediaGroup|spellCheck|(?:text|m(?:in|ax))Length|(?:unitsPerE|optimu|fro)m|r(?:adioGroup|e(?:sults|f[XY]|l)|ows|[xy])|a(?:rabicForm|l(?:phabetic|t)|sync)|pathLength|innerHTML|xlinkShow|(?:xlinkHr|glyphR)ef|(?:tabInde|(?:sand|b)bo|viewBo)x|(?:(?:href|xml|src)La|kerni)ng|autoPlay|o(?:verflow|pen)|f(?:o(?:ntSize|rm)|il(?:ter|l))|r(?:e(?:quired|sult|f))?|divisor|p(?:attern|oints)|unicode|d(?:efault|ata|ir)?|i(?:temRef|n2|s)|t(?:arget[XY]|o)|srcDoc|s(?:coped|te(?:m[hv]|p)|pan)|(?:width|size)s|prefix|typeof|itemID|s(?:t(?:roke|art)|hape|cope|rc)|t(?:arget|ype)|(?:stri|la)ng|a(?:ccept|s)|m(?:edia|a(?:sk|x)|in)|x(?:mlns)?|width|value|size|href|k(?:ey)?|end|low|by|i[dn]|y[12]|g[12]|x[12]|f[xy]|[yz])$/,we=RegExp.prototype.test.bind(new RegExp("^(x|data|aria)-[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"));var _e,Se,Me="__styled-components__",Te=Me+"next__",Ae=f.a.shape({getTheme:f.a.func,subscribe:f.a.func,unsubscribe:f.a.func});var Ee=function(e){function t(){I(this,t);var r=B(this,e.call(this));return r.unsubscribeToOuterId=-1,r.getTheme=r.getTheme.bind(r),r}return U(t,e),t.prototype.componentWillMount=function(){var e=this,t=this.context[Te];void 0!==t&&(this.unsubscribeToOuterId=t.subscribe(function(t){e.outerTheme=t,void 0!==e.broadcast&&e.publish(e.props.theme)})),this.broadcast=function(e){var t={},r=0,n=e;return{publish:function(e){for(var r in n=e,t){var i=t[r];void 0!==i&&i(n)}},subscribe:function(e){var i=r;return t[i]=e,r+=1,e(n),i},unsubscribe:function(e){t[e]=void 0}}}(this.getTheme())},t.prototype.getChildContext=function(){var e,t=this;return F({},this.context,((e={})[Te]={getTheme:this.getTheme,subscribe:this.broadcast.subscribe,unsubscribe:this.broadcast.unsubscribe},e[Me]=function(e){var r=t.broadcast.subscribe(e);return function(){return t.broadcast.unsubscribe(r)}},e))},t.prototype.componentWillReceiveProps=function(e){this.props.theme!==e.theme&&this.publish(e.theme)},t.prototype.componentWillUnmount=function(){-1!==this.unsubscribeToOuterId&&this.context[Te].unsubscribe(this.unsubscribeToOuterId)},t.prototype.getTheme=function(e){var t=e||this.props.theme;if(function(e){return"function"==typeof e}(t))return t(this.outerTheme);if(null===t||Array.isArray(t)||"object"!==(void 0===t?"undefined":R(t)))throw new Error("");return F({},this.outerTheme,t)},t.prototype.publish=function(e){this.broadcast.publish(this.getTheme(e))},t.prototype.render=function(){return this.props.children?h.a.Children.only(this.props.children):null},t}(l.Component);Ee.childContextTypes=((_e={})[Me]=f.a.func,_e[Te]=Ae,_e),Ee.contextTypes=((Se={})[Te]=Ae,Se);var Ce={};function Le(e){for(var t,r=0|e.length,n=0|r,i=0;r>=4;)t=1540483477*(65535&(t=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(t>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(t=1540483477*(65535&(t^=t>>>24))+((1540483477*(t>>>16)&65535)<<16)),r-=4,++i;switch(r){case 3:n^=(255&e.charCodeAt(i+2))<<16;case 2:n^=(255&e.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(i)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}var Pe=G,Oe=function e(t,r){for(var n=0;n<t.length;n+=1){var i=t[n];if(Array.isArray(i)&&!e(i))return!1;if("function"==typeof i&&!L(i))return!1}if(void 0!==r)for(var o in r){if("function"==typeof r[o])return!1}return!0},Ne=void 0!==n&&n.hot&&!1,Re=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];var Ie=function(e,t,r){var n=function(t){return e(Le(t))};return function(){function e(t,r,n){if(I(this,e),this.rules=t,this.isStatic=!Ne&&Oe(t,r),this.componentId=n,!he.master.hasId(n)){var i=[];he.master.deferredInject(n,i)}}return e.prototype.generateAndInjectStyles=function(e,i){var o=this.isStatic,a=this.componentId,s=this.lastClassName;if(Pe&&o&&void 0!==s&&i.hasNameForId(a,s))return s;var c=t(this.rules,e),u=n(this.componentId+c.join(""));if(!i.hasNameForId(a,u)){var l=r(c,"."+u);i.inject(this.componentId,l,u)}return this.lastClassName=u,u},e.generateName=function(e){return n(e)},e}()}(O,w,E),De=function(e){return function t(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Object(v.isValidElementType)(n))throw new Error("");var o=function(){return r(n,i,e.apply(void 0,arguments))};return o.withConfig=function(e){return t(r,n,F({},i,e))},o.attrs=function(e){return t(r,n,F({},i,{attrs:F({},i.attrs||{},e)}))},o}}(z),Fe=function(e,t){var r={},n=function(e){function t(){var r,n;I(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=B(this,e.call.apply(e,[this].concat(o))),n.attrs={},n.state={theme:null,generatedClassName:""},n.unsubscribeId=-1,B(n,r)}return U(t,e),t.prototype.unsubscribeFromContext=function(){-1!==this.unsubscribeId&&this.context[Te].unsubscribe(this.unsubscribeId)},t.prototype.buildExecutionContext=function(e,t){var r=this.constructor.attrs,n=F({},t,{theme:e});return void 0===r?n:(this.attrs=Object.keys(r).reduce(function(e,t){var i=r[t];return e[t]="function"!=typeof i||function(e,t){for(var r=e;r;)if((r=Object.getPrototypeOf(r))&&r===t)return!0;return!1}(i,l.Component)?i:i(n),e},{}),F({},n,this.attrs))},t.prototype.generateAndInjectStyles=function(e,t){var r=this.constructor,n=r.attrs,i=r.componentStyle,o=(r.warnTooManyClasses,this.context[V]||he.master);if(i.isStatic&&void 0===n)return i.generateAndInjectStyles(Ce,o);var a=this.buildExecutionContext(e,t);return i.generateAndInjectStyles(a,o)},t.prototype.componentWillMount=function(){var e=this,t=this.constructor.componentStyle,r=this.context[Te];if(t.isStatic){var n=this.generateAndInjectStyles(Ce,this.props);this.setState({generatedClassName:n})}else if(void 0!==r){var i=r.subscribe;this.unsubscribeId=i(function(t){var r=pe(e.props,t,e.constructor.defaultProps),n=e.generateAndInjectStyles(r,e.props);e.setState({theme:r,generatedClassName:n})})}else{var o=this.props.theme||{},a=this.generateAndInjectStyles(o,this.props);this.setState({theme:o,generatedClassName:a})}},t.prototype.componentWillReceiveProps=function(e){var t=this;this.constructor.componentStyle.isStatic||this.setState(function(r){var n=pe(e,r.theme,t.constructor.defaultProps);return{theme:n,generatedClassName:t.generateAndInjectStyles(n,e)}})},t.prototype.componentWillUnmount=function(){this.unsubscribeFromContext()},t.prototype.render=function(){var e=this,t=this.props.innerRef,r=this.state.generatedClassName,n=this.constructor,i=n.styledComponentId,o=n.target,a=be(o),s=[this.props.className,i,this.attrs.className,r].filter(Boolean).join(" "),c=F({},this.attrs,{className:s});L(o)?c.innerRef=t:c.ref=t;var u=Object.keys(this.props).reduce(function(t,r){return"innerRef"===r||"className"===r||a&&!function(e){return xe.test(e)||we(e.toLowerCase())}(r)||(t[r]=e.props[r]),t},c);return Object(l.createElement)(o,u)},t}(l.Component);return function i(o,a,s){var c,u=a.isClass,l=void 0===u?!be(o):u,h=a.displayName,d=void 0===h?function(e){return be(e)?"styled."+e:"Styled("+ye(e)+")"}(o):h,p=a.componentId,v=void 0===p?function(t,n){var i="string"!=typeof t?"sc":ge(t),o=void 0;if(t)o=i+"-"+e.generateName(i);else{var a=(r[i]||0)+1;r[i]=a,o=i+"-"+e.generateName(i+a)}return void 0!==n?n+"-"+o:o}(a.displayName,a.parentComponentId):p,g=a.ParentComponent,y=void 0===g?n:g,b=a.rules,x=a.attrs,w=a.displayName&&a.componentId?ge(a.displayName)+"-"+a.componentId:v,_=new e(void 0===b?s:b.concat(s),x,w),S=function(e){function r(){return I(this,r),B(this,e.apply(this,arguments))}return U(r,e),r.withComponent=function(e){var t=a.componentId,n=k(a,["componentId"]),o=t&&t+"-"+(be(e)?e:ge(ye(e))),c=F({},n,{componentId:o,ParentComponent:r});return i(e,c,s)},D(r,null,[{key:"extend",get:function(){var e=a.rules,n=a.componentId,c=k(a,["rules","componentId"]),u=void 0===e?s:e.concat(s),l=F({},c,{rules:u,parentComponentId:n,ParentComponent:r});return t(i,o,l)}}]),r}(y);return S.contextTypes=((c={})[Me]=f.a.func,c[Te]=Ae,c[V]=f.a.oneOfType([f.a.instanceOf(he),f.a.instanceOf(fe)]),c),l&&m()(S,o),S.displayName=d,S.styledComponentId=w,S.attrs=x,S.componentStyle=_,S.target=o,S}}(Ie,De),Ue=(function(e,t,r){}(O,E,z),function(e,t){return function(){var r=he.master,n=t.apply(void 0,arguments),i="sc-global-"+Le(JSON.stringify(n));r.hasId(i)||r.inject(i,e(n))}}(E,z)),ke=function(e,t){var r=function(r){return t(e,r)};return Re.forEach(function(e){r[e]=r(e)}),r}(Fe,De);t.a=ke}).call(this,r("26d59f808dff3e83c741"),r("044f282f6141fc605782")(e))},defadd612c0b27cd2d2d:function(e,t,r){"use strict";e.exports=function(e){var t=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"==typeof t.Node?e instanceof t.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}},e1840f007f040a84a1ab:function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("italics",function(e){return function(){return e(this,"i","","")}})},e28425bb72f854691929:function(e,t,r){var n=r("1b01d0e59d3af79760a0").f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||r("5975c7ea3ecd56e534e3")&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},e3136eea77d23f8d97ec:function(e,t,r){var n=r("d34390b928ecadc11dc8"),i=r("efae14a3f8cd9a616256"),o=r("2076e982c14c41925fb4")(!1),a=r("5f6eded14a8ed86276fc")("IE_PROTO");e.exports=function(e,t){var r,s=i(e),c=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~o(u,r)||u.push(r));return u}},e57aad3e28ab6bac0380:function(e,t,r){"use strict";var n=r("ccf730c83e7100f675a4"),i=r("2c407c4438ef2794ef23");r("0633550d227682cecd10")("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"WeakSet"),e,!0)}},n,!1,!0)},e5c4ff14bae25ddfa508:function(e,t,r){var n=r("621a65702ee1a566fd32")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},e61a87a9a868f6feefd8:function(e,t,r){!function(t,n){e.exports=n(r("8af190b70a6bc55c6f1b"),r("8a2d1b95e05b6a321e74"))}("undefined"!=typeof self&&self,function(e,t){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){console.warn("[react-ga]",e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/^\s+|\s+$/g,"")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testModeAPI=t.OutboundLink=t.plugin=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.initialize=_,t.ga=S,t.set=M,t.send=T,t.pageview=A,t.modalview=E,t.timing=C,t.event=L,t.exception=P,t.outboundLink=N;var o=f(r(3)),a=f(r(6)),s=f(r(1)),c=f(r(7)),u=f(r(0)),l=f(r(8)),h=f(r(9)),d=f(r(10));function f(e){return e&&e.__esModule?e:{default:e}}var p=!1,m=!0,v=!1,g=!0,y=function(){var e;return v?h.default.ga.apply(h.default,arguments):window.ga?(e=window).ga.apply(e,arguments):(0,u.default)("ReactGA.initialize must be called first or GoogleAnalytics should be loaded manually")};function b(e){return(0,o.default)(e,m)}function x(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=r[0];if("function"==typeof y){if("string"!=typeof i)return void(0,u.default)("ga command must be a string");!g&&Array.isArray(e)||y.apply(void 0,r),Array.isArray(e)&&e.forEach(function(e){y.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}([e+"."+i].concat(r.slice(1))))})}}function w(e,t){e?(t&&(t.debug&&!0===t.debug&&(p=!0),!1===t.titleCase&&(m=!1)),t&&t.gaOptions?y("create",e,t.gaOptions):y("create",e,"auto")):(0,u.default)("gaTrackingID is required in initialize()")}function _(e,t){if(t&&!0===t.testMode)v=!0;else{if("undefined"==typeof window)return!1;(0,c.default)(t)}return g=!t||"boolean"!=typeof t.alwaysSendToDefaultTracker||t.alwaysSendToDefaultTracker,Array.isArray(e)?e.forEach(function(e){"object"===(void 0===e?"undefined":i(e))?w(e.trackingId,e):(0,u.default)("All configs must be an object")}):w(e,t),!0}function S(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length>0&&(y.apply(void 0,t),p&&((0,l.default)("called ga('arguments');"),(0,l.default)("with arguments: "+JSON.stringify(t)))),window.ga}function M(e,t){e?"object"===(void 0===e?"undefined":i(e))?(0===Object.keys(e).length&&(0,u.default)("empty `fieldsObject` given to .set()"),x(t,"set",e),p&&((0,l.default)("called ga('set', fieldsObject);"),(0,l.default)("with fieldsObject: "+JSON.stringify(e)))):(0,u.default)("Expected `fieldsObject` arg to be an Object"):(0,u.default)("`fieldsObject` is required in .set()")}function T(e,t){x(t,"send",e),p&&((0,l.default)("called ga('send', fieldObject);"),(0,l.default)("with fieldObject: "+JSON.stringify(e)),(0,l.default)("with trackers: "+JSON.stringify(t)))}function A(e,t,r){if(e){var i=(0,s.default)(e);if(""!==i){var o={};if(r&&(o.title=r),x(t,"send",n({hitType:"pageview",page:i},o)),p){(0,l.default)("called ga('send', 'pageview', path);");var a="";r&&(a=" and title: "+r),(0,l.default)("with path: "+i+a)}}else(0,u.default)("path cannot be an empty string in .pageview()")}else(0,u.default)("path is required in .pageview()")}function E(e,t){if(e){var r=(0,a.default)((0,s.default)(e));if(""!==r){var n="/modal/"+r;x(t,"send","pageview",n),p&&((0,l.default)("called ga('send', 'pageview', path);"),(0,l.default)("with path: "+n))}else(0,u.default)("modalName cannot be an empty string or a single / in .modalview()")}else(0,u.default)("modalName is required in .modalview(modalName)")}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.category,r=e.variable,n=e.value,i=e.label,o=arguments[1];if(t&&r&&n&&"number"==typeof n){var a={hitType:"timing",timingCategory:b(t),timingVar:b(r),timingValue:n};i&&(a.timingLabel=b(i)),T(a,o)}else(0,u.default)("args.category, args.variable AND args.value are required in timing() AND args.value has to be a number")}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=e.category,n=e.action,i=e.label,o=e.value,a=e.nonInteraction,s=e.transport,c=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["category","action","label","value","nonInteraction","transport"]);if(r&&n){var l={hitType:"event",eventCategory:b(r),eventAction:b(n)};i&&(l.eventLabel=b(i)),void 0!==o&&("number"!=typeof o?(0,u.default)("Expected `args.value` arg to be a Number."):l.eventValue=o),void 0!==a&&("boolean"!=typeof a?(0,u.default)("`args.nonInteraction` must be a boolean."):l.nonInteraction=a),void 0!==s&&("string"!=typeof s?(0,u.default)("`args.transport` must be a string."):(-1===["beacon","xhr","image"].indexOf(s)&&(0,u.default)("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),l.transport=s)),Object.keys(c).filter(function(e){return"dimension"===e.substr(0,"dimension".length)}).forEach(function(e){l[e]=c[e]}),Object.keys(c).filter(function(e){return"metric"===e.substr(0,"metric".length)}).forEach(function(e){l[e]=c[e]}),T(l,t)}else(0,u.default)("args.category AND args.action are required in event()")}function P(e,t){var r=e.description,n=e.fatal,i={hitType:"exception"};r&&(i.exDescription=b(r)),void 0!==n&&("boolean"!=typeof n?(0,u.default)("`args.fatal` must be a boolean."):i.exFatal=n),T(i,t)}var O=t.plugin={require:function(e,t){if(e){var r=(0,s.default)(e);if(""!==r)if(t){if("object"!==(void 0===t?"undefined":i(t)))return void(0,u.default)("Expected `options` arg to be an Object");0===Object.keys(t).length&&(0,u.default)("Empty `options` given to .require()"),S("require",r,t),p&&(0,l.default)("called ga('require', '"+r+"', "+JSON.stringify(t))}else S("require",r),p&&(0,l.default)("called ga('require', '"+r+"');");else(0,u.default)("`name` cannot be an empty string in .require()")}else(0,u.default)("`name` is required in .require()")},execute:function(e,t){var r=void 0,n=void 0;if(1==(arguments.length<=2?0:arguments.length-2)?r=arguments.length<=2?void 0:arguments[2]:(n=arguments.length<=2?void 0:arguments[2],r=arguments.length<=3?void 0:arguments[3]),"string"!=typeof e)(0,u.default)("Expected `pluginName` arg to be a String.");else if("string"!=typeof t)(0,u.default)("Expected `action` arg to be a String.");else{var i=e+":"+t;r=r||null,n&&r?(S(i,n,r),p&&((0,l.default)("called ga('"+i+"');"),(0,l.default)('actionType: "'+n+'" with payload: '+JSON.stringify(r)))):r?(S(i,r),p&&((0,l.default)("called ga('"+i+"');"),(0,l.default)("with payload: "+JSON.stringify(r)))):(S(i),p&&(0,l.default)("called ga('"+i+"');"))}}};function N(e,t,r){if("function"==typeof t)if(e&&e.label){var n={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:b(e.label)},i=!1,o=setTimeout(function(){i=!0,t()},250);n.hitCallback=function(){clearTimeout(o),i||t()},T(n,r)}else(0,u.default)("args.label is required in outboundLink()");else(0,u.default)("hitCallback function is required")}d.default.origTrackLink=d.default.trackLink,d.default.trackLink=N;var R=t.OutboundLink=d.default;t.testModeAPI=h.default;t.default={initialize:_,ga:S,set:M,send:T,pageview:A,modalview:E,timing:C,event:L,exception:P,plugin:O,outboundLink:N,OutboundLink:R,testModeAPI:h.default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,n.default)(e))return(0,o.default)("This arg looks like an email address, redacting."),s;if(t)return(0,i.default)(e);return e};var n=a(r(4)),i=a(r(5)),o=a(r(0));function a(e){return e&&e.__esModule?e:{default:e}}var s="REDACTED (Potential Email Address)"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return/[^@]+@[^@]+/.test(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e).replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(e,t,r){return t>0&&t+e.length!==r.length&&e.search(i)>-1&&":"!==r.charAt(t-2)&&("-"!==r.charAt(t+e.length)||"-"===r.charAt(t-1))&&r.charAt(t-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)})};var n=function(e){return e&&e.__esModule?e:{default:e}}(r(1));var i=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("/"===e.substring(0,1))return e.substring(1);return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){!function(e,t,r,n,i,o,a){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,o=t.createElement(r),a=t.getElementsByTagName(r)[0],o.async=1,o.src=n,a.parentNode.insertBefore(o,a)}(window,document,"script",e&&e.gaAddress?e.gaAddress:"https://www.google-analytics.com/analytics.js","ga")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){console.info("[react-ga]",e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.gaCalls=[];t.default={calls:n,ga:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.push([].concat(t))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(11),a=u(o),s=u(r(12)),c=u(r(0));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h="_blank",d=1,f=function(e){function t(){var e,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.handleClick=function(e){var r=n.props,i=r.target,o=r.eventLabel,a=r.to,s=r.onClick,c={label:o},u=i!==h,l=!(e.ctrlKey||e.shiftKey||e.metaKey||e.button===d);u&&l?(e.preventDefault(),t.trackLink(c,function(){window.location.href=a})):t.trackLink(c,function(){}),s&&s(e)},l(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),i(t,[{key:"render",value:function(){var e=n({},this.props,{href:this.props.to,onClick:this.handleClick});return delete e.eventLabel,a.default.createElement("a",e)}}]),t}();f.propTypes={eventLabel:s.default.string.isRequired,target:s.default.string,to:s.default.string,onClick:s.default.func},f.defaultProps={target:null,to:null,onClick:null},f.trackLink=function(){(0,c.default)("ga tracking not enabled")},t.default=f},function(t,r){t.exports=e},function(e,r){e.exports=t}])})},e6a347faa9f19b1ed599:function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("big",function(e){return function(){return e(this,"big","","")}})},e6c5abf5a58e496b58dc:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("d14c3129375a94963214"));t.default=n.default},e72f1581ae3b588359b2:function(e,t,r){var n=r("61fcea04092a9580d371"),i=r("12323e1413cbffdabe02"),o=r("d34390b928ecadc11dc8"),a=r("2d13d93c336705cd8ff9"),s=r("a459ab805827640a27e8"),c=r("79c91dcd8cd554c59c7b");a(a.S,"Reflect",{get:function e(t,r){var a,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[r]:(a=n.f(t,r))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(u=i(t))?e(u,r,l):void 0}})},e7474db296820464a2ff:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("12323e1413cbffdabe02"),o=r("79c91dcd8cd554c59c7b");n(n.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},e92b89da57efd8b02487:function(e,t,r){var n=r("d394d0a4c1838202489d"),i=r("12323e1413cbffdabe02");r("f34797c0b42452934317")("getPrototypeOf",function(){return function(e){return i(n(e))}})},e95a63b25fb92ed15721:function(e,t,r){"use strict";t.__esModule=!0,t.withRouter=t.matchPath=t.generatePath=t.Switch=t.StaticRouter=t.Router=t.Route=t.Redirect=t.Prompt=t.NavLink=t.MemoryRouter=t.Link=t.HashRouter=t.BrowserRouter=void 0;var n=g(r("16c6ea6c9ece643bfb5c")),i=g(r("2aec3e82eb0e43bbbba2")),o=g(r("c5dd00b0f3b91ce870bd")),a=g(r("b05c6f46a9990189714c")),s=g(r("64c9c4b07fb151f67f60")),c=g(r("b3b01db6127592dc78f8")),u=g(r("801f84267d5c09c3892e")),l=g(r("f4443236244759f9cc1d")),h=g(r("3ddbfa7ffbc97506f3e4")),d=g(r("7336e9dece9add80afce")),f=g(r("2f2c658b8d03e5165a06")),p=g(r("e6c5abf5a58e496b58dc")),m=g(r("3ca1626832512beb31ab")),v=g(r("4901eb5005bcc482eb97"));function g(e){return e&&e.__esModule?e:{default:e}}t.BrowserRouter=n.default,t.HashRouter=i.default,t.Link=o.default,t.MemoryRouter=a.default,t.NavLink=s.default,t.Prompt=c.default,t.Redirect=u.default,t.Route=l.default,t.Router=h.default,t.StaticRouter=d.default,t.Switch=f.default,t.generatePath=p.default,t.matchPath=m.default,t.withRouter=v.default},e99524bb668f88c6c42e:function(e,t,r){var n=r("33e73011281ee8023d77"),i=r("4b93c5a7bb60dd6ab0f4"),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},ea43fcdd13c8985f076e:function(e,t,r){"use strict";var n=r("defadd612c0b27cd2d2d");e.exports=function(e){return n(e)&&3==e.nodeType}},ea45ad43eef3e386e18c:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.S+n.F*!r("5975c7ea3ecd56e534e3"),"Object",{defineProperties:r("a6d645856102faf17328")})},eb3400b937b92a185016:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r("54f683fcda7806277002")),i=r("36a2a8f008a24a4063b9");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.default.Map,r=Object.keys(e);return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t(),o=arguments[1];return n.withMutations(function(t){r.forEach(function(r){var n=(0,e[r])(t.get(r),o);(0,i.validateNextState)(n,r,o),t.set(r,n)})})}},e.exports=t.default},ebc27012af6f56e487f3:function(e,t,r){"use strict";var n=r("2d13d93c336705cd8ff9"),i=r("7ad2c0eb9a8edcc472a4"),o=r("ca19e32ab6ee3b3692aa"),a=r("1582553a0f2276f66f2f"),s=r("f936413e306f54e59a2a"),c=RegExp.prototype,u=function(e,t){this._r=e,this._s=t};r("5c5d334c57135891e397")(u,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),n(n.P,"String",{matchAll:function(e){if(i(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in c?String(e.flags):s.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=o(e.lastIndex),new u(n,t)}})},ec9de96ce27c00ac79c5:function(e,t,r){"use strict";function n(e){return function(){return e}}var i=function(){};i.thatReturns=n,i.thatReturnsFalse=n(!1),i.thatReturnsTrue=n(!0),i.thatReturnsNull=n(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},ecd0e0fb36455021f082:function(e,t,r){var n=r("0e717e1f47872428608d"),i=r("a537d0accb907bf9d41f"),o=r("d394d0a4c1838202489d"),a=r("ca19e32ab6ee3b3692aa"),s=r("0594430ce9777a0767aa");e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,h=6==e,d=5==e||h,f=t||s;return function(t,s,p){for(var m,v,g=o(t),y=i(g),b=n(s,p,3),x=a(y.length),w=0,_=r?f(t,x):c?f(t,0):void 0;x>w;w++)if((d||w in y)&&(v=b(m=y[w],w,g),e))if(r)_[w]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:_.push(m)}else if(l)return!1;return h?-1:u||l?l:_}}},edb183dfe43ad4a21ef0:function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},eedc997fc37971b68c9e:function(e,t,r){(function(e){var n=r("5de5c65c2c431f821291"),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i&&n.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(this,r("f586cf5b9f4b7719b2c1")(e))},ef09ce044ac3210bc947:function(e,t,r){var n=r("79c91dcd8cd554c59c7b"),i=r("a6d645856102faf17328"),o=r("380c0734c088ca78ccda"),a=r("5f6eded14a8ed86276fc")("IE_PROTO"),s=function(){},c=function(){var e,t=r("68a989d6f90923909f2a")("iframe"),n=o.length;for(t.style.display="none",r("5b9dc0e027f5c68eff1a").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[o[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=c(),void 0===t?r:i(r,t)}},efae14a3f8cd9a616256:function(e,t,r){var n=r("a537d0accb907bf9d41f"),i=r("7ad2c0eb9a8edcc472a4");e.exports=function(e){return n(i(e))}},f0200b4beabe56dc845a:function(e,t,r){var n=r("4be2c15021f717a728f0")(r("18caba858d9ea0f67284"),"Map");e.exports=n},f2873ecf7390fe7d7c89:function(e,t,r){var n=r("8ce22de999557008faac"),i=r("3478ed78d76c28060dce");e.exports=function(e,t){return null==t||n(e,t,i(t))}},f2ef6f6e544aad97aa22:function(e,t){var r=Array.isArray;e.exports=r},f309c35c0ec3caac8c45:function(e,t,r){var n=r("1b01d0e59d3af79760a0"),i=r("61fcea04092a9580d371"),o=r("12323e1413cbffdabe02"),a=r("d34390b928ecadc11dc8"),s=r("2d13d93c336705cd8ff9"),c=r("9d5592e83ab7f3d08974"),u=r("79c91dcd8cd554c59c7b"),l=r("a459ab805827640a27e8");s(s.S,"Reflect",{set:function e(t,r,s){var h,d,f=arguments.length<4?t:arguments[3],p=i.f(u(t),r);if(!p){if(l(d=o(t)))return e(d,r,s,f);p=c(0)}if(a(p,"value")){if(!1===p.writable||!l(f))return!1;if(h=i.f(f,r)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,n.f(f,r,h)}else n.f(f,r,c(0,s));return!0}return void 0!==p.set&&(p.set.call(f,s),!0)}})},f34797c0b42452934317:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("5925dad3c5243ffee3db"),o=r("7a7739dd8a198a2cfcb5");e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",a)}},f3b0ff1628e56352bcbf:function(e,t,r){var n=r("67042e57ad02a5947bc9"),i=r("d3a850c4000d77bccc89"),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";e.exports=function(e){if(!i(e))return!1;var t=n(e);return t==a||t==s||t==o||t==c}},f3bd18506acf22d8f1d4:function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},f4443236244759f9cc1d:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("35440e3d539ea8d61c51"));t.default=n.default},f519451816147948df30:function(e,t,r){"use strict";r("03ba1ede2f4706d1e7f7")("fixed",function(e){return function(){return e(this,"tt","","")}})},f586cf5b9f4b7719b2c1:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},f5ddf41194f6969220b2:function(e,t,r){var n=r("a459ab805827640a27e8"),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},f62053ff67fa82664144:function(e,t){e.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},f66a9a2f451f5f6cfabf:function(e,t,r){var n;
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/
!function(){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},f6c1259b6a257e147998:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r("54f683fcda7806277002")),i=o(r("a36c797149bbcb96646f"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,r){var o=Object.keys(t);if(!o.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";var a=(0,i.default)(r);if(n.default.isImmutable?!n.default.isImmutable(e):!n.default.Iterable.isIterable(e))return"The "+a+' is of unexpected type. Expected argument to be an instance of Immutable.Collection or Immutable.Record with the following properties: "'+o.join('", "')+'".';var s=e.toSeq().keySeq().toArray().filter(function(e){return!t.hasOwnProperty(e)});return s.length>0?"Unexpected "+(1===s.length?"property":"properties")+' "'+s.join('", "')+'" found in '+a+'. Expected to find one of the known reducer property names instead: "'+o.join('", "')+'". Unexpected properties will be ignored.':null},e.exports=t.default},f71a7c9d37f996326dd6:function(e,t){t.f=Object.getOwnPropertySymbols},f72c7c366a646d5e453e:function(e,t){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&n.test(e))&&e>-1&&e%1==0&&e<t}},f7ee588e96ed47a6425e:function(e,t,r){"use strict";e.exports=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}},f8695b95b3c9135976f0:function(e,t,r){r("c68991e63a6e99ff2511")("asyncIterator")},f883c6a0eaee60a48ea0:function(e,t,r){var n=r("191adceeffad46f4bba8"),i=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},f88518adc3004bf8d923:function(e,t,r){var n=r("32b716d95af2fd3c5c23"),i=r("621a65702ee1a566fd32")("iterator"),o=r("224ae09e536c09e69a0a");e.exports=r("5925dad3c5243ffee3db").getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},f936413e306f54e59a2a:function(e,t,r){"use strict";var n=r("79c91dcd8cd554c59c7b");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},fa5cd10f53a62f249502:function(e,t,r){var n=r("2d13d93c336705cd8ff9");n(n.P,"Array",{fill:r("03192b087bb464f059c0")}),r("a5e6f0092ff0290e0bcf")("fill")},fb18731b3c51330e7b11:function(e,t,r){r("9f769c6d0e4c9e82ba05")("Set")},fcdb9f352e4ad889e33f:function(e,t,r){var n=r("2d13d93c336705cd8ff9"),i=r("336cae077811264f3d1e")(!1);n(n.S,"Object",{values:function(e){return i(e)}})},fd8b6034a9a06242cc87:function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},ff48eaa47603dbd72464:function(e,t,r){var n=r("14462f9650d45fd47dc7"),i=r("79c91dcd8cd554c59c7b"),o=r("4d073e2fededcdd3f3d3"),a=n.key,s=n.set;n.exp({metadata:function(e,t){return function(r,n){s(e,t,(void 0!==n?i:o)(r),a(n))}}})}}]);